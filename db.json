{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/favicon.ico","path":"favicon.ico","modified":0,"renderable":0},{"_id":"source/images/1763449.jpeg","path":"images/1763449.jpeg","modified":0,"renderable":0},{"_id":"source/images/6rM7Vv.png","path":"images/6rM7Vv.png","modified":0,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"0f5ada9029dfc7aa0564af4ea2dd4b78e9c256bb","modified":1534830416132},{"_id":"source/404.html","hash":"d6cd47ba4ab178269d9e7be773e521a3f74a738b","modified":1522831013409},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1493607047000},{"_id":"source/favicon.ico","hash":"b8cbaae3179425a1f2f34e3cc7685156320e9c2b","modified":1495275034000},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1493607047000},{"_id":"themes/next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1493607047000},{"_id":"themes/next/.gitignore","hash":"32ea93f21d8693d5d8fa4eef1c51a21ad0670047","modified":1493607047000},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1493607047000},{"_id":"themes/next/.javascript_ignore","hash":"f9ea3c5395f8feb225a24e2c32baa79afda30c16","modified":1493607047000},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1493607047000},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1493607047000},{"_id":"themes/next/.travis.yml","hash":"c42d9608c8c7fe90de7b1581a8dc3886e90c179e","modified":1493607047000},{"_id":"themes/next/LICENSE","hash":"f293bcfcdc06c0b77ba13570bb8af55eb5c059fd","modified":1493607047000},{"_id":"themes/next/README.en.md","hash":"4ece25ee5f64447cd522e54cb0fffd9a375f0bd4","modified":1493607047000},{"_id":"themes/next/bower.json","hash":"be0a430362cb73a7e3cf9ecf51a67edf8214b637","modified":1493607047000},{"_id":"themes/next/_config.yml","hash":"3c1eff331b52f59e9c2b46b0a01f42c866da3c64","modified":1522831087485},{"_id":"themes/next/README.md","hash":"500b5606eb6a09c979d16128f8b00f4bf9bc95ac","modified":1493607047000},{"_id":"themes/next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1493607047000},{"_id":"themes/next/package-lock.json","hash":"3b6749ab243826db22385571b80bea680cf67415","modified":1522829447284},{"_id":"themes/next/package.json","hash":"dfc6f6259c0777577ea91da47cbb6dd55dd15321","modified":1522829447271},{"_id":"source/_drafts/hyperledger 多机器部署.md","hash":"c08a3699a72f50da1dd2019e1d7e9dfa599ab317","modified":1566798717053},{"_id":"source/_drafts/hyperledger CA部署.md","hash":"0e384d3262cdc06863448aff590b683b957e8d2d","modified":1566284425452},{"_id":"source/_posts/crontab.md","hash":"9aae2c6b0b3acce27634fd0492a95d0f99614abf","modified":1529400869763},{"_id":"source/_posts/hello-world.md","hash":"8a02477044e2b77f1b262da2c48c01429e4a32e4","modified":1493606384000},{"_id":"source/_posts/centos6.5安装python2.7.md","hash":"28ea700a8745320615a6ce3779ab49dae746a9d6","modified":1544775355013},{"_id":"source/_posts/gitlab维护命令.md","hash":"5edbb9fe78d05a4e229ee90bb86180065ce01eb8","modified":1546923547201},{"_id":"source/_posts/hyperledger 多机器部署.md","hash":"ca038a6e7dab905fd1bb867a13fcab996158a246","modified":1571195867709},{"_id":"source/_posts/hyperledger部署测试.md","hash":"6ffde12a6fae854da66f2711b748a9aea5ab403d","modified":1565924175546},{"_id":"source/_posts/hive on spark .md","hash":"0ba0e576b1366a5a6b719a3f0f702647579ac565","modified":1544774827003},{"_id":"source/_posts/hive表的创建.md","hash":"f3d0c204a39b4d482aa5a68b4d5ce7740034eed8","modified":1495266766000},{"_id":"source/_posts/jdk1.8安装.md","hash":"034e03da334402d1c99efd31b482c562958dfea2","modified":1527735989865},{"_id":"source/_posts/leetcode1.md","hash":"e08143ca095a70ef44e44f19146c47672785d3be","modified":1522993975386},{"_id":"source/_posts/java 垃圾回收.md","hash":"197f061b4ba160e6a36a5acb3480e2139aaa4e80","modified":1523261759905},{"_id":"source/_posts/linux 安装openvpn.md","hash":"87f3312ab169fd2652dc254ed68a55d026a1af67","modified":1546872824036},{"_id":"source/_posts/mysql5.7GTID主从同步.md","hash":"6b9b198d21034c492aaf3f3fc589bdb9ed0e005f","modified":1546853456759},{"_id":"source/_posts/linux磁盘格式化.md","hash":"225c1ee7deac33dce29423968677ec536f2a9199","modified":1528698445399},{"_id":"source/_posts/mysql安装.md","hash":"b42a3934b7deb2b1519bc1984933e03a55c6b8ac","modified":1552294055805},{"_id":"source/_posts/spark pyspark .md","hash":"b58d3a04622f09d3920cb2c3a808a67afe448ec2","modified":1529981227041},{"_id":"source/_posts/nginx-openssl版本问题.md","hash":"6140044a3a78fb47c18d55f481060a84bc910b20","modified":1522825402900},{"_id":"source/_posts/php启动设置.md","hash":"76695bf9b8019085199aec3194006b83d8eb3cdf","modified":1529400646165},{"_id":"source/_posts/mysql导出数据.md","hash":"4ec2ab3a2ea3a0dcd3fd0b00b7bde04e38d65a15","modified":1527935878531},{"_id":"source/_posts/单向散列函数.md","hash":"5d4655b96da607153c8fb615f9fc07ab2d50ba59","modified":1553839088659},{"_id":"source/_posts/在现实编程中使用fluent模式.md","hash":"98359cf2508b16f967536e3efbdc6c34f81bf250","modified":1495274804000},{"_id":"source/_posts/面试题1.md","hash":"44b4fd553540fc257d8dd2955d43bac40ce52741","modified":1575555542264},{"_id":"source/_posts/面试题2.md","hash":"73e9164b1e5797c18fd56c66f60debc8f96b903b","modified":1575555538544},{"_id":"source/_posts/编写第一个hyperledger区块链应用.md","hash":"b2d10ba174c58af9b3a3a2a624b33589dd53686d","modified":1567149971640},{"_id":"source/categories/index.md","hash":"426a38367f2a7d80bd8b6f24a00b24fc8942001b","modified":1493634903000},{"_id":"source/_posts/小华日常.md","hash":"bda2613e6517d50df5f94ddd4c047edf1f9bf543","modified":1507687554000},{"_id":"source/images/1763449.jpeg","hash":"de5e607a1f0fcb7fe007a906038f714915b29772","modified":1495274947000},{"_id":"source/tags/index.md","hash":"48877965149507385cc7944b67b3274afaa850bf","modified":1493634898000},{"_id":"source/images/6rM7Vv.png","hash":"6f6fcd2adce6f3844de46dc75b4c58c81a8cdf7a","modified":1495267331000},{"_id":"themes/next/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1493607047000},{"_id":"themes/next/.git/config","hash":"bf7d1df65cf34d0f25a7184a58c37a09f72e4be7","modified":1493607047000},{"_id":"themes/next/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1493607015000},{"_id":"themes/next/.git/packed-refs","hash":"3a1a0ea5adcb5ecd878b4d98ea9f24a0425b0f3e","modified":1493607047000},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"3b5eafd32abb718e56ccf8d1cee0607ad8ce611d","modified":1493607047000},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"fdd63b77472612337309eb93ec415a059b90756b","modified":1493607047000},{"_id":"themes/next/languages/id.yml","hash":"2835ea80dadf093fcf47edd957680973f1fb6b85","modified":1493607047000},{"_id":"themes/next/languages/default.yml","hash":"4cc6aeb1ac09a58330e494c8771773758ab354af","modified":1493607047000},{"_id":"themes/next/languages/de.yml","hash":"306db8c865630f32c6b6260ade9d3209fbec8011","modified":1493607047000},{"_id":"themes/next/.git/index","hash":"f4a696bdd21a0c084df1d03c77b5fdd3b4a4e7dc","modified":1522830781927},{"_id":"themes/next/languages/fr-FR.yml","hash":"24180322c83587a153cea110e74e96eacc3355ad","modified":1493607047000},{"_id":"themes/next/languages/en.yml","hash":"e7def07a709ef55684490b700a06998c67f35f39","modified":1493607047000},{"_id":"themes/next/languages/ko.yml","hash":"be150543379150f78329815af427bf152c0e9431","modified":1493607047000},{"_id":"themes/next/languages/ja.yml","hash":"1c3a05ab80a6f8be63268b66da6f19da7aa2c638","modified":1493607047000},{"_id":"themes/next/languages/ru.yml","hash":"1549a7c2fe23caa7cbedcd0aa2b77c46e57caf27","modified":1493607047000},{"_id":"themes/next/languages/pt.yml","hash":"36c8f60dacbe5d27d84d0e0d6974d7679f928da0","modified":1493607047000},{"_id":"themes/next/languages/pt-BR.yml","hash":"958e49571818a34fdf4af3232a07a024050f8f4e","modified":1493607047000},{"_id":"themes/next/languages/zh-hk.yml","hash":"1c917997413bf566cb79e0975789f3c9c9128ccd","modified":1493607047000},{"_id":"themes/next/languages/zh-tw.yml","hash":"0b2c18aa76570364003c8d1cd429fa158ae89022","modified":1493607047000},{"_id":"themes/next/languages/zh-Hans.yml","hash":"3c0c7dfd0256457ee24df9e9879226c58cb084b5","modified":1493607047000},{"_id":"themes/next/layout/_layout.swig","hash":"9d1a23a6add6f3d0f88c2d17979956f14aaa37a4","modified":1493607047000},{"_id":"themes/next/layout/page.swig","hash":"4ddaeedf1599d167c4ee166d391e616a7660a4ef","modified":1493607047000},{"_id":"themes/next/layout/archive.swig","hash":"5de4dca06b05d99e4f6bad617a4b8f4f3592fb01","modified":1493607047000},{"_id":"themes/next/layout/index.swig","hash":"03e8a2cda03bad42ac0cb827025eb81f95d496a2","modified":1493607047000},{"_id":"themes/next/layout/category.swig","hash":"fb55a48fe92621578ab2db0c983c609371b3ed0e","modified":1493607047000},{"_id":"themes/next/layout/post.swig","hash":"2d5f8d7f0a96b611e2d5a5e4d111fc17726a990f","modified":1493607047000},{"_id":"themes/next/layout/tag.swig","hash":"52c506fa2b46a28ae2df10831c61c51a45b2f6c1","modified":1493607047000},{"_id":"themes/next/layout/schedule.swig","hash":"f93c53f6fd5c712584f6efba6f770c30fa8a3e80","modified":1493607047000},{"_id":"themes/next/scripts/merge-configs.js","hash":"13c8b3a2d9fce06c2488820d9248d190c8100e0a","modified":1493607047000},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1493607047000},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1493607047000},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1493607047000},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1493607047000},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493607047000},{"_id":"themes/next/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1493607015000},{"_id":"themes/next/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1493607015000},{"_id":"themes/next/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1493607015000},{"_id":"themes/next/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1493607015000},{"_id":"themes/next/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1493607015000},{"_id":"themes/next/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1493607015000},{"_id":"themes/next/.git/hooks/pre-rebase.sample","hash":"5885a56ab4fca8075a05a562d005e922cde9853b","modified":1493607015000},{"_id":"themes/next/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1493607015000},{"_id":"themes/next/.git/hooks/prepare-commit-msg.sample","hash":"2b6275eda365cad50d167fe3a387c9bc9fedd54f","modified":1493607015000},{"_id":"themes/next/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1493607015000},{"_id":"themes/next/.git/logs/HEAD","hash":"7405509e2aba1267094fe623ed142c1d8fea5367","modified":1493607047000},{"_id":"themes/next/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1493607015000},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1493607047000},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1493607047000},{"_id":"themes/next/layout/_partials/comments.swig","hash":"1c7d3c975e499b9aa3119d6724b030b7b00fc87e","modified":1493607047000},{"_id":"themes/next/layout/_partials/footer.swig","hash":"7172c6053118b7c291a56a7860128a652ae66b83","modified":1493607047000},{"_id":"themes/next/layout/_partials/head.swig","hash":"d4a05c51aac02f1f6248baccf2ddb8ee12b9122f","modified":1493607047000},{"_id":"themes/next/layout/_partials/header.swig","hash":"a1ffbb691dfad3eaf2832a11766e58a179003b8b","modified":1493607047000},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1493607047000},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1493607047000},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1493607047000},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1493607047000},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1493607047000},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1493607047000},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1493607047000},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1493607047000},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"5864f5567ba5efeabcf6ea355013c0b603ee07f2","modified":1493607047000},{"_id":"themes/next/layout/_macro/reward.swig","hash":"37e5b7c42ec17b9b6b786c5512bcc481a21c974e","modified":1493607047000},{"_id":"themes/next/layout/_macro/post.swig","hash":"7b2683963693516b21095010911091414f112c03","modified":1493607047000},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"b16fcbf0efd20c018d7545257a8533c497ea7647","modified":1493607047000},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"911b99ba0445b2c07373128d87a4ef2eb7de341a","modified":1493607047000},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"14e785adeb0e671ba0ff9a553e6f0d8def6c670c","modified":1493607047000},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1493607047000},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1493607047000},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"9baf90f7c40b3b10f288e9268c3191e895890cea","modified":1493607047000},{"_id":"themes/next/node_modules/hexo-generator-archive/.eslintignore","hash":"0abf1c392f32bdf193fe824ead96926f550a85ae","modified":1510194199000},{"_id":"themes/next/node_modules/hexo-generator-archive/.jscsrc","hash":"5f410f9c9caedfdd1eabb1571de1f8f9014eefb6","modified":1510194199000},{"_id":"themes/next/node_modules/hexo-generator-archive/.eslintrc","hash":"2c4a55a386408308d637f658a4b2f5e82f4e58db","modified":1510194199000},{"_id":"themes/next/node_modules/hexo-generator-archive/.npmignore","hash":"8d71e1069cbd54d96300662bbe6df8c2d8ed68d9","modified":1510194199000},{"_id":"themes/next/node_modules/hexo-generator-archive/LICENSE","hash":"fecd013bdadc9ead2732027f06bf8fc19761efcb","modified":1510194199000},{"_id":"themes/next/node_modules/hexo-generator-archive/README.md","hash":"29cf20f72a1cfc052eba58ff4afb13112996a1d3","modified":1510194199000},{"_id":"themes/next/node_modules/hexo-generator-archive/index.js","hash":"517ad68d64877b19e12c5364e63902a5f0902ddf","modified":1510194199000},{"_id":"themes/next/node_modules/hexo-generator-archive/package.json","hash":"c3ccfd0e5a73502e322dc4133f584abe7e4d0e47","modified":1522829446071},{"_id":"themes/next/node_modules/hexo-generator-tag/.eslintignore","hash":"0abf1c392f32bdf193fe824ead96926f550a85ae","modified":1454749958000},{"_id":"themes/next/node_modules/hexo-generator-tag/.jscsrc","hash":"5f410f9c9caedfdd1eabb1571de1f8f9014eefb6","modified":1454749958000},{"_id":"themes/next/node_modules/hexo-generator-tag/.eslintrc","hash":"2c4a55a386408308d637f658a4b2f5e82f4e58db","modified":1454749958000},{"_id":"themes/next/node_modules/hexo-generator-tag/LICENSE","hash":"fecd013bdadc9ead2732027f06bf8fc19761efcb","modified":1417874762000},{"_id":"themes/next/node_modules/hexo-generator-tag/README.md","hash":"5ff72ed1f6636e9790cecf3bf4b4087c0f1226ba","modified":1423664061000},{"_id":"themes/next/node_modules/hexo-generator-tag/.npmignore","hash":"84ab7c92a20b2cdd63ada937fae53268474d9561","modified":1454749958000},{"_id":"themes/next/node_modules/hexo-generator-tag/index.js","hash":"c4b59ad39fb5c11f0270caab91ee11226baa8dd3","modified":1454750061000},{"_id":"themes/next/node_modules/hexo-generator-index/.eslintignore","hash":"6fac38c2a9f4c16f2d72e77be1a5d634dbfa6339","modified":1490991649000},{"_id":"themes/next/node_modules/hexo-generator-tag/package.json","hash":"70ad9b8016df8bd5671d6e9754326810e0dc329b","modified":1522829447247},{"_id":"themes/next/node_modules/hexo-generator-index/.eslintrc","hash":"762474f6647017bd0fea78348ba61cc8ea3fca0a","modified":1490991649000},{"_id":"themes/next/node_modules/hexo-generator-index/.jscsrc","hash":"8227ff4e1626b00e3571b144cca3ef0735a7f46d","modified":1490991649000},{"_id":"themes/next/node_modules/hexo-generator-index/README.md","hash":"8d4188cb30a45a10768e74f0eb7cc86652e3ab06","modified":1490991649000},{"_id":"themes/next/node_modules/hexo-generator-index/LICENSE","hash":"84f29a1627dea963d5eafb70d05ecb021b63dee4","modified":1490991649000},{"_id":"themes/next/node_modules/hexo-generator-index/.npmignore","hash":"13aeaa60dbb7fac7c176e024e7650c866e4536d2","modified":1490991649000},{"_id":"themes/next/node_modules/hexo-generator-index/index.js","hash":"6cffb5d1365f7542c668bbc9e49d748eb17d1a36","modified":1490991649000},{"_id":"themes/next/node_modules/hexo-pagination/LICENSE","hash":"fecd013bdadc9ead2732027f06bf8fc19761efcb","modified":1417874762000},{"_id":"themes/next/node_modules/hexo-generator-index/package.json","hash":"f9d5b0209e0bff433b68c0ab7397dfb2c22bccd5","modified":1522829443454},{"_id":"themes/next/node_modules/hexo-pagination/.npmignore","hash":"8d71e1069cbd54d96300662bbe6df8c2d8ed68d9","modified":1417853844000},{"_id":"themes/next/node_modules/hexo-pagination/README.md","hash":"1141d159b53212327c86c7351aecdeeb01e6bf6e","modified":1419847103000},{"_id":"themes/next/node_modules/hexo-pagination/package.json","hash":"9364aefbb1d6726a4fcae087b7d1364b2a24cfc7","modified":1522829443454},{"_id":"themes/next/node_modules/object-assign/index.js","hash":"519ffd5a4c91b67302cc9947b794966d629860cd","modified":1484580833000},{"_id":"themes/next/node_modules/object-assign/package.json","hash":"5422051f2563e049992bc532ab8a75b062a7b3a8","modified":1522829443454},{"_id":"themes/next/node_modules/object-assign/license","hash":"0c94f137f6e0536db8cb2622a9dc84253b91b90c","modified":1477421624000},{"_id":"themes/next/node_modules/object-assign/readme.md","hash":"572b4503897c85bbef9ba7d01839242a507acf7b","modified":1478225968000},{"_id":"themes/next/node_modules/utils-merge/.npmignore","hash":"c675b26b3b3f739f86e570525fbafa1af6598031","modified":1505866465000},{"_id":"themes/next/node_modules/utils-merge/index.js","hash":"77759a680bd22cacb94bdc438ed6250eeb10e50a","modified":1505865626000},{"_id":"themes/next/node_modules/utils-merge/LICENSE","hash":"840ec17dc7b3131dee404954b69c62b882ba6599","modified":1505866090000},{"_id":"themes/next/node_modules/utils-merge/README.md","hash":"3139b3182f49c480a6a6417d69a6657e37a56f2f","modified":1505866408000},{"_id":"themes/next/node_modules/utils-merge/package.json","hash":"dfad06f5e0a4dd075620f9b9ba6e96f20276be50","modified":1522829443455},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1493607047000},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"90035272fa31a3f65b3c0e2cb8a633876ef457dc","modified":1493607047000},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1493607047000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1493607047000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1493607047000},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1493607047000},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1493607047000},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1493607047000},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1493607047000},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1493607047000},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1493607047000},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1493607047000},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1493607047000},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1493607047000},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1493607047000},{"_id":"themes/next/scripts/tags/button.js","hash":"62e6dbeb53d07627a048132c79630b45d9a8f2cc","modified":1493607047000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1493607047000},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1493607047000},{"_id":"themes/next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1493607047000},{"_id":"themes/next/scripts/tags/note.js","hash":"6752925eedbdb939d8ec4d11bdfb75199f18dd70","modified":1493607047000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1493607047000},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493607047000},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493607047000},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493607047000},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493607047000},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493607047000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493607047000},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1493607047000},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1493607047000},{"_id":"themes/next/.git/refs/heads/master","hash":"05ad58d95ea75379eb800c0f3ddae719a3a48779","modified":1493607047000},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1493607047000},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"2d1075f4cabcb3956b7b84a8e210f5a66f0a5562","modified":1493607047000},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1493607047000},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1493607047000},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1493607047000},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1493607047000},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1493607047000},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"63315fcf210799f894208c9f512737096df84962","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"18e7bef8923d83ea42df6c97405e515a876cede4","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"394d008e5e94575280407ad8a1607a028026cbc3","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"92dc60821307fc9769bea9b2d60adaeb798342af","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"3358d11b9a26185a2d36c96049e4340e701646e4","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"a652f202bd5b30c648c228ab8f0e997eb4928e44","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1493607047000},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1493607047000},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1493607047000},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1493607047000},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1493607047000},{"_id":"themes/next/layout/_third-party/comments/gentie.swig","hash":"03592d1d731592103a41ebb87437fe4b0a4c78ca","modified":1493607047000},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1493607047000},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"abb92620197a16ed2c0775edf18a0f044a82256e","modified":1493607047000},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"af9dd8a4aed7d06cf47b363eebff48850888566c","modified":1493607047000},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"1d0d01aaeb7bcde3671263d736718f8837c20182","modified":1493607047000},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1493607047000},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1493607047000},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"363eafb5d3d2c0961e1d3449d6dfe21faa386f83","modified":1493607047000},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1493607047000},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1493607047000},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1493607047000},{"_id":"themes/next/node_modules/hexo-generator-archive/lib/generator.js","hash":"f821d03805a3bf43ce8e8ac92c6ef155df8258dc","modified":1510194199000},{"_id":"themes/next/node_modules/hexo-generator-tag/lib/generator.js","hash":"01dd5954e51bd2853aee752f58633ee1064e9c45","modified":1454750062000},{"_id":"themes/next/node_modules/hexo-generator-index/lib/generator.js","hash":"0b2889c9d3434d1d2b5a0b7d3f0aaa0057591311","modified":1490991649000},{"_id":"themes/next/node_modules/hexo-pagination/lib/pagination.js","hash":"1dcd9107aeac5facfac8437e7a66057618999700","modified":1419849623000},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"715d5b40dc52f319fe4bff0325beb874774d9bd9","modified":1493607047000},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"78a83c38f69a8747bb74e420e6c9eeef1ea76525","modified":1493607047000},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1493607047000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"c8d35a6b9e3bff6d8fdb66de853065af9d37562d","modified":1493607047000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"d6a793bcada68d4b6c58392546bc48a482e4a7d3","modified":1493607047000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"06f432f328a5b8a9ef0dbd5301b002aba600b4ce","modified":1493607047000},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1493607047000},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"aab7be0a6e2724b3faa9338db93c19556c559625","modified":1493607047000},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1493607047000},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1493607047000},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1493607047000},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1493607047000},{"_id":"themes/next/source/js/src/post-details.js","hash":"af7a417dd1cb02465a7b98211653e7c6192e6d55","modified":1493607047000},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1493607047000},{"_id":"themes/next/source/js/src/motion.js","hash":"269414e84df544a4ccb88519f6abae4943db3c67","modified":1493607047000},{"_id":"themes/next/source/js/src/utils.js","hash":"803f684fa7d0e729115a48851023a31f6fb6d0a7","modified":1493607047000},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"3587602ad777b031628bb5944864d1a4fcfea4ac","modified":1493607047000},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1493607047000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1493607047000},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1493607047000},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1493607047000},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1493607047000},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1493607047000},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1493607047000},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1493607047000},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1493607047000},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1493607047000},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1493607047000},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1493607047000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1493607047000},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1493607047000},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1493607047000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1493607047000},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1493607047000},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1493607047000},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1493607047000},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1493607047000},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1493607047000},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1493607047000},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1493607047000},{"_id":"themes/next/.git/logs/refs/heads/master","hash":"7405509e2aba1267094fe623ed142c1d8fea5367","modified":1493607047000},{"_id":"themes/next/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1493607047000},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1493607047000},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1493607047000},{"_id":"themes/next/node_modules/hexo-generator-archive/node_modules/object-assign/index.js","hash":"0d119bcabd0d55ea9c4cb04a73bd08ab2b6863b1","modified":1433514376000},{"_id":"themes/next/node_modules/hexo-generator-archive/node_modules/object-assign/readme.md","hash":"237462a8f598833f49e666f62c48a753fe647047","modified":1414015686000},{"_id":"themes/next/node_modules/hexo-generator-archive/node_modules/object-assign/license","hash":"0c94f137f6e0536db8cb2622a9dc84253b91b90c","modified":1396798991000},{"_id":"themes/next/node_modules/hexo-generator-archive/node_modules/object-assign/package.json","hash":"57fd82acf7adde949a9c37391abd6741b52e271d","modified":1522829446072},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"59ad08bcc6fe9793594869ac2b4c525021453e78","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"ef089a407c90e58eca10c49bc47ec978f96e03ba","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"0dfb4b3ba3180d7285e66f270e1d3fa0f132c3d2","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"711c8830886619d4f4a0598b0cde5499dce50c62","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1493607047000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"7804e31c44717c9a9ddf0f8482b9b9c1a0f74538","modified":1493607047000},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1493607047000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1493607047000},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"013619c472c7e4b08311c464fcbe9fcf5edde603","modified":1493607047000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1493607047000},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"fda14bc35be2e1b332809b55b3d07155a833dbf4","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"82bbaa6322764779a1ac2e2c8390ce901c7972e2","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"215de948be49bcf14f06d500cef9f7035e406a43","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5b93958239d3d2bf9aeaede44eced2434d784462","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"e3e23751d4ad24e8714b425d768cf68e37de7ded","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1493607047000},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"79da92119bc246fe05d1626ac98426a83ec90a94","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1493607047000},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"d9c0b3dc9158e717fde36f554709e6c3a22b5f85","modified":1493607047000},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1493607047000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1493607047000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1493607047000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1493607047000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1493607047000},{"_id":"themes/next/.git/objects/pack/pack-61ebe2999347efc54516d580bb22017130b8f91b.idx","hash":"16ec926e619c743574ae73dc3a6122148cdb6422","modified":1493607047000},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1493607047000},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"38e48f275ad00daa9dcdcb8d9b44e576acda4707","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1493607047000},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1493607047000},{"_id":"themes/next/.git/logs/refs/remotes/origin/HEAD","hash":"7405509e2aba1267094fe623ed142c1d8fea5367","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"8994ffcce84deac0471532f270f97c44fea54dc0","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"740d37f428b8f4574a76fc95cc25e50e0565f45e","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"7778920dd105fa4de3a7ab206eeba30b1a7bac45","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"beccb53dcd658136fb91a0c5678dea8f37d6e0b6","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"8fae54591877a73dff0b29b2be2e8935e3c63575","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"88c7d75646b66b168213190ee4cd874609afd5e3","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"c089419916988d0f51d89b225460fe11b631e0a3","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"963105a531403d7aad6d9e5e23e3bfabb8ec065a","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"e792c8dc41561c96d128e9b421187f1c3dc978a0","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"8c0276883398651336853d5ec0e9da267a00dd86","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"2e7ec9aaa3293941106b1bdd09055246aa3c3dc6","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"5f6ea57aabfa30a437059bf8352f1ad829dbd4ff","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"7690b9596ec3a49befbe529a5a2649abec0faf76","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"a2ec22ef4a6817bbb2abe8660fcd99fe4ca0cc5e","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"234facd038f144bd0fe09a31ed1357c5d74c517f","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"b8969e1654eec89a0fd10d88b337fee9cb03cd44","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"dd310c2d999185e881db007360176ee2f811df10","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"74d0ba86f698165d13402670382a822c8736a556","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/third-party/gentie.styl","hash":"586a3ec0f1015e7207cd6a2474362e068c341744","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1493607047000},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"bb3be8374c31c372ed0995bd8030d2b920d581de","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1493607047000},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1493607047000},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1493607047000},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1493607047000},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1493607047000},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1493607047000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1493607047000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1493607047000},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1493607047000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1493607047000},{"_id":"themes/next/.git/objects/pack/pack-61ebe2999347efc54516d580bb22017130b8f91b.pack","hash":"959fa8e1f3902f242e532308f245d0e244c9d3de","modified":1493607047000},{"_id":"public/404.html","hash":"9f8fa0e12a4027781185415f0d9e38440c3752ca","modified":1575555414216},{"_id":"public/categories/index.html","hash":"98e449f174698c31f58997d001a8f1c24e06f00e","modified":1575555414217},{"_id":"public/tags/index.html","hash":"0a26f7b4da72c0849a2a0c71be78fe5afc72b59f","modified":1575555414217},{"_id":"public/2018/06/11/linux磁盘格式化/index.html","hash":"8e04d9d48001c9f795e3e776daca5fedae752630","modified":1575555414217},{"_id":"public/2018/05/31/php启动设置/index.html","hash":"d2eb491d4261f23814762c29822ad7abd3165055","modified":1575555414217},{"_id":"public/archives/page/2/index.html","hash":"636412e8851a63c0b7915a9eb9b61001731529a8","modified":1575555414217},{"_id":"public/archives/2017/index.html","hash":"4508c15108cf9e5f0b60822e1769c60301efcce0","modified":1575555414217},{"_id":"public/archives/2017/05/index.html","hash":"46e504c0b25488ec7c1f780e0fe1e476e4a50527","modified":1575555414217},{"_id":"public/archives/2017/07/index.html","hash":"49b39a6bb9fa308a5d64b3eeca62e240ec65cd3f","modified":1575555414217},{"_id":"public/archives/2018/04/index.html","hash":"fdd585529921c87064c10802b8111b0f4e5ec499","modified":1575555414217},{"_id":"public/archives/2018/05/index.html","hash":"d4aaa53a6318505b273ca273e37525f17ae856f9","modified":1575555414217},{"_id":"public/archives/2018/06/index.html","hash":"5e76ef1f41b604b1d4c64fd71f7b0aaaaf22907a","modified":1575555414217},{"_id":"public/archives/2018/12/index.html","hash":"7cdd065f43476b5b19a0d2a7bd2ea87d7f8f2ab1","modified":1575555414217},{"_id":"public/archives/2019/index.html","hash":"c5d2c55fe7e69adfca6349ba1f0b3aa1069415ad","modified":1575555414217},{"_id":"public/archives/2019/03/index.html","hash":"97cd054955fbdb3747f801a8d5376ffe514efdba","modified":1575555414217},{"_id":"public/archives/2019/08/index.html","hash":"81b6040bcc12b6059de6c22f606d3459a91253f9","modified":1575555414218},{"_id":"public/categories/区块链/index.html","hash":"3f016fae3b34bac683e01221fd3de7e0de1ff77d","modified":1575555414218},{"_id":"public/categories/gitlab/index.html","hash":"1d7639f0f09eb6e70c5baf0935e269773d5e3819","modified":1575555414218},{"_id":"public/categories/centos6-5/index.html","hash":"4b50180b76d511748cd1aad35cc795fe3a89ea72","modified":1575555414218},{"_id":"public/categories/区块链/hyperledger/index.html","hash":"66649752de4ef103112529e358cde7973cc7d28c","modified":1575555414218},{"_id":"public/categories/大数据/index.html","hash":"96a8472668da58dd03a42d40fc8695adee4731c0","modified":1575555414218},{"_id":"public/categories/centos6-5/python/index.html","hash":"0ef36da29e0b191f86f53b71d1e29bafb959ffa4","modified":1575555414218},{"_id":"public/categories/java/index.html","hash":"e5f8bbcf1e2c54f6fa0da175b02f5283ab8afde1","modified":1575555414218},{"_id":"public/categories/算法/index.html","hash":"a705701e1cae86907f89f234af5647e1da1b896e","modified":1575555414218},{"_id":"public/categories/大数据/spark/index.html","hash":"d0d767990ff4a6e82daa3623325962707ba1f37f","modified":1575555414218},{"_id":"public/categories/mysql/index.html","hash":"9388aef9b844f17ea27c85779642eeaafb75325e","modified":1575555414218},{"_id":"public/categories/系统/index.html","hash":"d789d306bc65b2020a3efb79fe5719ae508dec52","modified":1575555414218},{"_id":"public/categories/nginx/index.html","hash":"c35a0b8ca638856183852c56b25835ed2f8988db","modified":1575555414218},{"_id":"public/categories/php/index.html","hash":"40e0f3c3b1ca151460ba4d988d2aebcf151e66e4","modified":1575555414218},{"_id":"public/categories/密码学/index.html","hash":"1b6747b06502d5aa8d2bc1b598af49073769f042","modified":1575555414218},{"_id":"public/categories/设计模式/index.html","hash":"3737959d2b0cc7f0a8fde7f55cf1f7189ac2bd23","modified":1575555414218},{"_id":"public/categories/日常生活/index.html","hash":"c6f45db68f9bb4cd742e88b024a398ece71fdcb2","modified":1575555414218},{"_id":"public/tags/hyperledger-多机器部署/index.html","hash":"92e6697b81a41dfcc0f7f6b311cf54ae22cb853a","modified":1575555414218},{"_id":"public/tags/linux/index.html","hash":"f9af4b2687f74e50a50f55df67d1a9eab3af098a","modified":1575555414218},{"_id":"public/tags/centos6-5/index.html","hash":"17ff2e9a17e4427d1422c0ae96cff36f3b44071f","modified":1575555414218},{"_id":"public/tags/crontab/index.html","hash":"3cd10813b751b2807006a76db85c31643c8c351d","modified":1575555414218},{"_id":"public/tags/python/index.html","hash":"0da60862a2dc26fdbda66a5fc422b4276dd88aa0","modified":1575555414218},{"_id":"public/tags/gitlab/index.html","hash":"fc85f00498094fd07161b9690d11fd3d2b0d80be","modified":1575555414218},{"_id":"public/tags/git/index.html","hash":"8e98ff974a3d6007eee5968a7664a177cd1895bb","modified":1575555414218},{"_id":"public/tags/spark/index.html","hash":"d0221e592272e49b21d81311f5654e17b14257bd","modified":1575555414218},{"_id":"public/tags/hive/index.html","hash":"330392c96b25c81d4932e0ddd11b27de34eb0409","modified":1575555414218},{"_id":"public/tags/hive-on-spark/index.html","hash":"37a1cdc5dc5af48fc49c9fc6c7c8aa2a7582e7aa","modified":1575555414219},{"_id":"public/tags/安装/index.html","hash":"9b6bbc1d0c8e960d7eceae6b18deeba8e1ab3e84","modified":1575555414219},{"_id":"public/tags/数组/index.html","hash":"729d1386f2c525bd4de0e3daabc66edfc2ef06e9","modified":1575555414219},{"_id":"public/tags/查找index/index.html","hash":"a02868967c38cd269c0330d9ab6631b385dbc270","modified":1575555414219},{"_id":"public/tags/java/index.html","hash":"f05fdc3fde9fcbb15fc516e955b9b57d3fe87f65","modified":1575555414219},{"_id":"public/tags/hyperledger-测试/index.html","hash":"3d2ce31dbfa3065630601942aed291f5f2d231e8","modified":1575555414219},{"_id":"public/tags/垃圾回收/index.html","hash":"9b8a817fc2a37f25a53016de9685151007e87f24","modified":1575555414219},{"_id":"public/tags/jvm/index.html","hash":"0815ece61e6aaf1af6903574565539151454102d","modified":1575555414219},{"_id":"public/tags/读书笔记/index.html","hash":"a0b7c8bd93ee9697b631c1e9f39d801c3a2b3637","modified":1575555414219},{"_id":"public/tags/openvpn/index.html","hash":"784c848ecfb162deb71f81128fab9e70a672db80","modified":1575555414219},{"_id":"public/tags/安装mysql/index.html","hash":"838f7100ef771cbf782dffb3050416672c95eafc","modified":1575555414219},{"_id":"public/tags/主从同步/index.html","hash":"7603b3cde45794b9df8f30fb3b89da1eb5a91371","modified":1575555414219},{"_id":"public/tags/pyspark/index.html","hash":"bd33582b2d459314b691402db99780663224e1a5","modified":1575555414219},{"_id":"public/tags/nginx/index.html","hash":"1cb4674a583ce91e3441166def5a76de11dc1c87","modified":1575555414219},{"_id":"public/tags/openssl/index.html","hash":"26de8a0639598c1e30d6b022b47a9e6664563621","modified":1575555414219},{"_id":"public/tags/php/index.html","hash":"e05676c5c7d6d2c5988ca5cf79d35c2e769e5401","modified":1575555414219},{"_id":"public/tags/导出数据/index.html","hash":"6f1a31a6a5bfc51b6ed7c38c7dcc9ee1ce31cbd9","modified":1575555414219},{"_id":"public/tags/hash/index.html","hash":"a2db5a6030aa568b41662917740b99921bc4fdb7","modified":1575555414219},{"_id":"public/tags/hyperledger-应用/index.html","hash":"e86e1b4ab6e8bcee7629810cf804cd10b70f909c","modified":1575555414219},{"_id":"public/tags/小华二三事/index.html","hash":"abcc12b8220e3a4388f2c5ee7bf4212973ef99ca","modified":1575555414219},{"_id":"public/2019/08/30/编写第一个hyperledger区块链应用/index.html","hash":"6effc72999c78feb3835724fbddc6dcb3337b60a","modified":1575555414219},{"_id":"public/2019/08/25/hyperledger 多机器部署/index.html","hash":"c5ffb58e99e48fac36a59693a817643d5ce5ecec","modified":1575555414220},{"_id":"public/2019/08/16/hyperledger部署测试/index.html","hash":"5b5e9fa4557c09f6f1822a7ea3a302779e4c1d1e","modified":1575555414220},{"_id":"public/2019/03/29/单向散列函数/index.html","hash":"349faad002966be5c71d1a472156942a204d2019","modified":1575555414220},{"_id":"public/2018/12/14/hive on spark /index.html","hash":"557f81ec741549c36d61adf62e36e2ecd3219c7a","modified":1575555414220},{"_id":"public/2018/06/27/centos6.5安装python2.7/index.html","hash":"14d7f0c5f12074a9b49fdc6c2844631a83854549","modified":1575555414220},{"_id":"public/2018/06/26/spark pyspark /index.html","hash":"4a9bdb9f816922ae84697a0466896707ec816193","modified":1575555414220},{"_id":"public/2018/06/13/crontab/index.html","hash":"31db022f0499650eced1fd69e00c494ea5c4690a","modified":1575555414220},{"_id":"public/2018/06/13/gitlab维护命令/index.html","hash":"3ae5608f7f3675c714fd531518c7fbe409a2026b","modified":1575555414220},{"_id":"public/2018/06/11/linux 安装openvpn/index.html","hash":"97adf5ad9305ab04bc1ddcac95f2ff61f99e9735","modified":1575555414220},{"_id":"public/2018/05/31/mysql安装/index.html","hash":"d989b1bbc03d70489306bddf1404c902316bb243","modified":1575555414220},{"_id":"public/2018/05/31/mysql5.7GTID主从同步/index.html","hash":"acff5c5d9c8c996a5207bd5462ce4d97a3ce8fa3","modified":1575555414220},{"_id":"public/2018/05/31/mysql导出数据/index.html","hash":"a25fa487a5f58320ccb05c98934e3c6b30759e5d","modified":1575555414220},{"_id":"public/2018/05/31/jdk1.8安装/index.html","hash":"676d449299bb2ec8c36dd47306f24a7fc679ec5c","modified":1575555414220},{"_id":"public/2018/04/04/leetcode1/index.html","hash":"e6af5f2810acde58e5959d0044933ad84ecaa280","modified":1575555414220},{"_id":"public/2018/04/04/nginx-openssl版本问题/index.html","hash":"82c8861ae652688ee306a04449ebcffac13717b2","modified":1575555414220},{"_id":"public/2017/07/01/java 垃圾回收/index.html","hash":"8d2d62784aba602d59b345cad2b5310526456332","modified":1575555414220},{"_id":"public/2017/07/01/小华日常/index.html","hash":"d6676d9ebb8dc581aee5fd7120e85540334313a1","modified":1575555414220},{"_id":"public/2017/05/01/在现实编程中使用fluent模式/index.html","hash":"3cf95958cf4dc3b44b24813e89760696d07bf012","modified":1575555414220},{"_id":"public/2017/05/01/hive表的创建/index.html","hash":"245b1e7d8cba6caffb9988c7f9217f2b386b143b","modified":1575555414220},{"_id":"public/2017/05/01/hello-world/index.html","hash":"d6474a197201b9b5fedabb63e78fd7a4a203a73a","modified":1575555414221},{"_id":"public/archives/index.html","hash":"5ad15a5628dc9ea29b3802e1f33ca6028c1e24f9","modified":1575555414221},{"_id":"public/archives/2018/index.html","hash":"a6d05dc2189ad6e3d301623bcf43f4fe7e84920e","modified":1575555414221},{"_id":"public/index.html","hash":"727ff356056c47ec6d3c063dc276cb8e04814a77","modified":1575555414221},{"_id":"public/page/2/index.html","hash":"2b91dc11f195f1e552a57feb0e45cd1a7490cbea","modified":1575555414221},{"_id":"public/page/3/index.html","hash":"20bf4679558f4d3aa71cc585271c4988e6c5f572","modified":1575555414221},{"_id":"public/page/4/index.html","hash":"b408e707f6bdedf38c461e4c6f1b3d6c5f7d0ec4","modified":1575555414221},{"_id":"public/page/5/index.html","hash":"592b854953a4f73bb59b5db762c25844fe88a72b","modified":1575555414221},{"_id":"public/favicon.ico","hash":"b8cbaae3179425a1f2f34e3cc7685156320e9c2b","modified":1575555414232},{"_id":"public/images/1763449.jpeg","hash":"de5e607a1f0fcb7fe007a906038f714915b29772","modified":1575555414232},{"_id":"public/images/6rM7Vv.png","hash":"6f6fcd2adce6f3844de46dc75b4c58c81a8cdf7a","modified":1575555414232},{"_id":"public/images/algolia_logo.svg","hash":"90035272fa31a3f65b3c0e2cb8a633876ef457dc","modified":1575555414232},{"_id":"public/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1575555414232},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1575555414232},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1575555414232},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1575555414232},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1575555414233},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1575555414233},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1575555414233},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1575555414233},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1575555414233},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1575555414233},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1575555414233},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1575555414233},{"_id":"public/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1575555414233},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1575555414233},{"_id":"public/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1575555414233},{"_id":"public/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1575555414233},{"_id":"public/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1575555414233},{"_id":"public/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1575555414233},{"_id":"public/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1575555414234},{"_id":"public/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1575555414234},{"_id":"public/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1575555414234},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1575555414235},{"_id":"public/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1575555414235},{"_id":"public/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1575555414235},{"_id":"public/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1575555414235},{"_id":"public/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1575555414235},{"_id":"public/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1575555414235},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1575555414854},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1575555414862},{"_id":"public/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1575555414869},{"_id":"public/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1575555414869},{"_id":"public/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1575555414870},{"_id":"public/js/src/bootstrap.js","hash":"aab7be0a6e2724b3faa9338db93c19556c559625","modified":1575555414870},{"_id":"public/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1575555414870},{"_id":"public/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1575555414870},{"_id":"public/js/src/post-details.js","hash":"af7a417dd1cb02465a7b98211653e7c6192e6d55","modified":1575555414870},{"_id":"public/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1575555414870},{"_id":"public/js/src/motion.js","hash":"269414e84df544a4ccb88519f6abae4943db3c67","modified":1575555414870},{"_id":"public/lib/canvas-ribbon/canvas-ribbon.js","hash":"3587602ad777b031628bb5944864d1a4fcfea4ac","modified":1575555414870},{"_id":"public/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1575555414870},{"_id":"public/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1575555414870},{"_id":"public/js/src/utils.js","hash":"803f684fa7d0e729115a48851023a31f6fb6d0a7","modified":1575555414870},{"_id":"public/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1575555414870},{"_id":"public/lib/fastclick/README.html","hash":"da3c74d484c73cc7df565e8abbfa4d6a5a18d4da","modified":1575555414871},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1575555414871},{"_id":"public/lib/fastclick/bower.json","hash":"4dcecf83afddba148464d5339c93f6d0aa9f42e9","modified":1575555414871},{"_id":"public/lib/jquery_lazyload/CONTRIBUTING.html","hash":"a6358170d346af13b1452ac157b60505bec7015c","modified":1575555414871},{"_id":"public/lib/jquery_lazyload/bower.json","hash":"ae3c3b61e6e7f9e1d7e3585ad854380ecc04cf53","modified":1575555414871},{"_id":"public/lib/jquery_lazyload/README.html","hash":"bde24335f6bc09d8801c0dcd7274f71b466552bd","modified":1575555414871},{"_id":"public/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1575555414871},{"_id":"public/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1575555414871},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1575555414871},{"_id":"public/lib/velocity/bower.json","hash":"0ef14e7ccdfba5db6eb3f8fc6aa3b47282c36409","modified":1575555414871},{"_id":"public/js/src/schemes/pisces.js","hash":"79da92119bc246fe05d1626ac98426a83ec90a94","modified":1575555414871},{"_id":"public/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1575555414871},{"_id":"public/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1575555414871},{"_id":"public/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1575555414871},{"_id":"public/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1575555414871},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1575555414871},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1575555414871},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1575555414871},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1575555414871},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1575555414871},{"_id":"public/css/main.css","hash":"6b11866ad5ba22d7cc9ee6120392ae678cafdbe4","modified":1575555414871},{"_id":"public/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1575555414871},{"_id":"public/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1575555414872},{"_id":"public/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1575555414872},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1575555414872},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1575555414872},{"_id":"public/lib/Han/dist/han.min.css","hash":"d9c0b3dc9158e717fde36f554709e6c3a22b5f85","modified":1575555414872},{"_id":"public/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1575555414872},{"_id":"public/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1575555414872},{"_id":"public/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1575555414872},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1575555414872},{"_id":"public/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1575555414872},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1575555414872},{"_id":"public/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1575555414872},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1575555414872},{"_id":"public/lib/Han/dist/han.css","hash":"38e48f275ad00daa9dcdcb8d9b44e576acda4707","modified":1575555414872},{"_id":"public/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1575555414872},{"_id":"public/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1575555414872},{"_id":"public/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1575555414872},{"_id":"public/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1575555414873},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1575555414873},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1575555414873},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1575555414884}],"Category":[{"name":"区块链","_id":"ck3st0exe00051fihkl1io1jp"},{"name":"gitlab","_id":"ck3st0exo000a1fihdh0rw96h"},{"name":"centos6.5","_id":"ck3st0exr000g1fihsp5dgvfc"},{"name":"hyperledger","parent":"ck3st0exe00051fihkl1io1jp","_id":"ck3st0exu000n1fih1fue6jmv"},{"name":"大数据","_id":"ck3st0exv000s1fihfw5217sw"},{"name":"python","parent":"ck3st0exr000g1fihsp5dgvfc","_id":"ck3st0exz00101fihidcd0qjs"},{"name":"java","_id":"ck3st0ey8001f1fih15iu72dq"},{"name":"算法","_id":"ck3st0eyd001n1fihqr997b8t"},{"name":"spark","parent":"ck3st0exv000s1fihfw5217sw","_id":"ck3st0eyj001z1fihkfqrjlo5"},{"name":"系统","_id":"ck3st0eyl00251fihyskrikam"},{"name":"mysql","_id":"ck3st0eyn00291fihon5snfg4"},{"name":"nginx","_id":"ck3st0eyt002s1fihp4uc9uh0"},{"name":"php","_id":"ck3st0eyu002w1fihhsduhyn4"},{"name":"密码学","_id":"ck3st0eyv00351fihav4sid4w"},{"name":"设计模式","_id":"ck3st0eyw00381fih3yq4ub3o"},{"name":"日常生活","_id":"ck3st0eyw003b1fihp9q7op0s"}],"Data":[],"Page":[{"_content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\"\n          charset=\"utf-8\" homePageUrl=\"/\"\n          homePageName=\"回到我的主页\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","source":"404.html","raw":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\"\n          charset=\"utf-8\" homePageUrl=\"/\"\n          homePageName=\"回到我的主页\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","date":"2018-04-04T08:36:53.409Z","updated":"2018-04-04T08:36:53.409Z","path":"404.html","title":"","comments":1,"layout":"page","_id":"ck3st0es200001fihyg12no5o","content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n  <meta name=\"robots\" content=\"all\">\n  <meta name=\"robots\" content=\"index,follow\">\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"回到我的主页\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","site":{"data":{}},"excerpt":"","more":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n  <meta name=\"robots\" content=\"all\">\n  <meta name=\"robots\" content=\"index,follow\">\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"回到我的主页\">\n  </script>\n  <script src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>"},{"title":"分类","date":"2017-05-01T10:23:16.000Z","type":"categories","comments":1,"_content":"","source":"categories/index.md","raw":"---\ntitle: 分类\ndate: 2017-05-01 18:23:16\ntype: \"categories\"\ncomments: true\n---\n","updated":"2017-05-01T10:35:03.000Z","path":"categories/index.html","layout":"page","_id":"ck3st0ex700021fihbowxrtxn","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"标签","date":"2017-05-01T10:18:45.000Z","type":"tags","comments":1,"_content":"","source":"tags/index.md","raw":"---\ntitle: 标签\ndate: 2017-05-01 18:18:45\ntype: \"tags\"\ncomments: true\n---\n","updated":"2017-05-01T10:34:58.000Z","path":"tags/index.html","layout":"page","_id":"ck3st0exd00041fihfilo12j1","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"hyperledger 多机器部署","date":"2019-03-29T05:57:23.000Z","_content":"\n### 机器准备\n\n| 功能 | ip  | 机器名称 |\n|:------------- |:---------:| -------:|\n| orderer   | 10.9.149.68 |  order.bits.com |\n| peer0   | 10.9.149.68 |  peer0.org1.bits.com |\n| peer0   | 10.9.84.83 |  peer0.org2.bits.com |\n### 创建目录\n```\nmkdir bits\ncd bits\n```\n### 获取生成工具\n```\n把下载的hyperledger-fabric-linux-amd64-1.4.1.tar.gz二进制文件包解压，\n把其中的bin目录拷贝到bits目录下。\n设置权限：chmod -R 777 ./bin\n```\n\n### 准备生成证书和区块配置文件\n配置crypto-config.yaml和configtx.yaml文件，拷贝到bits目录下。\n#### crypto-config.yaml 文件\n```\n\t# Copyright IBM Corp. All Rights Reserved.\n\t#\n\t# SPDX-License-Identifier: Apache-2.0\n\t#\n\t\n\t# ---------------------------------------------------------------------------\n\t# \"OrdererOrgs\" - Definition of organizations managing orderer nodes\n\t# ---------------------------------------------------------------------------\n\tOrdererOrgs:\n\t  # ---------------------------------------------------------------------------\n\t  # Orderer\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Orderer\n\t    Domain: bits.com\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    # ---------------------------------------------------------------------------\n\t    # \"Specs\" - See PeerOrgs below for complete description\n\t    # ---------------------------------------------------------------------------\n\t    Specs:\n\t      - Hostname: orderer\n\t# ---------------------------------------------------------------------------\n\t# \"PeerOrgs\" - Definition of organizations managing peer nodes\n\t# ---------------------------------------------------------------------------\n\tPeerOrgs:\n\t  # ---------------------------------------------------------------------------\n\t  # Org1\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Org1\n\t    Domain: org1.bits.com\n\t    EnableNodeOUs: true\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    # ---------------------------------------------------------------------------\n\t    # \"Specs\"\n\t    # ---------------------------------------------------------------------------\n\t    # Uncomment this section to enable the explicit definition of hosts in your\n\t    # configuration.  Most users will want to use Template, below\n\t    #\n\t    # Specs is an array of Spec entries.  Each Spec entry consists of two fields:\n\t    #   - Hostname:   (Required) The desired hostname, sans the domain.\n\t    #   - CommonName: (Optional) Specifies the template or explicit override for\n\t    #                 the CN.  By default, this is the template:\n\t    #\n\t    #                              \"{{.Hostname}}.{{.Domain}}\"\n\t    #\n\t    #                 which obtains its values from the Spec.Hostname and\n\t    #                 Org.Domain, respectively.\n\t    # ---------------------------------------------------------------------------\n\t    # Specs:\n\t    #   - Hostname: foo # implicitly \"foo.org1.example.com\"\n\t    #     CommonName: foo27.org5.example.com # overrides Hostname-based FQDN set above\n\t    #   - Hostname: bar\n\t    #   - Hostname: baz\n\t    # ---------------------------------------------------------------------------\n\t    # \"Template\"\n\t    # ---------------------------------------------------------------------------\n\t    # Allows for the definition of 1 or more hosts that are created sequentially\n\t    # from a template. By default, this looks like \"peer%d\" from 0 to Count-1.\n\t    # You may override the number of nodes (Count), the starting index (Start)\n\t    # or the template used to construct the name (Hostname).\n\t    #\n\t    # Note: Template and Specs are not mutually exclusive.  You may define both\n\t    # sections and the aggregate nodes will be created for you.  Take care with\n\t    # name collisions\n\t    # ---------------------------------------------------------------------------\n\t    Template:\n\t      Count: 1\n\t      # Start: 5\n\t      # Hostname: {{.Prefix}}{{.Index}} # default\n\t    # ---------------------------------------------------------------------------\n\t    # \"Users\"\n\t    # ---------------------------------------------------------------------------\n\t    # Count: The number of user accounts _in addition_ to Admin\n\t    # ---------------------------------------------------------------------------\n\t    Users:\n\t      Count: 1\n\t  # ---------------------------------------------------------------------------\n\t  # Org2: See \"Org1\" for full specification\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Org2\n\t    Domain: org2.bits.com\n\t    EnableNodeOUs: true\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    Template:\n\t      Count: 1\n\t    Users:\n\t      Count: 1\n\n```\n#### configtx.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\n---\n################################################################################\n#\n#   Section: Organizations\n#\n#   - This section defines the different organizational identities which will\n#   be referenced later in the configuration.\n#\n################################################################################\nOrganizations:\n\n    # SampleOrg defines an MSP using the sampleconfig.  It should never be used\n    # in production but may be used as a template for other definitions\n    - &OrdererOrg\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: OrdererOrg\n\n        # ID to load the MSP definition as\n        ID: OrdererMSP\n\n        # MSPDir is the filesystem path which contains the MSP configuration\n        MSPDir: crypto-config/ordererOrganizations/bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.member')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.member')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.admin')\"\n\n    - &Org1\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: Org1MSP\n\n        # ID to load the MSP definition as\n        ID: Org1MSP\n\n        MSPDir: crypto-config/peerOrganizations/org1.bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin', 'Org1MSP.peer', 'Org1MSP.client')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin', 'Org1MSP.client')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin')\"\n\n        AnchorPeers:\n            # AnchorPeers defines the location of peers which can be used\n            # for cross org gossip communication.  Note, this value is only\n            # encoded in the genesis block in the Application section context\n            - Host: peer0.org1.bits.com\n              Port: 7051\n\n    - &Org2\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: Org2MSP\n\n        # ID to load the MSP definition as\n        ID: Org2MSP\n\n        MSPDir: crypto-config/peerOrganizations/org2.bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin', 'Org2MSP.peer', 'Org2MSP.client')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin', 'Org2MSP.client')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin')\"\n\n        AnchorPeers:\n            # AnchorPeers defines the location of peers which can be used\n            # for cross org gossip communication.  Note, this value is only\n            # encoded in the genesis block in the Application section context\n            - Host: peer0.org2.bits.com\n              Port: 7051\n\n################################################################################\n#\n#   SECTION: Capabilities\n#\n#   - This section defines the capabilities of fabric network. This is a new\n#   concept as of v1.1.0 and should not be utilized in mixed networks with\n#   v1.0.x peers and orderers.  Capabilities define features which must be\n#   present in a fabric binary for that binary to safely participate in the\n#   fabric network.  For instance, if a new MSP type is added, newer binaries\n#   might recognize and validate the signatures from this type, while older\n#   binaries without this support would be unable to validate those\n#   transactions.  This could lead to different versions of the fabric binaries\n#   having different world states.  Instead, defining a capability for a channel\n#   informs those binaries without this capability that they must cease\n#   processing transactions until they have been upgraded.  For v1.0.x if any\n#   capabilities are defined (including a map with all capabilities turned off)\n#   then the v1.0.x peer will deliberately crash.\n#\n################################################################################\nCapabilities:\n    # Channel capabilities apply to both the orderers and the peers and must be\n    # supported by both.  Set the value of the capability to true to require it.\n    Global: &ChannelCapabilities\n        # V1.1 for Global is a catchall flag for behavior which has been\n        # determined to be desired for all orderers and peers running v1.0.x,\n        # but the modification of which would cause incompatibilities.  Users\n        # should leave this flag set to true.\n        V1_1: true\n\n    # Orderer capabilities apply only to the orderers, and may be safely\n    # manipulated without concern for upgrading peers.  Set the value of the\n    # capability to true to require it.\n    Orderer: &OrdererCapabilities\n        # V1.1 for Order is a catchall flag for behavior which has been\n        # determined to be desired for all orderers running v1.0.x, but the\n        # modification of which  would cause incompatibilities.  Users should\n        # leave this flag set to true.\n        V1_1: true\n\n    # Application capabilities apply only to the peer network, and may be safely\n    # manipulated without concern for upgrading orderers.  Set the value of the\n    # capability to true to require it.\n    Application: &ApplicationCapabilities\n        # V1.1 for Application is a catchall flag for behavior which has been\n        # determined to be desired for all peers running v1.0.x, but the\n        # modification of which would cause incompatibilities.  Users should\n        # leave this flag set to true.\n        V1_2: true\n\n################################################################################\n#\n#   SECTION: Application\n#\n#   - This section defines the values to encode into a config transaction or\n#   genesis block for application related parameters\n#\n################################################################################\nApplication: &ApplicationDefaults\n\n    # Organizations is the list of orgs which are defined as participants on\n    # the application side of the network\n    Organizations:\n\n    # Policies defines the set of policies at this level of the config tree\n    # For Application policies, their canonical path is\n    #   /Channel/Application/<PolicyName>\n    Policies:\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n\n    # Capabilities describes the application level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *ApplicationCapabilities\n\n################################################################################\n#\n#   SECTION: Orderer\n#\n#   - This section defines the values to encode into a config transaction or\n#   genesis block for orderer related parameters\n#\n################################################################################\nOrderer: &OrdererDefaults\n\n    # Orderer Type: The orderer implementation to start\n    # Available types are \"solo\" and \"kafka\" and \"raft\"\n    OrdererType: solo\n\n    Addresses:\n        - orderer.bits.com:7050\n\n    # Batch Timeout: The amount of time to wait before creating a batch\n    BatchTimeout: 2s\n\n    # Batch Size: Controls the number of messages batched into a block\n    BatchSize:\n\n        # Max Message Count: The maximum number of messages to permit in a batch\n        MaxMessageCount: 10\n\n        # Absolute Max Bytes: The absolute maximum number of bytes allowed for\n        # the serialized messages in a batch.\n        AbsoluteMaxBytes: 98 MB\n\n        # Preferred Max Bytes: The preferred maximum number of bytes allowed for\n        # the serialized messages in a batch. A message larger than the preferred\n        # max bytes will result in a batch larger than preferred max bytes.\n        PreferredMaxBytes: 512 KB\n\n    Kafka:\n        # Brokers: A list of Kafka brokers to which the orderer connects. Edit\n        # this list to identify the brokers of the ordering service.\n        # NOTE: Use IP:port notation.\n        Brokers:\n            - 127.0.0.1:9092\n\n    # Organizations is the list of orgs which are defined as participants on\n    # the orderer side of the network\n    Organizations:\n\n    # Policies defines the set of policies at this level of the config tree\n    # For Orderer policies, their canonical path is\n    #   /Channel/Orderer/<PolicyName>\n    Policies:\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n        # BlockValidation specifies what signatures must be included in the block\n        # from the orderer for the peer to validate it.\n        BlockValidation:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n\n    # Capabilities describes the orderer level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *OrdererCapabilities\n\n################################################################################\n#\n#   CHANNEL\n#\n#   This section defines the values to encode into a config transaction or\n#   genesis block for channel related parameters.\n#\n################################################################################\nChannel: &ChannelDefaults\n    # Policies defines the set of policies at this level of the config tree\n    # For Channel policies, their canonical path is\n    #   /Channel/<PolicyName>\n    Policies:\n        # Who may invoke the 'Deliver' API\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        # Who may invoke the 'Broadcast' API\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        # By default, who may modify elements at this config level\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n\n\n    # Capabilities describes the channel level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *ChannelCapabilities\n\n################################################################################\n#\n#   Profile\n#\n#   - Different configuration profiles may be encoded here to be specified\n#   as parameters to the configtxgen tool\n#\n################################################################################\nProfiles:\n\n    TwoOrgsOrdererGenesis:\n        <<: *ChannelDefaults\n        Orderer:\n            <<: *OrdererDefaults\n            Organizations:\n                - *OrdererOrg\n        Consortiums:\n            SampleConsortium:\n                Organizations:\n                    - *Org1\n                    - *Org2\n    TwoOrgsChannel:\n        Consortium: SampleConsortium\n        Application:\n            <<: *ApplicationDefaults\n            Organizations:\n                - *Org1\n                - *Org2\n\n```\n\n#### 生成公私钥和证书\n\n```\n./bin/cryptogen generate --config=./crypto-config.yaml\n\n```\n#### 生成创世区块\n\n```\nmkdir channel-artifacts\n./bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block\n\n```\n#### 生成通道配置区块\n\n```\n./bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/bits-query.tx -channelID bits-query\n```\n#### 拷贝到别的电脑\n\n```\ncd ..\nscp -r bits ubuntu@10.9.84.83:/data/bits\n\n```\n\n## 部署order，配置docker-compose-orderer.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n\n  orderer.example.com:\n    container_name: orderer.bits.com\n    image: hyperledger/fabric-orderer\n    environment:\n      - ORDERER_GENERAL_LOGLEVEL=debug\n      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0\n      - ORDERER_GENERAL_GENESISMETHOD=file\n      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block\n      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP\n      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp\n      # enabled TLS\n      - ORDERER_GENERAL_TLS_ENABLED=true\n      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key\n      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt\n      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]\n      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s\n      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s\n      - ORDERER_KAFKA_VERBOSE=true\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric\n    command: orderer\n    volumes:\n      - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block\n      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp:/var/hyperledger/orderer/msp\n      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/:/var/hyperledger/orderer/tls\n    ports:\n      - 7050:7050\n```\n#### 启动Fabric orderer排序服务\n```\ndocker-compose -f docker-compose-orderer.yaml up -d\n\n```\n## 部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n  peer0.org1.bits.com:\n    container_name: peer0.org1.bits.com\n    image: hyperledger/fabric-peer\n    environment:\n      - CORE_PEER_ID=peer0.org1.bits.com\n      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051\n      - CORE_PEER_CHAINCODEADDRESS=peer0.org1.bits.com:7052\n      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052\n      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org1MSP\n\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      # the following setting starts chaincode containers on the same\n      # bridge network as the peers\n      # https://docs.docker.com/compose/networking/\n      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default\n      #- CORE_LOGGING_LEVEL=ERROR\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_GOSSIP_USELEADERELECTION=true\n      - CORE_PEER_GOSSIP_ORGLEADER=false\n      - CORE_PEER_PROFILE_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    command: peer node start\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp:/etc/hyperledger/fabric/msp\n        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls:/etc/hyperledger/fabric/tls\n    ports:\n      - 7051:7051\n      - 7052:7052\n      - 7053:7053\n    extra_hosts:\n      - \"orderer.bits.com:10.9.149.68\"\n\n  cli:\n    container_name: cli\n    image: hyperledger/fabric-tools\n    tty: true\n    environment:\n      - GOPATH=/opt/gopath\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_ID=cli\n      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org1MSP\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt\n      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go\n        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/\n        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts\n    depends_on:\n       - peer0.org1.bits.com\n    extra_hosts:\n       - \"orderer.bits.com:10.9.149.68\"\n       - \"peer0.org1.bits.com:10.9.149.68\"\n       - \"peer0.org2.bits.com:10.9.84.83\"\n```\n#### 启动peer0.org1.bits.com\n```\ndocker-compose -f docker-compose-org1-peer0.yaml up -d\n```\n#### 进入容器\n```\ndocker exec -it cli bash\n```\n#### 创建Channel通道\n```\n# 因为创建通道需要通知orderer 所以设置oderer的tls证书\nORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem\n\npeer channel create -o orderer.bits.com:7050 -c bits-query -f ./channel-artifacts/bits-query.tx --tls --cafile $ORDERER_CA\n\n```\n#### 加入channel通道 \n```\npeer channel join -b bits-query.block\n```\n#### 保存通道信息,需将通道信息拷贝至其他节点\n```\n#容器名\ndocker cp xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.block /data/bits/channel-artifacts\n\nscp -r /data/bits xxx:/data\n\n```\n\n#### 打包智能合约\n```\n # 每台机器单独安装的话，里面的编号不一致，所以打包好后，去有需要的节点再安装\n \n peer chaincode package -n bits-query -p query/cmd/ -v 1.0 bits-query.pak\n \n docker cp xxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.pak /data/bits/channel-artifacts\n```\n\n#### peer0.org1.bits.com安装\n```\npeer chaincode install bits-query.pak\n\n```\n##  部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n  peer0.org2.bits.com:\n    container_name: peer0.org2.bits.com\n    image: hyperledger/fabric-peer\n    environment:\n      - CORE_PEER_ID=peer0.org2.bits.com\n      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051\n      - CORE_PEER_CHAINCODEADDRESS=peer0.org2.bits.com:7052\n      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052\n      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org2.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org2MSP\n\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      # the following setting starts chaincode containers on the same\n      # bridge network as the peers\n      # https://docs.docker.com/compose/networking/\n      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default\n      #- CORE_LOGGING_LEVEL=ERROR\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_GOSSIP_USELEADERELECTION=true\n      - CORE_PEER_GOSSIP_ORGLEADER=false\n      - CORE_PEER_PROFILE_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    command: peer node start\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp:/etc/hyperledger/fabric/msp\n        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls:/etc/hyperledger/fabric/tls\n    ports:\n      - 7051:7051\n      - 7052:7052\n      - 7053:7053\n    extra_hosts:\n      - \"orderer.bits.com:10.9.149.68\"\n\n  cli:\n    container_name: cli\n    image: hyperledger/fabric-tools\n    tty: true\n    environment:\n      - GOPATH=/opt/gopath\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_ID=cli\n      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org2MSP\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt\n      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go\n        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/\n        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts\n    depends_on:\n       - peer0.org2.bits.com\n    extra_hosts:\n       - \"orderer.bits.com:10.9.149.68\"\n       - \"peer0.org1.bits.com:10.9.149.68\"\n       - \"peer0.org2.bits.com:10.9.84.83\"\n```\n#### 启动peer0.org2.bits.com\n```\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n```\n#### 进入容器\n```\ndocker exec -it cli bash\n```\n#### 加入通道\n```\ndocker cp /data/bits/channel-artifacts/bits-query.block xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b bits-query.block\n\n```\n\n#### peer0.org2.bits.com安装\n```\ndocker cp /data/bits/channel-artifacts/bits-query.pak xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n##安装\npeer chaincode install bits-query.pak\n##查看是否安装成功\npeer chaincode list --installed\npeer chaincode list --instantiated -C bits-query\n\n```\n\n## 调用\n### 添加数据 \n```\nORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem\n\n\n<!--peer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C bits-query -n bit-query -v 1.0 -c '{\"Args\":[\"init\",\"\",\"\",\"\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"-->\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C bits-query -n bits-query -c '{\"Args\":[\"put\",\"{\\\"queryId\\\":233,\\\"indexDigest\\\":\\\"indexDigest\\\",\\\"provideQueryOrg\\\":\\\"provideQueryOrg\\\",\\\"offerOrg\\\":\\\"offerOrg\\\",\\\"queryTime\\\":\\\"queryTime\\\",\\\"queryType\\\":11,\\\"queryResult\\\":11,\\\"querySerial\\\":\\\"querySerial\\\",\\\"hit\\\":1}\"]}'\n\n\n\n```\n### 查看数据\n```\npeer chaincode query  -C bits-query -n bits-query -c '{\"Args\":[\"query\",\"222\"]}'\n\n```\n\n\n\n\n<!--\n<!--peer chaincode install -n mycc -p github.com/hyperledger/fabric/multipeer/chaincode/go/example02/cmd/ -v 1.0\n\n peer chaincode install -n mycc -p github.com/hyperledger/fabric/bits/chaincode/go/example02/cmd/ -v 1.0\n\n\npeer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n mycc -v 1.0 -c '{\"Args\":[\"init\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"\n\n\n\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n\n\n\ndocker cp /data/bits/mychannel.block 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\ndocker cp /data/bits/mycc.pak 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b mychannel.block\n\npeer chaincode install mycc.pak\n\n\npeer chaincode list --installed\n\n\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C mychannel -n mycc -c '{\"Args\":[\"invoke\",\"a\",\"b\",\"10\"]}'\n\n\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"a\"]}'-->\n","source":"_drafts/hyperledger 多机器部署.md","raw":"---\ntitle: hyperledger 多机器部署\ndate: 2019-03-29 13:57:23\ncategories: \n\t- 区块链\ntags:\n\t- hyperledger 多机器部署\n---\n\n### 机器准备\n\n| 功能 | ip  | 机器名称 |\n|:------------- |:---------:| -------:|\n| orderer   | 10.9.149.68 |  order.bits.com |\n| peer0   | 10.9.149.68 |  peer0.org1.bits.com |\n| peer0   | 10.9.84.83 |  peer0.org2.bits.com |\n### 创建目录\n```\nmkdir bits\ncd bits\n```\n### 获取生成工具\n```\n把下载的hyperledger-fabric-linux-amd64-1.4.1.tar.gz二进制文件包解压，\n把其中的bin目录拷贝到bits目录下。\n设置权限：chmod -R 777 ./bin\n```\n\n### 准备生成证书和区块配置文件\n配置crypto-config.yaml和configtx.yaml文件，拷贝到bits目录下。\n#### crypto-config.yaml 文件\n```\n\t# Copyright IBM Corp. All Rights Reserved.\n\t#\n\t# SPDX-License-Identifier: Apache-2.0\n\t#\n\t\n\t# ---------------------------------------------------------------------------\n\t# \"OrdererOrgs\" - Definition of organizations managing orderer nodes\n\t# ---------------------------------------------------------------------------\n\tOrdererOrgs:\n\t  # ---------------------------------------------------------------------------\n\t  # Orderer\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Orderer\n\t    Domain: bits.com\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    # ---------------------------------------------------------------------------\n\t    # \"Specs\" - See PeerOrgs below for complete description\n\t    # ---------------------------------------------------------------------------\n\t    Specs:\n\t      - Hostname: orderer\n\t# ---------------------------------------------------------------------------\n\t# \"PeerOrgs\" - Definition of organizations managing peer nodes\n\t# ---------------------------------------------------------------------------\n\tPeerOrgs:\n\t  # ---------------------------------------------------------------------------\n\t  # Org1\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Org1\n\t    Domain: org1.bits.com\n\t    EnableNodeOUs: true\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    # ---------------------------------------------------------------------------\n\t    # \"Specs\"\n\t    # ---------------------------------------------------------------------------\n\t    # Uncomment this section to enable the explicit definition of hosts in your\n\t    # configuration.  Most users will want to use Template, below\n\t    #\n\t    # Specs is an array of Spec entries.  Each Spec entry consists of two fields:\n\t    #   - Hostname:   (Required) The desired hostname, sans the domain.\n\t    #   - CommonName: (Optional) Specifies the template or explicit override for\n\t    #                 the CN.  By default, this is the template:\n\t    #\n\t    #                              \"{{.Hostname}}.{{.Domain}}\"\n\t    #\n\t    #                 which obtains its values from the Spec.Hostname and\n\t    #                 Org.Domain, respectively.\n\t    # ---------------------------------------------------------------------------\n\t    # Specs:\n\t    #   - Hostname: foo # implicitly \"foo.org1.example.com\"\n\t    #     CommonName: foo27.org5.example.com # overrides Hostname-based FQDN set above\n\t    #   - Hostname: bar\n\t    #   - Hostname: baz\n\t    # ---------------------------------------------------------------------------\n\t    # \"Template\"\n\t    # ---------------------------------------------------------------------------\n\t    # Allows for the definition of 1 or more hosts that are created sequentially\n\t    # from a template. By default, this looks like \"peer%d\" from 0 to Count-1.\n\t    # You may override the number of nodes (Count), the starting index (Start)\n\t    # or the template used to construct the name (Hostname).\n\t    #\n\t    # Note: Template and Specs are not mutually exclusive.  You may define both\n\t    # sections and the aggregate nodes will be created for you.  Take care with\n\t    # name collisions\n\t    # ---------------------------------------------------------------------------\n\t    Template:\n\t      Count: 1\n\t      # Start: 5\n\t      # Hostname: {{.Prefix}}{{.Index}} # default\n\t    # ---------------------------------------------------------------------------\n\t    # \"Users\"\n\t    # ---------------------------------------------------------------------------\n\t    # Count: The number of user accounts _in addition_ to Admin\n\t    # ---------------------------------------------------------------------------\n\t    Users:\n\t      Count: 1\n\t  # ---------------------------------------------------------------------------\n\t  # Org2: See \"Org1\" for full specification\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Org2\n\t    Domain: org2.bits.com\n\t    EnableNodeOUs: true\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    Template:\n\t      Count: 1\n\t    Users:\n\t      Count: 1\n\n```\n#### configtx.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\n---\n################################################################################\n#\n#   Section: Organizations\n#\n#   - This section defines the different organizational identities which will\n#   be referenced later in the configuration.\n#\n################################################################################\nOrganizations:\n\n    # SampleOrg defines an MSP using the sampleconfig.  It should never be used\n    # in production but may be used as a template for other definitions\n    - &OrdererOrg\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: OrdererOrg\n\n        # ID to load the MSP definition as\n        ID: OrdererMSP\n\n        # MSPDir is the filesystem path which contains the MSP configuration\n        MSPDir: crypto-config/ordererOrganizations/bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.member')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.member')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.admin')\"\n\n    - &Org1\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: Org1MSP\n\n        # ID to load the MSP definition as\n        ID: Org1MSP\n\n        MSPDir: crypto-config/peerOrganizations/org1.bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin', 'Org1MSP.peer', 'Org1MSP.client')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin', 'Org1MSP.client')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin')\"\n\n        AnchorPeers:\n            # AnchorPeers defines the location of peers which can be used\n            # for cross org gossip communication.  Note, this value is only\n            # encoded in the genesis block in the Application section context\n            - Host: peer0.org1.bits.com\n              Port: 7051\n\n    - &Org2\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: Org2MSP\n\n        # ID to load the MSP definition as\n        ID: Org2MSP\n\n        MSPDir: crypto-config/peerOrganizations/org2.bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin', 'Org2MSP.peer', 'Org2MSP.client')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin', 'Org2MSP.client')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin')\"\n\n        AnchorPeers:\n            # AnchorPeers defines the location of peers which can be used\n            # for cross org gossip communication.  Note, this value is only\n            # encoded in the genesis block in the Application section context\n            - Host: peer0.org2.bits.com\n              Port: 7051\n\n################################################################################\n#\n#   SECTION: Capabilities\n#\n#   - This section defines the capabilities of fabric network. This is a new\n#   concept as of v1.1.0 and should not be utilized in mixed networks with\n#   v1.0.x peers and orderers.  Capabilities define features which must be\n#   present in a fabric binary for that binary to safely participate in the\n#   fabric network.  For instance, if a new MSP type is added, newer binaries\n#   might recognize and validate the signatures from this type, while older\n#   binaries without this support would be unable to validate those\n#   transactions.  This could lead to different versions of the fabric binaries\n#   having different world states.  Instead, defining a capability for a channel\n#   informs those binaries without this capability that they must cease\n#   processing transactions until they have been upgraded.  For v1.0.x if any\n#   capabilities are defined (including a map with all capabilities turned off)\n#   then the v1.0.x peer will deliberately crash.\n#\n################################################################################\nCapabilities:\n    # Channel capabilities apply to both the orderers and the peers and must be\n    # supported by both.  Set the value of the capability to true to require it.\n    Global: &ChannelCapabilities\n        # V1.1 for Global is a catchall flag for behavior which has been\n        # determined to be desired for all orderers and peers running v1.0.x,\n        # but the modification of which would cause incompatibilities.  Users\n        # should leave this flag set to true.\n        V1_1: true\n\n    # Orderer capabilities apply only to the orderers, and may be safely\n    # manipulated without concern for upgrading peers.  Set the value of the\n    # capability to true to require it.\n    Orderer: &OrdererCapabilities\n        # V1.1 for Order is a catchall flag for behavior which has been\n        # determined to be desired for all orderers running v1.0.x, but the\n        # modification of which  would cause incompatibilities.  Users should\n        # leave this flag set to true.\n        V1_1: true\n\n    # Application capabilities apply only to the peer network, and may be safely\n    # manipulated without concern for upgrading orderers.  Set the value of the\n    # capability to true to require it.\n    Application: &ApplicationCapabilities\n        # V1.1 for Application is a catchall flag for behavior which has been\n        # determined to be desired for all peers running v1.0.x, but the\n        # modification of which would cause incompatibilities.  Users should\n        # leave this flag set to true.\n        V1_2: true\n\n################################################################################\n#\n#   SECTION: Application\n#\n#   - This section defines the values to encode into a config transaction or\n#   genesis block for application related parameters\n#\n################################################################################\nApplication: &ApplicationDefaults\n\n    # Organizations is the list of orgs which are defined as participants on\n    # the application side of the network\n    Organizations:\n\n    # Policies defines the set of policies at this level of the config tree\n    # For Application policies, their canonical path is\n    #   /Channel/Application/<PolicyName>\n    Policies:\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n\n    # Capabilities describes the application level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *ApplicationCapabilities\n\n################################################################################\n#\n#   SECTION: Orderer\n#\n#   - This section defines the values to encode into a config transaction or\n#   genesis block for orderer related parameters\n#\n################################################################################\nOrderer: &OrdererDefaults\n\n    # Orderer Type: The orderer implementation to start\n    # Available types are \"solo\" and \"kafka\" and \"raft\"\n    OrdererType: solo\n\n    Addresses:\n        - orderer.bits.com:7050\n\n    # Batch Timeout: The amount of time to wait before creating a batch\n    BatchTimeout: 2s\n\n    # Batch Size: Controls the number of messages batched into a block\n    BatchSize:\n\n        # Max Message Count: The maximum number of messages to permit in a batch\n        MaxMessageCount: 10\n\n        # Absolute Max Bytes: The absolute maximum number of bytes allowed for\n        # the serialized messages in a batch.\n        AbsoluteMaxBytes: 98 MB\n\n        # Preferred Max Bytes: The preferred maximum number of bytes allowed for\n        # the serialized messages in a batch. A message larger than the preferred\n        # max bytes will result in a batch larger than preferred max bytes.\n        PreferredMaxBytes: 512 KB\n\n    Kafka:\n        # Brokers: A list of Kafka brokers to which the orderer connects. Edit\n        # this list to identify the brokers of the ordering service.\n        # NOTE: Use IP:port notation.\n        Brokers:\n            - 127.0.0.1:9092\n\n    # Organizations is the list of orgs which are defined as participants on\n    # the orderer side of the network\n    Organizations:\n\n    # Policies defines the set of policies at this level of the config tree\n    # For Orderer policies, their canonical path is\n    #   /Channel/Orderer/<PolicyName>\n    Policies:\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n        # BlockValidation specifies what signatures must be included in the block\n        # from the orderer for the peer to validate it.\n        BlockValidation:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n\n    # Capabilities describes the orderer level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *OrdererCapabilities\n\n################################################################################\n#\n#   CHANNEL\n#\n#   This section defines the values to encode into a config transaction or\n#   genesis block for channel related parameters.\n#\n################################################################################\nChannel: &ChannelDefaults\n    # Policies defines the set of policies at this level of the config tree\n    # For Channel policies, their canonical path is\n    #   /Channel/<PolicyName>\n    Policies:\n        # Who may invoke the 'Deliver' API\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        # Who may invoke the 'Broadcast' API\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        # By default, who may modify elements at this config level\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n\n\n    # Capabilities describes the channel level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *ChannelCapabilities\n\n################################################################################\n#\n#   Profile\n#\n#   - Different configuration profiles may be encoded here to be specified\n#   as parameters to the configtxgen tool\n#\n################################################################################\nProfiles:\n\n    TwoOrgsOrdererGenesis:\n        <<: *ChannelDefaults\n        Orderer:\n            <<: *OrdererDefaults\n            Organizations:\n                - *OrdererOrg\n        Consortiums:\n            SampleConsortium:\n                Organizations:\n                    - *Org1\n                    - *Org2\n    TwoOrgsChannel:\n        Consortium: SampleConsortium\n        Application:\n            <<: *ApplicationDefaults\n            Organizations:\n                - *Org1\n                - *Org2\n\n```\n\n#### 生成公私钥和证书\n\n```\n./bin/cryptogen generate --config=./crypto-config.yaml\n\n```\n#### 生成创世区块\n\n```\nmkdir channel-artifacts\n./bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block\n\n```\n#### 生成通道配置区块\n\n```\n./bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/bits-query.tx -channelID bits-query\n```\n#### 拷贝到别的电脑\n\n```\ncd ..\nscp -r bits ubuntu@10.9.84.83:/data/bits\n\n```\n\n## 部署order，配置docker-compose-orderer.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n\n  orderer.example.com:\n    container_name: orderer.bits.com\n    image: hyperledger/fabric-orderer\n    environment:\n      - ORDERER_GENERAL_LOGLEVEL=debug\n      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0\n      - ORDERER_GENERAL_GENESISMETHOD=file\n      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block\n      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP\n      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp\n      # enabled TLS\n      - ORDERER_GENERAL_TLS_ENABLED=true\n      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key\n      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt\n      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]\n      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s\n      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s\n      - ORDERER_KAFKA_VERBOSE=true\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric\n    command: orderer\n    volumes:\n      - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block\n      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp:/var/hyperledger/orderer/msp\n      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/:/var/hyperledger/orderer/tls\n    ports:\n      - 7050:7050\n```\n#### 启动Fabric orderer排序服务\n```\ndocker-compose -f docker-compose-orderer.yaml up -d\n\n```\n## 部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n  peer0.org1.bits.com:\n    container_name: peer0.org1.bits.com\n    image: hyperledger/fabric-peer\n    environment:\n      - CORE_PEER_ID=peer0.org1.bits.com\n      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051\n      - CORE_PEER_CHAINCODEADDRESS=peer0.org1.bits.com:7052\n      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052\n      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org1MSP\n\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      # the following setting starts chaincode containers on the same\n      # bridge network as the peers\n      # https://docs.docker.com/compose/networking/\n      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default\n      #- CORE_LOGGING_LEVEL=ERROR\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_GOSSIP_USELEADERELECTION=true\n      - CORE_PEER_GOSSIP_ORGLEADER=false\n      - CORE_PEER_PROFILE_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    command: peer node start\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp:/etc/hyperledger/fabric/msp\n        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls:/etc/hyperledger/fabric/tls\n    ports:\n      - 7051:7051\n      - 7052:7052\n      - 7053:7053\n    extra_hosts:\n      - \"orderer.bits.com:10.9.149.68\"\n\n  cli:\n    container_name: cli\n    image: hyperledger/fabric-tools\n    tty: true\n    environment:\n      - GOPATH=/opt/gopath\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_ID=cli\n      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org1MSP\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt\n      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go\n        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/\n        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts\n    depends_on:\n       - peer0.org1.bits.com\n    extra_hosts:\n       - \"orderer.bits.com:10.9.149.68\"\n       - \"peer0.org1.bits.com:10.9.149.68\"\n       - \"peer0.org2.bits.com:10.9.84.83\"\n```\n#### 启动peer0.org1.bits.com\n```\ndocker-compose -f docker-compose-org1-peer0.yaml up -d\n```\n#### 进入容器\n```\ndocker exec -it cli bash\n```\n#### 创建Channel通道\n```\n# 因为创建通道需要通知orderer 所以设置oderer的tls证书\nORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem\n\npeer channel create -o orderer.bits.com:7050 -c bits-query -f ./channel-artifacts/bits-query.tx --tls --cafile $ORDERER_CA\n\n```\n#### 加入channel通道 \n```\npeer channel join -b bits-query.block\n```\n#### 保存通道信息,需将通道信息拷贝至其他节点\n```\n#容器名\ndocker cp xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.block /data/bits/channel-artifacts\n\nscp -r /data/bits xxx:/data\n\n```\n\n#### 打包智能合约\n```\n # 每台机器单独安装的话，里面的编号不一致，所以打包好后，去有需要的节点再安装\n \n peer chaincode package -n bits-query -p query/cmd/ -v 1.0 bits-query.pak\n \n docker cp xxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.pak /data/bits/channel-artifacts\n```\n\n#### peer0.org1.bits.com安装\n```\npeer chaincode install bits-query.pak\n\n```\n##  部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n  peer0.org2.bits.com:\n    container_name: peer0.org2.bits.com\n    image: hyperledger/fabric-peer\n    environment:\n      - CORE_PEER_ID=peer0.org2.bits.com\n      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051\n      - CORE_PEER_CHAINCODEADDRESS=peer0.org2.bits.com:7052\n      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052\n      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org2.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org2MSP\n\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      # the following setting starts chaincode containers on the same\n      # bridge network as the peers\n      # https://docs.docker.com/compose/networking/\n      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default\n      #- CORE_LOGGING_LEVEL=ERROR\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_GOSSIP_USELEADERELECTION=true\n      - CORE_PEER_GOSSIP_ORGLEADER=false\n      - CORE_PEER_PROFILE_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    command: peer node start\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp:/etc/hyperledger/fabric/msp\n        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls:/etc/hyperledger/fabric/tls\n    ports:\n      - 7051:7051\n      - 7052:7052\n      - 7053:7053\n    extra_hosts:\n      - \"orderer.bits.com:10.9.149.68\"\n\n  cli:\n    container_name: cli\n    image: hyperledger/fabric-tools\n    tty: true\n    environment:\n      - GOPATH=/opt/gopath\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_ID=cli\n      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org2MSP\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt\n      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go\n        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/\n        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts\n    depends_on:\n       - peer0.org2.bits.com\n    extra_hosts:\n       - \"orderer.bits.com:10.9.149.68\"\n       - \"peer0.org1.bits.com:10.9.149.68\"\n       - \"peer0.org2.bits.com:10.9.84.83\"\n```\n#### 启动peer0.org2.bits.com\n```\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n```\n#### 进入容器\n```\ndocker exec -it cli bash\n```\n#### 加入通道\n```\ndocker cp /data/bits/channel-artifacts/bits-query.block xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b bits-query.block\n\n```\n\n#### peer0.org2.bits.com安装\n```\ndocker cp /data/bits/channel-artifacts/bits-query.pak xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n##安装\npeer chaincode install bits-query.pak\n##查看是否安装成功\npeer chaincode list --installed\npeer chaincode list --instantiated -C bits-query\n\n```\n\n## 调用\n### 添加数据 \n```\nORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem\n\n\n<!--peer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C bits-query -n bit-query -v 1.0 -c '{\"Args\":[\"init\",\"\",\"\",\"\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"-->\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C bits-query -n bits-query -c '{\"Args\":[\"put\",\"{\\\"queryId\\\":233,\\\"indexDigest\\\":\\\"indexDigest\\\",\\\"provideQueryOrg\\\":\\\"provideQueryOrg\\\",\\\"offerOrg\\\":\\\"offerOrg\\\",\\\"queryTime\\\":\\\"queryTime\\\",\\\"queryType\\\":11,\\\"queryResult\\\":11,\\\"querySerial\\\":\\\"querySerial\\\",\\\"hit\\\":1}\"]}'\n\n\n\n```\n### 查看数据\n```\npeer chaincode query  -C bits-query -n bits-query -c '{\"Args\":[\"query\",\"222\"]}'\n\n```\n\n\n\n\n<!--\n<!--peer chaincode install -n mycc -p github.com/hyperledger/fabric/multipeer/chaincode/go/example02/cmd/ -v 1.0\n\n peer chaincode install -n mycc -p github.com/hyperledger/fabric/bits/chaincode/go/example02/cmd/ -v 1.0\n\n\npeer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n mycc -v 1.0 -c '{\"Args\":[\"init\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"\n\n\n\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n\n\n\ndocker cp /data/bits/mychannel.block 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\ndocker cp /data/bits/mycc.pak 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b mychannel.block\n\npeer chaincode install mycc.pak\n\n\npeer chaincode list --installed\n\n\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C mychannel -n mycc -c '{\"Args\":[\"invoke\",\"a\",\"b\",\"10\"]}'\n\n\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"a\"]}'-->\n","slug":"hyperledger 多机器部署","published":0,"updated":"2019-08-26T05:51:57.053Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0ex400011fihy729g474","content":"<h3 id=\"机器准备\"><a href=\"#机器准备\" class=\"headerlink\" title=\"机器准备\"></a>机器准备</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">功能</th>\n<th style=\"text-align:center\">ip</th>\n<th style=\"text-align:right\">机器名称</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">orderer</td>\n<td style=\"text-align:center\">10.9.149.68</td>\n<td style=\"text-align:right\">order.bits.com</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">peer0</td>\n<td style=\"text-align:center\">10.9.149.68</td>\n<td style=\"text-align:right\">peer0.org1.bits.com</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">peer0</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">peer0.org2.bits.com</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"创建目录\"><a href=\"#创建目录\" class=\"headerlink\" title=\"创建目录\"></a>创建目录</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir bits</div><div class=\"line\">cd bits</div></pre></td></tr></table></figure>\n<h3 id=\"获取生成工具\"><a href=\"#获取生成工具\" class=\"headerlink\" title=\"获取生成工具\"></a>获取生成工具</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">把下载的hyperledger-fabric-linux-amd64-1.4.1.tar.gz二进制文件包解压，</div><div class=\"line\">把其中的bin目录拷贝到bits目录下。</div><div class=\"line\">设置权限：chmod -R 777 ./bin</div></pre></td></tr></table></figure>\n<h3 id=\"准备生成证书和区块配置文件\"><a href=\"#准备生成证书和区块配置文件\" class=\"headerlink\" title=\"准备生成证书和区块配置文件\"></a>准备生成证书和区块配置文件</h3><p>配置crypto-config.yaml和configtx.yaml文件，拷贝到bits目录下。</p>\n<h4 id=\"crypto-config-yaml-文件\"><a href=\"#crypto-config-yaml-文件\" class=\"headerlink\" title=\"crypto-config.yaml 文件\"></a>crypto-config.yaml 文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\"># &quot;OrdererOrgs&quot; - Definition of organizations managing orderer nodes</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\">OrdererOrgs:</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Orderer</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Orderer</div><div class=\"line\">    Domain: bits.com</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Specs&quot; - See PeerOrgs below for complete description</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Specs:</div><div class=\"line\">      - Hostname: orderer</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\"># &quot;PeerOrgs&quot; - Definition of organizations managing peer nodes</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\">PeerOrgs:</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Org1</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Org1</div><div class=\"line\">    Domain: org1.bits.com</div><div class=\"line\">    EnableNodeOUs: true</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Specs&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Uncomment this section to enable the explicit definition of hosts in your</div><div class=\"line\">    # configuration.  Most users will want to use Template, below</div><div class=\"line\">    #</div><div class=\"line\">    # Specs is an array of Spec entries.  Each Spec entry consists of two fields:</div><div class=\"line\">    #   - Hostname:   (Required) The desired hostname, sans the domain.</div><div class=\"line\">    #   - CommonName: (Optional) Specifies the template or explicit override for</div><div class=\"line\">    #                 the CN.  By default, this is the template:</div><div class=\"line\">    #</div><div class=\"line\">    #                              &quot;&#123;&#123;.Hostname&#125;&#125;.&#123;&#123;.Domain&#125;&#125;&quot;</div><div class=\"line\">    #</div><div class=\"line\">    #                 which obtains its values from the Spec.Hostname and</div><div class=\"line\">    #                 Org.Domain, respectively.</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Specs:</div><div class=\"line\">    #   - Hostname: foo # implicitly &quot;foo.org1.example.com&quot;</div><div class=\"line\">    #     CommonName: foo27.org5.example.com # overrides Hostname-based FQDN set above</div><div class=\"line\">    #   - Hostname: bar</div><div class=\"line\">    #   - Hostname: baz</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Template&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Allows for the definition of 1 or more hosts that are created sequentially</div><div class=\"line\">    # from a template. By default, this looks like &quot;peer%d&quot; from 0 to Count-1.</div><div class=\"line\">    # You may override the number of nodes (Count), the starting index (Start)</div><div class=\"line\">    # or the template used to construct the name (Hostname).</div><div class=\"line\">    #</div><div class=\"line\">    # Note: Template and Specs are not mutually exclusive.  You may define both</div><div class=\"line\">    # sections and the aggregate nodes will be created for you.  Take care with</div><div class=\"line\">    # name collisions</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Template:</div><div class=\"line\">      Count: 1</div><div class=\"line\">      # Start: 5</div><div class=\"line\">      # Hostname: &#123;&#123;.Prefix&#125;&#125;&#123;&#123;.Index&#125;&#125; # default</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Users&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Count: The number of user accounts _in addition_ to Admin</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Users:</div><div class=\"line\">      Count: 1</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Org2: See &quot;Org1&quot; for full specification</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Org2</div><div class=\"line\">    Domain: org2.bits.com</div><div class=\"line\">    EnableNodeOUs: true</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    Template:</div><div class=\"line\">      Count: 1</div><div class=\"line\">    Users:</div><div class=\"line\">      Count: 1</div></pre></td></tr></table></figure>\n<h4 id=\"configtx-yaml文件\"><a href=\"#configtx-yaml文件\" class=\"headerlink\" title=\"configtx.yaml文件\"></a>configtx.yaml文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">---</div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   Section: Organizations</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the different organizational identities which will</div><div class=\"line\">#   be referenced later in the configuration.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Organizations:</div><div class=\"line\"></div><div class=\"line\">    # SampleOrg defines an MSP using the sampleconfig.  It should never be used</div><div class=\"line\">    # in production but may be used as a template for other definitions</div><div class=\"line\">    - &amp;OrdererOrg</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: OrdererOrg</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: OrdererMSP</div><div class=\"line\"></div><div class=\"line\">        # MSPDir is the filesystem path which contains the MSP configuration</div><div class=\"line\">        MSPDir: crypto-config/ordererOrganizations/bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.member&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.member&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">    - &amp;Org1</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: Org1MSP</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: Org1MSP</div><div class=\"line\"></div><div class=\"line\">        MSPDir: crypto-config/peerOrganizations/org1.bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;, &apos;Org1MSP.peer&apos;, &apos;Org1MSP.client&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;, &apos;Org1MSP.client&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">        AnchorPeers:</div><div class=\"line\">            # AnchorPeers defines the location of peers which can be used</div><div class=\"line\">            # for cross org gossip communication.  Note, this value is only</div><div class=\"line\">            # encoded in the genesis block in the Application section context</div><div class=\"line\">            - Host: peer0.org1.bits.com</div><div class=\"line\">              Port: 7051</div><div class=\"line\"></div><div class=\"line\">    - &amp;Org2</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: Org2MSP</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: Org2MSP</div><div class=\"line\"></div><div class=\"line\">        MSPDir: crypto-config/peerOrganizations/org2.bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;, &apos;Org2MSP.peer&apos;, &apos;Org2MSP.client&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;, &apos;Org2MSP.client&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">        AnchorPeers:</div><div class=\"line\">            # AnchorPeers defines the location of peers which can be used</div><div class=\"line\">            # for cross org gossip communication.  Note, this value is only</div><div class=\"line\">            # encoded in the genesis block in the Application section context</div><div class=\"line\">            - Host: peer0.org2.bits.com</div><div class=\"line\">              Port: 7051</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Capabilities</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the capabilities of fabric network. This is a new</div><div class=\"line\">#   concept as of v1.1.0 and should not be utilized in mixed networks with</div><div class=\"line\">#   v1.0.x peers and orderers.  Capabilities define features which must be</div><div class=\"line\">#   present in a fabric binary for that binary to safely participate in the</div><div class=\"line\">#   fabric network.  For instance, if a new MSP type is added, newer binaries</div><div class=\"line\">#   might recognize and validate the signatures from this type, while older</div><div class=\"line\">#   binaries without this support would be unable to validate those</div><div class=\"line\">#   transactions.  This could lead to different versions of the fabric binaries</div><div class=\"line\">#   having different world states.  Instead, defining a capability for a channel</div><div class=\"line\">#   informs those binaries without this capability that they must cease</div><div class=\"line\">#   processing transactions until they have been upgraded.  For v1.0.x if any</div><div class=\"line\">#   capabilities are defined (including a map with all capabilities turned off)</div><div class=\"line\">#   then the v1.0.x peer will deliberately crash.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Capabilities:</div><div class=\"line\">    # Channel capabilities apply to both the orderers and the peers and must be</div><div class=\"line\">    # supported by both.  Set the value of the capability to true to require it.</div><div class=\"line\">    Global: &amp;ChannelCapabilities</div><div class=\"line\">        # V1.1 for Global is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all orderers and peers running v1.0.x,</div><div class=\"line\">        # but the modification of which would cause incompatibilities.  Users</div><div class=\"line\">        # should leave this flag set to true.</div><div class=\"line\">        V1_1: true</div><div class=\"line\"></div><div class=\"line\">    # Orderer capabilities apply only to the orderers, and may be safely</div><div class=\"line\">    # manipulated without concern for upgrading peers.  Set the value of the</div><div class=\"line\">    # capability to true to require it.</div><div class=\"line\">    Orderer: &amp;OrdererCapabilities</div><div class=\"line\">        # V1.1 for Order is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all orderers running v1.0.x, but the</div><div class=\"line\">        # modification of which  would cause incompatibilities.  Users should</div><div class=\"line\">        # leave this flag set to true.</div><div class=\"line\">        V1_1: true</div><div class=\"line\"></div><div class=\"line\">    # Application capabilities apply only to the peer network, and may be safely</div><div class=\"line\">    # manipulated without concern for upgrading orderers.  Set the value of the</div><div class=\"line\">    # capability to true to require it.</div><div class=\"line\">    Application: &amp;ApplicationCapabilities</div><div class=\"line\">        # V1.1 for Application is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all peers running v1.0.x, but the</div><div class=\"line\">        # modification of which would cause incompatibilities.  Users should</div><div class=\"line\">        # leave this flag set to true.</div><div class=\"line\">        V1_2: true</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Application</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for application related parameters</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Application: &amp;ApplicationDefaults</div><div class=\"line\"></div><div class=\"line\">    # Organizations is the list of orgs which are defined as participants on</div><div class=\"line\">    # the application side of the network</div><div class=\"line\">    Organizations:</div><div class=\"line\"></div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Application policies, their canonical path is</div><div class=\"line\">    #   /Channel/Application/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the application level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *ApplicationCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Orderer</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for orderer related parameters</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Orderer: &amp;OrdererDefaults</div><div class=\"line\"></div><div class=\"line\">    # Orderer Type: The orderer implementation to start</div><div class=\"line\">    # Available types are &quot;solo&quot; and &quot;kafka&quot; and &quot;raft&quot;</div><div class=\"line\">    OrdererType: solo</div><div class=\"line\"></div><div class=\"line\">    Addresses:</div><div class=\"line\">        - orderer.bits.com:7050</div><div class=\"line\"></div><div class=\"line\">    # Batch Timeout: The amount of time to wait before creating a batch</div><div class=\"line\">    BatchTimeout: 2s</div><div class=\"line\"></div><div class=\"line\">    # Batch Size: Controls the number of messages batched into a block</div><div class=\"line\">    BatchSize:</div><div class=\"line\"></div><div class=\"line\">        # Max Message Count: The maximum number of messages to permit in a batch</div><div class=\"line\">        MaxMessageCount: 10</div><div class=\"line\"></div><div class=\"line\">        # Absolute Max Bytes: The absolute maximum number of bytes allowed for</div><div class=\"line\">        # the serialized messages in a batch.</div><div class=\"line\">        AbsoluteMaxBytes: 98 MB</div><div class=\"line\"></div><div class=\"line\">        # Preferred Max Bytes: The preferred maximum number of bytes allowed for</div><div class=\"line\">        # the serialized messages in a batch. A message larger than the preferred</div><div class=\"line\">        # max bytes will result in a batch larger than preferred max bytes.</div><div class=\"line\">        PreferredMaxBytes: 512 KB</div><div class=\"line\"></div><div class=\"line\">    Kafka:</div><div class=\"line\">        # Brokers: A list of Kafka brokers to which the orderer connects. Edit</div><div class=\"line\">        # this list to identify the brokers of the ordering service.</div><div class=\"line\">        # NOTE: Use IP:port notation.</div><div class=\"line\">        Brokers:</div><div class=\"line\">            - 127.0.0.1:9092</div><div class=\"line\"></div><div class=\"line\">    # Organizations is the list of orgs which are defined as participants on</div><div class=\"line\">    # the orderer side of the network</div><div class=\"line\">    Organizations:</div><div class=\"line\"></div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Orderer policies, their canonical path is</div><div class=\"line\">    #   /Channel/Orderer/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\">        # BlockValidation specifies what signatures must be included in the block</div><div class=\"line\">        # from the orderer for the peer to validate it.</div><div class=\"line\">        BlockValidation:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the orderer level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *OrdererCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   CHANNEL</div><div class=\"line\">#</div><div class=\"line\">#   This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for channel related parameters.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Channel: &amp;ChannelDefaults</div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Channel policies, their canonical path is</div><div class=\"line\">    #   /Channel/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        # Who may invoke the &apos;Deliver&apos; API</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        # Who may invoke the &apos;Broadcast&apos; API</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        # By default, who may modify elements at this config level</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the channel level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *ChannelCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   Profile</div><div class=\"line\">#</div><div class=\"line\">#   - Different configuration profiles may be encoded here to be specified</div><div class=\"line\">#   as parameters to the configtxgen tool</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Profiles:</div><div class=\"line\"></div><div class=\"line\">    TwoOrgsOrdererGenesis:</div><div class=\"line\">        &lt;&lt;: *ChannelDefaults</div><div class=\"line\">        Orderer:</div><div class=\"line\">            &lt;&lt;: *OrdererDefaults</div><div class=\"line\">            Organizations:</div><div class=\"line\">                - *OrdererOrg</div><div class=\"line\">        Consortiums:</div><div class=\"line\">            SampleConsortium:</div><div class=\"line\">                Organizations:</div><div class=\"line\">                    - *Org1</div><div class=\"line\">                    - *Org2</div><div class=\"line\">    TwoOrgsChannel:</div><div class=\"line\">        Consortium: SampleConsortium</div><div class=\"line\">        Application:</div><div class=\"line\">            &lt;&lt;: *ApplicationDefaults</div><div class=\"line\">            Organizations:</div><div class=\"line\">                - *Org1</div><div class=\"line\">                - *Org2</div></pre></td></tr></table></figure>\n<h4 id=\"生成公私钥和证书\"><a href=\"#生成公私钥和证书\" class=\"headerlink\" title=\"生成公私钥和证书\"></a>生成公私钥和证书</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./bin/cryptogen generate --config=./crypto-config.yaml</div></pre></td></tr></table></figure>\n<h4 id=\"生成创世区块\"><a href=\"#生成创世区块\" class=\"headerlink\" title=\"生成创世区块\"></a>生成创世区块</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir channel-artifacts</div><div class=\"line\">./bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block</div></pre></td></tr></table></figure>\n<h4 id=\"生成通道配置区块\"><a href=\"#生成通道配置区块\" class=\"headerlink\" title=\"生成通道配置区块\"></a>生成通道配置区块</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/bits-query.tx -channelID bits-query</div></pre></td></tr></table></figure>\n<h4 id=\"拷贝到别的电脑\"><a href=\"#拷贝到别的电脑\" class=\"headerlink\" title=\"拷贝到别的电脑\"></a>拷贝到别的电脑</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd ..</div><div class=\"line\">scp -r bits ubuntu@10.9.84.83:/data/bits</div></pre></td></tr></table></figure>\n<h2 id=\"部署order，配置docker-compose-orderer-yaml文件\"><a href=\"#部署order，配置docker-compose-orderer-yaml文件\" class=\"headerlink\" title=\"部署order，配置docker-compose-orderer.yaml文件\"></a>部署order，配置docker-compose-orderer.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\"></div><div class=\"line\">  orderer.example.com:</div><div class=\"line\">    container_name: orderer.bits.com</div><div class=\"line\">    image: hyperledger/fabric-orderer</div><div class=\"line\">    environment:</div><div class=\"line\">      - ORDERER_GENERAL_LOGLEVEL=debug</div><div class=\"line\">      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0</div><div class=\"line\">      - ORDERER_GENERAL_GENESISMETHOD=file</div><div class=\"line\">      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block</div><div class=\"line\">      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP</div><div class=\"line\">      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp</div><div class=\"line\">      # enabled TLS</div><div class=\"line\">      - ORDERER_GENERAL_TLS_ENABLED=true</div><div class=\"line\">      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key</div><div class=\"line\">      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt</div><div class=\"line\">      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</div><div class=\"line\">      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s</div><div class=\"line\">      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s</div><div class=\"line\">      - ORDERER_KAFKA_VERBOSE=true</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric</div><div class=\"line\">    command: orderer</div><div class=\"line\">    volumes:</div><div class=\"line\">      - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block</div><div class=\"line\">      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp:/var/hyperledger/orderer/msp</div><div class=\"line\">      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/:/var/hyperledger/orderer/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7050:7050</div></pre></td></tr></table></figure>\n<h4 id=\"启动Fabric-orderer排序服务\"><a href=\"#启动Fabric-orderer排序服务\" class=\"headerlink\" title=\"启动Fabric orderer排序服务\"></a>启动Fabric orderer排序服务</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-orderer.yaml up -d</div></pre></td></tr></table></figure>\n<h2 id=\"部署peer0-org1-bits-com-配置docker-compose-org1-peer0-yaml文件\"><a href=\"#部署peer0-org1-bits-com-配置docker-compose-org1-peer0-yaml文件\" class=\"headerlink\" title=\"部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件\"></a>部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\">  peer0.org1.bits.com:</div><div class=\"line\">    container_name: peer0.org1.bits.com</div><div class=\"line\">    image: hyperledger/fabric-peer</div><div class=\"line\">    environment:</div><div class=\"line\">      - CORE_PEER_ID=peer0.org1.bits.com</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_CHAINCODEADDRESS=peer0.org1.bits.com:7052</div><div class=\"line\">      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</div><div class=\"line\">      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org1MSP</div><div class=\"line\"></div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      # the following setting starts chaincode containers on the same</div><div class=\"line\">      # bridge network as the peers</div><div class=\"line\">      # https://docs.docker.com/compose/networking/</div><div class=\"line\">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default</div><div class=\"line\">      #- CORE_LOGGING_LEVEL=ERROR</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_USELEADERELECTION=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_ORGLEADER=false</div><div class=\"line\">      - CORE_PEER_PROFILE_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    command: peer node start</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp:/etc/hyperledger/fabric/msp</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls:/etc/hyperledger/fabric/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7051:7051</div><div class=\"line\">      - 7052:7052</div><div class=\"line\">      - 7053:7053</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">      - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\"></div><div class=\"line\">  cli:</div><div class=\"line\">    container_name: cli</div><div class=\"line\">    image: hyperledger/fabric-tools</div><div class=\"line\">    tty: true</div><div class=\"line\">    environment:</div><div class=\"line\">      - GOPATH=/opt/gopath</div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_ID=cli</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org1MSP</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt</div><div class=\"line\">      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go</div><div class=\"line\">        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/</div><div class=\"line\">        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</div><div class=\"line\">    depends_on:</div><div class=\"line\">       - peer0.org1.bits.com</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">       - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org1.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org2.bits.com:10.9.84.83&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"启动peer0-org1-bits-com\"><a href=\"#启动peer0-org1-bits-com\" class=\"headerlink\" title=\"启动peer0.org1.bits.com\"></a>启动peer0.org1.bits.com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-org1-peer0.yaml up -d</div></pre></td></tr></table></figure>\n<h4 id=\"进入容器\"><a href=\"#进入容器\" class=\"headerlink\" title=\"进入容器\"></a>进入容器</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it cli bash</div></pre></td></tr></table></figure>\n<h4 id=\"创建Channel通道\"><a href=\"#创建Channel通道\" class=\"headerlink\" title=\"创建Channel通道\"></a>创建Channel通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 因为创建通道需要通知orderer 所以设置oderer的tls证书</div><div class=\"line\">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem</div><div class=\"line\"></div><div class=\"line\">peer channel create -o orderer.bits.com:7050 -c bits-query -f ./channel-artifacts/bits-query.tx --tls --cafile $ORDERER_CA</div></pre></td></tr></table></figure>\n<h4 id=\"加入channel通道\"><a href=\"#加入channel通道\" class=\"headerlink\" title=\"加入channel通道\"></a>加入channel通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer channel join -b bits-query.block</div></pre></td></tr></table></figure>\n<h4 id=\"保存通道信息-需将通道信息拷贝至其他节点\"><a href=\"#保存通道信息-需将通道信息拷贝至其他节点\" class=\"headerlink\" title=\"保存通道信息,需将通道信息拷贝至其他节点\"></a>保存通道信息,需将通道信息拷贝至其他节点</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">#容器名</div><div class=\"line\">docker cp xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.block /data/bits/channel-artifacts</div><div class=\"line\"></div><div class=\"line\">scp -r /data/bits xxx:/data</div></pre></td></tr></table></figure>\n<h4 id=\"打包智能合约\"><a href=\"#打包智能合约\" class=\"headerlink\" title=\"打包智能合约\"></a>打包智能合约</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 每台机器单独安装的话，里面的编号不一致，所以打包好后，去有需要的节点再安装</div><div class=\"line\"></div><div class=\"line\">peer chaincode package -n bits-query -p query/cmd/ -v 1.0 bits-query.pak</div><div class=\"line\"></div><div class=\"line\">docker cp xxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.pak /data/bits/channel-artifacts</div></pre></td></tr></table></figure>\n<h4 id=\"peer0-org1-bits-com安装\"><a href=\"#peer0-org1-bits-com安装\" class=\"headerlink\" title=\"peer0.org1.bits.com安装\"></a>peer0.org1.bits.com安装</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode install bits-query.pak</div></pre></td></tr></table></figure>\n<h2 id=\"部署peer0-org2-bits-com-配置docker-compose-org2-peer0-yaml文件\"><a href=\"#部署peer0-org2-bits-com-配置docker-compose-org2-peer0-yaml文件\" class=\"headerlink\" title=\"部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件\"></a>部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\">  peer0.org2.bits.com:</div><div class=\"line\">    container_name: peer0.org2.bits.com</div><div class=\"line\">    image: hyperledger/fabric-peer</div><div class=\"line\">    environment:</div><div class=\"line\">      - CORE_PEER_ID=peer0.org2.bits.com</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_CHAINCODEADDRESS=peer0.org2.bits.com:7052</div><div class=\"line\">      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</div><div class=\"line\">      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org2MSP</div><div class=\"line\"></div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      # the following setting starts chaincode containers on the same</div><div class=\"line\">      # bridge network as the peers</div><div class=\"line\">      # https://docs.docker.com/compose/networking/</div><div class=\"line\">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default</div><div class=\"line\">      #- CORE_LOGGING_LEVEL=ERROR</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_USELEADERELECTION=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_ORGLEADER=false</div><div class=\"line\">      - CORE_PEER_PROFILE_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    command: peer node start</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp:/etc/hyperledger/fabric/msp</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls:/etc/hyperledger/fabric/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7051:7051</div><div class=\"line\">      - 7052:7052</div><div class=\"line\">      - 7053:7053</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">      - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\"></div><div class=\"line\">  cli:</div><div class=\"line\">    container_name: cli</div><div class=\"line\">    image: hyperledger/fabric-tools</div><div class=\"line\">    tty: true</div><div class=\"line\">    environment:</div><div class=\"line\">      - GOPATH=/opt/gopath</div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_ID=cli</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org2MSP</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt</div><div class=\"line\">      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go</div><div class=\"line\">        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/</div><div class=\"line\">        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</div><div class=\"line\">    depends_on:</div><div class=\"line\">       - peer0.org2.bits.com</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">       - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org1.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org2.bits.com:10.9.84.83&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"启动peer0-org2-bits-com\"><a href=\"#启动peer0-org2-bits-com\" class=\"headerlink\" title=\"启动peer0.org2.bits.com\"></a>启动peer0.org2.bits.com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-org2-peer0.yaml up -d</div></pre></td></tr></table></figure>\n<h4 id=\"进入容器-1\"><a href=\"#进入容器-1\" class=\"headerlink\" title=\"进入容器\"></a>进入容器</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it cli bash</div></pre></td></tr></table></figure>\n<h4 id=\"加入通道\"><a href=\"#加入通道\" class=\"headerlink\" title=\"加入通道\"></a>加入通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker cp /data/bits/channel-artifacts/bits-query.block xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/</div><div class=\"line\"></div><div class=\"line\">peer channel join -b bits-query.block</div></pre></td></tr></table></figure>\n<h4 id=\"peer0-org2-bits-com安装\"><a href=\"#peer0-org2-bits-com安装\" class=\"headerlink\" title=\"peer0.org2.bits.com安装\"></a>peer0.org2.bits.com安装</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker cp /data/bits/channel-artifacts/bits-query.pak xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/</div><div class=\"line\">##安装</div><div class=\"line\">peer chaincode install bits-query.pak</div><div class=\"line\">##查看是否安装成功</div><div class=\"line\">peer chaincode list --installed</div><div class=\"line\">peer chaincode list --instantiated -C bits-query</div></pre></td></tr></table></figure>\n<h2 id=\"调用\"><a href=\"#调用\" class=\"headerlink\" title=\"调用\"></a>调用</h2><h3 id=\"添加数据\"><a href=\"#添加数据\" class=\"headerlink\" title=\"添加数据\"></a>添加数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">&lt;!--peer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C bits-query -n bit-query -v 1.0 -c &apos;&#123;&quot;Args&quot;:[&quot;init&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;]&#125;&apos; -P &quot;OR (&apos;Org1MSP.peer&apos;,&apos;Org2MSP.peer&apos;)&quot;--&gt;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">peer chaincode invoke --tls --cafile $ORDERER_CA -C bits-query -n bits-query -c &apos;&#123;&quot;Args&quot;:[&quot;put&quot;,&quot;&#123;\\&quot;queryId\\&quot;:233,\\&quot;indexDigest\\&quot;:\\&quot;indexDigest\\&quot;,\\&quot;provideQueryOrg\\&quot;:\\&quot;provideQueryOrg\\&quot;,\\&quot;offerOrg\\&quot;:\\&quot;offerOrg\\&quot;,\\&quot;queryTime\\&quot;:\\&quot;queryTime\\&quot;,\\&quot;queryType\\&quot;:11,\\&quot;queryResult\\&quot;:11,\\&quot;querySerial\\&quot;:\\&quot;querySerial\\&quot;,\\&quot;hit\\&quot;:1&#125;&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<h3 id=\"查看数据\"><a href=\"#查看数据\" class=\"headerlink\" title=\"查看数据\"></a>查看数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode query  -C bits-query -n bits-query -c &apos;&#123;&quot;Args&quot;:[&quot;query&quot;,&quot;222&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<!--\n<!--peer chaincode install -n mycc -p github.com/hyperledger/fabric/multipeer/chaincode/go/example02/cmd/ -v 1.0\n\n peer chaincode install -n mycc -p github.com/hyperledger/fabric/bits/chaincode/go/example02/cmd/ -v 1.0\n\n\npeer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n mycc -v 1.0 -c '{\"Args\":[\"init\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"\n\n\n\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n\n\n\ndocker cp /data/bits/mychannel.block 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\ndocker cp /data/bits/mycc.pak 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b mychannel.block\n\npeer chaincode install mycc.pak\n\n\npeer chaincode list --installed\n\n\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C mychannel -n mycc -c '{\"Args\":[\"invoke\",\"a\",\"b\",\"10\"]}'\n\n\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"a\"]}'-->\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"机器准备\"><a href=\"#机器准备\" class=\"headerlink\" title=\"机器准备\"></a>机器准备</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">功能</th>\n<th style=\"text-align:center\">ip</th>\n<th style=\"text-align:right\">机器名称</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">orderer</td>\n<td style=\"text-align:center\">10.9.149.68</td>\n<td style=\"text-align:right\">order.bits.com</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">peer0</td>\n<td style=\"text-align:center\">10.9.149.68</td>\n<td style=\"text-align:right\">peer0.org1.bits.com</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">peer0</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">peer0.org2.bits.com</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"创建目录\"><a href=\"#创建目录\" class=\"headerlink\" title=\"创建目录\"></a>创建目录</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir bits</div><div class=\"line\">cd bits</div></pre></td></tr></table></figure>\n<h3 id=\"获取生成工具\"><a href=\"#获取生成工具\" class=\"headerlink\" title=\"获取生成工具\"></a>获取生成工具</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">把下载的hyperledger-fabric-linux-amd64-1.4.1.tar.gz二进制文件包解压，</div><div class=\"line\">把其中的bin目录拷贝到bits目录下。</div><div class=\"line\">设置权限：chmod -R 777 ./bin</div></pre></td></tr></table></figure>\n<h3 id=\"准备生成证书和区块配置文件\"><a href=\"#准备生成证书和区块配置文件\" class=\"headerlink\" title=\"准备生成证书和区块配置文件\"></a>准备生成证书和区块配置文件</h3><p>配置crypto-config.yaml和configtx.yaml文件，拷贝到bits目录下。</p>\n<h4 id=\"crypto-config-yaml-文件\"><a href=\"#crypto-config-yaml-文件\" class=\"headerlink\" title=\"crypto-config.yaml 文件\"></a>crypto-config.yaml 文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\"># &quot;OrdererOrgs&quot; - Definition of organizations managing orderer nodes</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\">OrdererOrgs:</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Orderer</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Orderer</div><div class=\"line\">    Domain: bits.com</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Specs&quot; - See PeerOrgs below for complete description</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Specs:</div><div class=\"line\">      - Hostname: orderer</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\"># &quot;PeerOrgs&quot; - Definition of organizations managing peer nodes</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\">PeerOrgs:</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Org1</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Org1</div><div class=\"line\">    Domain: org1.bits.com</div><div class=\"line\">    EnableNodeOUs: true</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Specs&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Uncomment this section to enable the explicit definition of hosts in your</div><div class=\"line\">    # configuration.  Most users will want to use Template, below</div><div class=\"line\">    #</div><div class=\"line\">    # Specs is an array of Spec entries.  Each Spec entry consists of two fields:</div><div class=\"line\">    #   - Hostname:   (Required) The desired hostname, sans the domain.</div><div class=\"line\">    #   - CommonName: (Optional) Specifies the template or explicit override for</div><div class=\"line\">    #                 the CN.  By default, this is the template:</div><div class=\"line\">    #</div><div class=\"line\">    #                              &quot;&#123;&#123;.Hostname&#125;&#125;.&#123;&#123;.Domain&#125;&#125;&quot;</div><div class=\"line\">    #</div><div class=\"line\">    #                 which obtains its values from the Spec.Hostname and</div><div class=\"line\">    #                 Org.Domain, respectively.</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Specs:</div><div class=\"line\">    #   - Hostname: foo # implicitly &quot;foo.org1.example.com&quot;</div><div class=\"line\">    #     CommonName: foo27.org5.example.com # overrides Hostname-based FQDN set above</div><div class=\"line\">    #   - Hostname: bar</div><div class=\"line\">    #   - Hostname: baz</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Template&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Allows for the definition of 1 or more hosts that are created sequentially</div><div class=\"line\">    # from a template. By default, this looks like &quot;peer%d&quot; from 0 to Count-1.</div><div class=\"line\">    # You may override the number of nodes (Count), the starting index (Start)</div><div class=\"line\">    # or the template used to construct the name (Hostname).</div><div class=\"line\">    #</div><div class=\"line\">    # Note: Template and Specs are not mutually exclusive.  You may define both</div><div class=\"line\">    # sections and the aggregate nodes will be created for you.  Take care with</div><div class=\"line\">    # name collisions</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Template:</div><div class=\"line\">      Count: 1</div><div class=\"line\">      # Start: 5</div><div class=\"line\">      # Hostname: &#123;&#123;.Prefix&#125;&#125;&#123;&#123;.Index&#125;&#125; # default</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Users&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Count: The number of user accounts _in addition_ to Admin</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Users:</div><div class=\"line\">      Count: 1</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Org2: See &quot;Org1&quot; for full specification</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Org2</div><div class=\"line\">    Domain: org2.bits.com</div><div class=\"line\">    EnableNodeOUs: true</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    Template:</div><div class=\"line\">      Count: 1</div><div class=\"line\">    Users:</div><div class=\"line\">      Count: 1</div></pre></td></tr></table></figure>\n<h4 id=\"configtx-yaml文件\"><a href=\"#configtx-yaml文件\" class=\"headerlink\" title=\"configtx.yaml文件\"></a>configtx.yaml文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">---</div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   Section: Organizations</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the different organizational identities which will</div><div class=\"line\">#   be referenced later in the configuration.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Organizations:</div><div class=\"line\"></div><div class=\"line\">    # SampleOrg defines an MSP using the sampleconfig.  It should never be used</div><div class=\"line\">    # in production but may be used as a template for other definitions</div><div class=\"line\">    - &amp;OrdererOrg</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: OrdererOrg</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: OrdererMSP</div><div class=\"line\"></div><div class=\"line\">        # MSPDir is the filesystem path which contains the MSP configuration</div><div class=\"line\">        MSPDir: crypto-config/ordererOrganizations/bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.member&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.member&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">    - &amp;Org1</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: Org1MSP</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: Org1MSP</div><div class=\"line\"></div><div class=\"line\">        MSPDir: crypto-config/peerOrganizations/org1.bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;, &apos;Org1MSP.peer&apos;, &apos;Org1MSP.client&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;, &apos;Org1MSP.client&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">        AnchorPeers:</div><div class=\"line\">            # AnchorPeers defines the location of peers which can be used</div><div class=\"line\">            # for cross org gossip communication.  Note, this value is only</div><div class=\"line\">            # encoded in the genesis block in the Application section context</div><div class=\"line\">            - Host: peer0.org1.bits.com</div><div class=\"line\">              Port: 7051</div><div class=\"line\"></div><div class=\"line\">    - &amp;Org2</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: Org2MSP</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: Org2MSP</div><div class=\"line\"></div><div class=\"line\">        MSPDir: crypto-config/peerOrganizations/org2.bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;, &apos;Org2MSP.peer&apos;, &apos;Org2MSP.client&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;, &apos;Org2MSP.client&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">        AnchorPeers:</div><div class=\"line\">            # AnchorPeers defines the location of peers which can be used</div><div class=\"line\">            # for cross org gossip communication.  Note, this value is only</div><div class=\"line\">            # encoded in the genesis block in the Application section context</div><div class=\"line\">            - Host: peer0.org2.bits.com</div><div class=\"line\">              Port: 7051</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Capabilities</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the capabilities of fabric network. This is a new</div><div class=\"line\">#   concept as of v1.1.0 and should not be utilized in mixed networks with</div><div class=\"line\">#   v1.0.x peers and orderers.  Capabilities define features which must be</div><div class=\"line\">#   present in a fabric binary for that binary to safely participate in the</div><div class=\"line\">#   fabric network.  For instance, if a new MSP type is added, newer binaries</div><div class=\"line\">#   might recognize and validate the signatures from this type, while older</div><div class=\"line\">#   binaries without this support would be unable to validate those</div><div class=\"line\">#   transactions.  This could lead to different versions of the fabric binaries</div><div class=\"line\">#   having different world states.  Instead, defining a capability for a channel</div><div class=\"line\">#   informs those binaries without this capability that they must cease</div><div class=\"line\">#   processing transactions until they have been upgraded.  For v1.0.x if any</div><div class=\"line\">#   capabilities are defined (including a map with all capabilities turned off)</div><div class=\"line\">#   then the v1.0.x peer will deliberately crash.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Capabilities:</div><div class=\"line\">    # Channel capabilities apply to both the orderers and the peers and must be</div><div class=\"line\">    # supported by both.  Set the value of the capability to true to require it.</div><div class=\"line\">    Global: &amp;ChannelCapabilities</div><div class=\"line\">        # V1.1 for Global is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all orderers and peers running v1.0.x,</div><div class=\"line\">        # but the modification of which would cause incompatibilities.  Users</div><div class=\"line\">        # should leave this flag set to true.</div><div class=\"line\">        V1_1: true</div><div class=\"line\"></div><div class=\"line\">    # Orderer capabilities apply only to the orderers, and may be safely</div><div class=\"line\">    # manipulated without concern for upgrading peers.  Set the value of the</div><div class=\"line\">    # capability to true to require it.</div><div class=\"line\">    Orderer: &amp;OrdererCapabilities</div><div class=\"line\">        # V1.1 for Order is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all orderers running v1.0.x, but the</div><div class=\"line\">        # modification of which  would cause incompatibilities.  Users should</div><div class=\"line\">        # leave this flag set to true.</div><div class=\"line\">        V1_1: true</div><div class=\"line\"></div><div class=\"line\">    # Application capabilities apply only to the peer network, and may be safely</div><div class=\"line\">    # manipulated without concern for upgrading orderers.  Set the value of the</div><div class=\"line\">    # capability to true to require it.</div><div class=\"line\">    Application: &amp;ApplicationCapabilities</div><div class=\"line\">        # V1.1 for Application is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all peers running v1.0.x, but the</div><div class=\"line\">        # modification of which would cause incompatibilities.  Users should</div><div class=\"line\">        # leave this flag set to true.</div><div class=\"line\">        V1_2: true</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Application</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for application related parameters</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Application: &amp;ApplicationDefaults</div><div class=\"line\"></div><div class=\"line\">    # Organizations is the list of orgs which are defined as participants on</div><div class=\"line\">    # the application side of the network</div><div class=\"line\">    Organizations:</div><div class=\"line\"></div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Application policies, their canonical path is</div><div class=\"line\">    #   /Channel/Application/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the application level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *ApplicationCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Orderer</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for orderer related parameters</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Orderer: &amp;OrdererDefaults</div><div class=\"line\"></div><div class=\"line\">    # Orderer Type: The orderer implementation to start</div><div class=\"line\">    # Available types are &quot;solo&quot; and &quot;kafka&quot; and &quot;raft&quot;</div><div class=\"line\">    OrdererType: solo</div><div class=\"line\"></div><div class=\"line\">    Addresses:</div><div class=\"line\">        - orderer.bits.com:7050</div><div class=\"line\"></div><div class=\"line\">    # Batch Timeout: The amount of time to wait before creating a batch</div><div class=\"line\">    BatchTimeout: 2s</div><div class=\"line\"></div><div class=\"line\">    # Batch Size: Controls the number of messages batched into a block</div><div class=\"line\">    BatchSize:</div><div class=\"line\"></div><div class=\"line\">        # Max Message Count: The maximum number of messages to permit in a batch</div><div class=\"line\">        MaxMessageCount: 10</div><div class=\"line\"></div><div class=\"line\">        # Absolute Max Bytes: The absolute maximum number of bytes allowed for</div><div class=\"line\">        # the serialized messages in a batch.</div><div class=\"line\">        AbsoluteMaxBytes: 98 MB</div><div class=\"line\"></div><div class=\"line\">        # Preferred Max Bytes: The preferred maximum number of bytes allowed for</div><div class=\"line\">        # the serialized messages in a batch. A message larger than the preferred</div><div class=\"line\">        # max bytes will result in a batch larger than preferred max bytes.</div><div class=\"line\">        PreferredMaxBytes: 512 KB</div><div class=\"line\"></div><div class=\"line\">    Kafka:</div><div class=\"line\">        # Brokers: A list of Kafka brokers to which the orderer connects. Edit</div><div class=\"line\">        # this list to identify the brokers of the ordering service.</div><div class=\"line\">        # NOTE: Use IP:port notation.</div><div class=\"line\">        Brokers:</div><div class=\"line\">            - 127.0.0.1:9092</div><div class=\"line\"></div><div class=\"line\">    # Organizations is the list of orgs which are defined as participants on</div><div class=\"line\">    # the orderer side of the network</div><div class=\"line\">    Organizations:</div><div class=\"line\"></div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Orderer policies, their canonical path is</div><div class=\"line\">    #   /Channel/Orderer/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\">        # BlockValidation specifies what signatures must be included in the block</div><div class=\"line\">        # from the orderer for the peer to validate it.</div><div class=\"line\">        BlockValidation:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the orderer level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *OrdererCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   CHANNEL</div><div class=\"line\">#</div><div class=\"line\">#   This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for channel related parameters.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Channel: &amp;ChannelDefaults</div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Channel policies, their canonical path is</div><div class=\"line\">    #   /Channel/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        # Who may invoke the &apos;Deliver&apos; API</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        # Who may invoke the &apos;Broadcast&apos; API</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        # By default, who may modify elements at this config level</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the channel level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *ChannelCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   Profile</div><div class=\"line\">#</div><div class=\"line\">#   - Different configuration profiles may be encoded here to be specified</div><div class=\"line\">#   as parameters to the configtxgen tool</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Profiles:</div><div class=\"line\"></div><div class=\"line\">    TwoOrgsOrdererGenesis:</div><div class=\"line\">        &lt;&lt;: *ChannelDefaults</div><div class=\"line\">        Orderer:</div><div class=\"line\">            &lt;&lt;: *OrdererDefaults</div><div class=\"line\">            Organizations:</div><div class=\"line\">                - *OrdererOrg</div><div class=\"line\">        Consortiums:</div><div class=\"line\">            SampleConsortium:</div><div class=\"line\">                Organizations:</div><div class=\"line\">                    - *Org1</div><div class=\"line\">                    - *Org2</div><div class=\"line\">    TwoOrgsChannel:</div><div class=\"line\">        Consortium: SampleConsortium</div><div class=\"line\">        Application:</div><div class=\"line\">            &lt;&lt;: *ApplicationDefaults</div><div class=\"line\">            Organizations:</div><div class=\"line\">                - *Org1</div><div class=\"line\">                - *Org2</div></pre></td></tr></table></figure>\n<h4 id=\"生成公私钥和证书\"><a href=\"#生成公私钥和证书\" class=\"headerlink\" title=\"生成公私钥和证书\"></a>生成公私钥和证书</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./bin/cryptogen generate --config=./crypto-config.yaml</div></pre></td></tr></table></figure>\n<h4 id=\"生成创世区块\"><a href=\"#生成创世区块\" class=\"headerlink\" title=\"生成创世区块\"></a>生成创世区块</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir channel-artifacts</div><div class=\"line\">./bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block</div></pre></td></tr></table></figure>\n<h4 id=\"生成通道配置区块\"><a href=\"#生成通道配置区块\" class=\"headerlink\" title=\"生成通道配置区块\"></a>生成通道配置区块</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/bits-query.tx -channelID bits-query</div></pre></td></tr></table></figure>\n<h4 id=\"拷贝到别的电脑\"><a href=\"#拷贝到别的电脑\" class=\"headerlink\" title=\"拷贝到别的电脑\"></a>拷贝到别的电脑</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd ..</div><div class=\"line\">scp -r bits ubuntu@10.9.84.83:/data/bits</div></pre></td></tr></table></figure>\n<h2 id=\"部署order，配置docker-compose-orderer-yaml文件\"><a href=\"#部署order，配置docker-compose-orderer-yaml文件\" class=\"headerlink\" title=\"部署order，配置docker-compose-orderer.yaml文件\"></a>部署order，配置docker-compose-orderer.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\"></div><div class=\"line\">  orderer.example.com:</div><div class=\"line\">    container_name: orderer.bits.com</div><div class=\"line\">    image: hyperledger/fabric-orderer</div><div class=\"line\">    environment:</div><div class=\"line\">      - ORDERER_GENERAL_LOGLEVEL=debug</div><div class=\"line\">      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0</div><div class=\"line\">      - ORDERER_GENERAL_GENESISMETHOD=file</div><div class=\"line\">      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block</div><div class=\"line\">      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP</div><div class=\"line\">      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp</div><div class=\"line\">      # enabled TLS</div><div class=\"line\">      - ORDERER_GENERAL_TLS_ENABLED=true</div><div class=\"line\">      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key</div><div class=\"line\">      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt</div><div class=\"line\">      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</div><div class=\"line\">      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s</div><div class=\"line\">      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s</div><div class=\"line\">      - ORDERER_KAFKA_VERBOSE=true</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric</div><div class=\"line\">    command: orderer</div><div class=\"line\">    volumes:</div><div class=\"line\">      - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block</div><div class=\"line\">      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp:/var/hyperledger/orderer/msp</div><div class=\"line\">      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/:/var/hyperledger/orderer/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7050:7050</div></pre></td></tr></table></figure>\n<h4 id=\"启动Fabric-orderer排序服务\"><a href=\"#启动Fabric-orderer排序服务\" class=\"headerlink\" title=\"启动Fabric orderer排序服务\"></a>启动Fabric orderer排序服务</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-orderer.yaml up -d</div></pre></td></tr></table></figure>\n<h2 id=\"部署peer0-org1-bits-com-配置docker-compose-org1-peer0-yaml文件\"><a href=\"#部署peer0-org1-bits-com-配置docker-compose-org1-peer0-yaml文件\" class=\"headerlink\" title=\"部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件\"></a>部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\">  peer0.org1.bits.com:</div><div class=\"line\">    container_name: peer0.org1.bits.com</div><div class=\"line\">    image: hyperledger/fabric-peer</div><div class=\"line\">    environment:</div><div class=\"line\">      - CORE_PEER_ID=peer0.org1.bits.com</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_CHAINCODEADDRESS=peer0.org1.bits.com:7052</div><div class=\"line\">      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</div><div class=\"line\">      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org1MSP</div><div class=\"line\"></div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      # the following setting starts chaincode containers on the same</div><div class=\"line\">      # bridge network as the peers</div><div class=\"line\">      # https://docs.docker.com/compose/networking/</div><div class=\"line\">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default</div><div class=\"line\">      #- CORE_LOGGING_LEVEL=ERROR</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_USELEADERELECTION=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_ORGLEADER=false</div><div class=\"line\">      - CORE_PEER_PROFILE_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    command: peer node start</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp:/etc/hyperledger/fabric/msp</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls:/etc/hyperledger/fabric/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7051:7051</div><div class=\"line\">      - 7052:7052</div><div class=\"line\">      - 7053:7053</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">      - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\"></div><div class=\"line\">  cli:</div><div class=\"line\">    container_name: cli</div><div class=\"line\">    image: hyperledger/fabric-tools</div><div class=\"line\">    tty: true</div><div class=\"line\">    environment:</div><div class=\"line\">      - GOPATH=/opt/gopath</div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_ID=cli</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org1MSP</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt</div><div class=\"line\">      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go</div><div class=\"line\">        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/</div><div class=\"line\">        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</div><div class=\"line\">    depends_on:</div><div class=\"line\">       - peer0.org1.bits.com</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">       - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org1.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org2.bits.com:10.9.84.83&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"启动peer0-org1-bits-com\"><a href=\"#启动peer0-org1-bits-com\" class=\"headerlink\" title=\"启动peer0.org1.bits.com\"></a>启动peer0.org1.bits.com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-org1-peer0.yaml up -d</div></pre></td></tr></table></figure>\n<h4 id=\"进入容器\"><a href=\"#进入容器\" class=\"headerlink\" title=\"进入容器\"></a>进入容器</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it cli bash</div></pre></td></tr></table></figure>\n<h4 id=\"创建Channel通道\"><a href=\"#创建Channel通道\" class=\"headerlink\" title=\"创建Channel通道\"></a>创建Channel通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 因为创建通道需要通知orderer 所以设置oderer的tls证书</div><div class=\"line\">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem</div><div class=\"line\"></div><div class=\"line\">peer channel create -o orderer.bits.com:7050 -c bits-query -f ./channel-artifacts/bits-query.tx --tls --cafile $ORDERER_CA</div></pre></td></tr></table></figure>\n<h4 id=\"加入channel通道\"><a href=\"#加入channel通道\" class=\"headerlink\" title=\"加入channel通道\"></a>加入channel通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer channel join -b bits-query.block</div></pre></td></tr></table></figure>\n<h4 id=\"保存通道信息-需将通道信息拷贝至其他节点\"><a href=\"#保存通道信息-需将通道信息拷贝至其他节点\" class=\"headerlink\" title=\"保存通道信息,需将通道信息拷贝至其他节点\"></a>保存通道信息,需将通道信息拷贝至其他节点</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">#容器名</div><div class=\"line\">docker cp xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.block /data/bits/channel-artifacts</div><div class=\"line\"></div><div class=\"line\">scp -r /data/bits xxx:/data</div></pre></td></tr></table></figure>\n<h4 id=\"打包智能合约\"><a href=\"#打包智能合约\" class=\"headerlink\" title=\"打包智能合约\"></a>打包智能合约</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 每台机器单独安装的话，里面的编号不一致，所以打包好后，去有需要的节点再安装</div><div class=\"line\"></div><div class=\"line\">peer chaincode package -n bits-query -p query/cmd/ -v 1.0 bits-query.pak</div><div class=\"line\"></div><div class=\"line\">docker cp xxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.pak /data/bits/channel-artifacts</div></pre></td></tr></table></figure>\n<h4 id=\"peer0-org1-bits-com安装\"><a href=\"#peer0-org1-bits-com安装\" class=\"headerlink\" title=\"peer0.org1.bits.com安装\"></a>peer0.org1.bits.com安装</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode install bits-query.pak</div></pre></td></tr></table></figure>\n<h2 id=\"部署peer0-org2-bits-com-配置docker-compose-org2-peer0-yaml文件\"><a href=\"#部署peer0-org2-bits-com-配置docker-compose-org2-peer0-yaml文件\" class=\"headerlink\" title=\"部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件\"></a>部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\">  peer0.org2.bits.com:</div><div class=\"line\">    container_name: peer0.org2.bits.com</div><div class=\"line\">    image: hyperledger/fabric-peer</div><div class=\"line\">    environment:</div><div class=\"line\">      - CORE_PEER_ID=peer0.org2.bits.com</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_CHAINCODEADDRESS=peer0.org2.bits.com:7052</div><div class=\"line\">      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</div><div class=\"line\">      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org2MSP</div><div class=\"line\"></div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      # the following setting starts chaincode containers on the same</div><div class=\"line\">      # bridge network as the peers</div><div class=\"line\">      # https://docs.docker.com/compose/networking/</div><div class=\"line\">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default</div><div class=\"line\">      #- CORE_LOGGING_LEVEL=ERROR</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_USELEADERELECTION=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_ORGLEADER=false</div><div class=\"line\">      - CORE_PEER_PROFILE_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    command: peer node start</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp:/etc/hyperledger/fabric/msp</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls:/etc/hyperledger/fabric/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7051:7051</div><div class=\"line\">      - 7052:7052</div><div class=\"line\">      - 7053:7053</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">      - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\"></div><div class=\"line\">  cli:</div><div class=\"line\">    container_name: cli</div><div class=\"line\">    image: hyperledger/fabric-tools</div><div class=\"line\">    tty: true</div><div class=\"line\">    environment:</div><div class=\"line\">      - GOPATH=/opt/gopath</div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_ID=cli</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org2MSP</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt</div><div class=\"line\">      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go</div><div class=\"line\">        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/</div><div class=\"line\">        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</div><div class=\"line\">    depends_on:</div><div class=\"line\">       - peer0.org2.bits.com</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">       - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org1.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org2.bits.com:10.9.84.83&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"启动peer0-org2-bits-com\"><a href=\"#启动peer0-org2-bits-com\" class=\"headerlink\" title=\"启动peer0.org2.bits.com\"></a>启动peer0.org2.bits.com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-org2-peer0.yaml up -d</div></pre></td></tr></table></figure>\n<h4 id=\"进入容器-1\"><a href=\"#进入容器-1\" class=\"headerlink\" title=\"进入容器\"></a>进入容器</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it cli bash</div></pre></td></tr></table></figure>\n<h4 id=\"加入通道\"><a href=\"#加入通道\" class=\"headerlink\" title=\"加入通道\"></a>加入通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker cp /data/bits/channel-artifacts/bits-query.block xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/</div><div class=\"line\"></div><div class=\"line\">peer channel join -b bits-query.block</div></pre></td></tr></table></figure>\n<h4 id=\"peer0-org2-bits-com安装\"><a href=\"#peer0-org2-bits-com安装\" class=\"headerlink\" title=\"peer0.org2.bits.com安装\"></a>peer0.org2.bits.com安装</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker cp /data/bits/channel-artifacts/bits-query.pak xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/</div><div class=\"line\">##安装</div><div class=\"line\">peer chaincode install bits-query.pak</div><div class=\"line\">##查看是否安装成功</div><div class=\"line\">peer chaincode list --installed</div><div class=\"line\">peer chaincode list --instantiated -C bits-query</div></pre></td></tr></table></figure>\n<h2 id=\"调用\"><a href=\"#调用\" class=\"headerlink\" title=\"调用\"></a>调用</h2><h3 id=\"添加数据\"><a href=\"#添加数据\" class=\"headerlink\" title=\"添加数据\"></a>添加数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">&lt;!--peer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C bits-query -n bit-query -v 1.0 -c &apos;&#123;&quot;Args&quot;:[&quot;init&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;]&#125;&apos; -P &quot;OR (&apos;Org1MSP.peer&apos;,&apos;Org2MSP.peer&apos;)&quot;--&gt;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">peer chaincode invoke --tls --cafile $ORDERER_CA -C bits-query -n bits-query -c &apos;&#123;&quot;Args&quot;:[&quot;put&quot;,&quot;&#123;\\&quot;queryId\\&quot;:233,\\&quot;indexDigest\\&quot;:\\&quot;indexDigest\\&quot;,\\&quot;provideQueryOrg\\&quot;:\\&quot;provideQueryOrg\\&quot;,\\&quot;offerOrg\\&quot;:\\&quot;offerOrg\\&quot;,\\&quot;queryTime\\&quot;:\\&quot;queryTime\\&quot;,\\&quot;queryType\\&quot;:11,\\&quot;queryResult\\&quot;:11,\\&quot;querySerial\\&quot;:\\&quot;querySerial\\&quot;,\\&quot;hit\\&quot;:1&#125;&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<h3 id=\"查看数据\"><a href=\"#查看数据\" class=\"headerlink\" title=\"查看数据\"></a>查看数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode query  -C bits-query -n bits-query -c &apos;&#123;&quot;Args&quot;:[&quot;query&quot;,&quot;222&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<!--\n<!--peer chaincode install -n mycc -p github.com/hyperledger/fabric/multipeer/chaincode/go/example02/cmd/ -v 1.0\n\n peer chaincode install -n mycc -p github.com/hyperledger/fabric/bits/chaincode/go/example02/cmd/ -v 1.0\n\n\npeer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n mycc -v 1.0 -c '{\"Args\":[\"init\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"\n\n\n\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n\n\n\ndocker cp /data/bits/mychannel.block 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\ndocker cp /data/bits/mycc.pak 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b mychannel.block\n\npeer chaincode install mycc.pak\n\n\npeer chaincode list --installed\n\n\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C mychannel -n mycc -c '{\"Args\":[\"invoke\",\"a\",\"b\",\"10\"]}'\n\n\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"a\"]}'-->\n"},{"title":"crontab","date":"2018-06-13T05:39:23.000Z","_content":"\n### 执行时间设置\n```\n每五分钟执行   */5 * * * *\n\n每小时执行     0 * * * *\n\n每天执行       0 0 * * *\n\n每周执行       0 0 * * 0\n\n每月执行       0 0 1 * *\n\n每年执行       0 0 1 1 *\n\n```\n\n### 日志设置\n错误方式：\n\n```\n*/1 * * * * /data/crontab/test.sh  2>&1 >> /data/crontab/log/test.log\n\n```\n正确方式：\n\n```\n*/1 * * * * /data/crontab/test.sh  >> /data/crontab/log/test.log 2>&1\n```\n\n\n\n\n\n","source":"_posts/crontab.md","raw":"---\ntitle: crontab\ndate: 2018-06-13 13:39:23\ncategories: \n\t- gitlab\ntags:\n\t- linux\n\t- centos6.5\n\t- crontab\n---\n\n### 执行时间设置\n```\n每五分钟执行   */5 * * * *\n\n每小时执行     0 * * * *\n\n每天执行       0 0 * * *\n\n每周执行       0 0 * * 0\n\n每月执行       0 0 1 * *\n\n每年执行       0 0 1 1 *\n\n```\n\n### 日志设置\n错误方式：\n\n```\n*/1 * * * * /data/crontab/test.sh  2>&1 >> /data/crontab/log/test.log\n\n```\n正确方式：\n\n```\n*/1 * * * * /data/crontab/test.sh  >> /data/crontab/log/test.log 2>&1\n```\n\n\n\n\n\n","slug":"crontab","published":1,"updated":"2018-06-19T09:34:29.763Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exb00031fihcsobtpfo","content":"<h3 id=\"执行时间设置\"><a href=\"#执行时间设置\" class=\"headerlink\" title=\"执行时间设置\"></a>执行时间设置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">每五分钟执行   */5 * * * *</div><div class=\"line\"></div><div class=\"line\">每小时执行     0 * * * *</div><div class=\"line\"></div><div class=\"line\">每天执行       0 0 * * *</div><div class=\"line\"></div><div class=\"line\">每周执行       0 0 * * 0</div><div class=\"line\"></div><div class=\"line\">每月执行       0 0 1 * *</div><div class=\"line\"></div><div class=\"line\">每年执行       0 0 1 1 *</div></pre></td></tr></table></figure>\n<h3 id=\"日志设置\"><a href=\"#日志设置\" class=\"headerlink\" title=\"日志设置\"></a>日志设置</h3><p>错误方式：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">*/1 * * * * /data/crontab/test.sh  2&gt;&amp;1 &gt;&gt; /data/crontab/log/test.log</div></pre></td></tr></table></figure>\n<p>正确方式：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">*/1 * * * * /data/crontab/test.sh  &gt;&gt; /data/crontab/log/test.log 2&gt;&amp;1</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"执行时间设置\"><a href=\"#执行时间设置\" class=\"headerlink\" title=\"执行时间设置\"></a>执行时间设置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">每五分钟执行   */5 * * * *</div><div class=\"line\"></div><div class=\"line\">每小时执行     0 * * * *</div><div class=\"line\"></div><div class=\"line\">每天执行       0 0 * * *</div><div class=\"line\"></div><div class=\"line\">每周执行       0 0 * * 0</div><div class=\"line\"></div><div class=\"line\">每月执行       0 0 1 * *</div><div class=\"line\"></div><div class=\"line\">每年执行       0 0 1 1 *</div></pre></td></tr></table></figure>\n<h3 id=\"日志设置\"><a href=\"#日志设置\" class=\"headerlink\" title=\"日志设置\"></a>日志设置</h3><p>错误方式：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">*/1 * * * * /data/crontab/test.sh  2&gt;&amp;1 &gt;&gt; /data/crontab/log/test.log</div></pre></td></tr></table></figure>\n<p>正确方式：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">*/1 * * * * /data/crontab/test.sh  &gt;&gt; /data/crontab/log/test.log 2&gt;&amp;1</div></pre></td></tr></table></figure>\n"},{"title":"Hello World","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","slug":"hello-world","published":1,"date":"2017-05-01T02:39:44.000Z","updated":"2017-05-01T02:39:44.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exg00071fihz1tm05sx","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"external\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"external\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"external\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"external\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"external\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"external\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"external\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"external\">Deployment</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"external\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"external\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"external\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"external\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"external\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"external\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"external\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"external\">Deployment</a></p>\n"},{"title":"hyperledger CA部署","date":"2019-03-29T05:57:23.000Z","_content":"\n### 机器准备\n\n| 功能 | ip  | 机器名称 |端口\n|:------------- |:---------:| -------:|----:|\n| rootCa   | 10.9.84.83 |  rootCa.org2.bits.com |7054|\n| orgCa1   | 10.9.84.83 |  orgCa1.org2.bits.com |7055|\n| tlsCa1   | 10.9.84.83 |  tlsCa1.org2.bits.com |7056|\n| orgCa2   | 10.9.84.83 |  orgCa2.org2.bits.com |7057|\n| tlsca2   | 10.9.84.83 |  tlsca2.org2.bits.com |7058|\n## 初始化CA\n### 初始化ROOT\n```\nfabric-ca-server init -b admin:adminpw --home ./rootca\n```\n### 初始化org1ca\n```\nfabric-ca-server init -b admin1:adminpw1 -u http://admin:adminpw@localhost:7054 --home ./org1ca\n```\n### 初始化org1tlsca\n```\nfabric-ca-server init -b admin1:adminpw1 -u http://admin:adminpw@localhost:7054 --home ./org1tlsca\n```\n### 初始化org2ca\n```\nfabric-ca-server init -b admin2:adminpw2 -u http://admin:adminpw@localhost:7054 --home ./org2ca\n```\n### 初始化org2tlsca\n```\nfabric-ca-server init -b admin2:adminpw2 -u http://admin:adminpw@localhost:7054 --home ./org2tlsca\n```\n\n## 从rootCA 注册 order  bits.com \n\n```\n# 注册并生成MSP证书\nfabric-ca-client enroll -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n#查看已存在的成员\nfabric-ca-client affiliation list -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n\n```\n### 添加联盟\n```\nfabric-ca-client affiliation add com -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n\nfabric-ca-client affiliation add com.bits -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n```\n\n###  注册admin\n\n#### 注册\n```\nfabric-ca-client register --id.name Admin@bits.com --id.type client --id.affiliation \"com.bits\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=bits.com --csr.hosts=['bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n```\n#### 登记\n```\nfabric-ca-client enroll -u http://Admin@bits.com:123456@localhost:7054 --csr.cn=bits.com --csr.hosts=['bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp --home ./fabric-ca-client\n```\n#### 添加msp\n```\nmkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/admincerts\n\ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/admincerts\n\nmkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/msp/admincerts\n\ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/msp/admincerts\n\n```\n###生成bits.com的tls\n####注册\n```\nfabric-ca-client register --id.name Admin@bits.com --id.type client --id.affiliation \"com.bits\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=bits.com --csr.hosts=['bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/tls -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n```\n#### 登记\n```\n fabric-ca-client enroll -M ./ca-crypto-config/ordererOrganizations/bits.com/tls -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n```\n\n### admin生成tls\n####登记\n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@bits.com:123456@localhost:7054 --csr.cn=bits.com --csr.hosts=['bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls --home ./fabric-ca-client\n\n```\n#### 生成\n```\ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/tlscacerts/tls-localhost-7054.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/ca.crt\n\n cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/client.crt\n \ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/keystore/bbd7674ee2722ed168bb5d5f0643d1f4f2b0fa5fc6cf951363fb15cb88e378f0_sk ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/client.key\n\n```\n\n###  生成orderer.bits.com\n### 注册\n```\nfabric-ca-client register --id.name orderer.bits.com --id.type orderer --id.affiliation \"com.bits\" --id.attrs '\"role=orderer\",ecert=true' --id.secret=123456 --csr.cn=orderer.bits.com --csr.hosts=['orderer.bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n```\n###登记orderer\n\n```\nfabric-ca-client enroll -u http://orderer.bits.com:123456@localhost:7054 --csr.cn=orderer.bits.com --csr.hosts=['orderer.bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp --home ./fabric-ca-client\n\n```\n### 生成orderer msp\n```\n mkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/admincerts\n\ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/admincerts\n\n```\n### 生成 tls order直接从rootCA生成\n### 登记 \n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://orderer.bits.com:123456@localhost:7054 --csr.cn=orderer.bits.com --csr.hosts=['orderer.bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls --home ./fabric-ca-client\n```\n### 生成\n```\n\n cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/tlscacerts/tls-localhost-7054.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/ca.crt\n \n cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/server.crt\n\ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/keystore/0a0e6c818a2ce9f1596e196f22389f2a55c0a83c5dd52dfa1612640ade8df870_sk ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/server.key\n\n```\n\n### peer0.org1.bits.com 配置\n### 登记org1.bits.com\n```\nfabric-ca-client enroll --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n```\n### 添加msp\n```\n fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n \n \n fabric-ca-client affiliation add com -M ./ca-crypto-config/peebitsrOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n \n fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\nfabric-ca-client affiliation add com.bits.org1 -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n```\n### 注册admin\n```\nfabric-ca-client register --id.name Admin@org1.bits.com --id.type client --id.affiliation \"com.bits.org1\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n```\n### 登记\n```\n fabric-ca-client enroll -u http://Admin@org1.bits.com:123456@localhost:7055 --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -Mbits ./ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp --home ./fabric-ca-client\n```\n### 生成msp\n```\nmkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/admincerts\n\ncp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/admincerts\n\nmkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/msp/admincerts\n\ncp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/msp/admincerts\n\n```\n## 注册peer0.org1.bits.com\n### 注册\n```\n fabric-ca-client register --id.name peer0.org1.bits.com --id.type peer --id.affiliation \"com.bits.org1\" --id.attrs '\"role=peer\",ecert=true' --id.secret=123456 --csr.cn=peer0.org1.bits.com --csr.hosts=['peer0.org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n```\n### 登记\n```\nfabric-ca-client enroll -u http://peer0.org1.bits.com:123456@localhost:7055 --csr.cn=peer0.org1.bits.com --csr.hosts=['peer0.org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp --home ./fabric-ca-client\n```\n### 生成msp\n```\nmkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp/admincerts\ncp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp/admincerts\n\n```\n### 在tlsCa1.org2.bits.com上生成tls\n###登记\n```\nfabric-ca-client enroll --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n```\n### 添加联盟成员\n```\n fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n\n fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits.org1 -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n```\n\n### 添加admin\n```\n fabric-ca-client register --id.name Admin@org1.bits.com --id.type client --id.affiliation \"com.bits.org1\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n```\n###登记\n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@org1.bits.com:123456@localhost:7056 --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls --home ./fabric-ca-client\n\n```\n### 添加tls\n```\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/tlsintermediatecerts/tls-localhost-7056.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/ca.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/client.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/keystore/fb5f4402973df15c7ac37c8f6fc6182c1842be2b5a75c2015d6d6d2b0261a423_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/client.key\n```\n###生成peer0.org1.bits.com的msp\n#### 注册\n```\nfabric-ca-client register --id.name peer0.org1.bits.com --id.type peer --id.affiliation \"com.bits.org1\" --id.attrs '\"role=peer\",ecert=true' --id.secret=123456 --csr.cn=peer0.org1.bits.com --csr.hosts=['peer0.org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n```\n#### 登记\n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://peer0.org1.bits.com:123456@localhost:7056 --csr.cn=peer0.org1.bits.com --csr.hosts=['peer0.org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls --home ./fabric-ca-client\n```\n#### 添加tls\n```\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/tlsintermediatecerts/tls-localhost-7056.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/keystore/b240c32e626c0de53e1a7efdda64fd682b1a47a599926b11a7c8004c159ecd8d_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key\n```\n\n\n### 在orgCa2.org2.bits.com上生成peer0.org2.bits.com \n### 登记org2.bits.com\n```\nfabric-ca-client enroll --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n```\n### 添加联盟成员bits\n```\n fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n\n fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin3:adminpw2@localhost:7057 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits.org2 -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n\n```\n### 注册admin\n```\nfabric-ca-client register --id.name Admin@org2.bits.com --id.type client --id.affiliation \"com.bits.org2\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n\n```\n### 登记\n```\nfabric-ca-client enroll -u http://Admin@org2.bits.com:123456@localhost:7057 --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp --home ./fabric-ca-client\n\n```\n### 添加msp\n```\n mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/admincerts\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/admincerts\n mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/msp/admincerts\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/msp/admincerts\n\n```\n### 生成peer0.org2.bits.com的msp\n### 注册bits\n```\nfabric-ca-client register --id.name peer0.org2.bits.com --id.type peer --id.affiliation \"com.bits.org2\" --id.attrs '\"role=peer\",ecert=true' --id.secret=123456 --csr.cn=peer0.org2.bits.com --csr.hosts=['peer0.org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n```\n### 登记\n```\nfabric-ca-client enroll -u http://peer0.org2.bits.com:123456@localhost:7057 --csr.cn=peer0.org2.bits.com --csr.hosts=['peer0.org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp --home ./fabric-ca-client\n```\n### 添加msp\n```\n mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp/admincerts\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp/admincerts\n```\n\n## 在tlsca2.org2.bits.com上生成peer0.org2.bits.com的tls证书\n### 生成org2.bits.com的msp\n```\nfabric-ca-client enroll --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n\n```\n### 添加联盟成员\n```\n fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n\n fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits.org2 -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n\n```\n### 生成Admin@bits.com的msp\n####注册bits\n```\nfabric-ca-client register --id.name Admin@org2.bits.com --id.type client --id.affiliation \"com.bits.org2\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n```\n#### 登记\n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@org2.bits.com:123456@localhost:7058 --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls --home ./fabric-ca-client\n```\n### 添加tls\n```\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/tlsintermediatecerts/tls-localhost-7058.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/ca.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/client.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/keystore/6872abd57f40265c11e1f7c6630de995a732a75a41667928f4ba6540bb0ee429_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/client.key\n\n```\n###生成peer0.org2.bits.com的tls\n### 注册\n```\nfabric-ca-client register --id.name peer0.org2.bits.com --id.type peer --id.affiliation \"com.bits.org2\" --id.attrs '\"role=peer\",ecert=true' --id.secret=123456 --csr.cn=peer0.org2.bits.com --csr.hosts=['peer0.org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n```\n### 登记\n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://peer0.org2.bits.com:123456@localhost:7058 --csr.cn=peer0.org2.bits.com --csr.hosts=['peer0.org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls --home ./fabric-ca-client\n```\n### 添加\n\n```\ncp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/tlsintermediatecerts/tls-localhost-7058.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/keystore/19cc5473626ac32223df84ec1b05f5f2a98dc507c1325494ac3e7f5751118cdd_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key\n```\n\n\n","source":"_drafts/hyperledger CA部署.md","raw":"---\ntitle: hyperledger CA部署\ndate: 2019-03-29 13:57:23\ncategories: \n\t- 区块链\ntags:\n\t- hyperledger CA部署\n---\n\n### 机器准备\n\n| 功能 | ip  | 机器名称 |端口\n|:------------- |:---------:| -------:|----:|\n| rootCa   | 10.9.84.83 |  rootCa.org2.bits.com |7054|\n| orgCa1   | 10.9.84.83 |  orgCa1.org2.bits.com |7055|\n| tlsCa1   | 10.9.84.83 |  tlsCa1.org2.bits.com |7056|\n| orgCa2   | 10.9.84.83 |  orgCa2.org2.bits.com |7057|\n| tlsca2   | 10.9.84.83 |  tlsca2.org2.bits.com |7058|\n## 初始化CA\n### 初始化ROOT\n```\nfabric-ca-server init -b admin:adminpw --home ./rootca\n```\n### 初始化org1ca\n```\nfabric-ca-server init -b admin1:adminpw1 -u http://admin:adminpw@localhost:7054 --home ./org1ca\n```\n### 初始化org1tlsca\n```\nfabric-ca-server init -b admin1:adminpw1 -u http://admin:adminpw@localhost:7054 --home ./org1tlsca\n```\n### 初始化org2ca\n```\nfabric-ca-server init -b admin2:adminpw2 -u http://admin:adminpw@localhost:7054 --home ./org2ca\n```\n### 初始化org2tlsca\n```\nfabric-ca-server init -b admin2:adminpw2 -u http://admin:adminpw@localhost:7054 --home ./org2tlsca\n```\n\n## 从rootCA 注册 order  bits.com \n\n```\n# 注册并生成MSP证书\nfabric-ca-client enroll -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n#查看已存在的成员\nfabric-ca-client affiliation list -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n\n```\n### 添加联盟\n```\nfabric-ca-client affiliation add com -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n\nfabric-ca-client affiliation add com.bits -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n```\n\n###  注册admin\n\n#### 注册\n```\nfabric-ca-client register --id.name Admin@bits.com --id.type client --id.affiliation \"com.bits\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=bits.com --csr.hosts=['bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n```\n#### 登记\n```\nfabric-ca-client enroll -u http://Admin@bits.com:123456@localhost:7054 --csr.cn=bits.com --csr.hosts=['bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp --home ./fabric-ca-client\n```\n#### 添加msp\n```\nmkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/admincerts\n\ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/admincerts\n\nmkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/msp/admincerts\n\ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/msp/admincerts\n\n```\n###生成bits.com的tls\n####注册\n```\nfabric-ca-client register --id.name Admin@bits.com --id.type client --id.affiliation \"com.bits\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=bits.com --csr.hosts=['bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/tls -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n```\n#### 登记\n```\n fabric-ca-client enroll -M ./ca-crypto-config/ordererOrganizations/bits.com/tls -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n```\n\n### admin生成tls\n####登记\n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@bits.com:123456@localhost:7054 --csr.cn=bits.com --csr.hosts=['bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls --home ./fabric-ca-client\n\n```\n#### 生成\n```\ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/tlscacerts/tls-localhost-7054.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/ca.crt\n\n cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/client.crt\n \ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/keystore/bbd7674ee2722ed168bb5d5f0643d1f4f2b0fa5fc6cf951363fb15cb88e378f0_sk ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/client.key\n\n```\n\n###  生成orderer.bits.com\n### 注册\n```\nfabric-ca-client register --id.name orderer.bits.com --id.type orderer --id.affiliation \"com.bits\" --id.attrs '\"role=orderer\",ecert=true' --id.secret=123456 --csr.cn=orderer.bits.com --csr.hosts=['orderer.bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client\n```\n###登记orderer\n\n```\nfabric-ca-client enroll -u http://orderer.bits.com:123456@localhost:7054 --csr.cn=orderer.bits.com --csr.hosts=['orderer.bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp --home ./fabric-ca-client\n\n```\n### 生成orderer msp\n```\n mkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/admincerts\n\ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/admincerts\n\n```\n### 生成 tls order直接从rootCA生成\n### 登记 \n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://orderer.bits.com:123456@localhost:7054 --csr.cn=orderer.bits.com --csr.hosts=['orderer.bits.com'] -M ./ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls --home ./fabric-ca-client\n```\n### 生成\n```\n\n cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/tlscacerts/tls-localhost-7054.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/ca.crt\n \n cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/server.crt\n\ncp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/keystore/0a0e6c818a2ce9f1596e196f22389f2a55c0a83c5dd52dfa1612640ade8df870_sk ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/server.key\n\n```\n\n### peer0.org1.bits.com 配置\n### 登记org1.bits.com\n```\nfabric-ca-client enroll --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n```\n### 添加msp\n```\n fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n \n \n fabric-ca-client affiliation add com -M ./ca-crypto-config/peebitsrOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n \n fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\nfabric-ca-client affiliation add com.bits.org1 -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n```\n### 注册admin\n```\nfabric-ca-client register --id.name Admin@org1.bits.com --id.type client --id.affiliation \"com.bits.org1\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n```\n### 登记\n```\n fabric-ca-client enroll -u http://Admin@org1.bits.com:123456@localhost:7055 --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -Mbits ./ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp --home ./fabric-ca-client\n```\n### 生成msp\n```\nmkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/admincerts\n\ncp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/admincerts\n\nmkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/msp/admincerts\n\ncp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/msp/admincerts\n\n```\n## 注册peer0.org1.bits.com\n### 注册\n```\n fabric-ca-client register --id.name peer0.org1.bits.com --id.type peer --id.affiliation \"com.bits.org1\" --id.attrs '\"role=peer\",ecert=true' --id.secret=123456 --csr.cn=peer0.org1.bits.com --csr.hosts=['peer0.org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client\n```\n### 登记\n```\nfabric-ca-client enroll -u http://peer0.org1.bits.com:123456@localhost:7055 --csr.cn=peer0.org1.bits.com --csr.hosts=['peer0.org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp --home ./fabric-ca-client\n```\n### 生成msp\n```\nmkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp/admincerts\ncp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp/admincerts\n\n```\n### 在tlsCa1.org2.bits.com上生成tls\n###登记\n```\nfabric-ca-client enroll --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n```\n### 添加联盟成员\n```\n fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n\n fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits.org1 -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n```\n\n### 添加admin\n```\n fabric-ca-client register --id.name Admin@org1.bits.com --id.type client --id.affiliation \"com.bits.org1\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n```\n###登记\n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@org1.bits.com:123456@localhost:7056 --csr.cn=org1.bits.com --csr.hosts=['org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls --home ./fabric-ca-client\n\n```\n### 添加tls\n```\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/tlsintermediatecerts/tls-localhost-7056.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/ca.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/client.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/keystore/fb5f4402973df15c7ac37c8f6fc6182c1842be2b5a75c2015d6d6d2b0261a423_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/client.key\n```\n###生成peer0.org1.bits.com的msp\n#### 注册\n```\nfabric-ca-client register --id.name peer0.org1.bits.com --id.type peer --id.affiliation \"com.bits.org1\" --id.attrs '\"role=peer\",ecert=true' --id.secret=123456 --csr.cn=peer0.org1.bits.com --csr.hosts=['peer0.org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client\n```\n#### 登记\n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://peer0.org1.bits.com:123456@localhost:7056 --csr.cn=peer0.org1.bits.com --csr.hosts=['peer0.org1.bits.com'] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls --home ./fabric-ca-client\n```\n#### 添加tls\n```\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/tlsintermediatecerts/tls-localhost-7056.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/keystore/b240c32e626c0de53e1a7efdda64fd682b1a47a599926b11a7c8004c159ecd8d_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key\n```\n\n\n### 在orgCa2.org2.bits.com上生成peer0.org2.bits.com \n### 登记org2.bits.com\n```\nfabric-ca-client enroll --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n```\n### 添加联盟成员bits\n```\n fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n\n fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin3:adminpw2@localhost:7057 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits.org2 -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n\n```\n### 注册admin\n```\nfabric-ca-client register --id.name Admin@org2.bits.com --id.type client --id.affiliation \"com.bits.org2\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n\n```\n### 登记\n```\nfabric-ca-client enroll -u http://Admin@org2.bits.com:123456@localhost:7057 --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp --home ./fabric-ca-client\n\n```\n### 添加msp\n```\n mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/admincerts\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/admincerts\n mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/msp/admincerts\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/msp/admincerts\n\n```\n### 生成peer0.org2.bits.com的msp\n### 注册bits\n```\nfabric-ca-client register --id.name peer0.org2.bits.com --id.type peer --id.affiliation \"com.bits.org2\" --id.attrs '\"role=peer\",ecert=true' --id.secret=123456 --csr.cn=peer0.org2.bits.com --csr.hosts=['peer0.org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client\n```\n### 登记\n```\nfabric-ca-client enroll -u http://peer0.org2.bits.com:123456@localhost:7057 --csr.cn=peer0.org2.bits.com --csr.hosts=['peer0.org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp --home ./fabric-ca-client\n```\n### 添加msp\n```\n mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp/admincerts\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp/admincerts\n```\n\n## 在tlsca2.org2.bits.com上生成peer0.org2.bits.com的tls证书\n### 生成org2.bits.com的msp\n```\nfabric-ca-client enroll --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n\n```\n### 添加联盟成员\n```\n fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n\n fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n fabric-ca-client affiliation add com.bits.org2 -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n\n```\n### 生成Admin@bits.com的msp\n####注册bits\n```\nfabric-ca-client register --id.name Admin@org2.bits.com --id.type client --id.affiliation \"com.bits.org2\" --id.attrs '\"hf.Registrar.Roles=client,orderer,peer,user\",\"hf.Registrar.DelegateRoles=client,orderer,peer,user\",hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert' --id.secret=123456 --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n```\n#### 登记\n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@org2.bits.com:123456@localhost:7058 --csr.cn=org2.bits.com --csr.hosts=['org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls --home ./fabric-ca-client\n```\n### 添加tls\n```\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/tlsintermediatecerts/tls-localhost-7058.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/ca.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/client.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/keystore/6872abd57f40265c11e1f7c6630de995a732a75a41667928f4ba6540bb0ee429_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/client.key\n\n```\n###生成peer0.org2.bits.com的tls\n### 注册\n```\nfabric-ca-client register --id.name peer0.org2.bits.com --id.type peer --id.affiliation \"com.bits.org2\" --id.attrs '\"role=peer\",ecert=true' --id.secret=123456 --csr.cn=peer0.org2.bits.com --csr.hosts=['peer0.org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client\n```\n### 登记\n```\nfabric-ca-client enroll -d --enrollment.profile tls -u http://peer0.org2.bits.com:123456@localhost:7058 --csr.cn=peer0.org2.bits.com --csr.hosts=['peer0.org2.bits.com'] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls --home ./fabric-ca-client\n```\n### 添加\n\n```\ncp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/tlsintermediatecerts/tls-localhost-7058.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt\n cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/keystore/19cc5473626ac32223df84ec1b05f5f2a98dc507c1325494ac3e7f5751118cdd_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key\n```\n\n\n","slug":"hyperledger CA部署","published":0,"updated":"2019-08-20T07:00:25.452Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exj00081fihuhekvn2k","content":"<h3 id=\"机器准备\"><a href=\"#机器准备\" class=\"headerlink\" title=\"机器准备\"></a>机器准备</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">功能</th>\n<th style=\"text-align:center\">ip</th>\n<th style=\"text-align:right\">机器名称</th>\n<th style=\"text-align:right\">端口</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">rootCa</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">rootCa.org2.bits.com</td>\n<td style=\"text-align:right\">7054</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">orgCa1</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">orgCa1.org2.bits.com</td>\n<td style=\"text-align:right\">7055</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">tlsCa1</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">tlsCa1.org2.bits.com</td>\n<td style=\"text-align:right\">7056</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">orgCa2</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">orgCa2.org2.bits.com</td>\n<td style=\"text-align:right\">7057</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">tlsca2</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">tlsca2.org2.bits.com</td>\n<td style=\"text-align:right\">7058</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"初始化CA\"><a href=\"#初始化CA\" class=\"headerlink\" title=\"初始化CA\"></a>初始化CA</h2><h3 id=\"初始化ROOT\"><a href=\"#初始化ROOT\" class=\"headerlink\" title=\"初始化ROOT\"></a>初始化ROOT</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-server init -b admin:adminpw --home ./rootca</div></pre></td></tr></table></figure>\n<h3 id=\"初始化org1ca\"><a href=\"#初始化org1ca\" class=\"headerlink\" title=\"初始化org1ca\"></a>初始化org1ca</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-server init -b admin1:adminpw1 -u http://admin:adminpw@localhost:7054 --home ./org1ca</div></pre></td></tr></table></figure>\n<h3 id=\"初始化org1tlsca\"><a href=\"#初始化org1tlsca\" class=\"headerlink\" title=\"初始化org1tlsca\"></a>初始化org1tlsca</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-server init -b admin1:adminpw1 -u http://admin:adminpw@localhost:7054 --home ./org1tlsca</div></pre></td></tr></table></figure>\n<h3 id=\"初始化org2ca\"><a href=\"#初始化org2ca\" class=\"headerlink\" title=\"初始化org2ca\"></a>初始化org2ca</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-server init -b admin2:adminpw2 -u http://admin:adminpw@localhost:7054 --home ./org2ca</div></pre></td></tr></table></figure>\n<h3 id=\"初始化org2tlsca\"><a href=\"#初始化org2tlsca\" class=\"headerlink\" title=\"初始化org2tlsca\"></a>初始化org2tlsca</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-server init -b admin2:adminpw2 -u http://admin:adminpw@localhost:7054 --home ./org2tlsca</div></pre></td></tr></table></figure>\n<h2 id=\"从rootCA-注册-order-bits-com\"><a href=\"#从rootCA-注册-order-bits-com\" class=\"headerlink\" title=\"从rootCA 注册 order  bits.com\"></a>从rootCA 注册 order  bits.com</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 注册并生成MSP证书</div><div class=\"line\">fabric-ca-client enroll -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div><div class=\"line\">#查看已存在的成员</div><div class=\"line\">fabric-ca-client affiliation list -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加联盟\"><a href=\"#添加联盟\" class=\"headerlink\" title=\"添加联盟\"></a>添加联盟</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client affiliation add com -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div><div class=\"line\"></div><div class=\"line\">fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"注册admin\"><a href=\"#注册admin\" class=\"headerlink\" title=\"注册admin\"></a>注册admin</h3><h4 id=\"注册\"><a href=\"#注册\" class=\"headerlink\" title=\"注册\"></a>注册</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@bits.com --id.type client --id.affiliation &quot;com.bits&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=bits.com --csr.hosts=[&apos;bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h4 id=\"登记\"><a href=\"#登记\" class=\"headerlink\" title=\"登记\"></a>登记</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://Admin@bits.com:123456@localhost:7054 --csr.cn=bits.com --csr.hosts=[&apos;bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h4 id=\"添加msp\"><a href=\"#添加msp\" class=\"headerlink\" title=\"添加msp\"></a>添加msp</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<p>###生成bits.com的tls</p>\n<p>####注册<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@bits.com --id.type client --id.affiliation &quot;com.bits&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=bits.com --csr.hosts=[&apos;bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/tls -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure></p>\n<h4 id=\"登记-1\"><a href=\"#登记-1\" class=\"headerlink\" title=\"登记\"></a>登记</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -M ./ca-crypto-config/ordererOrganizations/bits.com/tls -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"admin生成tls\"><a href=\"#admin生成tls\" class=\"headerlink\" title=\"admin生成tls\"></a>admin生成tls</h3><p>####登记<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@bits.com:123456@localhost:7054 --csr.cn=bits.com --csr.hosts=[&apos;bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure></p>\n<h4 id=\"生成\"><a href=\"#生成\" class=\"headerlink\" title=\"生成\"></a>生成</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/tlscacerts/tls-localhost-7054.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/ca.crt</div><div class=\"line\"></div><div class=\"line\"> cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/client.crt</div><div class=\"line\"> </div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/keystore/bbd7674ee2722ed168bb5d5f0643d1f4f2b0fa5fc6cf951363fb15cb88e378f0_sk ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/client.key</div></pre></td></tr></table></figure>\n<h3 id=\"生成orderer-bits-com\"><a href=\"#生成orderer-bits-com\" class=\"headerlink\" title=\"生成orderer.bits.com\"></a>生成orderer.bits.com</h3><h3 id=\"注册-1\"><a href=\"#注册-1\" class=\"headerlink\" title=\"注册\"></a>注册</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name orderer.bits.com --id.type orderer --id.affiliation &quot;com.bits&quot; --id.attrs &apos;&quot;role=orderer&quot;,ecert=true&apos; --id.secret=123456 --csr.cn=orderer.bits.com --csr.hosts=[&apos;orderer.bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<p>###登记orderer</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://orderer.bits.com:123456@localhost:7054 --csr.cn=orderer.bits.com --csr.hosts=[&apos;orderer.bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"生成orderer-msp\"><a href=\"#生成orderer-msp\" class=\"headerlink\" title=\"生成orderer msp\"></a>生成orderer msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"> mkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<h3 id=\"生成-tls-order直接从rootCA生成\"><a href=\"#生成-tls-order直接从rootCA生成\" class=\"headerlink\" title=\"生成 tls order直接从rootCA生成\"></a>生成 tls order直接从rootCA生成</h3><h3 id=\"登记-2\"><a href=\"#登记-2\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://orderer.bits.com:123456@localhost:7054 --csr.cn=orderer.bits.com --csr.hosts=[&apos;orderer.bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"生成-1\"><a href=\"#生成-1\" class=\"headerlink\" title=\"生成\"></a>生成</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"> cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/tlscacerts/tls-localhost-7054.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/ca.crt</div><div class=\"line\"> </div><div class=\"line\"> cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/server.crt</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/keystore/0a0e6c818a2ce9f1596e196f22389f2a55c0a83c5dd52dfa1612640ade8df870_sk ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/server.key</div></pre></td></tr></table></figure>\n<h3 id=\"peer0-org1-bits-com-配置\"><a href=\"#peer0-org1-bits-com-配置\" class=\"headerlink\" title=\"peer0.org1.bits.com 配置\"></a>peer0.org1.bits.com 配置</h3><h3 id=\"登记org1-bits-com\"><a href=\"#登记org1-bits-com\" class=\"headerlink\" title=\"登记org1.bits.com\"></a>登记org1.bits.com</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加msp-1\"><a href=\"#添加msp-1\" class=\"headerlink\" title=\"添加msp\"></a>添加msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"> fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"> fabric-ca-client affiliation add com -M ./ca-crypto-config/peebitsrOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div><div class=\"line\"> </div><div class=\"line\"> fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits.org1 -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"注册admin-1\"><a href=\"#注册admin-1\" class=\"headerlink\" title=\"注册admin\"></a>注册admin</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@org1.bits.com --id.type client --id.affiliation &quot;com.bits.org1&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"登记-3\"><a href=\"#登记-3\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://Admin@org1.bits.com:123456@localhost:7055 --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -Mbits ./ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"生成msp\"><a href=\"#生成msp\" class=\"headerlink\" title=\"生成msp\"></a>生成msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<h2 id=\"注册peer0-org1-bits-com\"><a href=\"#注册peer0-org1-bits-com\" class=\"headerlink\" title=\"注册peer0.org1.bits.com\"></a>注册peer0.org1.bits.com</h2><h3 id=\"注册-2\"><a href=\"#注册-2\" class=\"headerlink\" title=\"注册\"></a>注册</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name peer0.org1.bits.com --id.type peer --id.affiliation &quot;com.bits.org1&quot; --id.attrs &apos;&quot;role=peer&quot;,ecert=true&apos; --id.secret=123456 --csr.cn=peer0.org1.bits.com --csr.hosts=[&apos;peer0.org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"登记-4\"><a href=\"#登记-4\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://peer0.org1.bits.com:123456@localhost:7055 --csr.cn=peer0.org1.bits.com --csr.hosts=[&apos;peer0.org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"生成msp-1\"><a href=\"#生成msp-1\" class=\"headerlink\" title=\"生成msp\"></a>生成msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp/admincerts</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<h3 id=\"在tlsCa1-org2-bits-com上生成tls\"><a href=\"#在tlsCa1-org2-bits-com上生成tls\" class=\"headerlink\" title=\"在tlsCa1.org2.bits.com上生成tls\"></a>在tlsCa1.org2.bits.com上生成tls</h3><p>###登记<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div></pre></td></tr></table></figure></p>\n<h3 id=\"添加联盟成员\"><a href=\"#添加联盟成员\" class=\"headerlink\" title=\"添加联盟成员\"></a>添加联盟成员</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div><div class=\"line\"></div><div class=\"line\">fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits.org1 -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加admin\"><a href=\"#添加admin\" class=\"headerlink\" title=\"添加admin\"></a>添加admin</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@org1.bits.com --id.type client --id.affiliation &quot;com.bits.org1&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<p>###登记<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@org1.bits.com:123456@localhost:7056 --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure></p>\n<h3 id=\"添加tls\"><a href=\"#添加tls\" class=\"headerlink\" title=\"添加tls\"></a>添加tls</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/tlsintermediatecerts/tls-localhost-7056.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/ca.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/client.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/keystore/fb5f4402973df15c7ac37c8f6fc6182c1842be2b5a75c2015d6d6d2b0261a423_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/client.key</div></pre></td></tr></table></figure>\n<p>###生成peer0.org1.bits.com的msp</p>\n<h4 id=\"注册-3\"><a href=\"#注册-3\" class=\"headerlink\" title=\"注册\"></a>注册</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name peer0.org1.bits.com --id.type peer --id.affiliation &quot;com.bits.org1&quot; --id.attrs &apos;&quot;role=peer&quot;,ecert=true&apos; --id.secret=123456 --csr.cn=peer0.org1.bits.com --csr.hosts=[&apos;peer0.org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h4 id=\"登记-5\"><a href=\"#登记-5\" class=\"headerlink\" title=\"登记\"></a>登记</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://peer0.org1.bits.com:123456@localhost:7056 --csr.cn=peer0.org1.bits.com --csr.hosts=[&apos;peer0.org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h4 id=\"添加tls-1\"><a href=\"#添加tls-1\" class=\"headerlink\" title=\"添加tls\"></a>添加tls</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/tlsintermediatecerts/tls-localhost-7056.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/keystore/b240c32e626c0de53e1a7efdda64fd682b1a47a599926b11a7c8004c159ecd8d_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key</div></pre></td></tr></table></figure>\n<h3 id=\"在orgCa2-org2-bits-com上生成peer0-org2-bits-com\"><a href=\"#在orgCa2-org2-bits-com上生成peer0-org2-bits-com\" class=\"headerlink\" title=\"在orgCa2.org2.bits.com上生成peer0.org2.bits.com\"></a>在orgCa2.org2.bits.com上生成peer0.org2.bits.com</h3><h3 id=\"登记org2-bits-com\"><a href=\"#登记org2-bits-com\" class=\"headerlink\" title=\"登记org2.bits.com\"></a>登记org2.bits.com</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加联盟成员bits\"><a href=\"#添加联盟成员bits\" class=\"headerlink\" title=\"添加联盟成员bits\"></a>添加联盟成员bits</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div><div class=\"line\"></div><div class=\"line\">fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin3:adminpw2@localhost:7057 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits.org2 -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"注册admin-2\"><a href=\"#注册admin-2\" class=\"headerlink\" title=\"注册admin\"></a>注册admin</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@org2.bits.com --id.type client --id.affiliation &quot;com.bits.org2&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"登记-6\"><a href=\"#登记-6\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://Admin@org2.bits.com:123456@localhost:7057 --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加msp-2\"><a href=\"#添加msp-2\" class=\"headerlink\" title=\"添加msp\"></a>添加msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/admincerts</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/admincerts</div><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/msp/admincerts</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<h3 id=\"生成peer0-org2-bits-com的msp\"><a href=\"#生成peer0-org2-bits-com的msp\" class=\"headerlink\" title=\"生成peer0.org2.bits.com的msp\"></a>生成peer0.org2.bits.com的msp</h3><h3 id=\"注册bits\"><a href=\"#注册bits\" class=\"headerlink\" title=\"注册bits\"></a>注册bits</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name peer0.org2.bits.com --id.type peer --id.affiliation &quot;com.bits.org2&quot; --id.attrs &apos;&quot;role=peer&quot;,ecert=true&apos; --id.secret=123456 --csr.cn=peer0.org2.bits.com --csr.hosts=[&apos;peer0.org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"登记-7\"><a href=\"#登记-7\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://peer0.org2.bits.com:123456@localhost:7057 --csr.cn=peer0.org2.bits.com --csr.hosts=[&apos;peer0.org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加msp-3\"><a href=\"#添加msp-3\" class=\"headerlink\" title=\"添加msp\"></a>添加msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp/admincerts</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<h2 id=\"在tlsca2-org2-bits-com上生成peer0-org2-bits-com的tls证书\"><a href=\"#在tlsca2-org2-bits-com上生成peer0-org2-bits-com的tls证书\" class=\"headerlink\" title=\"在tlsca2.org2.bits.com上生成peer0.org2.bits.com的tls证书\"></a>在tlsca2.org2.bits.com上生成peer0.org2.bits.com的tls证书</h2><h3 id=\"生成org2-bits-com的msp\"><a href=\"#生成org2-bits-com的msp\" class=\"headerlink\" title=\"生成org2.bits.com的msp\"></a>生成org2.bits.com的msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加联盟成员-1\"><a href=\"#添加联盟成员-1\" class=\"headerlink\" title=\"添加联盟成员\"></a>添加联盟成员</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div><div class=\"line\"></div><div class=\"line\">fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits.org2 -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"生成Admin-bits-com的msp\"><a href=\"#生成Admin-bits-com的msp\" class=\"headerlink\" title=\"生成Admin@bits.com的msp\"></a>生成Admin@bits.com的msp</h3><p>####注册bits<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@org2.bits.com --id.type client --id.affiliation &quot;com.bits.org2&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div></pre></td></tr></table></figure></p>\n<h4 id=\"登记-8\"><a href=\"#登记-8\" class=\"headerlink\" title=\"登记\"></a>登记</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@org2.bits.com:123456@localhost:7058 --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加tls-2\"><a href=\"#添加tls-2\" class=\"headerlink\" title=\"添加tls\"></a>添加tls</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/tlsintermediatecerts/tls-localhost-7058.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/ca.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/client.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/keystore/6872abd57f40265c11e1f7c6630de995a732a75a41667928f4ba6540bb0ee429_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/client.key</div></pre></td></tr></table></figure>\n<p>###生成peer0.org2.bits.com的tls</p>\n<h3 id=\"注册-4\"><a href=\"#注册-4\" class=\"headerlink\" title=\"注册\"></a>注册</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name peer0.org2.bits.com --id.type peer --id.affiliation &quot;com.bits.org2&quot; --id.attrs &apos;&quot;role=peer&quot;,ecert=true&apos; --id.secret=123456 --csr.cn=peer0.org2.bits.com --csr.hosts=[&apos;peer0.org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"登记-9\"><a href=\"#登记-9\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://peer0.org2.bits.com:123456@localhost:7058 --csr.cn=peer0.org2.bits.com --csr.hosts=[&apos;peer0.org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加\"><a href=\"#添加\" class=\"headerlink\" title=\"添加\"></a>添加</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/tlsintermediatecerts/tls-localhost-7058.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt</div><div class=\"line\"> cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt</div><div class=\"line\"> cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/keystore/19cc5473626ac32223df84ec1b05f5f2a98dc507c1325494ac3e7f5751118cdd_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"机器准备\"><a href=\"#机器准备\" class=\"headerlink\" title=\"机器准备\"></a>机器准备</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">功能</th>\n<th style=\"text-align:center\">ip</th>\n<th style=\"text-align:right\">机器名称</th>\n<th style=\"text-align:right\">端口</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">rootCa</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">rootCa.org2.bits.com</td>\n<td style=\"text-align:right\">7054</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">orgCa1</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">orgCa1.org2.bits.com</td>\n<td style=\"text-align:right\">7055</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">tlsCa1</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">tlsCa1.org2.bits.com</td>\n<td style=\"text-align:right\">7056</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">orgCa2</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">orgCa2.org2.bits.com</td>\n<td style=\"text-align:right\">7057</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">tlsca2</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">tlsca2.org2.bits.com</td>\n<td style=\"text-align:right\">7058</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"初始化CA\"><a href=\"#初始化CA\" class=\"headerlink\" title=\"初始化CA\"></a>初始化CA</h2><h3 id=\"初始化ROOT\"><a href=\"#初始化ROOT\" class=\"headerlink\" title=\"初始化ROOT\"></a>初始化ROOT</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-server init -b admin:adminpw --home ./rootca</div></pre></td></tr></table></figure>\n<h3 id=\"初始化org1ca\"><a href=\"#初始化org1ca\" class=\"headerlink\" title=\"初始化org1ca\"></a>初始化org1ca</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-server init -b admin1:adminpw1 -u http://admin:adminpw@localhost:7054 --home ./org1ca</div></pre></td></tr></table></figure>\n<h3 id=\"初始化org1tlsca\"><a href=\"#初始化org1tlsca\" class=\"headerlink\" title=\"初始化org1tlsca\"></a>初始化org1tlsca</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-server init -b admin1:adminpw1 -u http://admin:adminpw@localhost:7054 --home ./org1tlsca</div></pre></td></tr></table></figure>\n<h3 id=\"初始化org2ca\"><a href=\"#初始化org2ca\" class=\"headerlink\" title=\"初始化org2ca\"></a>初始化org2ca</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-server init -b admin2:adminpw2 -u http://admin:adminpw@localhost:7054 --home ./org2ca</div></pre></td></tr></table></figure>\n<h3 id=\"初始化org2tlsca\"><a href=\"#初始化org2tlsca\" class=\"headerlink\" title=\"初始化org2tlsca\"></a>初始化org2tlsca</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-server init -b admin2:adminpw2 -u http://admin:adminpw@localhost:7054 --home ./org2tlsca</div></pre></td></tr></table></figure>\n<h2 id=\"从rootCA-注册-order-bits-com\"><a href=\"#从rootCA-注册-order-bits-com\" class=\"headerlink\" title=\"从rootCA 注册 order  bits.com\"></a>从rootCA 注册 order  bits.com</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 注册并生成MSP证书</div><div class=\"line\">fabric-ca-client enroll -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div><div class=\"line\">#查看已存在的成员</div><div class=\"line\">fabric-ca-client affiliation list -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加联盟\"><a href=\"#添加联盟\" class=\"headerlink\" title=\"添加联盟\"></a>添加联盟</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client affiliation add com -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div><div class=\"line\"></div><div class=\"line\">fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"注册admin\"><a href=\"#注册admin\" class=\"headerlink\" title=\"注册admin\"></a>注册admin</h3><h4 id=\"注册\"><a href=\"#注册\" class=\"headerlink\" title=\"注册\"></a>注册</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@bits.com --id.type client --id.affiliation &quot;com.bits&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=bits.com --csr.hosts=[&apos;bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h4 id=\"登记\"><a href=\"#登记\" class=\"headerlink\" title=\"登记\"></a>登记</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://Admin@bits.com:123456@localhost:7054 --csr.cn=bits.com --csr.hosts=[&apos;bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h4 id=\"添加msp\"><a href=\"#添加msp\" class=\"headerlink\" title=\"添加msp\"></a>添加msp</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<p>###生成bits.com的tls</p>\n<p>####注册<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@bits.com --id.type client --id.affiliation &quot;com.bits&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=bits.com --csr.hosts=[&apos;bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/tls -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure></p>\n<h4 id=\"登记-1\"><a href=\"#登记-1\" class=\"headerlink\" title=\"登记\"></a>登记</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -M ./ca-crypto-config/ordererOrganizations/bits.com/tls -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"admin生成tls\"><a href=\"#admin生成tls\" class=\"headerlink\" title=\"admin生成tls\"></a>admin生成tls</h3><p>####登记<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@bits.com:123456@localhost:7054 --csr.cn=bits.com --csr.hosts=[&apos;bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure></p>\n<h4 id=\"生成\"><a href=\"#生成\" class=\"headerlink\" title=\"生成\"></a>生成</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/tlscacerts/tls-localhost-7054.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/ca.crt</div><div class=\"line\"></div><div class=\"line\"> cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/client.crt</div><div class=\"line\"> </div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/keystore/bbd7674ee2722ed168bb5d5f0643d1f4f2b0fa5fc6cf951363fb15cb88e378f0_sk ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/tls/client.key</div></pre></td></tr></table></figure>\n<h3 id=\"生成orderer-bits-com\"><a href=\"#生成orderer-bits-com\" class=\"headerlink\" title=\"生成orderer.bits.com\"></a>生成orderer.bits.com</h3><h3 id=\"注册-1\"><a href=\"#注册-1\" class=\"headerlink\" title=\"注册\"></a>注册</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name orderer.bits.com --id.type orderer --id.affiliation &quot;com.bits&quot; --id.attrs &apos;&quot;role=orderer&quot;,ecert=true&apos; --id.secret=123456 --csr.cn=orderer.bits.com --csr.hosts=[&apos;orderer.bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/msp -u http://admin:adminpw@localhost:7054 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<p>###登记orderer</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://orderer.bits.com:123456@localhost:7054 --csr.cn=orderer.bits.com --csr.hosts=[&apos;orderer.bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"生成orderer-msp\"><a href=\"#生成orderer-msp\" class=\"headerlink\" title=\"生成orderer msp\"></a>生成orderer msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"> mkdir ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/users/Admin@bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<h3 id=\"生成-tls-order直接从rootCA生成\"><a href=\"#生成-tls-order直接从rootCA生成\" class=\"headerlink\" title=\"生成 tls order直接从rootCA生成\"></a>生成 tls order直接从rootCA生成</h3><h3 id=\"登记-2\"><a href=\"#登记-2\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://orderer.bits.com:123456@localhost:7054 --csr.cn=orderer.bits.com --csr.hosts=[&apos;orderer.bits.com&apos;] -M ./ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"生成-1\"><a href=\"#生成-1\" class=\"headerlink\" title=\"生成\"></a>生成</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"> cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/tlscacerts/tls-localhost-7054.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/ca.crt</div><div class=\"line\"> </div><div class=\"line\"> cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/server.crt</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/keystore/0a0e6c818a2ce9f1596e196f22389f2a55c0a83c5dd52dfa1612640ade8df870_sk ./fabric-ca-client/ca-crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/server.key</div></pre></td></tr></table></figure>\n<h3 id=\"peer0-org1-bits-com-配置\"><a href=\"#peer0-org1-bits-com-配置\" class=\"headerlink\" title=\"peer0.org1.bits.com 配置\"></a>peer0.org1.bits.com 配置</h3><h3 id=\"登记org1-bits-com\"><a href=\"#登记org1-bits-com\" class=\"headerlink\" title=\"登记org1.bits.com\"></a>登记org1.bits.com</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加msp-1\"><a href=\"#添加msp-1\" class=\"headerlink\" title=\"添加msp\"></a>添加msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"> fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div><div class=\"line\"> </div><div class=\"line\"> </div><div class=\"line\"> fabric-ca-client affiliation add com -M ./ca-crypto-config/peebitsrOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div><div class=\"line\"> </div><div class=\"line\"> fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits.org1 -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"注册admin-1\"><a href=\"#注册admin-1\" class=\"headerlink\" title=\"注册admin\"></a>注册admin</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@org1.bits.com --id.type client --id.affiliation &quot;com.bits.org1&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"登记-3\"><a href=\"#登记-3\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://Admin@org1.bits.com:123456@localhost:7055 --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -Mbits ./ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"生成msp\"><a href=\"#生成msp\" class=\"headerlink\" title=\"生成msp\"></a>生成msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/msp/admincerts</div><div class=\"line\"></div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<h2 id=\"注册peer0-org1-bits-com\"><a href=\"#注册peer0-org1-bits-com\" class=\"headerlink\" title=\"注册peer0.org1.bits.com\"></a>注册peer0.org1.bits.com</h2><h3 id=\"注册-2\"><a href=\"#注册-2\" class=\"headerlink\" title=\"注册\"></a>注册</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name peer0.org1.bits.com --id.type peer --id.affiliation &quot;com.bits.org1&quot; --id.attrs &apos;&quot;role=peer&quot;,ecert=true&apos; --id.secret=123456 --csr.cn=peer0.org1.bits.com --csr.hosts=[&apos;peer0.org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/msp -u http://admin1:adminpw1@localhost:7055 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"登记-4\"><a href=\"#登记-4\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://peer0.org1.bits.com:123456@localhost:7055 --csr.cn=peer0.org1.bits.com --csr.hosts=[&apos;peer0.org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"生成msp-1\"><a href=\"#生成msp-1\" class=\"headerlink\" title=\"生成msp\"></a>生成msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp/admincerts</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<h3 id=\"在tlsCa1-org2-bits-com上生成tls\"><a href=\"#在tlsCa1-org2-bits-com上生成tls\" class=\"headerlink\" title=\"在tlsCa1.org2.bits.com上生成tls\"></a>在tlsCa1.org2.bits.com上生成tls</h3><p>###登记<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div></pre></td></tr></table></figure></p>\n<h3 id=\"添加联盟成员\"><a href=\"#添加联盟成员\" class=\"headerlink\" title=\"添加联盟成员\"></a>添加联盟成员</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div><div class=\"line\"></div><div class=\"line\">fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits.org1 -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加admin\"><a href=\"#添加admin\" class=\"headerlink\" title=\"添加admin\"></a>添加admin</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@org1.bits.com --id.type client --id.affiliation &quot;com.bits.org1&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<p>###登记<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@org1.bits.com:123456@localhost:7056 --csr.cn=org1.bits.com --csr.hosts=[&apos;org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure></p>\n<h3 id=\"添加tls\"><a href=\"#添加tls\" class=\"headerlink\" title=\"添加tls\"></a>添加tls</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/tlsintermediatecerts/tls-localhost-7056.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/ca.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/client.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/keystore/fb5f4402973df15c7ac37c8f6fc6182c1842be2b5a75c2015d6d6d2b0261a423_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/tls/client.key</div></pre></td></tr></table></figure>\n<p>###生成peer0.org1.bits.com的msp</p>\n<h4 id=\"注册-3\"><a href=\"#注册-3\" class=\"headerlink\" title=\"注册\"></a>注册</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name peer0.org1.bits.com --id.type peer --id.affiliation &quot;com.bits.org1&quot; --id.attrs &apos;&quot;role=peer&quot;,ecert=true&apos; --id.secret=123456 --csr.cn=peer0.org1.bits.com --csr.hosts=[&apos;peer0.org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/tls -u http://admin1:adminpw1@localhost:7056 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h4 id=\"登记-5\"><a href=\"#登记-5\" class=\"headerlink\" title=\"登记\"></a>登记</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://peer0.org1.bits.com:123456@localhost:7056 --csr.cn=peer0.org1.bits.com --csr.hosts=[&apos;peer0.org1.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h4 id=\"添加tls-1\"><a href=\"#添加tls-1\" class=\"headerlink\" title=\"添加tls\"></a>添加tls</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/tlsintermediatecerts/tls-localhost-7056.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/keystore/b240c32e626c0de53e1a7efdda64fd682b1a47a599926b11a7c8004c159ecd8d_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key</div></pre></td></tr></table></figure>\n<h3 id=\"在orgCa2-org2-bits-com上生成peer0-org2-bits-com\"><a href=\"#在orgCa2-org2-bits-com上生成peer0-org2-bits-com\" class=\"headerlink\" title=\"在orgCa2.org2.bits.com上生成peer0.org2.bits.com\"></a>在orgCa2.org2.bits.com上生成peer0.org2.bits.com</h3><h3 id=\"登记org2-bits-com\"><a href=\"#登记org2-bits-com\" class=\"headerlink\" title=\"登记org2.bits.com\"></a>登记org2.bits.com</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加联盟成员bits\"><a href=\"#添加联盟成员bits\" class=\"headerlink\" title=\"添加联盟成员bits\"></a>添加联盟成员bits</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div><div class=\"line\"></div><div class=\"line\">fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin3:adminpw2@localhost:7057 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits.org2 -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"注册admin-2\"><a href=\"#注册admin-2\" class=\"headerlink\" title=\"注册admin\"></a>注册admin</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@org2.bits.com --id.type client --id.affiliation &quot;com.bits.org2&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"登记-6\"><a href=\"#登记-6\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://Admin@org2.bits.com:123456@localhost:7057 --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加msp-2\"><a href=\"#添加msp-2\" class=\"headerlink\" title=\"添加msp\"></a>添加msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/admincerts</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/admincerts</div><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/msp/admincerts</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<h3 id=\"生成peer0-org2-bits-com的msp\"><a href=\"#生成peer0-org2-bits-com的msp\" class=\"headerlink\" title=\"生成peer0.org2.bits.com的msp\"></a>生成peer0.org2.bits.com的msp</h3><h3 id=\"注册bits\"><a href=\"#注册bits\" class=\"headerlink\" title=\"注册bits\"></a>注册bits</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name peer0.org2.bits.com --id.type peer --id.affiliation &quot;com.bits.org2&quot; --id.attrs &apos;&quot;role=peer&quot;,ecert=true&apos; --id.secret=123456 --csr.cn=peer0.org2.bits.com --csr.hosts=[&apos;peer0.org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/msp -u http://admin2:adminpw2@localhost:7057 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"登记-7\"><a href=\"#登记-7\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -u http://peer0.org2.bits.com:123456@localhost:7057 --csr.cn=peer0.org2.bits.com --csr.hosts=[&apos;peer0.org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加msp-3\"><a href=\"#添加msp-3\" class=\"headerlink\" title=\"添加msp\"></a>添加msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp/admincerts</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp/admincerts</div></pre></td></tr></table></figure>\n<h2 id=\"在tlsca2-org2-bits-com上生成peer0-org2-bits-com的tls证书\"><a href=\"#在tlsca2-org2-bits-com上生成peer0-org2-bits-com的tls证书\" class=\"headerlink\" title=\"在tlsca2.org2.bits.com上生成peer0.org2.bits.com的tls证书\"></a>在tlsca2.org2.bits.com上生成peer0.org2.bits.com的tls证书</h2><h3 id=\"生成org2-bits-com的msp\"><a href=\"#生成org2-bits-com的msp\" class=\"headerlink\" title=\"生成org2.bits.com的msp\"></a>生成org2.bits.com的msp</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加联盟成员-1\"><a href=\"#添加联盟成员-1\" class=\"headerlink\" title=\"添加联盟成员\"></a>添加联盟成员</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client affiliation list -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div><div class=\"line\"></div><div class=\"line\">fabric-ca-client affiliation add com -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div><div class=\"line\">fabric-ca-client affiliation add com.bits.org2 -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"生成Admin-bits-com的msp\"><a href=\"#生成Admin-bits-com的msp\" class=\"headerlink\" title=\"生成Admin@bits.com的msp\"></a>生成Admin@bits.com的msp</h3><p>####注册bits<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name Admin@org2.bits.com --id.type client --id.affiliation &quot;com.bits.org2&quot; --id.attrs &apos;&quot;hf.Registrar.Roles=client,orderer,peer,user&quot;,&quot;hf.Registrar.DelegateRoles=client,orderer,peer,user&quot;,hf.Registrar.Attributes=*,hf.GenCRL=true,hf.Revoker=true,hf.AffiliationMgr=true,hf.IntermediateCA=true,role=admin:ecert&apos; --id.secret=123456 --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div></pre></td></tr></table></figure></p>\n<h4 id=\"登记-8\"><a href=\"#登记-8\" class=\"headerlink\" title=\"登记\"></a>登记</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://Admin@org2.bits.com:123456@localhost:7058 --csr.cn=org2.bits.com --csr.hosts=[&apos;org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加tls-2\"><a href=\"#添加tls-2\" class=\"headerlink\" title=\"添加tls\"></a>添加tls</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/tlsintermediatecerts/tls-localhost-7058.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/ca.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/client.crt</div><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/keystore/6872abd57f40265c11e1f7c6630de995a732a75a41667928f4ba6540bb0ee429_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/tls/client.key</div></pre></td></tr></table></figure>\n<p>###生成peer0.org2.bits.com的tls</p>\n<h3 id=\"注册-4\"><a href=\"#注册-4\" class=\"headerlink\" title=\"注册\"></a>注册</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client register --id.name peer0.org2.bits.com --id.type peer --id.affiliation &quot;com.bits.org2&quot; --id.attrs &apos;&quot;role=peer&quot;,ecert=true&apos; --id.secret=123456 --csr.cn=peer0.org2.bits.com --csr.hosts=[&apos;peer0.org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/tls -u http://admin2:adminpw2@localhost:7058 --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"登记-9\"><a href=\"#登记-9\" class=\"headerlink\" title=\"登记\"></a>登记</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">fabric-ca-client enroll -d --enrollment.profile tls -u http://peer0.org2.bits.com:123456@localhost:7058 --csr.cn=peer0.org2.bits.com --csr.hosts=[&apos;peer0.org2.bits.com&apos;] -M ./ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls --home ./fabric-ca-client</div></pre></td></tr></table></figure>\n<h3 id=\"添加\"><a href=\"#添加\" class=\"headerlink\" title=\"添加\"></a>添加</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/tlsintermediatecerts/tls-localhost-7058.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt</div><div class=\"line\"> cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/signcerts/cert.pem ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt</div><div class=\"line\"> cp ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/keystore/19cc5473626ac32223df84ec1b05f5f2a98dc507c1325494ac3e7f5751118cdd_sk ./fabric-ca-client/ca-crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key</div></pre></td></tr></table></figure>\n"},{"title":"centos6.5 安装python 2.7","date":"2018-06-27T02:57:23.000Z","_content":"## 安装依赖环境\n\n```\nyum groupinstall \"Development tools\"\nyum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel\n\n```\n\n## 下载安装Python2.7\n```\n\nwget https://www.python.org/ftp/python/2.7.11/Python-2.7.11.tgz\ntar vxf Python-2.7.11.tgz\ncd Python-2.7.11\n./configure --prefix=/usr/local\nmake && make install\n\n\n```\n\n## 设置系统默认的环境为python2.7\n\n```\nmv /usr/bin/python /usr/bin/python2.6.6 \nln -s /usr/local/bin/python2.7 /usr/bin/python\n\n```\n## 修改 /usr/bin/yum  yum文件头部信息\n```\n#!/usr/bin/python\n改成\n#!/usr/bin/python2.6.6\n\n```\n\n## 安装setup\n```\nwget https://pypi.python.org/packages/ff/d4/209f4939c49e31f5524fa0027bf1c8ec3107abaf7c61fdaad704a648c281/setuptools-21.0.0.tar.gz#md5=81964fdb89534118707742e6d1a1ddb4\n\ntar vxf setuptools-21.0.0.tar.gz \ncd setuptools-21.0.0\npython setup.py  install\n\n```\n\n## 安装pip\n```\nwget https://pypi.python.org/packages/41/27/9a8d24e1b55bd8c85e4d022da2922cb206f183e2d18fee4e320c9547e751/pip-8.1.1.tar.gz#md5=6b86f11841e89c8241d689956ba99ed7\n\ntar vxf pip-8.1.1.tar.gz \ncd pip-8.1.1\npython setup.py install\n\n```\n\n","source":"_posts/centos6.5安装python2.7.md","raw":"---\ntitle: centos6.5 安装python 2.7\ndate: 2018-06-27 10:57:23\ncategories: \n\t- centos6.5\n\t- python\ntags:\n\t- python\n---\n## 安装依赖环境\n\n```\nyum groupinstall \"Development tools\"\nyum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel\n\n```\n\n## 下载安装Python2.7\n```\n\nwget https://www.python.org/ftp/python/2.7.11/Python-2.7.11.tgz\ntar vxf Python-2.7.11.tgz\ncd Python-2.7.11\n./configure --prefix=/usr/local\nmake && make install\n\n\n```\n\n## 设置系统默认的环境为python2.7\n\n```\nmv /usr/bin/python /usr/bin/python2.6.6 \nln -s /usr/local/bin/python2.7 /usr/bin/python\n\n```\n## 修改 /usr/bin/yum  yum文件头部信息\n```\n#!/usr/bin/python\n改成\n#!/usr/bin/python2.6.6\n\n```\n\n## 安装setup\n```\nwget https://pypi.python.org/packages/ff/d4/209f4939c49e31f5524fa0027bf1c8ec3107abaf7c61fdaad704a648c281/setuptools-21.0.0.tar.gz#md5=81964fdb89534118707742e6d1a1ddb4\n\ntar vxf setuptools-21.0.0.tar.gz \ncd setuptools-21.0.0\npython setup.py  install\n\n```\n\n## 安装pip\n```\nwget https://pypi.python.org/packages/41/27/9a8d24e1b55bd8c85e4d022da2922cb206f183e2d18fee4e320c9547e751/pip-8.1.1.tar.gz#md5=6b86f11841e89c8241d689956ba99ed7\n\ntar vxf pip-8.1.1.tar.gz \ncd pip-8.1.1\npython setup.py install\n\n```\n\n","slug":"centos6.5安装python2.7","published":1,"updated":"2018-12-14T08:15:55.013Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exm00091fih4qgacqse","content":"<h2 id=\"安装依赖环境\"><a href=\"#安装依赖环境\" class=\"headerlink\" title=\"安装依赖环境\"></a>安装依赖环境</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum groupinstall &quot;Development tools&quot;</div><div class=\"line\">yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel</div></pre></td></tr></table></figure>\n<h2 id=\"下载安装Python2-7\"><a href=\"#下载安装Python2-7\" class=\"headerlink\" title=\"下载安装Python2.7\"></a>下载安装Python2.7</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">wget https://www.python.org/ftp/python/2.7.11/Python-2.7.11.tgz</div><div class=\"line\">tar vxf Python-2.7.11.tgz</div><div class=\"line\">cd Python-2.7.11</div><div class=\"line\">./configure --prefix=/usr/local</div><div class=\"line\">make &amp;&amp; make install</div></pre></td></tr></table></figure>\n<h2 id=\"设置系统默认的环境为python2-7\"><a href=\"#设置系统默认的环境为python2-7\" class=\"headerlink\" title=\"设置系统默认的环境为python2.7\"></a>设置系统默认的环境为python2.7</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mv /usr/bin/python /usr/bin/python2.6.6 </div><div class=\"line\">ln -s /usr/local/bin/python2.7 /usr/bin/python</div></pre></td></tr></table></figure>\n<h2 id=\"修改-usr-bin-yum-yum文件头部信息\"><a href=\"#修改-usr-bin-yum-yum文件头部信息\" class=\"headerlink\" title=\"修改 /usr/bin/yum  yum文件头部信息\"></a>修改 /usr/bin/yum  yum文件头部信息</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/usr/bin/python</div><div class=\"line\">改成</div><div class=\"line\">#!/usr/bin/python2.6.6</div></pre></td></tr></table></figure>\n<h2 id=\"安装setup\"><a href=\"#安装setup\" class=\"headerlink\" title=\"安装setup\"></a>安装setup</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget https://pypi.python.org/packages/ff/d4/209f4939c49e31f5524fa0027bf1c8ec3107abaf7c61fdaad704a648c281/setuptools-21.0.0.tar.gz#md5=81964fdb89534118707742e6d1a1ddb4</div><div class=\"line\"></div><div class=\"line\">tar vxf setuptools-21.0.0.tar.gz </div><div class=\"line\">cd setuptools-21.0.0</div><div class=\"line\">python setup.py  install</div></pre></td></tr></table></figure>\n<h2 id=\"安装pip\"><a href=\"#安装pip\" class=\"headerlink\" title=\"安装pip\"></a>安装pip</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget https://pypi.python.org/packages/41/27/9a8d24e1b55bd8c85e4d022da2922cb206f183e2d18fee4e320c9547e751/pip-8.1.1.tar.gz#md5=6b86f11841e89c8241d689956ba99ed7</div><div class=\"line\"></div><div class=\"line\">tar vxf pip-8.1.1.tar.gz </div><div class=\"line\">cd pip-8.1.1</div><div class=\"line\">python setup.py install</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"安装依赖环境\"><a href=\"#安装依赖环境\" class=\"headerlink\" title=\"安装依赖环境\"></a>安装依赖环境</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum groupinstall &quot;Development tools&quot;</div><div class=\"line\">yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel</div></pre></td></tr></table></figure>\n<h2 id=\"下载安装Python2-7\"><a href=\"#下载安装Python2-7\" class=\"headerlink\" title=\"下载安装Python2.7\"></a>下载安装Python2.7</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">wget https://www.python.org/ftp/python/2.7.11/Python-2.7.11.tgz</div><div class=\"line\">tar vxf Python-2.7.11.tgz</div><div class=\"line\">cd Python-2.7.11</div><div class=\"line\">./configure --prefix=/usr/local</div><div class=\"line\">make &amp;&amp; make install</div></pre></td></tr></table></figure>\n<h2 id=\"设置系统默认的环境为python2-7\"><a href=\"#设置系统默认的环境为python2-7\" class=\"headerlink\" title=\"设置系统默认的环境为python2.7\"></a>设置系统默认的环境为python2.7</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mv /usr/bin/python /usr/bin/python2.6.6 </div><div class=\"line\">ln -s /usr/local/bin/python2.7 /usr/bin/python</div></pre></td></tr></table></figure>\n<h2 id=\"修改-usr-bin-yum-yum文件头部信息\"><a href=\"#修改-usr-bin-yum-yum文件头部信息\" class=\"headerlink\" title=\"修改 /usr/bin/yum  yum文件头部信息\"></a>修改 /usr/bin/yum  yum文件头部信息</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/usr/bin/python</div><div class=\"line\">改成</div><div class=\"line\">#!/usr/bin/python2.6.6</div></pre></td></tr></table></figure>\n<h2 id=\"安装setup\"><a href=\"#安装setup\" class=\"headerlink\" title=\"安装setup\"></a>安装setup</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget https://pypi.python.org/packages/ff/d4/209f4939c49e31f5524fa0027bf1c8ec3107abaf7c61fdaad704a648c281/setuptools-21.0.0.tar.gz#md5=81964fdb89534118707742e6d1a1ddb4</div><div class=\"line\"></div><div class=\"line\">tar vxf setuptools-21.0.0.tar.gz </div><div class=\"line\">cd setuptools-21.0.0</div><div class=\"line\">python setup.py  install</div></pre></td></tr></table></figure>\n<h2 id=\"安装pip\"><a href=\"#安装pip\" class=\"headerlink\" title=\"安装pip\"></a>安装pip</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget https://pypi.python.org/packages/41/27/9a8d24e1b55bd8c85e4d022da2922cb206f183e2d18fee4e320c9547e751/pip-8.1.1.tar.gz#md5=6b86f11841e89c8241d689956ba99ed7</div><div class=\"line\"></div><div class=\"line\">tar vxf pip-8.1.1.tar.gz </div><div class=\"line\">cd pip-8.1.1</div><div class=\"line\">python setup.py install</div></pre></td></tr></table></figure>\n"},{"title":"gitlab 维护命令","date":"2018-06-13T05:39:23.000Z","_content":"\n\n### 不用gitlab自带的nginx\n```\nvim /etc/gitlab/gitlab.rb\nnginx['enable'] = false\n```\n\n### 设置服务端口域名\n\n```\nexternal_url 'http://xxx.com'\nunicorn['port'] = 8800\n\n```\n\n### 更改配置文件后，重新设置生效\n```\ngitlab-ctl reconfigure\n\n```\n\n### 启动，重启，停止,查看状态，查看日志,查看某组件日志\n```\ngitlab-ctl start\ngitlab-ctl restart\ngitlab-ctl stop\ngitlab-ctl stop\ngitlab-ctl tail \ngitlab-ctl tail  unicorn\n```\n### gitlab无法push或clone的错误:JWT::DecodeError (Nil JSON web token): lib/gitlab/workhorse.rb:120:in `verify_\n\n问题出在反代的配置上:nginx或者apache的反代应该反代到 http://gitlab-workhorse; 而不应该反代到http://127.0.0.1:8080\n\n修改\n\n```\nvim /etc/nginx/nginx.conf  \n\nuser git;\n```\n添加gitlab配置\n\n```\nvim /etc/nginx/conf.d/gitlab.conf\n\nupstream gitlab-workhorse {\n  server unix:/var/opt/gitlab/gitlab-workhorse/socket;\n}\n# HTTPS server\n\n        #proxy_cache_path  /data/nginx/cache  levels=1:2    keys_zone=STATIC:10 inactive=24h  max_size=1g;\nserver {\n        listen       80  default_server;\n        #server_name  git.okycz.com;\n        #ssl                  on;\n        #ssl_certificate\n        #ssl_certificate_key\n\n        #ssl_session_cache    shared:SSL:1m;\n        #ssl_session_timeout  5m;\n\n        #ssl_ciphers  HIGH:!aNULL:!MD5;\n        #ssl_prefer_server_ciphers  on;\n\n        proxy_read_timeout 1800;\n        proxy_send_timeout 1800;\n        #proxy_connect_timeout 600;\n        #send_timeout  600;\n        #keepalive_timeout 600s;\n\n        location / {\n            proxy_pass http://gitlab-workhorse/;\n            proxy_set_header Host $host:$server_port;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header Via \"nginx\";\n            #proxy_cache STATIC;\n            #proxy_cache_valid  200 1d;\n            #proxy_cache_use_stale  error timeout invalid_header updating http_500 http_502 http_503 http_504;\n        }\n\n        location ~ ^/(assets)/ {\n                root /opt/gitlab/embedded/service/gitlab-rails/public;\n                gzip_static on; # to serve pre-gzipped version\n                expires max;\n                add_header Cache-Control public;\n         }\n\n        #rewrite ^(.*)$  https://$host$1 permanent;\n}\n\n```\n\n\n### webide异常\n```\nI made it work behind a nginx reverse proxy by adding $request_uri to the proxy_pass:\n\nproxy_pass http://my-gitlab:5555/$request_uri;\n```","source":"_posts/gitlab维护命令.md","raw":"---\ntitle: gitlab 维护命令\ndate: 2018-06-13 13:39:23\ncategories: \n\t- gitlab\ntags:\n\t- linux\n\t- centos6.5\n\t- gitlab\n\t- git\n---\n\n\n### 不用gitlab自带的nginx\n```\nvim /etc/gitlab/gitlab.rb\nnginx['enable'] = false\n```\n\n### 设置服务端口域名\n\n```\nexternal_url 'http://xxx.com'\nunicorn['port'] = 8800\n\n```\n\n### 更改配置文件后，重新设置生效\n```\ngitlab-ctl reconfigure\n\n```\n\n### 启动，重启，停止,查看状态，查看日志,查看某组件日志\n```\ngitlab-ctl start\ngitlab-ctl restart\ngitlab-ctl stop\ngitlab-ctl stop\ngitlab-ctl tail \ngitlab-ctl tail  unicorn\n```\n### gitlab无法push或clone的错误:JWT::DecodeError (Nil JSON web token): lib/gitlab/workhorse.rb:120:in `verify_\n\n问题出在反代的配置上:nginx或者apache的反代应该反代到 http://gitlab-workhorse; 而不应该反代到http://127.0.0.1:8080\n\n修改\n\n```\nvim /etc/nginx/nginx.conf  \n\nuser git;\n```\n添加gitlab配置\n\n```\nvim /etc/nginx/conf.d/gitlab.conf\n\nupstream gitlab-workhorse {\n  server unix:/var/opt/gitlab/gitlab-workhorse/socket;\n}\n# HTTPS server\n\n        #proxy_cache_path  /data/nginx/cache  levels=1:2    keys_zone=STATIC:10 inactive=24h  max_size=1g;\nserver {\n        listen       80  default_server;\n        #server_name  git.okycz.com;\n        #ssl                  on;\n        #ssl_certificate\n        #ssl_certificate_key\n\n        #ssl_session_cache    shared:SSL:1m;\n        #ssl_session_timeout  5m;\n\n        #ssl_ciphers  HIGH:!aNULL:!MD5;\n        #ssl_prefer_server_ciphers  on;\n\n        proxy_read_timeout 1800;\n        proxy_send_timeout 1800;\n        #proxy_connect_timeout 600;\n        #send_timeout  600;\n        #keepalive_timeout 600s;\n\n        location / {\n            proxy_pass http://gitlab-workhorse/;\n            proxy_set_header Host $host:$server_port;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header Via \"nginx\";\n            #proxy_cache STATIC;\n            #proxy_cache_valid  200 1d;\n            #proxy_cache_use_stale  error timeout invalid_header updating http_500 http_502 http_503 http_504;\n        }\n\n        location ~ ^/(assets)/ {\n                root /opt/gitlab/embedded/service/gitlab-rails/public;\n                gzip_static on; # to serve pre-gzipped version\n                expires max;\n                add_header Cache-Control public;\n         }\n\n        #rewrite ^(.*)$  https://$host$1 permanent;\n}\n\n```\n\n\n### webide异常\n```\nI made it work behind a nginx reverse proxy by adding $request_uri to the proxy_pass:\n\nproxy_pass http://my-gitlab:5555/$request_uri;\n```","slug":"gitlab维护命令","published":1,"updated":"2019-01-08T04:59:07.201Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exq000d1fihamp1vkex","content":"<h3 id=\"不用gitlab自带的nginx\"><a href=\"#不用gitlab自带的nginx\" class=\"headerlink\" title=\"不用gitlab自带的nginx\"></a>不用gitlab自带的nginx</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/gitlab/gitlab.rb</div><div class=\"line\">nginx[&apos;enable&apos;] = false</div></pre></td></tr></table></figure>\n<h3 id=\"设置服务端口域名\"><a href=\"#设置服务端口域名\" class=\"headerlink\" title=\"设置服务端口域名\"></a>设置服务端口域名</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">external_url &apos;http://xxx.com&apos;</div><div class=\"line\">unicorn[&apos;port&apos;] = 8800</div></pre></td></tr></table></figure>\n<h3 id=\"更改配置文件后，重新设置生效\"><a href=\"#更改配置文件后，重新设置生效\" class=\"headerlink\" title=\"更改配置文件后，重新设置生效\"></a>更改配置文件后，重新设置生效</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab-ctl reconfigure</div></pre></td></tr></table></figure>\n<h3 id=\"启动，重启，停止-查看状态，查看日志-查看某组件日志\"><a href=\"#启动，重启，停止-查看状态，查看日志-查看某组件日志\" class=\"headerlink\" title=\"启动，重启，停止,查看状态，查看日志,查看某组件日志\"></a>启动，重启，停止,查看状态，查看日志,查看某组件日志</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab-ctl start</div><div class=\"line\">gitlab-ctl restart</div><div class=\"line\">gitlab-ctl stop</div><div class=\"line\">gitlab-ctl stop</div><div class=\"line\">gitlab-ctl tail </div><div class=\"line\">gitlab-ctl tail  unicorn</div></pre></td></tr></table></figure>\n<h3 id=\"gitlab无法push或clone的错误-JWT-DecodeError-Nil-JSON-web-token-lib-gitlab-workhorse-rb-120-in-verify\"><a href=\"#gitlab无法push或clone的错误-JWT-DecodeError-Nil-JSON-web-token-lib-gitlab-workhorse-rb-120-in-verify\" class=\"headerlink\" title=\"gitlab无法push或clone的错误:JWT::DecodeError (Nil JSON web token): lib/gitlab/workhorse.rb:120:in `verify_\"></a>gitlab无法push或clone的错误:JWT::DecodeError (Nil JSON web token): lib/gitlab/workhorse.rb:120:in `verify_</h3><p>问题出在反代的配置上:nginx或者apache的反代应该反代到 <a href=\"http://gitlab-workhorse\" target=\"_blank\" rel=\"external\">http://gitlab-workhorse</a>; 而不应该反代到<a href=\"http://127.0.0.1:8080\" target=\"_blank\" rel=\"external\">http://127.0.0.1:8080</a></p>\n<p>修改</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/nginx/nginx.conf  </div><div class=\"line\"></div><div class=\"line\">user git;</div></pre></td></tr></table></figure>\n<p>添加gitlab配置</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/nginx/conf.d/gitlab.conf</div><div class=\"line\"></div><div class=\"line\">upstream gitlab-workhorse &#123;</div><div class=\"line\">  server unix:/var/opt/gitlab/gitlab-workhorse/socket;</div><div class=\"line\">&#125;</div><div class=\"line\"># HTTPS server</div><div class=\"line\"></div><div class=\"line\">        #proxy_cache_path  /data/nginx/cache  levels=1:2    keys_zone=STATIC:10 inactive=24h  max_size=1g;</div><div class=\"line\">server &#123;</div><div class=\"line\">        listen       80  default_server;</div><div class=\"line\">        #server_name  git.okycz.com;</div><div class=\"line\">        #ssl                  on;</div><div class=\"line\">        #ssl_certificate</div><div class=\"line\">        #ssl_certificate_key</div><div class=\"line\"></div><div class=\"line\">        #ssl_session_cache    shared:SSL:1m;</div><div class=\"line\">        #ssl_session_timeout  5m;</div><div class=\"line\"></div><div class=\"line\">        #ssl_ciphers  HIGH:!aNULL:!MD5;</div><div class=\"line\">        #ssl_prefer_server_ciphers  on;</div><div class=\"line\"></div><div class=\"line\">        proxy_read_timeout 1800;</div><div class=\"line\">        proxy_send_timeout 1800;</div><div class=\"line\">        #proxy_connect_timeout 600;</div><div class=\"line\">        #send_timeout  600;</div><div class=\"line\">        #keepalive_timeout 600s;</div><div class=\"line\"></div><div class=\"line\">        location / &#123;</div><div class=\"line\">            proxy_pass http://gitlab-workhorse/;</div><div class=\"line\">            proxy_set_header Host $host:$server_port;</div><div class=\"line\">            proxy_set_header X-Real-IP $remote_addr;</div><div class=\"line\">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</div><div class=\"line\">            proxy_set_header Via &quot;nginx&quot;;</div><div class=\"line\">            #proxy_cache STATIC;</div><div class=\"line\">            #proxy_cache_valid  200 1d;</div><div class=\"line\">            #proxy_cache_use_stale  error timeout invalid_header updating http_500 http_502 http_503 http_504;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        location ~ ^/(assets)/ &#123;</div><div class=\"line\">                root /opt/gitlab/embedded/service/gitlab-rails/public;</div><div class=\"line\">                gzip_static on; # to serve pre-gzipped version</div><div class=\"line\">                expires max;</div><div class=\"line\">                add_header Cache-Control public;</div><div class=\"line\">         &#125;</div><div class=\"line\"></div><div class=\"line\">        #rewrite ^(.*)$  https://$host$1 permanent;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"webide异常\"><a href=\"#webide异常\" class=\"headerlink\" title=\"webide异常\"></a>webide异常</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">I made it work behind a nginx reverse proxy by adding $request_uri to the proxy_pass:</div><div class=\"line\"></div><div class=\"line\">proxy_pass http://my-gitlab:5555/$request_uri;</div></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"不用gitlab自带的nginx\"><a href=\"#不用gitlab自带的nginx\" class=\"headerlink\" title=\"不用gitlab自带的nginx\"></a>不用gitlab自带的nginx</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/gitlab/gitlab.rb</div><div class=\"line\">nginx[&apos;enable&apos;] = false</div></pre></td></tr></table></figure>\n<h3 id=\"设置服务端口域名\"><a href=\"#设置服务端口域名\" class=\"headerlink\" title=\"设置服务端口域名\"></a>设置服务端口域名</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">external_url &apos;http://xxx.com&apos;</div><div class=\"line\">unicorn[&apos;port&apos;] = 8800</div></pre></td></tr></table></figure>\n<h3 id=\"更改配置文件后，重新设置生效\"><a href=\"#更改配置文件后，重新设置生效\" class=\"headerlink\" title=\"更改配置文件后，重新设置生效\"></a>更改配置文件后，重新设置生效</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab-ctl reconfigure</div></pre></td></tr></table></figure>\n<h3 id=\"启动，重启，停止-查看状态，查看日志-查看某组件日志\"><a href=\"#启动，重启，停止-查看状态，查看日志-查看某组件日志\" class=\"headerlink\" title=\"启动，重启，停止,查看状态，查看日志,查看某组件日志\"></a>启动，重启，停止,查看状态，查看日志,查看某组件日志</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">gitlab-ctl start</div><div class=\"line\">gitlab-ctl restart</div><div class=\"line\">gitlab-ctl stop</div><div class=\"line\">gitlab-ctl stop</div><div class=\"line\">gitlab-ctl tail </div><div class=\"line\">gitlab-ctl tail  unicorn</div></pre></td></tr></table></figure>\n<h3 id=\"gitlab无法push或clone的错误-JWT-DecodeError-Nil-JSON-web-token-lib-gitlab-workhorse-rb-120-in-verify\"><a href=\"#gitlab无法push或clone的错误-JWT-DecodeError-Nil-JSON-web-token-lib-gitlab-workhorse-rb-120-in-verify\" class=\"headerlink\" title=\"gitlab无法push或clone的错误:JWT::DecodeError (Nil JSON web token): lib/gitlab/workhorse.rb:120:in `verify_\"></a>gitlab无法push或clone的错误:JWT::DecodeError (Nil JSON web token): lib/gitlab/workhorse.rb:120:in `verify_</h3><p>问题出在反代的配置上:nginx或者apache的反代应该反代到 <a href=\"http://gitlab-workhorse\" target=\"_blank\" rel=\"external\">http://gitlab-workhorse</a>; 而不应该反代到<a href=\"http://127.0.0.1:8080\" target=\"_blank\" rel=\"external\">http://127.0.0.1:8080</a></p>\n<p>修改</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/nginx/nginx.conf  </div><div class=\"line\"></div><div class=\"line\">user git;</div></pre></td></tr></table></figure>\n<p>添加gitlab配置</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/nginx/conf.d/gitlab.conf</div><div class=\"line\"></div><div class=\"line\">upstream gitlab-workhorse &#123;</div><div class=\"line\">  server unix:/var/opt/gitlab/gitlab-workhorse/socket;</div><div class=\"line\">&#125;</div><div class=\"line\"># HTTPS server</div><div class=\"line\"></div><div class=\"line\">        #proxy_cache_path  /data/nginx/cache  levels=1:2    keys_zone=STATIC:10 inactive=24h  max_size=1g;</div><div class=\"line\">server &#123;</div><div class=\"line\">        listen       80  default_server;</div><div class=\"line\">        #server_name  git.okycz.com;</div><div class=\"line\">        #ssl                  on;</div><div class=\"line\">        #ssl_certificate</div><div class=\"line\">        #ssl_certificate_key</div><div class=\"line\"></div><div class=\"line\">        #ssl_session_cache    shared:SSL:1m;</div><div class=\"line\">        #ssl_session_timeout  5m;</div><div class=\"line\"></div><div class=\"line\">        #ssl_ciphers  HIGH:!aNULL:!MD5;</div><div class=\"line\">        #ssl_prefer_server_ciphers  on;</div><div class=\"line\"></div><div class=\"line\">        proxy_read_timeout 1800;</div><div class=\"line\">        proxy_send_timeout 1800;</div><div class=\"line\">        #proxy_connect_timeout 600;</div><div class=\"line\">        #send_timeout  600;</div><div class=\"line\">        #keepalive_timeout 600s;</div><div class=\"line\"></div><div class=\"line\">        location / &#123;</div><div class=\"line\">            proxy_pass http://gitlab-workhorse/;</div><div class=\"line\">            proxy_set_header Host $host:$server_port;</div><div class=\"line\">            proxy_set_header X-Real-IP $remote_addr;</div><div class=\"line\">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</div><div class=\"line\">            proxy_set_header Via &quot;nginx&quot;;</div><div class=\"line\">            #proxy_cache STATIC;</div><div class=\"line\">            #proxy_cache_valid  200 1d;</div><div class=\"line\">            #proxy_cache_use_stale  error timeout invalid_header updating http_500 http_502 http_503 http_504;</div><div class=\"line\">        &#125;</div><div class=\"line\"></div><div class=\"line\">        location ~ ^/(assets)/ &#123;</div><div class=\"line\">                root /opt/gitlab/embedded/service/gitlab-rails/public;</div><div class=\"line\">                gzip_static on; # to serve pre-gzipped version</div><div class=\"line\">                expires max;</div><div class=\"line\">                add_header Cache-Control public;</div><div class=\"line\">         &#125;</div><div class=\"line\"></div><div class=\"line\">        #rewrite ^(.*)$  https://$host$1 permanent;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"webide异常\"><a href=\"#webide异常\" class=\"headerlink\" title=\"webide异常\"></a>webide异常</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">I made it work behind a nginx reverse proxy by adding $request_uri to the proxy_pass:</div><div class=\"line\"></div><div class=\"line\">proxy_pass http://my-gitlab:5555/$request_uri;</div></pre></td></tr></table></figure>"},{"title":"hyperledger 多机器部署","date":"2019-08-25T05:57:23.000Z","_content":"\n### 机器准备\n\n| 功能 | ip  | 机器名称 |\n|:------------- |:---------:| -------:|\n| orderer   | 10.9.149.68 |  order.bits.com |\n| peer0   | 10.9.149.68 |  peer0.org1.bits.com |\n| peer0   | 10.9.84.83 |  peer0.org2.bits.com |\n### 创建目录\n```\nmkdir bits\ncd bits\n```\n### 获取生成工具\n```\n把下载的hyperledger-fabric-linux-amd64-1.4.1.tar.gz二进制文件包解压，\n把其中的bin目录拷贝到bits目录下。\n设置权限：chmod -R 777 ./bin\n```\n\n### 准备生成证书和区块配置文件\n配置crypto-config.yaml和configtx.yaml文件，拷贝到bits目录下。\n#### crypto-config.yaml 文件\n```\n\t# Copyright IBM Corp. All Rights Reserved.\n\t#\n\t# SPDX-License-Identifier: Apache-2.0\n\t#\n\t\n\t# ---------------------------------------------------------------------------\n\t# \"OrdererOrgs\" - Definition of organizations managing orderer nodes\n\t# ---------------------------------------------------------------------------\n\tOrdererOrgs:\n\t  # ---------------------------------------------------------------------------\n\t  # Orderer\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Orderer\n\t    Domain: bits.com\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    # ---------------------------------------------------------------------------\n\t    # \"Specs\" - See PeerOrgs below for complete description\n\t    # ---------------------------------------------------------------------------\n\t    Specs:\n\t      - Hostname: orderer\n\t# ---------------------------------------------------------------------------\n\t# \"PeerOrgs\" - Definition of organizations managing peer nodes\n\t# ---------------------------------------------------------------------------\n\tPeerOrgs:\n\t  # ---------------------------------------------------------------------------\n\t  # Org1\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Org1\n\t    Domain: org1.bits.com\n\t    EnableNodeOUs: true\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    # ---------------------------------------------------------------------------\n\t    # \"Specs\"\n\t    # ---------------------------------------------------------------------------\n\t    # Uncomment this section to enable the explicit definition of hosts in your\n\t    # configuration.  Most users will want to use Template, below\n\t    #\n\t    # Specs is an array of Spec entries.  Each Spec entry consists of two fields:\n\t    #   - Hostname:   (Required) The desired hostname, sans the domain.\n\t    #   - CommonName: (Optional) Specifies the template or explicit override for\n\t    #                 the CN.  By default, this is the template:\n\t    #\n\t    #                              \"{{.Hostname}}.{{.Domain}}\"\n\t    #\n\t    #                 which obtains its values from the Spec.Hostname and\n\t    #                 Org.Domain, respectively.\n\t    # ---------------------------------------------------------------------------\n\t    # Specs:\n\t    #   - Hostname: foo # implicitly \"foo.org1.example.com\"\n\t    #     CommonName: foo27.org5.example.com # overrides Hostname-based FQDN set above\n\t    #   - Hostname: bar\n\t    #   - Hostname: baz\n\t    # ---------------------------------------------------------------------------\n\t    # \"Template\"\n\t    # ---------------------------------------------------------------------------\n\t    # Allows for the definition of 1 or more hosts that are created sequentially\n\t    # from a template. By default, this looks like \"peer%d\" from 0 to Count-1.\n\t    # You may override the number of nodes (Count), the starting index (Start)\n\t    # or the template used to construct the name (Hostname).\n\t    #\n\t    # Note: Template and Specs are not mutually exclusive.  You may define both\n\t    # sections and the aggregate nodes will be created for you.  Take care with\n\t    # name collisions\n\t    # ---------------------------------------------------------------------------\n\t    Template:\n\t      Count: 1\n\t      # Start: 5\n\t      # Hostname: {{.Prefix}}{{.Index}} # default\n\t    # ---------------------------------------------------------------------------\n\t    # \"Users\"\n\t    # ---------------------------------------------------------------------------\n\t    # Count: The number of user accounts _in addition_ to Admin\n\t    # ---------------------------------------------------------------------------\n\t    Users:\n\t      Count: 1\n\t  # ---------------------------------------------------------------------------\n\t  # Org2: See \"Org1\" for full specification\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Org2\n\t    Domain: org2.bits.com\n\t    EnableNodeOUs: true\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    Template:\n\t      Count: 1\n\t    Users:\n\t      Count: 1\n\n```\n#### configtx.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\n---\n################################################################################\n#\n#   Section: Organizations\n#\n#   - This section defines the different organizational identities which will\n#   be referenced later in the configuration.\n#\n################################################################################\nOrganizations:\n\n    # SampleOrg defines an MSP using the sampleconfig.  It should never be used\n    # in production but may be used as a template for other definitions\n    - &OrdererOrg\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: OrdererOrg\n\n        # ID to load the MSP definition as\n        ID: OrdererMSP\n\n        # MSPDir is the filesystem path which contains the MSP configuration\n        MSPDir: crypto-config/ordererOrganizations/bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.member')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.member')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.admin')\"\n\n    - &Org1\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: Org1MSP\n\n        # ID to load the MSP definition as\n        ID: Org1MSP\n\n        MSPDir: crypto-config/peerOrganizations/org1.bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin', 'Org1MSP.peer', 'Org1MSP.client')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin', 'Org1MSP.client')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin')\"\n\n        AnchorPeers:\n            # AnchorPeers defines the location of peers which can be used\n            # for cross org gossip communication.  Note, this value is only\n            # encoded in the genesis block in the Application section context\n            - Host: peer0.org1.bits.com\n              Port: 7051\n\n    - &Org2\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: Org2MSP\n\n        # ID to load the MSP definition as\n        ID: Org2MSP\n\n        MSPDir: crypto-config/peerOrganizations/org2.bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin', 'Org2MSP.peer', 'Org2MSP.client')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin', 'Org2MSP.client')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin')\"\n\n        AnchorPeers:\n            # AnchorPeers defines the location of peers which can be used\n            # for cross org gossip communication.  Note, this value is only\n            # encoded in the genesis block in the Application section context\n            - Host: peer0.org2.bits.com\n              Port: 7051\n\n################################################################################\n#\n#   SECTION: Capabilities\n#\n#   - This section defines the capabilities of fabric network. This is a new\n#   concept as of v1.1.0 and should not be utilized in mixed networks with\n#   v1.0.x peers and orderers.  Capabilities define features which must be\n#   present in a fabric binary for that binary to safely participate in the\n#   fabric network.  For instance, if a new MSP type is added, newer binaries\n#   might recognize and validate the signatures from this type, while older\n#   binaries without this support would be unable to validate those\n#   transactions.  This could lead to different versions of the fabric binaries\n#   having different world states.  Instead, defining a capability for a channel\n#   informs those binaries without this capability that they must cease\n#   processing transactions until they have been upgraded.  For v1.0.x if any\n#   capabilities are defined (including a map with all capabilities turned off)\n#   then the v1.0.x peer will deliberately crash.\n#\n################################################################################\nCapabilities:\n    # Channel capabilities apply to both the orderers and the peers and must be\n    # supported by both.  Set the value of the capability to true to require it.\n    Global: &ChannelCapabilities\n        # V1.1 for Global is a catchall flag for behavior which has been\n        # determined to be desired for all orderers and peers running v1.0.x,\n        # but the modification of which would cause incompatibilities.  Users\n        # should leave this flag set to true.\n        V1_1: true\n\n    # Orderer capabilities apply only to the orderers, and may be safely\n    # manipulated without concern for upgrading peers.  Set the value of the\n    # capability to true to require it.\n    Orderer: &OrdererCapabilities\n        # V1.1 for Order is a catchall flag for behavior which has been\n        # determined to be desired for all orderers running v1.0.x, but the\n        # modification of which  would cause incompatibilities.  Users should\n        # leave this flag set to true.\n        V1_1: true\n\n    # Application capabilities apply only to the peer network, and may be safely\n    # manipulated without concern for upgrading orderers.  Set the value of the\n    # capability to true to require it.\n    Application: &ApplicationCapabilities\n        # V1.1 for Application is a catchall flag for behavior which has been\n        # determined to be desired for all peers running v1.0.x, but the\n        # modification of which would cause incompatibilities.  Users should\n        # leave this flag set to true.\n        V1_2: true\n\n################################################################################\n#\n#   SECTION: Application\n#\n#   - This section defines the values to encode into a config transaction or\n#   genesis block for application related parameters\n#\n################################################################################\nApplication: &ApplicationDefaults\n\n    # Organizations is the list of orgs which are defined as participants on\n    # the application side of the network\n    Organizations:\n\n    # Policies defines the set of policies at this level of the config tree\n    # For Application policies, their canonical path is\n    #   /Channel/Application/<PolicyName>\n    Policies:\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n\n    # Capabilities describes the application level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *ApplicationCapabilities\n\n################################################################################\n#\n#   SECTION: Orderer\n#\n#   - This section defines the values to encode into a config transaction or\n#   genesis block for orderer related parameters\n#\n################################################################################\nOrderer: &OrdererDefaults\n\n    # Orderer Type: The orderer implementation to start\n    # Available types are \"solo\" and \"kafka\" and \"raft\"\n    OrdererType: solo\n\n    Addresses:\n        - orderer.bits.com:7050\n\n    # Batch Timeout: The amount of time to wait before creating a batch\n    BatchTimeout: 2s\n\n    # Batch Size: Controls the number of messages batched into a block\n    BatchSize:\n\n        # Max Message Count: The maximum number of messages to permit in a batch\n        MaxMessageCount: 10\n\n        # Absolute Max Bytes: The absolute maximum number of bytes allowed for\n        # the serialized messages in a batch.\n        AbsoluteMaxBytes: 98 MB\n\n        # Preferred Max Bytes: The preferred maximum number of bytes allowed for\n        # the serialized messages in a batch. A message larger than the preferred\n        # max bytes will result in a batch larger than preferred max bytes.\n        PreferredMaxBytes: 512 KB\n\n    Kafka:\n        # Brokers: A list of Kafka brokers to which the orderer connects. Edit\n        # this list to identify the brokers of the ordering service.\n        # NOTE: Use IP:port notation.\n        Brokers:\n            - 127.0.0.1:9092\n\n    # Organizations is the list of orgs which are defined as participants on\n    # the orderer side of the network\n    Organizations:\n\n    # Policies defines the set of policies at this level of the config tree\n    # For Orderer policies, their canonical path is\n    #   /Channel/Orderer/<PolicyName>\n    Policies:\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n        # BlockValidation specifies what signatures must be included in the block\n        # from the orderer for the peer to validate it.\n        BlockValidation:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n\n    # Capabilities describes the orderer level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *OrdererCapabilities\n\n################################################################################\n#\n#   CHANNEL\n#\n#   This section defines the values to encode into a config transaction or\n#   genesis block for channel related parameters.\n#\n################################################################################\nChannel: &ChannelDefaults\n    # Policies defines the set of policies at this level of the config tree\n    # For Channel policies, their canonical path is\n    #   /Channel/<PolicyName>\n    Policies:\n        # Who may invoke the 'Deliver' API\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        # Who may invoke the 'Broadcast' API\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        # By default, who may modify elements at this config level\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n\n\n    # Capabilities describes the channel level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *ChannelCapabilities\n\n################################################################################\n#\n#   Profile\n#\n#   - Different configuration profiles may be encoded here to be specified\n#   as parameters to the configtxgen tool\n#\n################################################################################\nProfiles:\n\n    TwoOrgsOrdererGenesis:\n        <<: *ChannelDefaults\n        Orderer:\n            <<: *OrdererDefaults\n            Organizations:\n                - *OrdererOrg\n        Consortiums:\n            SampleConsortium:\n                Organizations:\n                    - *Org1\n                    - *Org2\n    TwoOrgsChannel:\n        Consortium: SampleConsortium\n        Application:\n            <<: *ApplicationDefaults\n            Organizations:\n                - *Org1\n                - *Org2\n\n```\n\n#### 生成公私钥和证书\n\n```\n./bin/cryptogen generate --config=./crypto-config.yaml\n\n```\n#### 生成创世区块\n\n```\nmkdir channel-artifacts\n./bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block\n\n```\n#### 生成通道配置区块\n\n```\n./bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/bits-query.tx -channelID bits-query\n```\n#### 拷贝到别的电脑\n\n```\ncd ..\nscp -r bits ubuntu@10.9.84.83:/data/bits\n\n```\n\n## 部署order，配置docker-compose-orderer.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n\n  orderer.example.com:\n    container_name: orderer.bits.com\n    image: hyperledger/fabric-orderer\n    environment:\n      - ORDERER_GENERAL_LOGLEVEL=debug\n      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0\n      - ORDERER_GENERAL_GENESISMETHOD=file\n      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block\n      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP\n      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp\n      # enabled TLS\n      - ORDERER_GENERAL_TLS_ENABLED=true\n      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key\n      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt\n      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]\n      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s\n      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s\n      - ORDERER_KAFKA_VERBOSE=true\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric\n    command: orderer\n    volumes:\n      - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block\n      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp:/var/hyperledger/orderer/msp\n      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/:/var/hyperledger/orderer/tls\n    ports:\n      - 7050:7050\n```\n#### 启动Fabric orderer排序服务\n```\ndocker-compose -f docker-compose-orderer.yaml up -d\n\n```\n## 部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n  peer0.org1.bits.com:\n    container_name: peer0.org1.bits.com\n    image: hyperledger/fabric-peer\n    environment:\n      - CORE_PEER_ID=peer0.org1.bits.com\n      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051\n      - CORE_PEER_CHAINCODEADDRESS=peer0.org1.bits.com:7052\n      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052\n      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org1MSP\n\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      # the following setting starts chaincode containers on the same\n      # bridge network as the peers\n      # https://docs.docker.com/compose/networking/\n      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default\n      #- CORE_LOGGING_LEVEL=ERROR\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_GOSSIP_USELEADERELECTION=true\n      - CORE_PEER_GOSSIP_ORGLEADER=false\n      - CORE_PEER_PROFILE_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    command: peer node start\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp:/etc/hyperledger/fabric/msp\n        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls:/etc/hyperledger/fabric/tls\n    ports:\n      - 7051:7051\n      - 7052:7052\n      - 7053:7053\n    extra_hosts:\n      - \"orderer.bits.com:10.9.149.68\"\n\n  cli:\n    container_name: cli\n    image: hyperledger/fabric-tools\n    tty: true\n    environment:\n      - GOPATH=/opt/gopath\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_ID=cli\n      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org1MSP\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt\n      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go\n        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/\n        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts\n    depends_on:\n       - peer0.org1.bits.com\n    extra_hosts:\n       - \"orderer.bits.com:10.9.149.68\"\n       - \"peer0.org1.bits.com:10.9.149.68\"\n       - \"peer0.org2.bits.com:10.9.84.83\"\n```\n#### 启动peer0.org1.bits.com\n```\ndocker-compose -f docker-compose-org1-peer0.yaml up -d\n```\n#### 进入容器\n```\ndocker exec -it cli bash\n```\n#### 创建Channel通道\n```\n# 因为创建通道需要通知orderer 所以设置oderer的tls证书\nORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem\n\npeer channel create -o orderer.bits.com:7050 -c bits-query -f ./channel-artifacts/bits-query.tx --tls --cafile $ORDERER_CA\n\n```\n#### 加入channel通道 \n```\npeer channel join -b bits-query.block\n```\n#### 保存通道信息,需将通道信息拷贝至其他节点\n```\n#容器名\ndocker cp xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.block /data/bits/channel-artifacts\n\nscp -r /data/bits xxx:/data\n\n```\n\n#### 打包智能合约\n```\n # 每台机器单独安装的话，里面的编号不一致，所以打包好后，去有需要的节点再安装\n \n peer chaincode package -n bits-query -p query/cmd/ -v 1.0 bits-query.pak\n \n docker cp xxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.pak /data/bits/channel-artifacts\n```\n\n#### peer0.org1.bits.com安装\n```\npeer chaincode install bits-query.pak\n\n```\n##  部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n  peer0.org2.bits.com:\n    container_name: peer0.org2.bits.com\n    image: hyperledger/fabric-peer\n    environment:\n      - CORE_PEER_ID=peer0.org2.bits.com\n      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051\n      - CORE_PEER_CHAINCODEADDRESS=peer0.org2.bits.com:7052\n      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052\n      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org2.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org2MSP\n\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      # the following setting starts chaincode containers on the same\n      # bridge network as the peers\n      # https://docs.docker.com/compose/networking/\n      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default\n      #- CORE_LOGGING_LEVEL=ERROR\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_GOSSIP_USELEADERELECTION=true\n      - CORE_PEER_GOSSIP_ORGLEADER=false\n      - CORE_PEER_PROFILE_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    command: peer node start\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp:/etc/hyperledger/fabric/msp\n        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls:/etc/hyperledger/fabric/tls\n    ports:\n      - 7051:7051\n      - 7052:7052\n      - 7053:7053\n    extra_hosts:\n      - \"orderer.bits.com:10.9.149.68\"\n\n  cli:\n    container_name: cli\n    image: hyperledger/fabric-tools\n    tty: true\n    environment:\n      - GOPATH=/opt/gopath\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_ID=cli\n      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org2MSP\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt\n      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go\n        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/\n        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts\n    depends_on:\n       - peer0.org2.bits.com\n    extra_hosts:\n       - \"orderer.bits.com:10.9.149.68\"\n       - \"peer0.org1.bits.com:10.9.149.68\"\n       - \"peer0.org2.bits.com:10.9.84.83\"\n```\n#### 启动peer0.org2.bits.com\n```\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n```\n#### 进入容器\n```\ndocker exec -it cli bash\n```\n#### 加入通道\n```\ndocker cp /data/bits/channel-artifacts/bits-query.block xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b bits-query.block\n\n```\n\n#### peer0.org2.bits.com安装\n```\ndocker cp /data/bits/channel-artifacts/bits-query.pak xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n##安装\npeer chaincode install bits-query.pak\n##查看是否安装成功\npeer chaincode list --installed\npeer chaincode list --instantiated -C bits-query\n\n```\n\n## 调用\n### 添加数据 \n```\nORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem\n\n\n<!--peer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C bits-query -n bit-query -v 1.0 -c '{\"Args\":[\"init\",\"\",\"\",\"\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"-->\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C bits-query -n bits-query -c '{\"Args\":[\"put\",\"{\\\"queryId\\\":233,\\\"indexDigest\\\":\\\"indexDigest\\\",\\\"provideQueryOrg\\\":\\\"provideQueryOrg\\\",\\\"offerOrg\\\":\\\"offerOrg\\\",\\\"queryTime\\\":\\\"queryTime\\\",\\\"queryType\\\":11,\\\"queryResult\\\":11,\\\"querySerial\\\":\\\"querySerial\\\",\\\"hit\\\":1}\"]}'\n\n\n\n```\n### 查看数据\n```\npeer chaincode query  -C bits-query -n bits-query -c '{\"Args\":[\"query\",\"222\"]}'\n\n```\n\n\n\n\n<!--\n<!--peer chaincode install -n mycc -p github.com/hyperledger/fabric/multipeer/chaincode/go/example02/cmd/ -v 1.0\n\n peer chaincode install -n mycc -p github.com/hyperledger/fabric/bits/chaincode/go/example02/cmd/ -v 1.0\n\n\npeer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n mycc -v 1.0 -c '{\"Args\":[\"init\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"\n\n\n\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n\n\n\ndocker cp /data/bits/mychannel.block 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\ndocker cp /data/bits/mycc.pak 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b mychannel.block\n\npeer chaincode install mycc.pak\n\n\npeer chaincode list --installed\n\n\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C mychannel -n mycc -c '{\"Args\":[\"invoke\",\"a\",\"b\",\"10\"]}'\n\n\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"a\"]}'-->\n","source":"_posts/hyperledger 多机器部署.md","raw":"---\ntitle: hyperledger 多机器部署\ndate: 2019-08-25 13:57:23\ncategories: \n\t- 区块链\n\t- hyperledger\ntags:\n\t- hyperledger 多机器部署\n---\n\n### 机器准备\n\n| 功能 | ip  | 机器名称 |\n|:------------- |:---------:| -------:|\n| orderer   | 10.9.149.68 |  order.bits.com |\n| peer0   | 10.9.149.68 |  peer0.org1.bits.com |\n| peer0   | 10.9.84.83 |  peer0.org2.bits.com |\n### 创建目录\n```\nmkdir bits\ncd bits\n```\n### 获取生成工具\n```\n把下载的hyperledger-fabric-linux-amd64-1.4.1.tar.gz二进制文件包解压，\n把其中的bin目录拷贝到bits目录下。\n设置权限：chmod -R 777 ./bin\n```\n\n### 准备生成证书和区块配置文件\n配置crypto-config.yaml和configtx.yaml文件，拷贝到bits目录下。\n#### crypto-config.yaml 文件\n```\n\t# Copyright IBM Corp. All Rights Reserved.\n\t#\n\t# SPDX-License-Identifier: Apache-2.0\n\t#\n\t\n\t# ---------------------------------------------------------------------------\n\t# \"OrdererOrgs\" - Definition of organizations managing orderer nodes\n\t# ---------------------------------------------------------------------------\n\tOrdererOrgs:\n\t  # ---------------------------------------------------------------------------\n\t  # Orderer\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Orderer\n\t    Domain: bits.com\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    # ---------------------------------------------------------------------------\n\t    # \"Specs\" - See PeerOrgs below for complete description\n\t    # ---------------------------------------------------------------------------\n\t    Specs:\n\t      - Hostname: orderer\n\t# ---------------------------------------------------------------------------\n\t# \"PeerOrgs\" - Definition of organizations managing peer nodes\n\t# ---------------------------------------------------------------------------\n\tPeerOrgs:\n\t  # ---------------------------------------------------------------------------\n\t  # Org1\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Org1\n\t    Domain: org1.bits.com\n\t    EnableNodeOUs: true\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    # ---------------------------------------------------------------------------\n\t    # \"Specs\"\n\t    # ---------------------------------------------------------------------------\n\t    # Uncomment this section to enable the explicit definition of hosts in your\n\t    # configuration.  Most users will want to use Template, below\n\t    #\n\t    # Specs is an array of Spec entries.  Each Spec entry consists of two fields:\n\t    #   - Hostname:   (Required) The desired hostname, sans the domain.\n\t    #   - CommonName: (Optional) Specifies the template or explicit override for\n\t    #                 the CN.  By default, this is the template:\n\t    #\n\t    #                              \"{{.Hostname}}.{{.Domain}}\"\n\t    #\n\t    #                 which obtains its values from the Spec.Hostname and\n\t    #                 Org.Domain, respectively.\n\t    # ---------------------------------------------------------------------------\n\t    # Specs:\n\t    #   - Hostname: foo # implicitly \"foo.org1.example.com\"\n\t    #     CommonName: foo27.org5.example.com # overrides Hostname-based FQDN set above\n\t    #   - Hostname: bar\n\t    #   - Hostname: baz\n\t    # ---------------------------------------------------------------------------\n\t    # \"Template\"\n\t    # ---------------------------------------------------------------------------\n\t    # Allows for the definition of 1 or more hosts that are created sequentially\n\t    # from a template. By default, this looks like \"peer%d\" from 0 to Count-1.\n\t    # You may override the number of nodes (Count), the starting index (Start)\n\t    # or the template used to construct the name (Hostname).\n\t    #\n\t    # Note: Template and Specs are not mutually exclusive.  You may define both\n\t    # sections and the aggregate nodes will be created for you.  Take care with\n\t    # name collisions\n\t    # ---------------------------------------------------------------------------\n\t    Template:\n\t      Count: 1\n\t      # Start: 5\n\t      # Hostname: {{.Prefix}}{{.Index}} # default\n\t    # ---------------------------------------------------------------------------\n\t    # \"Users\"\n\t    # ---------------------------------------------------------------------------\n\t    # Count: The number of user accounts _in addition_ to Admin\n\t    # ---------------------------------------------------------------------------\n\t    Users:\n\t      Count: 1\n\t  # ---------------------------------------------------------------------------\n\t  # Org2: See \"Org1\" for full specification\n\t  # ---------------------------------------------------------------------------\n\t  - Name: Org2\n\t    Domain: org2.bits.com\n\t    EnableNodeOUs: true\n\t    CA:\n\t        Country: US\n\t        Province: California\n\t        Locality: San Francisco\n\t    Template:\n\t      Count: 1\n\t    Users:\n\t      Count: 1\n\n```\n#### configtx.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\n---\n################################################################################\n#\n#   Section: Organizations\n#\n#   - This section defines the different organizational identities which will\n#   be referenced later in the configuration.\n#\n################################################################################\nOrganizations:\n\n    # SampleOrg defines an MSP using the sampleconfig.  It should never be used\n    # in production but may be used as a template for other definitions\n    - &OrdererOrg\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: OrdererOrg\n\n        # ID to load the MSP definition as\n        ID: OrdererMSP\n\n        # MSPDir is the filesystem path which contains the MSP configuration\n        MSPDir: crypto-config/ordererOrganizations/bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.member')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.member')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('OrdererMSP.admin')\"\n\n    - &Org1\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: Org1MSP\n\n        # ID to load the MSP definition as\n        ID: Org1MSP\n\n        MSPDir: crypto-config/peerOrganizations/org1.bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin', 'Org1MSP.peer', 'Org1MSP.client')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin', 'Org1MSP.client')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('Org1MSP.admin')\"\n\n        AnchorPeers:\n            # AnchorPeers defines the location of peers which can be used\n            # for cross org gossip communication.  Note, this value is only\n            # encoded in the genesis block in the Application section context\n            - Host: peer0.org1.bits.com\n              Port: 7051\n\n    - &Org2\n        # DefaultOrg defines the organization which is used in the sampleconfig\n        # of the fabric.git development environment\n        Name: Org2MSP\n\n        # ID to load the MSP definition as\n        ID: Org2MSP\n\n        MSPDir: crypto-config/peerOrganizations/org2.bits.com/msp\n\n        # Policies defines the set of policies at this level of the config tree\n        # For organization policies, their canonical path is usually\n        #   /Channel/<Application|Orderer>/<OrgName>/<PolicyName>\n        Policies:\n            Readers:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin', 'Org2MSP.peer', 'Org2MSP.client')\"\n            Writers:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin', 'Org2MSP.client')\"\n            Admins:\n                Type: Signature\n                Rule: \"OR('Org2MSP.admin')\"\n\n        AnchorPeers:\n            # AnchorPeers defines the location of peers which can be used\n            # for cross org gossip communication.  Note, this value is only\n            # encoded in the genesis block in the Application section context\n            - Host: peer0.org2.bits.com\n              Port: 7051\n\n################################################################################\n#\n#   SECTION: Capabilities\n#\n#   - This section defines the capabilities of fabric network. This is a new\n#   concept as of v1.1.0 and should not be utilized in mixed networks with\n#   v1.0.x peers and orderers.  Capabilities define features which must be\n#   present in a fabric binary for that binary to safely participate in the\n#   fabric network.  For instance, if a new MSP type is added, newer binaries\n#   might recognize and validate the signatures from this type, while older\n#   binaries without this support would be unable to validate those\n#   transactions.  This could lead to different versions of the fabric binaries\n#   having different world states.  Instead, defining a capability for a channel\n#   informs those binaries without this capability that they must cease\n#   processing transactions until they have been upgraded.  For v1.0.x if any\n#   capabilities are defined (including a map with all capabilities turned off)\n#   then the v1.0.x peer will deliberately crash.\n#\n################################################################################\nCapabilities:\n    # Channel capabilities apply to both the orderers and the peers and must be\n    # supported by both.  Set the value of the capability to true to require it.\n    Global: &ChannelCapabilities\n        # V1.1 for Global is a catchall flag for behavior which has been\n        # determined to be desired for all orderers and peers running v1.0.x,\n        # but the modification of which would cause incompatibilities.  Users\n        # should leave this flag set to true.\n        V1_1: true\n\n    # Orderer capabilities apply only to the orderers, and may be safely\n    # manipulated without concern for upgrading peers.  Set the value of the\n    # capability to true to require it.\n    Orderer: &OrdererCapabilities\n        # V1.1 for Order is a catchall flag for behavior which has been\n        # determined to be desired for all orderers running v1.0.x, but the\n        # modification of which  would cause incompatibilities.  Users should\n        # leave this flag set to true.\n        V1_1: true\n\n    # Application capabilities apply only to the peer network, and may be safely\n    # manipulated without concern for upgrading orderers.  Set the value of the\n    # capability to true to require it.\n    Application: &ApplicationCapabilities\n        # V1.1 for Application is a catchall flag for behavior which has been\n        # determined to be desired for all peers running v1.0.x, but the\n        # modification of which would cause incompatibilities.  Users should\n        # leave this flag set to true.\n        V1_2: true\n\n################################################################################\n#\n#   SECTION: Application\n#\n#   - This section defines the values to encode into a config transaction or\n#   genesis block for application related parameters\n#\n################################################################################\nApplication: &ApplicationDefaults\n\n    # Organizations is the list of orgs which are defined as participants on\n    # the application side of the network\n    Organizations:\n\n    # Policies defines the set of policies at this level of the config tree\n    # For Application policies, their canonical path is\n    #   /Channel/Application/<PolicyName>\n    Policies:\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n\n    # Capabilities describes the application level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *ApplicationCapabilities\n\n################################################################################\n#\n#   SECTION: Orderer\n#\n#   - This section defines the values to encode into a config transaction or\n#   genesis block for orderer related parameters\n#\n################################################################################\nOrderer: &OrdererDefaults\n\n    # Orderer Type: The orderer implementation to start\n    # Available types are \"solo\" and \"kafka\" and \"raft\"\n    OrdererType: solo\n\n    Addresses:\n        - orderer.bits.com:7050\n\n    # Batch Timeout: The amount of time to wait before creating a batch\n    BatchTimeout: 2s\n\n    # Batch Size: Controls the number of messages batched into a block\n    BatchSize:\n\n        # Max Message Count: The maximum number of messages to permit in a batch\n        MaxMessageCount: 10\n\n        # Absolute Max Bytes: The absolute maximum number of bytes allowed for\n        # the serialized messages in a batch.\n        AbsoluteMaxBytes: 98 MB\n\n        # Preferred Max Bytes: The preferred maximum number of bytes allowed for\n        # the serialized messages in a batch. A message larger than the preferred\n        # max bytes will result in a batch larger than preferred max bytes.\n        PreferredMaxBytes: 512 KB\n\n    Kafka:\n        # Brokers: A list of Kafka brokers to which the orderer connects. Edit\n        # this list to identify the brokers of the ordering service.\n        # NOTE: Use IP:port notation.\n        Brokers:\n            - 127.0.0.1:9092\n\n    # Organizations is the list of orgs which are defined as participants on\n    # the orderer side of the network\n    Organizations:\n\n    # Policies defines the set of policies at this level of the config tree\n    # For Orderer policies, their canonical path is\n    #   /Channel/Orderer/<PolicyName>\n    Policies:\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n        # BlockValidation specifies what signatures must be included in the block\n        # from the orderer for the peer to validate it.\n        BlockValidation:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n\n    # Capabilities describes the orderer level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *OrdererCapabilities\n\n################################################################################\n#\n#   CHANNEL\n#\n#   This section defines the values to encode into a config transaction or\n#   genesis block for channel related parameters.\n#\n################################################################################\nChannel: &ChannelDefaults\n    # Policies defines the set of policies at this level of the config tree\n    # For Channel policies, their canonical path is\n    #   /Channel/<PolicyName>\n    Policies:\n        # Who may invoke the 'Deliver' API\n        Readers:\n            Type: ImplicitMeta\n            Rule: \"ANY Readers\"\n        # Who may invoke the 'Broadcast' API\n        Writers:\n            Type: ImplicitMeta\n            Rule: \"ANY Writers\"\n        # By default, who may modify elements at this config level\n        Admins:\n            Type: ImplicitMeta\n            Rule: \"MAJORITY Admins\"\n\n\n    # Capabilities describes the channel level capabilities, see the\n    # dedicated Capabilities section elsewhere in this file for a full\n    # description\n    Capabilities:\n        <<: *ChannelCapabilities\n\n################################################################################\n#\n#   Profile\n#\n#   - Different configuration profiles may be encoded here to be specified\n#   as parameters to the configtxgen tool\n#\n################################################################################\nProfiles:\n\n    TwoOrgsOrdererGenesis:\n        <<: *ChannelDefaults\n        Orderer:\n            <<: *OrdererDefaults\n            Organizations:\n                - *OrdererOrg\n        Consortiums:\n            SampleConsortium:\n                Organizations:\n                    - *Org1\n                    - *Org2\n    TwoOrgsChannel:\n        Consortium: SampleConsortium\n        Application:\n            <<: *ApplicationDefaults\n            Organizations:\n                - *Org1\n                - *Org2\n\n```\n\n#### 生成公私钥和证书\n\n```\n./bin/cryptogen generate --config=./crypto-config.yaml\n\n```\n#### 生成创世区块\n\n```\nmkdir channel-artifacts\n./bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block\n\n```\n#### 生成通道配置区块\n\n```\n./bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/bits-query.tx -channelID bits-query\n```\n#### 拷贝到别的电脑\n\n```\ncd ..\nscp -r bits ubuntu@10.9.84.83:/data/bits\n\n```\n\n## 部署order，配置docker-compose-orderer.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n\n  orderer.example.com:\n    container_name: orderer.bits.com\n    image: hyperledger/fabric-orderer\n    environment:\n      - ORDERER_GENERAL_LOGLEVEL=debug\n      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0\n      - ORDERER_GENERAL_GENESISMETHOD=file\n      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block\n      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP\n      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp\n      # enabled TLS\n      - ORDERER_GENERAL_TLS_ENABLED=true\n      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key\n      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt\n      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]\n      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s\n      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s\n      - ORDERER_KAFKA_VERBOSE=true\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric\n    command: orderer\n    volumes:\n      - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block\n      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp:/var/hyperledger/orderer/msp\n      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/:/var/hyperledger/orderer/tls\n    ports:\n      - 7050:7050\n```\n#### 启动Fabric orderer排序服务\n```\ndocker-compose -f docker-compose-orderer.yaml up -d\n\n```\n## 部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n  peer0.org1.bits.com:\n    container_name: peer0.org1.bits.com\n    image: hyperledger/fabric-peer\n    environment:\n      - CORE_PEER_ID=peer0.org1.bits.com\n      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051\n      - CORE_PEER_CHAINCODEADDRESS=peer0.org1.bits.com:7052\n      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052\n      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org1MSP\n\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      # the following setting starts chaincode containers on the same\n      # bridge network as the peers\n      # https://docs.docker.com/compose/networking/\n      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default\n      #- CORE_LOGGING_LEVEL=ERROR\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_GOSSIP_USELEADERELECTION=true\n      - CORE_PEER_GOSSIP_ORGLEADER=false\n      - CORE_PEER_PROFILE_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    command: peer node start\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp:/etc/hyperledger/fabric/msp\n        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls:/etc/hyperledger/fabric/tls\n    ports:\n      - 7051:7051\n      - 7052:7052\n      - 7053:7053\n    extra_hosts:\n      - \"orderer.bits.com:10.9.149.68\"\n\n  cli:\n    container_name: cli\n    image: hyperledger/fabric-tools\n    tty: true\n    environment:\n      - GOPATH=/opt/gopath\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_ID=cli\n      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org1MSP\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt\n      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go\n        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/\n        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts\n    depends_on:\n       - peer0.org1.bits.com\n    extra_hosts:\n       - \"orderer.bits.com:10.9.149.68\"\n       - \"peer0.org1.bits.com:10.9.149.68\"\n       - \"peer0.org2.bits.com:10.9.84.83\"\n```\n#### 启动peer0.org1.bits.com\n```\ndocker-compose -f docker-compose-org1-peer0.yaml up -d\n```\n#### 进入容器\n```\ndocker exec -it cli bash\n```\n#### 创建Channel通道\n```\n# 因为创建通道需要通知orderer 所以设置oderer的tls证书\nORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem\n\npeer channel create -o orderer.bits.com:7050 -c bits-query -f ./channel-artifacts/bits-query.tx --tls --cafile $ORDERER_CA\n\n```\n#### 加入channel通道 \n```\npeer channel join -b bits-query.block\n```\n#### 保存通道信息,需将通道信息拷贝至其他节点\n```\n#容器名\ndocker cp xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.block /data/bits/channel-artifacts\n\nscp -r /data/bits xxx:/data\n\n```\n\n#### 打包智能合约\n```\n # 每台机器单独安装的话，里面的编号不一致，所以打包好后，去有需要的节点再安装\n \n peer chaincode package -n bits-query -p query/cmd/ -v 1.0 bits-query.pak\n \n docker cp xxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.pak /data/bits/channel-artifacts\n```\n\n#### peer0.org1.bits.com安装\n```\npeer chaincode install bits-query.pak\n\n```\n##  部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件\n```\n# Copyright IBM Corp. All Rights Reserved.\n#\n# SPDX-License-Identifier: Apache-2.0\n#\n\nversion: '2'\n\nservices:\n  peer0.org2.bits.com:\n    container_name: peer0.org2.bits.com\n    image: hyperledger/fabric-peer\n    environment:\n      - CORE_PEER_ID=peer0.org2.bits.com\n      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051\n      - CORE_PEER_CHAINCODEADDRESS=peer0.org2.bits.com:7052\n      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052\n      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org2.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org2MSP\n\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      # the following setting starts chaincode containers on the same\n      # bridge network as the peers\n      # https://docs.docker.com/compose/networking/\n      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default\n      #- CORE_LOGGING_LEVEL=ERROR\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_GOSSIP_USELEADERELECTION=true\n      - CORE_PEER_GOSSIP_ORGLEADER=false\n      - CORE_PEER_PROFILE_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    command: peer node start\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp:/etc/hyperledger/fabric/msp\n        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls:/etc/hyperledger/fabric/tls\n    ports:\n      - 7051:7051\n      - 7052:7052\n      - 7053:7053\n    extra_hosts:\n      - \"orderer.bits.com:10.9.149.68\"\n\n  cli:\n    container_name: cli\n    image: hyperledger/fabric-tools\n    tty: true\n    environment:\n      - GOPATH=/opt/gopath\n      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock\n      - CORE_LOGGING_LEVEL=DEBUG\n      - CORE_PEER_ID=cli\n      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051\n      - CORE_PEER_LOCALMSPID=Org2MSP\n      - CORE_PEER_TLS_ENABLED=true\n      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt\n      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key\n      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt\n      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp\n    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer\n    volumes:\n        - /var/run/:/host/var/run/\n        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go\n        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/\n        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts\n    depends_on:\n       - peer0.org2.bits.com\n    extra_hosts:\n       - \"orderer.bits.com:10.9.149.68\"\n       - \"peer0.org1.bits.com:10.9.149.68\"\n       - \"peer0.org2.bits.com:10.9.84.83\"\n```\n#### 启动peer0.org2.bits.com\n```\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n```\n#### 进入容器\n```\ndocker exec -it cli bash\n```\n#### 加入通道\n```\ndocker cp /data/bits/channel-artifacts/bits-query.block xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b bits-query.block\n\n```\n\n#### peer0.org2.bits.com安装\n```\ndocker cp /data/bits/channel-artifacts/bits-query.pak xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n##安装\npeer chaincode install bits-query.pak\n##查看是否安装成功\npeer chaincode list --installed\npeer chaincode list --instantiated -C bits-query\n\n```\n\n## 调用\n### 添加数据 \n```\nORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem\n\n\n<!--peer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C bits-query -n bit-query -v 1.0 -c '{\"Args\":[\"init\",\"\",\"\",\"\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"-->\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C bits-query -n bits-query -c '{\"Args\":[\"put\",\"{\\\"queryId\\\":233,\\\"indexDigest\\\":\\\"indexDigest\\\",\\\"provideQueryOrg\\\":\\\"provideQueryOrg\\\",\\\"offerOrg\\\":\\\"offerOrg\\\",\\\"queryTime\\\":\\\"queryTime\\\",\\\"queryType\\\":11,\\\"queryResult\\\":11,\\\"querySerial\\\":\\\"querySerial\\\",\\\"hit\\\":1}\"]}'\n\n\n\n```\n### 查看数据\n```\npeer chaincode query  -C bits-query -n bits-query -c '{\"Args\":[\"query\",\"222\"]}'\n\n```\n\n\n\n\n<!--\n<!--peer chaincode install -n mycc -p github.com/hyperledger/fabric/multipeer/chaincode/go/example02/cmd/ -v 1.0\n\n peer chaincode install -n mycc -p github.com/hyperledger/fabric/bits/chaincode/go/example02/cmd/ -v 1.0\n\n\npeer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n mycc -v 1.0 -c '{\"Args\":[\"init\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"\n\n\n\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n\n\n\ndocker cp /data/bits/mychannel.block 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\ndocker cp /data/bits/mycc.pak 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b mychannel.block\n\npeer chaincode install mycc.pak\n\n\npeer chaincode list --installed\n\n\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C mychannel -n mycc -c '{\"Args\":[\"invoke\",\"a\",\"b\",\"10\"]}'\n\n\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"a\"]}'-->\n","slug":"hyperledger 多机器部署","published":1,"updated":"2019-10-16T03:17:47.709Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exr000f1fiht7r2cbaz","content":"<h3 id=\"机器准备\"><a href=\"#机器准备\" class=\"headerlink\" title=\"机器准备\"></a>机器准备</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">功能</th>\n<th style=\"text-align:center\">ip</th>\n<th style=\"text-align:right\">机器名称</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">orderer</td>\n<td style=\"text-align:center\">10.9.149.68</td>\n<td style=\"text-align:right\">order.bits.com</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">peer0</td>\n<td style=\"text-align:center\">10.9.149.68</td>\n<td style=\"text-align:right\">peer0.org1.bits.com</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">peer0</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">peer0.org2.bits.com</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"创建目录\"><a href=\"#创建目录\" class=\"headerlink\" title=\"创建目录\"></a>创建目录</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir bits</div><div class=\"line\">cd bits</div></pre></td></tr></table></figure>\n<h3 id=\"获取生成工具\"><a href=\"#获取生成工具\" class=\"headerlink\" title=\"获取生成工具\"></a>获取生成工具</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">把下载的hyperledger-fabric-linux-amd64-1.4.1.tar.gz二进制文件包解压，</div><div class=\"line\">把其中的bin目录拷贝到bits目录下。</div><div class=\"line\">设置权限：chmod -R 777 ./bin</div></pre></td></tr></table></figure>\n<h3 id=\"准备生成证书和区块配置文件\"><a href=\"#准备生成证书和区块配置文件\" class=\"headerlink\" title=\"准备生成证书和区块配置文件\"></a>准备生成证书和区块配置文件</h3><p>配置crypto-config.yaml和configtx.yaml文件，拷贝到bits目录下。</p>\n<h4 id=\"crypto-config-yaml-文件\"><a href=\"#crypto-config-yaml-文件\" class=\"headerlink\" title=\"crypto-config.yaml 文件\"></a>crypto-config.yaml 文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\"># &quot;OrdererOrgs&quot; - Definition of organizations managing orderer nodes</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\">OrdererOrgs:</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Orderer</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Orderer</div><div class=\"line\">    Domain: bits.com</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Specs&quot; - See PeerOrgs below for complete description</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Specs:</div><div class=\"line\">      - Hostname: orderer</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\"># &quot;PeerOrgs&quot; - Definition of organizations managing peer nodes</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\">PeerOrgs:</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Org1</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Org1</div><div class=\"line\">    Domain: org1.bits.com</div><div class=\"line\">    EnableNodeOUs: true</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Specs&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Uncomment this section to enable the explicit definition of hosts in your</div><div class=\"line\">    # configuration.  Most users will want to use Template, below</div><div class=\"line\">    #</div><div class=\"line\">    # Specs is an array of Spec entries.  Each Spec entry consists of two fields:</div><div class=\"line\">    #   - Hostname:   (Required) The desired hostname, sans the domain.</div><div class=\"line\">    #   - CommonName: (Optional) Specifies the template or explicit override for</div><div class=\"line\">    #                 the CN.  By default, this is the template:</div><div class=\"line\">    #</div><div class=\"line\">    #                              &quot;&#123;&#123;.Hostname&#125;&#125;.&#123;&#123;.Domain&#125;&#125;&quot;</div><div class=\"line\">    #</div><div class=\"line\">    #                 which obtains its values from the Spec.Hostname and</div><div class=\"line\">    #                 Org.Domain, respectively.</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Specs:</div><div class=\"line\">    #   - Hostname: foo # implicitly &quot;foo.org1.example.com&quot;</div><div class=\"line\">    #     CommonName: foo27.org5.example.com # overrides Hostname-based FQDN set above</div><div class=\"line\">    #   - Hostname: bar</div><div class=\"line\">    #   - Hostname: baz</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Template&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Allows for the definition of 1 or more hosts that are created sequentially</div><div class=\"line\">    # from a template. By default, this looks like &quot;peer%d&quot; from 0 to Count-1.</div><div class=\"line\">    # You may override the number of nodes (Count), the starting index (Start)</div><div class=\"line\">    # or the template used to construct the name (Hostname).</div><div class=\"line\">    #</div><div class=\"line\">    # Note: Template and Specs are not mutually exclusive.  You may define both</div><div class=\"line\">    # sections and the aggregate nodes will be created for you.  Take care with</div><div class=\"line\">    # name collisions</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Template:</div><div class=\"line\">      Count: 1</div><div class=\"line\">      # Start: 5</div><div class=\"line\">      # Hostname: &#123;&#123;.Prefix&#125;&#125;&#123;&#123;.Index&#125;&#125; # default</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Users&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Count: The number of user accounts _in addition_ to Admin</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Users:</div><div class=\"line\">      Count: 1</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Org2: See &quot;Org1&quot; for full specification</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Org2</div><div class=\"line\">    Domain: org2.bits.com</div><div class=\"line\">    EnableNodeOUs: true</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    Template:</div><div class=\"line\">      Count: 1</div><div class=\"line\">    Users:</div><div class=\"line\">      Count: 1</div></pre></td></tr></table></figure>\n<h4 id=\"configtx-yaml文件\"><a href=\"#configtx-yaml文件\" class=\"headerlink\" title=\"configtx.yaml文件\"></a>configtx.yaml文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">---</div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   Section: Organizations</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the different organizational identities which will</div><div class=\"line\">#   be referenced later in the configuration.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Organizations:</div><div class=\"line\"></div><div class=\"line\">    # SampleOrg defines an MSP using the sampleconfig.  It should never be used</div><div class=\"line\">    # in production but may be used as a template for other definitions</div><div class=\"line\">    - &amp;OrdererOrg</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: OrdererOrg</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: OrdererMSP</div><div class=\"line\"></div><div class=\"line\">        # MSPDir is the filesystem path which contains the MSP configuration</div><div class=\"line\">        MSPDir: crypto-config/ordererOrganizations/bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.member&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.member&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">    - &amp;Org1</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: Org1MSP</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: Org1MSP</div><div class=\"line\"></div><div class=\"line\">        MSPDir: crypto-config/peerOrganizations/org1.bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;, &apos;Org1MSP.peer&apos;, &apos;Org1MSP.client&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;, &apos;Org1MSP.client&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">        AnchorPeers:</div><div class=\"line\">            # AnchorPeers defines the location of peers which can be used</div><div class=\"line\">            # for cross org gossip communication.  Note, this value is only</div><div class=\"line\">            # encoded in the genesis block in the Application section context</div><div class=\"line\">            - Host: peer0.org1.bits.com</div><div class=\"line\">              Port: 7051</div><div class=\"line\"></div><div class=\"line\">    - &amp;Org2</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: Org2MSP</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: Org2MSP</div><div class=\"line\"></div><div class=\"line\">        MSPDir: crypto-config/peerOrganizations/org2.bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;, &apos;Org2MSP.peer&apos;, &apos;Org2MSP.client&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;, &apos;Org2MSP.client&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">        AnchorPeers:</div><div class=\"line\">            # AnchorPeers defines the location of peers which can be used</div><div class=\"line\">            # for cross org gossip communication.  Note, this value is only</div><div class=\"line\">            # encoded in the genesis block in the Application section context</div><div class=\"line\">            - Host: peer0.org2.bits.com</div><div class=\"line\">              Port: 7051</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Capabilities</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the capabilities of fabric network. This is a new</div><div class=\"line\">#   concept as of v1.1.0 and should not be utilized in mixed networks with</div><div class=\"line\">#   v1.0.x peers and orderers.  Capabilities define features which must be</div><div class=\"line\">#   present in a fabric binary for that binary to safely participate in the</div><div class=\"line\">#   fabric network.  For instance, if a new MSP type is added, newer binaries</div><div class=\"line\">#   might recognize and validate the signatures from this type, while older</div><div class=\"line\">#   binaries without this support would be unable to validate those</div><div class=\"line\">#   transactions.  This could lead to different versions of the fabric binaries</div><div class=\"line\">#   having different world states.  Instead, defining a capability for a channel</div><div class=\"line\">#   informs those binaries without this capability that they must cease</div><div class=\"line\">#   processing transactions until they have been upgraded.  For v1.0.x if any</div><div class=\"line\">#   capabilities are defined (including a map with all capabilities turned off)</div><div class=\"line\">#   then the v1.0.x peer will deliberately crash.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Capabilities:</div><div class=\"line\">    # Channel capabilities apply to both the orderers and the peers and must be</div><div class=\"line\">    # supported by both.  Set the value of the capability to true to require it.</div><div class=\"line\">    Global: &amp;ChannelCapabilities</div><div class=\"line\">        # V1.1 for Global is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all orderers and peers running v1.0.x,</div><div class=\"line\">        # but the modification of which would cause incompatibilities.  Users</div><div class=\"line\">        # should leave this flag set to true.</div><div class=\"line\">        V1_1: true</div><div class=\"line\"></div><div class=\"line\">    # Orderer capabilities apply only to the orderers, and may be safely</div><div class=\"line\">    # manipulated without concern for upgrading peers.  Set the value of the</div><div class=\"line\">    # capability to true to require it.</div><div class=\"line\">    Orderer: &amp;OrdererCapabilities</div><div class=\"line\">        # V1.1 for Order is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all orderers running v1.0.x, but the</div><div class=\"line\">        # modification of which  would cause incompatibilities.  Users should</div><div class=\"line\">        # leave this flag set to true.</div><div class=\"line\">        V1_1: true</div><div class=\"line\"></div><div class=\"line\">    # Application capabilities apply only to the peer network, and may be safely</div><div class=\"line\">    # manipulated without concern for upgrading orderers.  Set the value of the</div><div class=\"line\">    # capability to true to require it.</div><div class=\"line\">    Application: &amp;ApplicationCapabilities</div><div class=\"line\">        # V1.1 for Application is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all peers running v1.0.x, but the</div><div class=\"line\">        # modification of which would cause incompatibilities.  Users should</div><div class=\"line\">        # leave this flag set to true.</div><div class=\"line\">        V1_2: true</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Application</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for application related parameters</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Application: &amp;ApplicationDefaults</div><div class=\"line\"></div><div class=\"line\">    # Organizations is the list of orgs which are defined as participants on</div><div class=\"line\">    # the application side of the network</div><div class=\"line\">    Organizations:</div><div class=\"line\"></div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Application policies, their canonical path is</div><div class=\"line\">    #   /Channel/Application/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the application level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *ApplicationCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Orderer</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for orderer related parameters</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Orderer: &amp;OrdererDefaults</div><div class=\"line\"></div><div class=\"line\">    # Orderer Type: The orderer implementation to start</div><div class=\"line\">    # Available types are &quot;solo&quot; and &quot;kafka&quot; and &quot;raft&quot;</div><div class=\"line\">    OrdererType: solo</div><div class=\"line\"></div><div class=\"line\">    Addresses:</div><div class=\"line\">        - orderer.bits.com:7050</div><div class=\"line\"></div><div class=\"line\">    # Batch Timeout: The amount of time to wait before creating a batch</div><div class=\"line\">    BatchTimeout: 2s</div><div class=\"line\"></div><div class=\"line\">    # Batch Size: Controls the number of messages batched into a block</div><div class=\"line\">    BatchSize:</div><div class=\"line\"></div><div class=\"line\">        # Max Message Count: The maximum number of messages to permit in a batch</div><div class=\"line\">        MaxMessageCount: 10</div><div class=\"line\"></div><div class=\"line\">        # Absolute Max Bytes: The absolute maximum number of bytes allowed for</div><div class=\"line\">        # the serialized messages in a batch.</div><div class=\"line\">        AbsoluteMaxBytes: 98 MB</div><div class=\"line\"></div><div class=\"line\">        # Preferred Max Bytes: The preferred maximum number of bytes allowed for</div><div class=\"line\">        # the serialized messages in a batch. A message larger than the preferred</div><div class=\"line\">        # max bytes will result in a batch larger than preferred max bytes.</div><div class=\"line\">        PreferredMaxBytes: 512 KB</div><div class=\"line\"></div><div class=\"line\">    Kafka:</div><div class=\"line\">        # Brokers: A list of Kafka brokers to which the orderer connects. Edit</div><div class=\"line\">        # this list to identify the brokers of the ordering service.</div><div class=\"line\">        # NOTE: Use IP:port notation.</div><div class=\"line\">        Brokers:</div><div class=\"line\">            - 127.0.0.1:9092</div><div class=\"line\"></div><div class=\"line\">    # Organizations is the list of orgs which are defined as participants on</div><div class=\"line\">    # the orderer side of the network</div><div class=\"line\">    Organizations:</div><div class=\"line\"></div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Orderer policies, their canonical path is</div><div class=\"line\">    #   /Channel/Orderer/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\">        # BlockValidation specifies what signatures must be included in the block</div><div class=\"line\">        # from the orderer for the peer to validate it.</div><div class=\"line\">        BlockValidation:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the orderer level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *OrdererCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   CHANNEL</div><div class=\"line\">#</div><div class=\"line\">#   This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for channel related parameters.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Channel: &amp;ChannelDefaults</div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Channel policies, their canonical path is</div><div class=\"line\">    #   /Channel/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        # Who may invoke the &apos;Deliver&apos; API</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        # Who may invoke the &apos;Broadcast&apos; API</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        # By default, who may modify elements at this config level</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the channel level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *ChannelCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   Profile</div><div class=\"line\">#</div><div class=\"line\">#   - Different configuration profiles may be encoded here to be specified</div><div class=\"line\">#   as parameters to the configtxgen tool</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Profiles:</div><div class=\"line\"></div><div class=\"line\">    TwoOrgsOrdererGenesis:</div><div class=\"line\">        &lt;&lt;: *ChannelDefaults</div><div class=\"line\">        Orderer:</div><div class=\"line\">            &lt;&lt;: *OrdererDefaults</div><div class=\"line\">            Organizations:</div><div class=\"line\">                - *OrdererOrg</div><div class=\"line\">        Consortiums:</div><div class=\"line\">            SampleConsortium:</div><div class=\"line\">                Organizations:</div><div class=\"line\">                    - *Org1</div><div class=\"line\">                    - *Org2</div><div class=\"line\">    TwoOrgsChannel:</div><div class=\"line\">        Consortium: SampleConsortium</div><div class=\"line\">        Application:</div><div class=\"line\">            &lt;&lt;: *ApplicationDefaults</div><div class=\"line\">            Organizations:</div><div class=\"line\">                - *Org1</div><div class=\"line\">                - *Org2</div></pre></td></tr></table></figure>\n<h4 id=\"生成公私钥和证书\"><a href=\"#生成公私钥和证书\" class=\"headerlink\" title=\"生成公私钥和证书\"></a>生成公私钥和证书</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./bin/cryptogen generate --config=./crypto-config.yaml</div></pre></td></tr></table></figure>\n<h4 id=\"生成创世区块\"><a href=\"#生成创世区块\" class=\"headerlink\" title=\"生成创世区块\"></a>生成创世区块</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir channel-artifacts</div><div class=\"line\">./bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block</div></pre></td></tr></table></figure>\n<h4 id=\"生成通道配置区块\"><a href=\"#生成通道配置区块\" class=\"headerlink\" title=\"生成通道配置区块\"></a>生成通道配置区块</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/bits-query.tx -channelID bits-query</div></pre></td></tr></table></figure>\n<h4 id=\"拷贝到别的电脑\"><a href=\"#拷贝到别的电脑\" class=\"headerlink\" title=\"拷贝到别的电脑\"></a>拷贝到别的电脑</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd ..</div><div class=\"line\">scp -r bits ubuntu@10.9.84.83:/data/bits</div></pre></td></tr></table></figure>\n<h2 id=\"部署order，配置docker-compose-orderer-yaml文件\"><a href=\"#部署order，配置docker-compose-orderer-yaml文件\" class=\"headerlink\" title=\"部署order，配置docker-compose-orderer.yaml文件\"></a>部署order，配置docker-compose-orderer.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\"></div><div class=\"line\">  orderer.example.com:</div><div class=\"line\">    container_name: orderer.bits.com</div><div class=\"line\">    image: hyperledger/fabric-orderer</div><div class=\"line\">    environment:</div><div class=\"line\">      - ORDERER_GENERAL_LOGLEVEL=debug</div><div class=\"line\">      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0</div><div class=\"line\">      - ORDERER_GENERAL_GENESISMETHOD=file</div><div class=\"line\">      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block</div><div class=\"line\">      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP</div><div class=\"line\">      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp</div><div class=\"line\">      # enabled TLS</div><div class=\"line\">      - ORDERER_GENERAL_TLS_ENABLED=true</div><div class=\"line\">      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key</div><div class=\"line\">      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt</div><div class=\"line\">      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</div><div class=\"line\">      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s</div><div class=\"line\">      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s</div><div class=\"line\">      - ORDERER_KAFKA_VERBOSE=true</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric</div><div class=\"line\">    command: orderer</div><div class=\"line\">    volumes:</div><div class=\"line\">      - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block</div><div class=\"line\">      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp:/var/hyperledger/orderer/msp</div><div class=\"line\">      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/:/var/hyperledger/orderer/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7050:7050</div></pre></td></tr></table></figure>\n<h4 id=\"启动Fabric-orderer排序服务\"><a href=\"#启动Fabric-orderer排序服务\" class=\"headerlink\" title=\"启动Fabric orderer排序服务\"></a>启动Fabric orderer排序服务</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-orderer.yaml up -d</div></pre></td></tr></table></figure>\n<h2 id=\"部署peer0-org1-bits-com-配置docker-compose-org1-peer0-yaml文件\"><a href=\"#部署peer0-org1-bits-com-配置docker-compose-org1-peer0-yaml文件\" class=\"headerlink\" title=\"部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件\"></a>部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\">  peer0.org1.bits.com:</div><div class=\"line\">    container_name: peer0.org1.bits.com</div><div class=\"line\">    image: hyperledger/fabric-peer</div><div class=\"line\">    environment:</div><div class=\"line\">      - CORE_PEER_ID=peer0.org1.bits.com</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_CHAINCODEADDRESS=peer0.org1.bits.com:7052</div><div class=\"line\">      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</div><div class=\"line\">      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org1MSP</div><div class=\"line\"></div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      # the following setting starts chaincode containers on the same</div><div class=\"line\">      # bridge network as the peers</div><div class=\"line\">      # https://docs.docker.com/compose/networking/</div><div class=\"line\">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default</div><div class=\"line\">      #- CORE_LOGGING_LEVEL=ERROR</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_USELEADERELECTION=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_ORGLEADER=false</div><div class=\"line\">      - CORE_PEER_PROFILE_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    command: peer node start</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp:/etc/hyperledger/fabric/msp</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls:/etc/hyperledger/fabric/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7051:7051</div><div class=\"line\">      - 7052:7052</div><div class=\"line\">      - 7053:7053</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">      - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\"></div><div class=\"line\">  cli:</div><div class=\"line\">    container_name: cli</div><div class=\"line\">    image: hyperledger/fabric-tools</div><div class=\"line\">    tty: true</div><div class=\"line\">    environment:</div><div class=\"line\">      - GOPATH=/opt/gopath</div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_ID=cli</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org1MSP</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt</div><div class=\"line\">      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go</div><div class=\"line\">        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/</div><div class=\"line\">        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</div><div class=\"line\">    depends_on:</div><div class=\"line\">       - peer0.org1.bits.com</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">       - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org1.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org2.bits.com:10.9.84.83&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"启动peer0-org1-bits-com\"><a href=\"#启动peer0-org1-bits-com\" class=\"headerlink\" title=\"启动peer0.org1.bits.com\"></a>启动peer0.org1.bits.com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-org1-peer0.yaml up -d</div></pre></td></tr></table></figure>\n<h4 id=\"进入容器\"><a href=\"#进入容器\" class=\"headerlink\" title=\"进入容器\"></a>进入容器</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it cli bash</div></pre></td></tr></table></figure>\n<h4 id=\"创建Channel通道\"><a href=\"#创建Channel通道\" class=\"headerlink\" title=\"创建Channel通道\"></a>创建Channel通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 因为创建通道需要通知orderer 所以设置oderer的tls证书</div><div class=\"line\">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem</div><div class=\"line\"></div><div class=\"line\">peer channel create -o orderer.bits.com:7050 -c bits-query -f ./channel-artifacts/bits-query.tx --tls --cafile $ORDERER_CA</div></pre></td></tr></table></figure>\n<h4 id=\"加入channel通道\"><a href=\"#加入channel通道\" class=\"headerlink\" title=\"加入channel通道\"></a>加入channel通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer channel join -b bits-query.block</div></pre></td></tr></table></figure>\n<h4 id=\"保存通道信息-需将通道信息拷贝至其他节点\"><a href=\"#保存通道信息-需将通道信息拷贝至其他节点\" class=\"headerlink\" title=\"保存通道信息,需将通道信息拷贝至其他节点\"></a>保存通道信息,需将通道信息拷贝至其他节点</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">#容器名</div><div class=\"line\">docker cp xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.block /data/bits/channel-artifacts</div><div class=\"line\"></div><div class=\"line\">scp -r /data/bits xxx:/data</div></pre></td></tr></table></figure>\n<h4 id=\"打包智能合约\"><a href=\"#打包智能合约\" class=\"headerlink\" title=\"打包智能合约\"></a>打包智能合约</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 每台机器单独安装的话，里面的编号不一致，所以打包好后，去有需要的节点再安装</div><div class=\"line\"></div><div class=\"line\">peer chaincode package -n bits-query -p query/cmd/ -v 1.0 bits-query.pak</div><div class=\"line\"></div><div class=\"line\">docker cp xxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.pak /data/bits/channel-artifacts</div></pre></td></tr></table></figure>\n<h4 id=\"peer0-org1-bits-com安装\"><a href=\"#peer0-org1-bits-com安装\" class=\"headerlink\" title=\"peer0.org1.bits.com安装\"></a>peer0.org1.bits.com安装</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode install bits-query.pak</div></pre></td></tr></table></figure>\n<h2 id=\"部署peer0-org2-bits-com-配置docker-compose-org2-peer0-yaml文件\"><a href=\"#部署peer0-org2-bits-com-配置docker-compose-org2-peer0-yaml文件\" class=\"headerlink\" title=\"部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件\"></a>部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\">  peer0.org2.bits.com:</div><div class=\"line\">    container_name: peer0.org2.bits.com</div><div class=\"line\">    image: hyperledger/fabric-peer</div><div class=\"line\">    environment:</div><div class=\"line\">      - CORE_PEER_ID=peer0.org2.bits.com</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_CHAINCODEADDRESS=peer0.org2.bits.com:7052</div><div class=\"line\">      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</div><div class=\"line\">      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org2MSP</div><div class=\"line\"></div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      # the following setting starts chaincode containers on the same</div><div class=\"line\">      # bridge network as the peers</div><div class=\"line\">      # https://docs.docker.com/compose/networking/</div><div class=\"line\">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default</div><div class=\"line\">      #- CORE_LOGGING_LEVEL=ERROR</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_USELEADERELECTION=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_ORGLEADER=false</div><div class=\"line\">      - CORE_PEER_PROFILE_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    command: peer node start</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp:/etc/hyperledger/fabric/msp</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls:/etc/hyperledger/fabric/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7051:7051</div><div class=\"line\">      - 7052:7052</div><div class=\"line\">      - 7053:7053</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">      - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\"></div><div class=\"line\">  cli:</div><div class=\"line\">    container_name: cli</div><div class=\"line\">    image: hyperledger/fabric-tools</div><div class=\"line\">    tty: true</div><div class=\"line\">    environment:</div><div class=\"line\">      - GOPATH=/opt/gopath</div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_ID=cli</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org2MSP</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt</div><div class=\"line\">      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go</div><div class=\"line\">        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/</div><div class=\"line\">        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</div><div class=\"line\">    depends_on:</div><div class=\"line\">       - peer0.org2.bits.com</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">       - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org1.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org2.bits.com:10.9.84.83&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"启动peer0-org2-bits-com\"><a href=\"#启动peer0-org2-bits-com\" class=\"headerlink\" title=\"启动peer0.org2.bits.com\"></a>启动peer0.org2.bits.com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-org2-peer0.yaml up -d</div></pre></td></tr></table></figure>\n<h4 id=\"进入容器-1\"><a href=\"#进入容器-1\" class=\"headerlink\" title=\"进入容器\"></a>进入容器</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it cli bash</div></pre></td></tr></table></figure>\n<h4 id=\"加入通道\"><a href=\"#加入通道\" class=\"headerlink\" title=\"加入通道\"></a>加入通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker cp /data/bits/channel-artifacts/bits-query.block xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/</div><div class=\"line\"></div><div class=\"line\">peer channel join -b bits-query.block</div></pre></td></tr></table></figure>\n<h4 id=\"peer0-org2-bits-com安装\"><a href=\"#peer0-org2-bits-com安装\" class=\"headerlink\" title=\"peer0.org2.bits.com安装\"></a>peer0.org2.bits.com安装</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker cp /data/bits/channel-artifacts/bits-query.pak xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/</div><div class=\"line\">##安装</div><div class=\"line\">peer chaincode install bits-query.pak</div><div class=\"line\">##查看是否安装成功</div><div class=\"line\">peer chaincode list --installed</div><div class=\"line\">peer chaincode list --instantiated -C bits-query</div></pre></td></tr></table></figure>\n<h2 id=\"调用\"><a href=\"#调用\" class=\"headerlink\" title=\"调用\"></a>调用</h2><h3 id=\"添加数据\"><a href=\"#添加数据\" class=\"headerlink\" title=\"添加数据\"></a>添加数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">&lt;!--peer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C bits-query -n bit-query -v 1.0 -c &apos;&#123;&quot;Args&quot;:[&quot;init&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;]&#125;&apos; -P &quot;OR (&apos;Org1MSP.peer&apos;,&apos;Org2MSP.peer&apos;)&quot;--&gt;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">peer chaincode invoke --tls --cafile $ORDERER_CA -C bits-query -n bits-query -c &apos;&#123;&quot;Args&quot;:[&quot;put&quot;,&quot;&#123;\\&quot;queryId\\&quot;:233,\\&quot;indexDigest\\&quot;:\\&quot;indexDigest\\&quot;,\\&quot;provideQueryOrg\\&quot;:\\&quot;provideQueryOrg\\&quot;,\\&quot;offerOrg\\&quot;:\\&quot;offerOrg\\&quot;,\\&quot;queryTime\\&quot;:\\&quot;queryTime\\&quot;,\\&quot;queryType\\&quot;:11,\\&quot;queryResult\\&quot;:11,\\&quot;querySerial\\&quot;:\\&quot;querySerial\\&quot;,\\&quot;hit\\&quot;:1&#125;&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<h3 id=\"查看数据\"><a href=\"#查看数据\" class=\"headerlink\" title=\"查看数据\"></a>查看数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode query  -C bits-query -n bits-query -c &apos;&#123;&quot;Args&quot;:[&quot;query&quot;,&quot;222&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<!--\n<!--peer chaincode install -n mycc -p github.com/hyperledger/fabric/multipeer/chaincode/go/example02/cmd/ -v 1.0\n\n peer chaincode install -n mycc -p github.com/hyperledger/fabric/bits/chaincode/go/example02/cmd/ -v 1.0\n\n\npeer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n mycc -v 1.0 -c '{\"Args\":[\"init\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"\n\n\n\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n\n\n\ndocker cp /data/bits/mychannel.block 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\ndocker cp /data/bits/mycc.pak 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b mychannel.block\n\npeer chaincode install mycc.pak\n\n\npeer chaincode list --installed\n\n\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C mychannel -n mycc -c '{\"Args\":[\"invoke\",\"a\",\"b\",\"10\"]}'\n\n\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"a\"]}'-->\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"机器准备\"><a href=\"#机器准备\" class=\"headerlink\" title=\"机器准备\"></a>机器准备</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">功能</th>\n<th style=\"text-align:center\">ip</th>\n<th style=\"text-align:right\">机器名称</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">orderer</td>\n<td style=\"text-align:center\">10.9.149.68</td>\n<td style=\"text-align:right\">order.bits.com</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">peer0</td>\n<td style=\"text-align:center\">10.9.149.68</td>\n<td style=\"text-align:right\">peer0.org1.bits.com</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">peer0</td>\n<td style=\"text-align:center\">10.9.84.83</td>\n<td style=\"text-align:right\">peer0.org2.bits.com</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"创建目录\"><a href=\"#创建目录\" class=\"headerlink\" title=\"创建目录\"></a>创建目录</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir bits</div><div class=\"line\">cd bits</div></pre></td></tr></table></figure>\n<h3 id=\"获取生成工具\"><a href=\"#获取生成工具\" class=\"headerlink\" title=\"获取生成工具\"></a>获取生成工具</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">把下载的hyperledger-fabric-linux-amd64-1.4.1.tar.gz二进制文件包解压，</div><div class=\"line\">把其中的bin目录拷贝到bits目录下。</div><div class=\"line\">设置权限：chmod -R 777 ./bin</div></pre></td></tr></table></figure>\n<h3 id=\"准备生成证书和区块配置文件\"><a href=\"#准备生成证书和区块配置文件\" class=\"headerlink\" title=\"准备生成证书和区块配置文件\"></a>准备生成证书和区块配置文件</h3><p>配置crypto-config.yaml和configtx.yaml文件，拷贝到bits目录下。</p>\n<h4 id=\"crypto-config-yaml-文件\"><a href=\"#crypto-config-yaml-文件\" class=\"headerlink\" title=\"crypto-config.yaml 文件\"></a>crypto-config.yaml 文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\"># &quot;OrdererOrgs&quot; - Definition of organizations managing orderer nodes</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\">OrdererOrgs:</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Orderer</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Orderer</div><div class=\"line\">    Domain: bits.com</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Specs&quot; - See PeerOrgs below for complete description</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Specs:</div><div class=\"line\">      - Hostname: orderer</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\"># &quot;PeerOrgs&quot; - Definition of organizations managing peer nodes</div><div class=\"line\"># ---------------------------------------------------------------------------</div><div class=\"line\">PeerOrgs:</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Org1</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Org1</div><div class=\"line\">    Domain: org1.bits.com</div><div class=\"line\">    EnableNodeOUs: true</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Specs&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Uncomment this section to enable the explicit definition of hosts in your</div><div class=\"line\">    # configuration.  Most users will want to use Template, below</div><div class=\"line\">    #</div><div class=\"line\">    # Specs is an array of Spec entries.  Each Spec entry consists of two fields:</div><div class=\"line\">    #   - Hostname:   (Required) The desired hostname, sans the domain.</div><div class=\"line\">    #   - CommonName: (Optional) Specifies the template or explicit override for</div><div class=\"line\">    #                 the CN.  By default, this is the template:</div><div class=\"line\">    #</div><div class=\"line\">    #                              &quot;&#123;&#123;.Hostname&#125;&#125;.&#123;&#123;.Domain&#125;&#125;&quot;</div><div class=\"line\">    #</div><div class=\"line\">    #                 which obtains its values from the Spec.Hostname and</div><div class=\"line\">    #                 Org.Domain, respectively.</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Specs:</div><div class=\"line\">    #   - Hostname: foo # implicitly &quot;foo.org1.example.com&quot;</div><div class=\"line\">    #     CommonName: foo27.org5.example.com # overrides Hostname-based FQDN set above</div><div class=\"line\">    #   - Hostname: bar</div><div class=\"line\">    #   - Hostname: baz</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Template&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Allows for the definition of 1 or more hosts that are created sequentially</div><div class=\"line\">    # from a template. By default, this looks like &quot;peer%d&quot; from 0 to Count-1.</div><div class=\"line\">    # You may override the number of nodes (Count), the starting index (Start)</div><div class=\"line\">    # or the template used to construct the name (Hostname).</div><div class=\"line\">    #</div><div class=\"line\">    # Note: Template and Specs are not mutually exclusive.  You may define both</div><div class=\"line\">    # sections and the aggregate nodes will be created for you.  Take care with</div><div class=\"line\">    # name collisions</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Template:</div><div class=\"line\">      Count: 1</div><div class=\"line\">      # Start: 5</div><div class=\"line\">      # Hostname: &#123;&#123;.Prefix&#125;&#125;&#123;&#123;.Index&#125;&#125; # default</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # &quot;Users&quot;</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    # Count: The number of user accounts _in addition_ to Admin</div><div class=\"line\">    # ---------------------------------------------------------------------------</div><div class=\"line\">    Users:</div><div class=\"line\">      Count: 1</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  # Org2: See &quot;Org1&quot; for full specification</div><div class=\"line\">  # ---------------------------------------------------------------------------</div><div class=\"line\">  - Name: Org2</div><div class=\"line\">    Domain: org2.bits.com</div><div class=\"line\">    EnableNodeOUs: true</div><div class=\"line\">    CA:</div><div class=\"line\">        Country: US</div><div class=\"line\">        Province: California</div><div class=\"line\">        Locality: San Francisco</div><div class=\"line\">    Template:</div><div class=\"line\">      Count: 1</div><div class=\"line\">    Users:</div><div class=\"line\">      Count: 1</div></pre></td></tr></table></figure>\n<h4 id=\"configtx-yaml文件\"><a href=\"#configtx-yaml文件\" class=\"headerlink\" title=\"configtx.yaml文件\"></a>configtx.yaml文件</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">---</div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   Section: Organizations</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the different organizational identities which will</div><div class=\"line\">#   be referenced later in the configuration.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Organizations:</div><div class=\"line\"></div><div class=\"line\">    # SampleOrg defines an MSP using the sampleconfig.  It should never be used</div><div class=\"line\">    # in production but may be used as a template for other definitions</div><div class=\"line\">    - &amp;OrdererOrg</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: OrdererOrg</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: OrdererMSP</div><div class=\"line\"></div><div class=\"line\">        # MSPDir is the filesystem path which contains the MSP configuration</div><div class=\"line\">        MSPDir: crypto-config/ordererOrganizations/bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.member&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.member&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;OrdererMSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">    - &amp;Org1</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: Org1MSP</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: Org1MSP</div><div class=\"line\"></div><div class=\"line\">        MSPDir: crypto-config/peerOrganizations/org1.bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;, &apos;Org1MSP.peer&apos;, &apos;Org1MSP.client&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;, &apos;Org1MSP.client&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org1MSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">        AnchorPeers:</div><div class=\"line\">            # AnchorPeers defines the location of peers which can be used</div><div class=\"line\">            # for cross org gossip communication.  Note, this value is only</div><div class=\"line\">            # encoded in the genesis block in the Application section context</div><div class=\"line\">            - Host: peer0.org1.bits.com</div><div class=\"line\">              Port: 7051</div><div class=\"line\"></div><div class=\"line\">    - &amp;Org2</div><div class=\"line\">        # DefaultOrg defines the organization which is used in the sampleconfig</div><div class=\"line\">        # of the fabric.git development environment</div><div class=\"line\">        Name: Org2MSP</div><div class=\"line\"></div><div class=\"line\">        # ID to load the MSP definition as</div><div class=\"line\">        ID: Org2MSP</div><div class=\"line\"></div><div class=\"line\">        MSPDir: crypto-config/peerOrganizations/org2.bits.com/msp</div><div class=\"line\"></div><div class=\"line\">        # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">        # For organization policies, their canonical path is usually</div><div class=\"line\">        #   /Channel/&lt;Application|Orderer&gt;/&lt;OrgName&gt;/&lt;PolicyName&gt;</div><div class=\"line\">        Policies:</div><div class=\"line\">            Readers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;, &apos;Org2MSP.peer&apos;, &apos;Org2MSP.client&apos;)&quot;</div><div class=\"line\">            Writers:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;, &apos;Org2MSP.client&apos;)&quot;</div><div class=\"line\">            Admins:</div><div class=\"line\">                Type: Signature</div><div class=\"line\">                Rule: &quot;OR(&apos;Org2MSP.admin&apos;)&quot;</div><div class=\"line\"></div><div class=\"line\">        AnchorPeers:</div><div class=\"line\">            # AnchorPeers defines the location of peers which can be used</div><div class=\"line\">            # for cross org gossip communication.  Note, this value is only</div><div class=\"line\">            # encoded in the genesis block in the Application section context</div><div class=\"line\">            - Host: peer0.org2.bits.com</div><div class=\"line\">              Port: 7051</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Capabilities</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the capabilities of fabric network. This is a new</div><div class=\"line\">#   concept as of v1.1.0 and should not be utilized in mixed networks with</div><div class=\"line\">#   v1.0.x peers and orderers.  Capabilities define features which must be</div><div class=\"line\">#   present in a fabric binary for that binary to safely participate in the</div><div class=\"line\">#   fabric network.  For instance, if a new MSP type is added, newer binaries</div><div class=\"line\">#   might recognize and validate the signatures from this type, while older</div><div class=\"line\">#   binaries without this support would be unable to validate those</div><div class=\"line\">#   transactions.  This could lead to different versions of the fabric binaries</div><div class=\"line\">#   having different world states.  Instead, defining a capability for a channel</div><div class=\"line\">#   informs those binaries without this capability that they must cease</div><div class=\"line\">#   processing transactions until they have been upgraded.  For v1.0.x if any</div><div class=\"line\">#   capabilities are defined (including a map with all capabilities turned off)</div><div class=\"line\">#   then the v1.0.x peer will deliberately crash.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Capabilities:</div><div class=\"line\">    # Channel capabilities apply to both the orderers and the peers and must be</div><div class=\"line\">    # supported by both.  Set the value of the capability to true to require it.</div><div class=\"line\">    Global: &amp;ChannelCapabilities</div><div class=\"line\">        # V1.1 for Global is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all orderers and peers running v1.0.x,</div><div class=\"line\">        # but the modification of which would cause incompatibilities.  Users</div><div class=\"line\">        # should leave this flag set to true.</div><div class=\"line\">        V1_1: true</div><div class=\"line\"></div><div class=\"line\">    # Orderer capabilities apply only to the orderers, and may be safely</div><div class=\"line\">    # manipulated without concern for upgrading peers.  Set the value of the</div><div class=\"line\">    # capability to true to require it.</div><div class=\"line\">    Orderer: &amp;OrdererCapabilities</div><div class=\"line\">        # V1.1 for Order is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all orderers running v1.0.x, but the</div><div class=\"line\">        # modification of which  would cause incompatibilities.  Users should</div><div class=\"line\">        # leave this flag set to true.</div><div class=\"line\">        V1_1: true</div><div class=\"line\"></div><div class=\"line\">    # Application capabilities apply only to the peer network, and may be safely</div><div class=\"line\">    # manipulated without concern for upgrading orderers.  Set the value of the</div><div class=\"line\">    # capability to true to require it.</div><div class=\"line\">    Application: &amp;ApplicationCapabilities</div><div class=\"line\">        # V1.1 for Application is a catchall flag for behavior which has been</div><div class=\"line\">        # determined to be desired for all peers running v1.0.x, but the</div><div class=\"line\">        # modification of which would cause incompatibilities.  Users should</div><div class=\"line\">        # leave this flag set to true.</div><div class=\"line\">        V1_2: true</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Application</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for application related parameters</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Application: &amp;ApplicationDefaults</div><div class=\"line\"></div><div class=\"line\">    # Organizations is the list of orgs which are defined as participants on</div><div class=\"line\">    # the application side of the network</div><div class=\"line\">    Organizations:</div><div class=\"line\"></div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Application policies, their canonical path is</div><div class=\"line\">    #   /Channel/Application/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the application level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *ApplicationCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   SECTION: Orderer</div><div class=\"line\">#</div><div class=\"line\">#   - This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for orderer related parameters</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Orderer: &amp;OrdererDefaults</div><div class=\"line\"></div><div class=\"line\">    # Orderer Type: The orderer implementation to start</div><div class=\"line\">    # Available types are &quot;solo&quot; and &quot;kafka&quot; and &quot;raft&quot;</div><div class=\"line\">    OrdererType: solo</div><div class=\"line\"></div><div class=\"line\">    Addresses:</div><div class=\"line\">        - orderer.bits.com:7050</div><div class=\"line\"></div><div class=\"line\">    # Batch Timeout: The amount of time to wait before creating a batch</div><div class=\"line\">    BatchTimeout: 2s</div><div class=\"line\"></div><div class=\"line\">    # Batch Size: Controls the number of messages batched into a block</div><div class=\"line\">    BatchSize:</div><div class=\"line\"></div><div class=\"line\">        # Max Message Count: The maximum number of messages to permit in a batch</div><div class=\"line\">        MaxMessageCount: 10</div><div class=\"line\"></div><div class=\"line\">        # Absolute Max Bytes: The absolute maximum number of bytes allowed for</div><div class=\"line\">        # the serialized messages in a batch.</div><div class=\"line\">        AbsoluteMaxBytes: 98 MB</div><div class=\"line\"></div><div class=\"line\">        # Preferred Max Bytes: The preferred maximum number of bytes allowed for</div><div class=\"line\">        # the serialized messages in a batch. A message larger than the preferred</div><div class=\"line\">        # max bytes will result in a batch larger than preferred max bytes.</div><div class=\"line\">        PreferredMaxBytes: 512 KB</div><div class=\"line\"></div><div class=\"line\">    Kafka:</div><div class=\"line\">        # Brokers: A list of Kafka brokers to which the orderer connects. Edit</div><div class=\"line\">        # this list to identify the brokers of the ordering service.</div><div class=\"line\">        # NOTE: Use IP:port notation.</div><div class=\"line\">        Brokers:</div><div class=\"line\">            - 127.0.0.1:9092</div><div class=\"line\"></div><div class=\"line\">    # Organizations is the list of orgs which are defined as participants on</div><div class=\"line\">    # the orderer side of the network</div><div class=\"line\">    Organizations:</div><div class=\"line\"></div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Orderer policies, their canonical path is</div><div class=\"line\">    #   /Channel/Orderer/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\">        # BlockValidation specifies what signatures must be included in the block</div><div class=\"line\">        # from the orderer for the peer to validate it.</div><div class=\"line\">        BlockValidation:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the orderer level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *OrdererCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   CHANNEL</div><div class=\"line\">#</div><div class=\"line\">#   This section defines the values to encode into a config transaction or</div><div class=\"line\">#   genesis block for channel related parameters.</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Channel: &amp;ChannelDefaults</div><div class=\"line\">    # Policies defines the set of policies at this level of the config tree</div><div class=\"line\">    # For Channel policies, their canonical path is</div><div class=\"line\">    #   /Channel/&lt;PolicyName&gt;</div><div class=\"line\">    Policies:</div><div class=\"line\">        # Who may invoke the &apos;Deliver&apos; API</div><div class=\"line\">        Readers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Readers&quot;</div><div class=\"line\">        # Who may invoke the &apos;Broadcast&apos; API</div><div class=\"line\">        Writers:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;ANY Writers&quot;</div><div class=\"line\">        # By default, who may modify elements at this config level</div><div class=\"line\">        Admins:</div><div class=\"line\">            Type: ImplicitMeta</div><div class=\"line\">            Rule: &quot;MAJORITY Admins&quot;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    # Capabilities describes the channel level capabilities, see the</div><div class=\"line\">    # dedicated Capabilities section elsewhere in this file for a full</div><div class=\"line\">    # description</div><div class=\"line\">    Capabilities:</div><div class=\"line\">        &lt;&lt;: *ChannelCapabilities</div><div class=\"line\"></div><div class=\"line\">################################################################################</div><div class=\"line\">#</div><div class=\"line\">#   Profile</div><div class=\"line\">#</div><div class=\"line\">#   - Different configuration profiles may be encoded here to be specified</div><div class=\"line\">#   as parameters to the configtxgen tool</div><div class=\"line\">#</div><div class=\"line\">################################################################################</div><div class=\"line\">Profiles:</div><div class=\"line\"></div><div class=\"line\">    TwoOrgsOrdererGenesis:</div><div class=\"line\">        &lt;&lt;: *ChannelDefaults</div><div class=\"line\">        Orderer:</div><div class=\"line\">            &lt;&lt;: *OrdererDefaults</div><div class=\"line\">            Organizations:</div><div class=\"line\">                - *OrdererOrg</div><div class=\"line\">        Consortiums:</div><div class=\"line\">            SampleConsortium:</div><div class=\"line\">                Organizations:</div><div class=\"line\">                    - *Org1</div><div class=\"line\">                    - *Org2</div><div class=\"line\">    TwoOrgsChannel:</div><div class=\"line\">        Consortium: SampleConsortium</div><div class=\"line\">        Application:</div><div class=\"line\">            &lt;&lt;: *ApplicationDefaults</div><div class=\"line\">            Organizations:</div><div class=\"line\">                - *Org1</div><div class=\"line\">                - *Org2</div></pre></td></tr></table></figure>\n<h4 id=\"生成公私钥和证书\"><a href=\"#生成公私钥和证书\" class=\"headerlink\" title=\"生成公私钥和证书\"></a>生成公私钥和证书</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./bin/cryptogen generate --config=./crypto-config.yaml</div></pre></td></tr></table></figure>\n<h4 id=\"生成创世区块\"><a href=\"#生成创世区块\" class=\"headerlink\" title=\"生成创世区块\"></a>生成创世区块</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir channel-artifacts</div><div class=\"line\">./bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block</div></pre></td></tr></table></figure>\n<h4 id=\"生成通道配置区块\"><a href=\"#生成通道配置区块\" class=\"headerlink\" title=\"生成通道配置区块\"></a>生成通道配置区块</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/bits-query.tx -channelID bits-query</div></pre></td></tr></table></figure>\n<h4 id=\"拷贝到别的电脑\"><a href=\"#拷贝到别的电脑\" class=\"headerlink\" title=\"拷贝到别的电脑\"></a>拷贝到别的电脑</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd ..</div><div class=\"line\">scp -r bits ubuntu@10.9.84.83:/data/bits</div></pre></td></tr></table></figure>\n<h2 id=\"部署order，配置docker-compose-orderer-yaml文件\"><a href=\"#部署order，配置docker-compose-orderer-yaml文件\" class=\"headerlink\" title=\"部署order，配置docker-compose-orderer.yaml文件\"></a>部署order，配置docker-compose-orderer.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\"></div><div class=\"line\">  orderer.example.com:</div><div class=\"line\">    container_name: orderer.bits.com</div><div class=\"line\">    image: hyperledger/fabric-orderer</div><div class=\"line\">    environment:</div><div class=\"line\">      - ORDERER_GENERAL_LOGLEVEL=debug</div><div class=\"line\">      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0</div><div class=\"line\">      - ORDERER_GENERAL_GENESISMETHOD=file</div><div class=\"line\">      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block</div><div class=\"line\">      - ORDERER_GENERAL_LOCALMSPID=OrdererMSP</div><div class=\"line\">      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp</div><div class=\"line\">      # enabled TLS</div><div class=\"line\">      - ORDERER_GENERAL_TLS_ENABLED=true</div><div class=\"line\">      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key</div><div class=\"line\">      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt</div><div class=\"line\">      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</div><div class=\"line\">      - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s</div><div class=\"line\">      - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s</div><div class=\"line\">      - ORDERER_KAFKA_VERBOSE=true</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric</div><div class=\"line\">    command: orderer</div><div class=\"line\">    volumes:</div><div class=\"line\">      - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block</div><div class=\"line\">      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp:/var/hyperledger/orderer/msp</div><div class=\"line\">      - ./crypto-config/ordererOrganizations/bits.com/orderers/orderer.bits.com/tls/:/var/hyperledger/orderer/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7050:7050</div></pre></td></tr></table></figure>\n<h4 id=\"启动Fabric-orderer排序服务\"><a href=\"#启动Fabric-orderer排序服务\" class=\"headerlink\" title=\"启动Fabric orderer排序服务\"></a>启动Fabric orderer排序服务</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-orderer.yaml up -d</div></pre></td></tr></table></figure>\n<h2 id=\"部署peer0-org1-bits-com-配置docker-compose-org1-peer0-yaml文件\"><a href=\"#部署peer0-org1-bits-com-配置docker-compose-org1-peer0-yaml文件\" class=\"headerlink\" title=\"部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件\"></a>部署peer0.org1.bits.com,配置docker-compose-org1-peer0.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\">  peer0.org1.bits.com:</div><div class=\"line\">    container_name: peer0.org1.bits.com</div><div class=\"line\">    image: hyperledger/fabric-peer</div><div class=\"line\">    environment:</div><div class=\"line\">      - CORE_PEER_ID=peer0.org1.bits.com</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_CHAINCODEADDRESS=peer0.org1.bits.com:7052</div><div class=\"line\">      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</div><div class=\"line\">      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org1MSP</div><div class=\"line\"></div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      # the following setting starts chaincode containers on the same</div><div class=\"line\">      # bridge network as the peers</div><div class=\"line\">      # https://docs.docker.com/compose/networking/</div><div class=\"line\">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default</div><div class=\"line\">      #- CORE_LOGGING_LEVEL=ERROR</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_USELEADERELECTION=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_ORGLEADER=false</div><div class=\"line\">      - CORE_PEER_PROFILE_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    command: peer node start</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/msp:/etc/hyperledger/fabric/msp</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls:/etc/hyperledger/fabric/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7051:7051</div><div class=\"line\">      - 7052:7052</div><div class=\"line\">      - 7053:7053</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">      - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\"></div><div class=\"line\">  cli:</div><div class=\"line\">    container_name: cli</div><div class=\"line\">    image: hyperledger/fabric-tools</div><div class=\"line\">    tty: true</div><div class=\"line\">    environment:</div><div class=\"line\">      - GOPATH=/opt/gopath</div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_ID=cli</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org1.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org1MSP</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/peers/peer0.org1.bits.com/tls/ca.crt</div><div class=\"line\">      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.bits.com/users/Admin@org1.bits.com/msp</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go</div><div class=\"line\">        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/</div><div class=\"line\">        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</div><div class=\"line\">    depends_on:</div><div class=\"line\">       - peer0.org1.bits.com</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">       - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org1.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org2.bits.com:10.9.84.83&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"启动peer0-org1-bits-com\"><a href=\"#启动peer0-org1-bits-com\" class=\"headerlink\" title=\"启动peer0.org1.bits.com\"></a>启动peer0.org1.bits.com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-org1-peer0.yaml up -d</div></pre></td></tr></table></figure>\n<h4 id=\"进入容器\"><a href=\"#进入容器\" class=\"headerlink\" title=\"进入容器\"></a>进入容器</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it cli bash</div></pre></td></tr></table></figure>\n<h4 id=\"创建Channel通道\"><a href=\"#创建Channel通道\" class=\"headerlink\" title=\"创建Channel通道\"></a>创建Channel通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 因为创建通道需要通知orderer 所以设置oderer的tls证书</div><div class=\"line\">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem</div><div class=\"line\"></div><div class=\"line\">peer channel create -o orderer.bits.com:7050 -c bits-query -f ./channel-artifacts/bits-query.tx --tls --cafile $ORDERER_CA</div></pre></td></tr></table></figure>\n<h4 id=\"加入channel通道\"><a href=\"#加入channel通道\" class=\"headerlink\" title=\"加入channel通道\"></a>加入channel通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer channel join -b bits-query.block</div></pre></td></tr></table></figure>\n<h4 id=\"保存通道信息-需将通道信息拷贝至其他节点\"><a href=\"#保存通道信息-需将通道信息拷贝至其他节点\" class=\"headerlink\" title=\"保存通道信息,需将通道信息拷贝至其他节点\"></a>保存通道信息,需将通道信息拷贝至其他节点</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">#容器名</div><div class=\"line\">docker cp xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.block /data/bits/channel-artifacts</div><div class=\"line\"></div><div class=\"line\">scp -r /data/bits xxx:/data</div></pre></td></tr></table></figure>\n<h4 id=\"打包智能合约\"><a href=\"#打包智能合约\" class=\"headerlink\" title=\"打包智能合约\"></a>打包智能合约</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 每台机器单独安装的话，里面的编号不一致，所以打包好后，去有需要的节点再安装</div><div class=\"line\"></div><div class=\"line\">peer chaincode package -n bits-query -p query/cmd/ -v 1.0 bits-query.pak</div><div class=\"line\"></div><div class=\"line\">docker cp xxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/bits-query.pak /data/bits/channel-artifacts</div></pre></td></tr></table></figure>\n<h4 id=\"peer0-org1-bits-com安装\"><a href=\"#peer0-org1-bits-com安装\" class=\"headerlink\" title=\"peer0.org1.bits.com安装\"></a>peer0.org1.bits.com安装</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode install bits-query.pak</div></pre></td></tr></table></figure>\n<h2 id=\"部署peer0-org2-bits-com-配置docker-compose-org2-peer0-yaml文件\"><a href=\"#部署peer0-org2-bits-com-配置docker-compose-org2-peer0-yaml文件\" class=\"headerlink\" title=\"部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件\"></a>部署peer0.org2.bits.com,配置docker-compose-org2-peer0.yaml文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Copyright IBM Corp. All Rights Reserved.</div><div class=\"line\">#</div><div class=\"line\"># SPDX-License-Identifier: Apache-2.0</div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">version: &apos;2&apos;</div><div class=\"line\"></div><div class=\"line\">services:</div><div class=\"line\">  peer0.org2.bits.com:</div><div class=\"line\">    container_name: peer0.org2.bits.com</div><div class=\"line\">    image: hyperledger/fabric-peer</div><div class=\"line\">    environment:</div><div class=\"line\">      - CORE_PEER_ID=peer0.org2.bits.com</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_CHAINCODEADDRESS=peer0.org2.bits.com:7052</div><div class=\"line\">      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</div><div class=\"line\">      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org2MSP</div><div class=\"line\"></div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      # the following setting starts chaincode containers on the same</div><div class=\"line\">      # bridge network as the peers</div><div class=\"line\">      # https://docs.docker.com/compose/networking/</div><div class=\"line\">      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=bits_default</div><div class=\"line\">      #- CORE_LOGGING_LEVEL=ERROR</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_USELEADERELECTION=true</div><div class=\"line\">      - CORE_PEER_GOSSIP_ORGLEADER=false</div><div class=\"line\">      - CORE_PEER_PROFILE_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    command: peer node start</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/msp:/etc/hyperledger/fabric/msp</div><div class=\"line\">        - ./crypto-config/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls:/etc/hyperledger/fabric/tls</div><div class=\"line\">    ports:</div><div class=\"line\">      - 7051:7051</div><div class=\"line\">      - 7052:7052</div><div class=\"line\">      - 7053:7053</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">      - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\"></div><div class=\"line\">  cli:</div><div class=\"line\">    container_name: cli</div><div class=\"line\">    image: hyperledger/fabric-tools</div><div class=\"line\">    tty: true</div><div class=\"line\">    environment:</div><div class=\"line\">      - GOPATH=/opt/gopath</div><div class=\"line\">      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</div><div class=\"line\">      - CORE_LOGGING_LEVEL=DEBUG</div><div class=\"line\">      - CORE_PEER_ID=cli</div><div class=\"line\">      - CORE_PEER_ADDRESS=peer0.org2.bits.com:7051</div><div class=\"line\">      - CORE_PEER_LOCALMSPID=Org2MSP</div><div class=\"line\">      - CORE_PEER_TLS_ENABLED=true</div><div class=\"line\">      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.crt</div><div class=\"line\">      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/server.key</div><div class=\"line\">      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/peers/peer0.org2.bits.com/tls/ca.crt</div><div class=\"line\">      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.bits.com/users/Admin@org2.bits.com/msp</div><div class=\"line\">    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</div><div class=\"line\">    volumes:</div><div class=\"line\">        - /var/run/:/host/var/run/</div><div class=\"line\">        - ./chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric/bits/chaincode/go</div><div class=\"line\">        - ./crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/</div><div class=\"line\">        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</div><div class=\"line\">    depends_on:</div><div class=\"line\">       - peer0.org2.bits.com</div><div class=\"line\">    extra_hosts:</div><div class=\"line\">       - &quot;orderer.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org1.bits.com:10.9.149.68&quot;</div><div class=\"line\">       - &quot;peer0.org2.bits.com:10.9.84.83&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"启动peer0-org2-bits-com\"><a href=\"#启动peer0-org2-bits-com\" class=\"headerlink\" title=\"启动peer0.org2.bits.com\"></a>启动peer0.org2.bits.com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose-org2-peer0.yaml up -d</div></pre></td></tr></table></figure>\n<h4 id=\"进入容器-1\"><a href=\"#进入容器-1\" class=\"headerlink\" title=\"进入容器\"></a>进入容器</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it cli bash</div></pre></td></tr></table></figure>\n<h4 id=\"加入通道\"><a href=\"#加入通道\" class=\"headerlink\" title=\"加入通道\"></a>加入通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker cp /data/bits/channel-artifacts/bits-query.block xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/</div><div class=\"line\"></div><div class=\"line\">peer channel join -b bits-query.block</div></pre></td></tr></table></figure>\n<h4 id=\"peer0-org2-bits-com安装\"><a href=\"#peer0-org2-bits-com安装\" class=\"headerlink\" title=\"peer0.org2.bits.com安装\"></a>peer0.org2.bits.com安装</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker cp /data/bits/channel-artifacts/bits-query.pak xxxxxxxx:/opt/gopath/src/github.com/hyperledger/fabric/peer/</div><div class=\"line\">##安装</div><div class=\"line\">peer chaincode install bits-query.pak</div><div class=\"line\">##查看是否安装成功</div><div class=\"line\">peer chaincode list --installed</div><div class=\"line\">peer chaincode list --instantiated -C bits-query</div></pre></td></tr></table></figure>\n<h2 id=\"调用\"><a href=\"#调用\" class=\"headerlink\" title=\"调用\"></a>调用</h2><h3 id=\"添加数据\"><a href=\"#添加数据\" class=\"headerlink\" title=\"添加数据\"></a>添加数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/bits.com/orderers/orderer.bits.com/msp/tlscacerts/tlsca.bits.com-cert.pem</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">&lt;!--peer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C bits-query -n bit-query -v 1.0 -c &apos;&#123;&quot;Args&quot;:[&quot;init&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;]&#125;&apos; -P &quot;OR (&apos;Org1MSP.peer&apos;,&apos;Org2MSP.peer&apos;)&quot;--&gt;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">peer chaincode invoke --tls --cafile $ORDERER_CA -C bits-query -n bits-query -c &apos;&#123;&quot;Args&quot;:[&quot;put&quot;,&quot;&#123;\\&quot;queryId\\&quot;:233,\\&quot;indexDigest\\&quot;:\\&quot;indexDigest\\&quot;,\\&quot;provideQueryOrg\\&quot;:\\&quot;provideQueryOrg\\&quot;,\\&quot;offerOrg\\&quot;:\\&quot;offerOrg\\&quot;,\\&quot;queryTime\\&quot;:\\&quot;queryTime\\&quot;,\\&quot;queryType\\&quot;:11,\\&quot;queryResult\\&quot;:11,\\&quot;querySerial\\&quot;:\\&quot;querySerial\\&quot;,\\&quot;hit\\&quot;:1&#125;&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<h3 id=\"查看数据\"><a href=\"#查看数据\" class=\"headerlink\" title=\"查看数据\"></a>查看数据</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode query  -C bits-query -n bits-query -c &apos;&#123;&quot;Args&quot;:[&quot;query&quot;,&quot;222&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<!--\n<!--peer chaincode install -n mycc -p github.com/hyperledger/fabric/multipeer/chaincode/go/example02/cmd/ -v 1.0\n\n peer chaincode install -n mycc -p github.com/hyperledger/fabric/bits/chaincode/go/example02/cmd/ -v 1.0\n\n\npeer chaincode instantiate -o orderer.bits.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n mycc -v 1.0 -c '{\"Args\":[\"init\",\"\"]}' -P \"OR ('Org1MSP.peer','Org2MSP.peer')\"\n\n\n\ndocker-compose -f docker-compose-org2-peer0.yaml up -d\n\n\n\ndocker cp /data/bits/mychannel.block 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\ndocker cp /data/bits/mycc.pak 474c4699e132:/opt/gopath/src/github.com/hyperledger/fabric/peer/\n\npeer channel join -b mychannel.block\n\npeer chaincode install mycc.pak\n\n\npeer chaincode list --installed\n\n\n\n\npeer chaincode invoke --tls --cafile $ORDERER_CA -C mychannel -n mycc -c '{\"Args\":[\"invoke\",\"a\",\"b\",\"10\"]}'\n\n\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"a\"]}'-->\n"},{"title":"hive on spark  java.net.ConnectException:Connection refused","date":"2018-12-14T05:57:23.000Z","_content":"## hive on spark hive cli运行时 \n执行命令  \n```\nset hive.execution.engine=spark;\nselect count(1) from ****;\n```   \n出现以下错误提示：\n\n```\nFailed to execute spark task, with exception 'org.apache.hadoop.hive.ql.metadata.HiveException(Failed to create spark client.)'\nFAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.spark.SparkTask\n\n```  \n使用**yarn logs -applicationId application_1544681531973_0028** 查看yarn日志：\n   \n```\n18/12/14 15:16:28 INFO client.RMProxy: Connecting to ResourceManager at ***.com/10.19.170.62:8032\n\n\nContainer: container_1544681531973_0028_01_000001 on ***.com_8041\n=======================================================================\nLogType:stderr\nLog Upload Time:Thu Dec 13 16:54:50 +0800 2018\nLogLength:4896\nLog Contents:\n18/12/13 16:54:46 INFO yarn.ApplicationMaster: Registered signal handlers for [TERM, HUP, INT]\n18/12/13 16:54:47 INFO yarn.ApplicationMaster: ApplicationAttemptId: appattempt_1544681531973_0028_000001\n18/12/13 16:54:48 INFO spark.SecurityManager: Changing view acls to: yarn,root\n18/12/13 16:54:48 INFO spark.SecurityManager: Changing modify acls to: yarn,root\n18/12/13 16:54:48 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(yarn, root); users with modify permissions: Set(yarn, root)\n18/12/13 16:54:48 INFO yarn.ApplicationMaster: Starting the user application in a separate Thread\n18/12/13 16:54:48 INFO yarn.ApplicationMaster: Waiting for spark context initialization...\n18/12/13 16:54:48 INFO client.RemoteDriver: Connecting to: localhost:39851\n18/12/13 16:54:49 ERROR yarn.ApplicationMaster: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851\njava.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851\n\tat io.netty.util.concurrent.AbstractFuture.get(AbstractFuture.java:37)\n\tat org.apache.hive.spark.client.RemoteDriver.<init>(RemoteDriver.java:156)\n\tat org.apache.hive.spark.client.RemoteDriver.main(RemoteDriver.java:556)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:552)\nCaused by: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:224)\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:289)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:528)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)\n\tat java.lang.Thread.run(Thread.java:748)\n18/12/13 16:54:49 INFO yarn.ApplicationMaster: Final app status: FAILED, exitCode: 15, (reason: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851)\n18/12/13 16:54:49 ERROR yarn.ApplicationMaster: Uncaught exception:\njava.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851\n\tat io.netty.util.concurrent.AbstractFuture.get(AbstractFuture.java:37)\n\tat org.apache.hive.spark.client.RemoteDriver.<init>(RemoteDriver.java:156)\n\tat org.apache.hive.spark.client.RemoteDriver.main(RemoteDriver.java:556)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:552)\nCaused by: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:224)\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:289)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:528)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)\n\tat java.lang.Thread.run(Thread.java:748)\n18/12/13 16:54:49 INFO yarn.ApplicationMaster: Unregistering ApplicationMaster with FAILED (diag message: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851)\n18/12/13 16:54:49 INFO yarn.ApplicationMaster: Deleting staging directory .sparkStaging/application_1544681531973_0028\n18/12/13 16:54:49 INFO util.ShutdownHookManager: Shutdown hook called\n\nLogType:stdout\nLog Upload Time:Thu Dec 13 16:54:50 +0800 2018\nLogLength:0\nLog Contents:\n\n```\n找了一天的原因，都没有找到，理解的是找不到某个服务的进程，链接，安装错误等等。  \n试了重装spark，查看了不同的进程。重启了集群N次，最后在\n\n## 分析错误原因\n1. hive 不使用 spark 引擎，正常跑任务  \n2. spark-shell 正常提交认为  \n3. hive on spark 不能提交任务\n4. yarn 能正常跑任务\n\n搜索clouder上hive on spark 安装配置步骤   \n\n```  \n\tBy default, if a Spark service is available, the Hive dependency on the Spark service is configured. To change this configuration, do the following:\n\n\tIn the Cloudera Manager Admin Console, go to the Hive service.\n\tClick the Configuration tab.\n\tSearch for the Spark On YARN Service. To configure the Spark service, select the Spark service name. To remove the dependency, select none.\n\tClick Save Changes.\n\tGo to the Spark service.\n\tAdd a Spark gateway role to the host running HiveServer2.\n\tReturn to the Home page by clicking the Cloudera Manager logo.\n\tClick the icon next to any stale services to invoke the cluster restart wizard.\n\tClick Restart Stale Services.\n\tClick Restart Now.\n\tClick Finish.\n\tIn the Hive client, configure the Spark execution engine.\n``` \n\n\n检查安装步骤后发现:   \nAdd a Spark gateway role to the host running HiveServer2.    \n由于安装了 spark gateway 的机器 并不在 hiveServer2上，遂通过CDH的WEB界面在相应的机器上安装相关的环境。最后进入该机器，运行hive，设置**SET hive.execution.engine=spark;\n** 运行相关脚本。   \n最后异常信息消失，正常运行提交任务。\n","source":"_posts/hive on spark .md","raw":"---\ntitle: hive on spark  java.net.ConnectException:Connection refused\ndate: 2018-12-14 13:57:23\ncategories: \n\t- 大数据\n\t- spark\ntags:\n\t- spark\n\t- hive\n\t- hive on spark \n---\n## hive on spark hive cli运行时 \n执行命令  \n```\nset hive.execution.engine=spark;\nselect count(1) from ****;\n```   \n出现以下错误提示：\n\n```\nFailed to execute spark task, with exception 'org.apache.hadoop.hive.ql.metadata.HiveException(Failed to create spark client.)'\nFAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.spark.SparkTask\n\n```  \n使用**yarn logs -applicationId application_1544681531973_0028** 查看yarn日志：\n   \n```\n18/12/14 15:16:28 INFO client.RMProxy: Connecting to ResourceManager at ***.com/10.19.170.62:8032\n\n\nContainer: container_1544681531973_0028_01_000001 on ***.com_8041\n=======================================================================\nLogType:stderr\nLog Upload Time:Thu Dec 13 16:54:50 +0800 2018\nLogLength:4896\nLog Contents:\n18/12/13 16:54:46 INFO yarn.ApplicationMaster: Registered signal handlers for [TERM, HUP, INT]\n18/12/13 16:54:47 INFO yarn.ApplicationMaster: ApplicationAttemptId: appattempt_1544681531973_0028_000001\n18/12/13 16:54:48 INFO spark.SecurityManager: Changing view acls to: yarn,root\n18/12/13 16:54:48 INFO spark.SecurityManager: Changing modify acls to: yarn,root\n18/12/13 16:54:48 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(yarn, root); users with modify permissions: Set(yarn, root)\n18/12/13 16:54:48 INFO yarn.ApplicationMaster: Starting the user application in a separate Thread\n18/12/13 16:54:48 INFO yarn.ApplicationMaster: Waiting for spark context initialization...\n18/12/13 16:54:48 INFO client.RemoteDriver: Connecting to: localhost:39851\n18/12/13 16:54:49 ERROR yarn.ApplicationMaster: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851\njava.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851\n\tat io.netty.util.concurrent.AbstractFuture.get(AbstractFuture.java:37)\n\tat org.apache.hive.spark.client.RemoteDriver.<init>(RemoteDriver.java:156)\n\tat org.apache.hive.spark.client.RemoteDriver.main(RemoteDriver.java:556)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:552)\nCaused by: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:224)\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:289)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:528)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)\n\tat java.lang.Thread.run(Thread.java:748)\n18/12/13 16:54:49 INFO yarn.ApplicationMaster: Final app status: FAILED, exitCode: 15, (reason: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851)\n18/12/13 16:54:49 ERROR yarn.ApplicationMaster: Uncaught exception:\njava.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851\n\tat io.netty.util.concurrent.AbstractFuture.get(AbstractFuture.java:37)\n\tat org.apache.hive.spark.client.RemoteDriver.<init>(RemoteDriver.java:156)\n\tat org.apache.hive.spark.client.RemoteDriver.main(RemoteDriver.java:556)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:552)\nCaused by: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:224)\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:289)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:528)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)\n\tat java.lang.Thread.run(Thread.java:748)\n18/12/13 16:54:49 INFO yarn.ApplicationMaster: Unregistering ApplicationMaster with FAILED (diag message: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851)\n18/12/13 16:54:49 INFO yarn.ApplicationMaster: Deleting staging directory .sparkStaging/application_1544681531973_0028\n18/12/13 16:54:49 INFO util.ShutdownHookManager: Shutdown hook called\n\nLogType:stdout\nLog Upload Time:Thu Dec 13 16:54:50 +0800 2018\nLogLength:0\nLog Contents:\n\n```\n找了一天的原因，都没有找到，理解的是找不到某个服务的进程，链接，安装错误等等。  \n试了重装spark，查看了不同的进程。重启了集群N次，最后在\n\n## 分析错误原因\n1. hive 不使用 spark 引擎，正常跑任务  \n2. spark-shell 正常提交认为  \n3. hive on spark 不能提交任务\n4. yarn 能正常跑任务\n\n搜索clouder上hive on spark 安装配置步骤   \n\n```  \n\tBy default, if a Spark service is available, the Hive dependency on the Spark service is configured. To change this configuration, do the following:\n\n\tIn the Cloudera Manager Admin Console, go to the Hive service.\n\tClick the Configuration tab.\n\tSearch for the Spark On YARN Service. To configure the Spark service, select the Spark service name. To remove the dependency, select none.\n\tClick Save Changes.\n\tGo to the Spark service.\n\tAdd a Spark gateway role to the host running HiveServer2.\n\tReturn to the Home page by clicking the Cloudera Manager logo.\n\tClick the icon next to any stale services to invoke the cluster restart wizard.\n\tClick Restart Stale Services.\n\tClick Restart Now.\n\tClick Finish.\n\tIn the Hive client, configure the Spark execution engine.\n``` \n\n\n检查安装步骤后发现:   \nAdd a Spark gateway role to the host running HiveServer2.    \n由于安装了 spark gateway 的机器 并不在 hiveServer2上，遂通过CDH的WEB界面在相应的机器上安装相关的环境。最后进入该机器，运行hive，设置**SET hive.execution.engine=spark;\n** 运行相关脚本。   \n最后异常信息消失，正常运行提交任务。\n","slug":"hive on spark ","published":1,"updated":"2018-12-14T08:07:07.003Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exs000j1fihhba8n117","content":"<h2 id=\"hive-on-spark-hive-cli运行时\"><a href=\"#hive-on-spark-hive-cli运行时\" class=\"headerlink\" title=\"hive on spark hive cli运行时\"></a>hive on spark hive cli运行时</h2><p>执行命令<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">set hive.execution.engine=spark;</div><div class=\"line\">select count(1) from ****;</div><div class=\"line\">```   </div><div class=\"line\">出现以下错误提示：</div></pre></td></tr></table></figure></p>\n<p>Failed to execute spark task, with exception ‘org.apache.hadoop.hive.ql.metadata.HiveException(Failed to create spark client.)’<br>FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.spark.SparkTask</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">使用**yarn logs -applicationId application_1544681531973_0028** 查看yarn日志：</div></pre></td></tr></table></figure>\n<p>18/12/14 15:16:28 INFO client.RMProxy: Connecting to ResourceManager at <em>*</em>.com/10.19.170.62:8032</p>\n<h1 id=\"Container-container-1544681531973-0028-01-000001-on-com-8041\"><a href=\"#Container-container-1544681531973-0028-01-000001-on-com-8041\" class=\"headerlink\" title=\"Container: container_1544681531973_0028_01_000001 on *.com_8041\"></a>Container: container_1544681531973_0028_01_000001 on <em>*</em>.com_8041</h1><p>LogType:stderr<br>Log Upload Time:Thu Dec 13 16:54:50 +0800 2018<br>LogLength:4896<br>Log Contents:<br>18/12/13 16:54:46 INFO yarn.ApplicationMaster: Registered signal handlers for [TERM, HUP, INT]<br>18/12/13 16:54:47 INFO yarn.ApplicationMaster: ApplicationAttemptId: appattempt_1544681531973_0028_000001<br>18/12/13 16:54:48 INFO spark.SecurityManager: Changing view acls to: yarn,root<br>18/12/13 16:54:48 INFO spark.SecurityManager: Changing modify acls to: yarn,root<br>18/12/13 16:54:48 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(yarn, root); users with modify permissions: Set(yarn, root)<br>18/12/13 16:54:48 INFO yarn.ApplicationMaster: Starting the user application in a separate Thread<br>18/12/13 16:54:48 INFO yarn.ApplicationMaster: Waiting for spark context initialization…<br>18/12/13 16:54:48 INFO client.RemoteDriver: Connecting to: localhost:39851<br>18/12/13 16:54:49 ERROR yarn.ApplicationMaster: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851<br>java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851<br>    at io.netty.util.concurrent.AbstractFuture.get(AbstractFuture.java:37)<br>    at org.apache.hive.spark.client.RemoteDriver.<init>(RemoteDriver.java:156)<br>    at org.apache.hive.spark.client.RemoteDriver.main(RemoteDriver.java:556)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)<br>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br>    at java.lang.reflect.Method.invoke(Method.java:498)<br>    at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:552)<br>Caused by: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851<br>    at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)<br>    at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)<br>    at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:224)<br>    at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:289)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:528)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)<br>    at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)<br>    at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)<br>    at java.lang.Thread.run(Thread.java:748)<br>18/12/13 16:54:49 INFO yarn.ApplicationMaster: Final app status: FAILED, exitCode: 15, (reason: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851)<br>18/12/13 16:54:49 ERROR yarn.ApplicationMaster: Uncaught exception:<br>java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851<br>    at io.netty.util.concurrent.AbstractFuture.get(AbstractFuture.java:37)<br>    at org.apache.hive.spark.client.RemoteDriver.<init>(RemoteDriver.java:156)<br>    at org.apache.hive.spark.client.RemoteDriver.main(RemoteDriver.java:556)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)<br>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br>    at java.lang.reflect.Method.invoke(Method.java:498)<br>    at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:552)<br>Caused by: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851<br>    at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)<br>    at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)<br>    at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:224)<br>    at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:289)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:528)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)<br>    at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)<br>    at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)<br>    at java.lang.Thread.run(Thread.java:748)<br>18/12/13 16:54:49 INFO yarn.ApplicationMaster: Unregistering ApplicationMaster with FAILED (diag message: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851)<br>18/12/13 16:54:49 INFO yarn.ApplicationMaster: Deleting staging directory .sparkStaging/application_1544681531973_0028<br>18/12/13 16:54:49 INFO util.ShutdownHookManager: Shutdown hook called</init></init></p>\n<p>LogType:stdout<br>Log Upload Time:Thu Dec 13 16:54:50 +0800 2018<br>LogLength:0<br>Log Contents:</p>\n<pre><code>找了一天的原因，都没有找到，理解的是找不到某个服务的进程，链接，安装错误等等。  \n试了重装spark，查看了不同的进程。重启了集群N次，最后在\n\n## 分析错误原因\n1. hive 不使用 spark 引擎，正常跑任务  \n2. spark-shell 正常提交认为  \n3. hive on spark 不能提交任务\n4. yarn 能正常跑任务\n\n搜索clouder上hive on spark 安装配置步骤\n</code></pre><pre><code>By default, if a Spark service is available, the Hive dependency on the Spark service is configured. To change this configuration, do the following:\n\nIn the Cloudera Manager Admin Console, go to the Hive service.\nClick the Configuration tab.\nSearch for the Spark On YARN Service. To configure the Spark service, select the Spark service name. To remove the dependency, select none.\nClick Save Changes.\nGo to the Spark service.\nAdd a Spark gateway role to the host running HiveServer2.\nReturn to the Home page by clicking the Cloudera Manager logo.\nClick the icon next to any stale services to invoke the cluster restart wizard.\nClick Restart Stale Services.\nClick Restart Now.\nClick Finish.\nIn the Hive client, configure the Spark execution engine.\n</code></pre><p>``` </p>\n<p>检查安装步骤后发现:<br>Add a Spark gateway role to the host running HiveServer2.<br>由于安装了 spark gateway 的机器 并不在 hiveServer2上，遂通过CDH的WEB界面在相应的机器上安装相关的环境。最后进入该机器，运行hive，设置<strong>SET hive.execution.engine=spark;\n</strong> 运行相关脚本。<br>最后异常信息消失，正常运行提交任务。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"hive-on-spark-hive-cli运行时\"><a href=\"#hive-on-spark-hive-cli运行时\" class=\"headerlink\" title=\"hive on spark hive cli运行时\"></a>hive on spark hive cli运行时</h2><p>执行命令<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">set hive.execution.engine=spark;</div><div class=\"line\">select count(1) from ****;</div><div class=\"line\">```   </div><div class=\"line\">出现以下错误提示：</div></pre></td></tr></table></figure></p>\n<p>Failed to execute spark task, with exception ‘org.apache.hadoop.hive.ql.metadata.HiveException(Failed to create spark client.)’<br>FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.spark.SparkTask</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">使用**yarn logs -applicationId application_1544681531973_0028** 查看yarn日志：</div></pre></td></tr></table></figure>\n<p>18/12/14 15:16:28 INFO client.RMProxy: Connecting to ResourceManager at <em>*</em>.com/10.19.170.62:8032</p>\n<h1 id=\"Container-container-1544681531973-0028-01-000001-on-com-8041\"><a href=\"#Container-container-1544681531973-0028-01-000001-on-com-8041\" class=\"headerlink\" title=\"Container: container_1544681531973_0028_01_000001 on *.com_8041\"></a>Container: container_1544681531973_0028_01_000001 on <em>*</em>.com_8041</h1><p>LogType:stderr<br>Log Upload Time:Thu Dec 13 16:54:50 +0800 2018<br>LogLength:4896<br>Log Contents:<br>18/12/13 16:54:46 INFO yarn.ApplicationMaster: Registered signal handlers for [TERM, HUP, INT]<br>18/12/13 16:54:47 INFO yarn.ApplicationMaster: ApplicationAttemptId: appattempt_1544681531973_0028_000001<br>18/12/13 16:54:48 INFO spark.SecurityManager: Changing view acls to: yarn,root<br>18/12/13 16:54:48 INFO spark.SecurityManager: Changing modify acls to: yarn,root<br>18/12/13 16:54:48 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(yarn, root); users with modify permissions: Set(yarn, root)<br>18/12/13 16:54:48 INFO yarn.ApplicationMaster: Starting the user application in a separate Thread<br>18/12/13 16:54:48 INFO yarn.ApplicationMaster: Waiting for spark context initialization…<br>18/12/13 16:54:48 INFO client.RemoteDriver: Connecting to: localhost:39851<br>18/12/13 16:54:49 ERROR yarn.ApplicationMaster: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851<br>java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851<br>    at io.netty.util.concurrent.AbstractFuture.get(AbstractFuture.java:37)<br>    at org.apache.hive.spark.client.RemoteDriver.<init>(RemoteDriver.java:156)<br>    at org.apache.hive.spark.client.RemoteDriver.main(RemoteDriver.java:556)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)<br>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br>    at java.lang.reflect.Method.invoke(Method.java:498)<br>    at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:552)<br>Caused by: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851<br>    at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)<br>    at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)<br>    at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:224)<br>    at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:289)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:528)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)<br>    at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)<br>    at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)<br>    at java.lang.Thread.run(Thread.java:748)<br>18/12/13 16:54:49 INFO yarn.ApplicationMaster: Final app status: FAILED, exitCode: 15, (reason: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851)<br>18/12/13 16:54:49 ERROR yarn.ApplicationMaster: Uncaught exception:<br>java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851<br>    at io.netty.util.concurrent.AbstractFuture.get(AbstractFuture.java:37)<br>    at org.apache.hive.spark.client.RemoteDriver.<init>(RemoteDriver.java:156)<br>    at org.apache.hive.spark.client.RemoteDriver.main(RemoteDriver.java:556)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)<br>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br>    at java.lang.reflect.Method.invoke(Method.java:498)<br>    at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:552)<br>Caused by: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851<br>    at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)<br>    at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)<br>    at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:224)<br>    at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:289)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:528)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:468)<br>    at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:382)<br>    at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:354)<br>    at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:111)<br>    at java.lang.Thread.run(Thread.java:748)<br>18/12/13 16:54:49 INFO yarn.ApplicationMaster: Unregistering ApplicationMaster with FAILED (diag message: User class threw exception: java.util.concurrent.ExecutionException: java.net.ConnectException: 拒绝连接: localhost/127.0.0.1:39851)<br>18/12/13 16:54:49 INFO yarn.ApplicationMaster: Deleting staging directory .sparkStaging/application_1544681531973_0028<br>18/12/13 16:54:49 INFO util.ShutdownHookManager: Shutdown hook called</init></init></p>\n<p>LogType:stdout<br>Log Upload Time:Thu Dec 13 16:54:50 +0800 2018<br>LogLength:0<br>Log Contents:</p>\n<pre><code>找了一天的原因，都没有找到，理解的是找不到某个服务的进程，链接，安装错误等等。  \n试了重装spark，查看了不同的进程。重启了集群N次，最后在\n\n## 分析错误原因\n1. hive 不使用 spark 引擎，正常跑任务  \n2. spark-shell 正常提交认为  \n3. hive on spark 不能提交任务\n4. yarn 能正常跑任务\n\n搜索clouder上hive on spark 安装配置步骤\n</code></pre><pre><code>By default, if a Spark service is available, the Hive dependency on the Spark service is configured. To change this configuration, do the following:\n\nIn the Cloudera Manager Admin Console, go to the Hive service.\nClick the Configuration tab.\nSearch for the Spark On YARN Service. To configure the Spark service, select the Spark service name. To remove the dependency, select none.\nClick Save Changes.\nGo to the Spark service.\nAdd a Spark gateway role to the host running HiveServer2.\nReturn to the Home page by clicking the Cloudera Manager logo.\nClick the icon next to any stale services to invoke the cluster restart wizard.\nClick Restart Stale Services.\nClick Restart Now.\nClick Finish.\nIn the Hive client, configure the Spark execution engine.\n</code></pre><p>``` </p>\n<p>检查安装步骤后发现:<br>Add a Spark gateway role to the host running HiveServer2.<br>由于安装了 spark gateway 的机器 并不在 hiveServer2上，遂通过CDH的WEB界面在相应的机器上安装相关的环境。最后进入该机器，运行hive，设置<strong>SET hive.execution.engine=spark;\n</strong> 运行相关脚本。<br>最后异常信息消失，正常运行提交任务。</p>\n"},{"title":"hive表创建的几种方式","date":"2017-05-01T05:39:23.000Z","_content":"\n##   hive表的创建\n### 一、语法\n```sql\nCREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name    -- (Note: TEMPORARY available in Hive 0.14.0 and later)\n  [(col_name data_type [COMMENT col_comment], ...)]\n  [COMMENT table_comment]\n  [PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)]\n  [CLUSTERED BY (col_name, col_name, ...) [SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS]\n  [SKEWED BY (col_name, col_name, ...)                  -- (Note: Available in Hive 0.10.0 and later)]\n     ON ((col_value, col_value, ...), (col_value, col_value, ...), ...)\n     [STORED AS DIRECTORIES]\n  [\n   [ROW FORMAT row_format] \n   [STORED AS file_format]\n     | STORED BY 'storage.handler.class.name' [WITH SERDEPROPERTIES (...)]  -- (Note: Available in Hive 0.6.0 and later)\n  ]\n  [LOCATION hdfs_path]\n  [TBLPROPERTIES (property_name=property_value, ...)]   -- (Note: Available in Hive 0.6.0 and later)\n  [AS select_statement];   -- (Note: Available in Hive 0.5.0 and later; not supported for external tables)\n \nCREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name\n  LIKE existing_table_or_view_name\n  [LOCATION hdfs_path];\n \ndata_type\n  : primitive_type\n  | array_type\n  | map_type\n  | struct_type\n  | union_type  -- (Note: Available in Hive 0.7.0 and later)\n \nprimitive_type\n  : TINYINT\n  | SMALLINT\n  | INT\n  | BIGINT\n  | BOOLEAN\n  | FLOAT\n  | DOUBLE\n  | STRING\n  | BINARY      -- (Note: Available in Hive 0.8.0 and later)\n  | TIMESTAMP   -- (Note: Available in Hive 0.8.0 and later)\n  | DECIMAL     -- (Note: Available in Hive 0.11.0 and later)\n  | DECIMAL(precision, scale)  -- (Note: Available in Hive 0.13.0 and later)\n  | DATE        -- (Note: Available in Hive 0.12.0 and later)\n  | VARCHAR     -- (Note: Available in Hive 0.12.0 and later)\n  | CHAR        -- (Note: Available in Hive 0.13.0 and later)\n \narray_type\n  : ARRAY < data_type >\n \nmap_type\n  : MAP < primitive_type, data_type >\n \nstruct_type\n  : STRUCT < col_name : data_type [COMMENT col_comment], ...>\n \nunion_type\n   : UNIONTYPE < data_type, data_type, ... >  -- (Note: Available in Hive 0.7.0 and later)\n \nrow_format\n  : DELIMITED [FIELDS TERMINATED BY char [ESCAPED BY char]] [COLLECTION ITEMS TERMINATED BY char]\n        [MAP KEYS TERMINATED BY char] [LINES TERMINATED BY char]\n        [NULL DEFINED AS char]   -- (Note: Available in Hive 0.13 and later)\n  | SERDE serde_name [WITH SERDEPROPERTIES (property_name=property_value, property_name=property_value, ...)]\n \nfile_format:\n  : SEQUENCEFILE\n  | TEXTFILE    -- (Default, depending on hive.default.fileformat configuration)\n  | RCFILE      -- (Note: Available in Hive 0.6.0 and later)\n  | ORC         -- (Note: Available in Hive 0.11.0 and later)\n  | PARQUET     -- (Note: Available in Hive 0.13.0 and later)\n  | AVRO        -- (Note: Available in Hive 0.14.0 and later)\n  | INPUTFORMAT input_format_classname OUTPUTFORMAT output_format_classname\n\n```\n### 二、创建表时的4种模式\n1. TEMPORARY模式，在该模式下创建的表，只在当前session中有效，当前session关闭时，该表会被hive删除，不支持分区，也不支持创建索引.  \n2. EXTERNAL模式，俗称外部表，该模式的表，数据不由hive管理，删除表时，数据不会被删除，创建表时可以指定数据加载的路径如:  \n\n\t\tCREATE EXTERNAL TABLE [IF NOT EXISTS] [db_name.]table_name\n \t\tLIKE existing_table_or_view_name\n\t\t[LOCATION hdfs_path];\n3. \t默认模式，俗称管理表，该模式的表，数据由hive管理,删除表时数据也会被删除。\n4. Create Table As Select (CTAS)模式，该模式的表是由查询的结果来创建，在该模式下，不能创建分区表，不能创建外部表，也不支持数据分桶。  \n\n### 三、表中的字段的数据类型\n##### 在hive中字段支持5种类型:  \n1.基本类型（primitive_type）:\n\t \n\t   TINYINT\n\t  | SMALLINT\n\t  | INT\n\t  | BIGINT\n\t  | BOOLEAN\n\t  | FLOAT\n\t  | DOUBLE\n\t  | STRING\n\t  | BINARY      \n\t  | TIMESTAMP   \n\t  | DECIMAL    \n\t  | DECIMAL(precision, scale)  \n\t  | DATE        \n\t  | VARCHAR     \n\t  | CHAR \n2.数组类型（array_type）  \n3.字典类型(map_type)   \n4.结构类型(struct_type)  \n5.联合类型(union_type)  \n如:  \n\n\t\tCREATE TABLE employees (  \n\t\t    name STRING,  \n\t\t    salary FLOAT,  \n\t\t    subordinates ARRAY<STRING>,  \n\t\t    deductions MAP<STRING, FLOAT>,  \n\t\t    address STRUCT<street:STRING, city:STRING, state:STRING, zip:INT>,\n\t\t    dddd:UNIONTYPE<data_type,data_type,....>\n\t\t) PARTITIONED BY (country STRING, state STRING);  \n\n\n###  四、数据分区\n数据分区为将数据按照指定字段的值来分别存放，这样在查询时，可以只查某一个分区的数据，以提高数据查询效率，也可以在数据的管理上更有效率。指定分区时，数据将按照分区字段先后的顺序来存放.\n如：  \n  \n \tCREATE TABLE employees (.....)\n\tPARTITIONED BY (pt_dt string)\n\tROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\n\tSTORED AS TEXTFILE;\n### 五、数据分桶\n#####把表（或者分区）组织成桶（Bucket）有两个理由：  \n1.为获得更高的查询处理效率。桶为表加上了额外的结构，Hive 在处理有些查询时能利用这个结构。具体而言，连接两个在（包含连接列的）相同列上划分了桶的表，可以使用 Map 端连接 （Map-side join）高效的实现。比如JOIN操作。对于JOIN操作两个表有一个相同的列，如果对这两个表都进行了桶操作。那么将保存相同列值的桶进行JOIN操作就可以，可以大大较少JOIN的数据量。  \n\n2.使取样（sampling）更高效。在处理大规模数据集时，在开发和修改查询的阶段，如果能在数据集的一小部分数据上试运行查询，会带来很多方便。\n\n### 六、数据导入与数据导出\n在创建表时，可以指定3个属性[INPUTFORMAT, OUTPUTFORMAT, SERDE],由这些属性来指定数据的导入格式和导出格式  \n首先来理清这三者之间的关系，我们直接引用Hive官方说法：  \n\n\tSerDe is a short name for “Serializer and Deserializer.”\n\tHive uses SerDe (and !FileFormat) to read and write table rows.\n\tHDFS files –> InputFileFormat –> <key, value> –> Deserializer –> Row object\n\tRow object –> Serializer –> <key, value> –> OutputFileFormat –> HDFS files\n总结一下，当面临一个HDFS上的文件时，Hive将如下处理（以读为例）：\n\t\n\t1.调用InputFormat，将文件切成不同的文档。每篇文档即一行(Row)。  \n\t2.调用SerDe的Deserializer，将一行(Row)，切分为各个字段。\n当HIVE执行INSERT操作，将Row写入文件时，主要调用OutputFormat、SerDe的Seriliazer，顺序与读取相反  \n【INPUTFORMAT】属性的类必须实现org.apache.hadoop.mapred.InputFormat接口  \n【OUTPUTFORMAT】属性的类必须实现org.apache.hadoop.mapreduce.OutputFormat接口  \n【SERDE】属性的类必须实现org.apache.hadoop.hive.serde2接口\n\n\n\n\n\n\n\n\n\n\n\n\n###注：参考文档\n\thttps://cwiki.apache.org/confluence/display/Hive/DeveloperGuide\n\thttps://hive.apache.org/javadocs/r1.2.1/api/\n\thttp://hadoop.apache.org/docs/r2.7.1/api/\n\thttps://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL\n\n","source":"_posts/hive表的创建.md","raw":"---\ntitle: hive表创建的几种方式\ndate: 2017-05-01 13:39:23\ncategories: \n\t- 大数据\ntags:\n\t- hive \n---\n\n##   hive表的创建\n### 一、语法\n```sql\nCREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name    -- (Note: TEMPORARY available in Hive 0.14.0 and later)\n  [(col_name data_type [COMMENT col_comment], ...)]\n  [COMMENT table_comment]\n  [PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)]\n  [CLUSTERED BY (col_name, col_name, ...) [SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS]\n  [SKEWED BY (col_name, col_name, ...)                  -- (Note: Available in Hive 0.10.0 and later)]\n     ON ((col_value, col_value, ...), (col_value, col_value, ...), ...)\n     [STORED AS DIRECTORIES]\n  [\n   [ROW FORMAT row_format] \n   [STORED AS file_format]\n     | STORED BY 'storage.handler.class.name' [WITH SERDEPROPERTIES (...)]  -- (Note: Available in Hive 0.6.0 and later)\n  ]\n  [LOCATION hdfs_path]\n  [TBLPROPERTIES (property_name=property_value, ...)]   -- (Note: Available in Hive 0.6.0 and later)\n  [AS select_statement];   -- (Note: Available in Hive 0.5.0 and later; not supported for external tables)\n \nCREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name\n  LIKE existing_table_or_view_name\n  [LOCATION hdfs_path];\n \ndata_type\n  : primitive_type\n  | array_type\n  | map_type\n  | struct_type\n  | union_type  -- (Note: Available in Hive 0.7.0 and later)\n \nprimitive_type\n  : TINYINT\n  | SMALLINT\n  | INT\n  | BIGINT\n  | BOOLEAN\n  | FLOAT\n  | DOUBLE\n  | STRING\n  | BINARY      -- (Note: Available in Hive 0.8.0 and later)\n  | TIMESTAMP   -- (Note: Available in Hive 0.8.0 and later)\n  | DECIMAL     -- (Note: Available in Hive 0.11.0 and later)\n  | DECIMAL(precision, scale)  -- (Note: Available in Hive 0.13.0 and later)\n  | DATE        -- (Note: Available in Hive 0.12.0 and later)\n  | VARCHAR     -- (Note: Available in Hive 0.12.0 and later)\n  | CHAR        -- (Note: Available in Hive 0.13.0 and later)\n \narray_type\n  : ARRAY < data_type >\n \nmap_type\n  : MAP < primitive_type, data_type >\n \nstruct_type\n  : STRUCT < col_name : data_type [COMMENT col_comment], ...>\n \nunion_type\n   : UNIONTYPE < data_type, data_type, ... >  -- (Note: Available in Hive 0.7.0 and later)\n \nrow_format\n  : DELIMITED [FIELDS TERMINATED BY char [ESCAPED BY char]] [COLLECTION ITEMS TERMINATED BY char]\n        [MAP KEYS TERMINATED BY char] [LINES TERMINATED BY char]\n        [NULL DEFINED AS char]   -- (Note: Available in Hive 0.13 and later)\n  | SERDE serde_name [WITH SERDEPROPERTIES (property_name=property_value, property_name=property_value, ...)]\n \nfile_format:\n  : SEQUENCEFILE\n  | TEXTFILE    -- (Default, depending on hive.default.fileformat configuration)\n  | RCFILE      -- (Note: Available in Hive 0.6.0 and later)\n  | ORC         -- (Note: Available in Hive 0.11.0 and later)\n  | PARQUET     -- (Note: Available in Hive 0.13.0 and later)\n  | AVRO        -- (Note: Available in Hive 0.14.0 and later)\n  | INPUTFORMAT input_format_classname OUTPUTFORMAT output_format_classname\n\n```\n### 二、创建表时的4种模式\n1. TEMPORARY模式，在该模式下创建的表，只在当前session中有效，当前session关闭时，该表会被hive删除，不支持分区，也不支持创建索引.  \n2. EXTERNAL模式，俗称外部表，该模式的表，数据不由hive管理，删除表时，数据不会被删除，创建表时可以指定数据加载的路径如:  \n\n\t\tCREATE EXTERNAL TABLE [IF NOT EXISTS] [db_name.]table_name\n \t\tLIKE existing_table_or_view_name\n\t\t[LOCATION hdfs_path];\n3. \t默认模式，俗称管理表，该模式的表，数据由hive管理,删除表时数据也会被删除。\n4. Create Table As Select (CTAS)模式，该模式的表是由查询的结果来创建，在该模式下，不能创建分区表，不能创建外部表，也不支持数据分桶。  \n\n### 三、表中的字段的数据类型\n##### 在hive中字段支持5种类型:  \n1.基本类型（primitive_type）:\n\t \n\t   TINYINT\n\t  | SMALLINT\n\t  | INT\n\t  | BIGINT\n\t  | BOOLEAN\n\t  | FLOAT\n\t  | DOUBLE\n\t  | STRING\n\t  | BINARY      \n\t  | TIMESTAMP   \n\t  | DECIMAL    \n\t  | DECIMAL(precision, scale)  \n\t  | DATE        \n\t  | VARCHAR     \n\t  | CHAR \n2.数组类型（array_type）  \n3.字典类型(map_type)   \n4.结构类型(struct_type)  \n5.联合类型(union_type)  \n如:  \n\n\t\tCREATE TABLE employees (  \n\t\t    name STRING,  \n\t\t    salary FLOAT,  \n\t\t    subordinates ARRAY<STRING>,  \n\t\t    deductions MAP<STRING, FLOAT>,  \n\t\t    address STRUCT<street:STRING, city:STRING, state:STRING, zip:INT>,\n\t\t    dddd:UNIONTYPE<data_type,data_type,....>\n\t\t) PARTITIONED BY (country STRING, state STRING);  \n\n\n###  四、数据分区\n数据分区为将数据按照指定字段的值来分别存放，这样在查询时，可以只查某一个分区的数据，以提高数据查询效率，也可以在数据的管理上更有效率。指定分区时，数据将按照分区字段先后的顺序来存放.\n如：  \n  \n \tCREATE TABLE employees (.....)\n\tPARTITIONED BY (pt_dt string)\n\tROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t'\n\tSTORED AS TEXTFILE;\n### 五、数据分桶\n#####把表（或者分区）组织成桶（Bucket）有两个理由：  \n1.为获得更高的查询处理效率。桶为表加上了额外的结构，Hive 在处理有些查询时能利用这个结构。具体而言，连接两个在（包含连接列的）相同列上划分了桶的表，可以使用 Map 端连接 （Map-side join）高效的实现。比如JOIN操作。对于JOIN操作两个表有一个相同的列，如果对这两个表都进行了桶操作。那么将保存相同列值的桶进行JOIN操作就可以，可以大大较少JOIN的数据量。  \n\n2.使取样（sampling）更高效。在处理大规模数据集时，在开发和修改查询的阶段，如果能在数据集的一小部分数据上试运行查询，会带来很多方便。\n\n### 六、数据导入与数据导出\n在创建表时，可以指定3个属性[INPUTFORMAT, OUTPUTFORMAT, SERDE],由这些属性来指定数据的导入格式和导出格式  \n首先来理清这三者之间的关系，我们直接引用Hive官方说法：  \n\n\tSerDe is a short name for “Serializer and Deserializer.”\n\tHive uses SerDe (and !FileFormat) to read and write table rows.\n\tHDFS files –> InputFileFormat –> <key, value> –> Deserializer –> Row object\n\tRow object –> Serializer –> <key, value> –> OutputFileFormat –> HDFS files\n总结一下，当面临一个HDFS上的文件时，Hive将如下处理（以读为例）：\n\t\n\t1.调用InputFormat，将文件切成不同的文档。每篇文档即一行(Row)。  \n\t2.调用SerDe的Deserializer，将一行(Row)，切分为各个字段。\n当HIVE执行INSERT操作，将Row写入文件时，主要调用OutputFormat、SerDe的Seriliazer，顺序与读取相反  \n【INPUTFORMAT】属性的类必须实现org.apache.hadoop.mapred.InputFormat接口  \n【OUTPUTFORMAT】属性的类必须实现org.apache.hadoop.mapreduce.OutputFormat接口  \n【SERDE】属性的类必须实现org.apache.hadoop.hive.serde2接口\n\n\n\n\n\n\n\n\n\n\n\n\n###注：参考文档\n\thttps://cwiki.apache.org/confluence/display/Hive/DeveloperGuide\n\thttps://hive.apache.org/javadocs/r1.2.1/api/\n\thttp://hadoop.apache.org/docs/r2.7.1/api/\n\thttps://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL\n\n","slug":"hive表的创建","published":1,"updated":"2017-05-20T07:52:46.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0ext000m1fihacbz21ml","content":"<h2 id=\"hive表的创建\"><a href=\"#hive表的创建\" class=\"headerlink\" title=\"hive表的创建\"></a>hive表的创建</h2><h3 id=\"一、语法\"><a href=\"#一、语法\" class=\"headerlink\" title=\"一、语法\"></a>一、语法</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\">CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name    -- (Note: TEMPORARY available in Hive 0.14.0 and later)</div><div class=\"line\">  [(col_name data_type [COMMENT col_comment], ...)]</div><div class=\"line\">  [COMMENT table_comment]</div><div class=\"line\">  [PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)]</div><div class=\"line\">  [CLUSTERED BY (col_name, col_name, ...) [SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS]</div><div class=\"line\">  [SKEWED BY (col_name, col_name, ...)                  -- (Note: Available in Hive 0.10.0 and later)]</div><div class=\"line\">     ON ((col_value, col_value, ...), (col_value, col_value, ...), ...)</div><div class=\"line\">     [STORED AS DIRECTORIES]</div><div class=\"line\">  [</div><div class=\"line\">   [ROW FORMAT row_format] </div><div class=\"line\">   [STORED AS file_format]</div><div class=\"line\">     | STORED BY 'storage.handler.class.name' [WITH SERDEPROPERTIES (...)]  -- (Note: Available in Hive 0.6.0 and later)</div><div class=\"line\">  ]</div><div class=\"line\">  [LOCATION hdfs_path]</div><div class=\"line\">  [TBLPROPERTIES (property_name=property_value, ...)]   -- (Note: Available in Hive 0.6.0 and later)</div><div class=\"line\">  [AS select_statement];   -- (Note: Available in Hive 0.5.0 and later; not supported for external tables)</div><div class=\"line\"> </div><div class=\"line\">CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name</div><div class=\"line\">  LIKE existing_table_or_view_name</div><div class=\"line\">  [LOCATION hdfs_path];</div><div class=\"line\"> </div><div class=\"line\">data_type</div><div class=\"line\">  : primitive_type</div><div class=\"line\">  | array_type</div><div class=\"line\">  | map_type</div><div class=\"line\">  | struct_type</div><div class=\"line\">  | union_type  -- (Note: Available in Hive 0.7.0 and later)</div><div class=\"line\"> </div><div class=\"line\">primitive_type</div><div class=\"line\">  : TINYINT</div><div class=\"line\">  | SMALLINT</div><div class=\"line\">  | INT</div><div class=\"line\">  | BIGINT</div><div class=\"line\">  | BOOLEAN</div><div class=\"line\">  | FLOAT</div><div class=\"line\">  | DOUBLE</div><div class=\"line\">  | STRING</div><div class=\"line\">  | BINARY      -- (Note: Available in Hive 0.8.0 and later)</div><div class=\"line\">  | TIMESTAMP   -- (Note: Available in Hive 0.8.0 and later)</div><div class=\"line\">  | DECIMAL     -- (Note: Available in Hive 0.11.0 and later)</div><div class=\"line\">  | DECIMAL(precision, scale)  -- (Note: Available in Hive 0.13.0 and later)</div><div class=\"line\">  | DATE        -- (Note: Available in Hive 0.12.0 and later)</div><div class=\"line\">  | VARCHAR     -- (Note: Available in Hive 0.12.0 and later)</div><div class=\"line\">  | CHAR        -- (Note: Available in Hive 0.13.0 and later)</div><div class=\"line\"> </div><div class=\"line\">array_type</div><div class=\"line\">  : ARRAY &lt; data_type &gt;</div><div class=\"line\"> </div><div class=\"line\">map_type</div><div class=\"line\">  : MAP &lt; primitive_type, data_type &gt;</div><div class=\"line\"> </div><div class=\"line\">struct_type</div><div class=\"line\">  : STRUCT &lt; col_name : data_type [COMMENT col_comment], ...&gt;</div><div class=\"line\"> </div><div class=\"line\">union_type</div><div class=\"line\">   : UNIONTYPE &lt; data_type, data_type, ... &gt;  -- (Note: Available in Hive 0.7.0 and later)</div><div class=\"line\"> </div><div class=\"line\">row_format</div><div class=\"line\">  : DELIMITED [FIELDS TERMINATED BY char [ESCAPED BY char]] [COLLECTION ITEMS TERMINATED BY char]</div><div class=\"line\">        [MAP KEYS TERMINATED BY char] [LINES TERMINATED BY char]</div><div class=\"line\">        [NULL DEFINED AS char]   -- (Note: Available in Hive 0.13 and later)</div><div class=\"line\">  | SERDE serde_name [WITH SERDEPROPERTIES (property_name=property_value, property_name=property_value, ...)]</div><div class=\"line\"> </div><div class=\"line\">file_format:</div><div class=\"line\">  : SEQUENCEFILE</div><div class=\"line\">  | TEXTFILE    -- (Default, depending on hive.default.fileformat configuration)</div><div class=\"line\">  | RCFILE      -- (Note: Available in Hive 0.6.0 and later)</div><div class=\"line\">  | ORC         -- (Note: Available in Hive 0.11.0 and later)</div><div class=\"line\">  | PARQUET     -- (Note: Available in Hive 0.13.0 and later)</div><div class=\"line\">  | AVRO        -- (Note: Available in Hive 0.14.0 and later)</div><div class=\"line\">  | INPUTFORMAT input_format_classname OUTPUTFORMAT output_format_classname</div></pre></td></tr></table></figure>\n<h3 id=\"二、创建表时的4种模式\"><a href=\"#二、创建表时的4种模式\" class=\"headerlink\" title=\"二、创建表时的4种模式\"></a>二、创建表时的4种模式</h3><ol>\n<li>TEMPORARY模式，在该模式下创建的表，只在当前session中有效，当前session关闭时，该表会被hive删除，不支持分区，也不支持创建索引.  </li>\n<li><p>EXTERNAL模式，俗称外部表，该模式的表，数据不由hive管理，删除表时，数据不会被删除，创建表时可以指定数据加载的路径如:  </p>\n<pre><code>CREATE EXTERNAL TABLE [IF NOT EXISTS] [db_name.]table_name\n LIKE existing_table_or_view_name\n[LOCATION hdfs_path];\n</code></pre></li>\n<li>默认模式，俗称管理表，该模式的表，数据由hive管理,删除表时数据也会被删除。</li>\n<li>Create Table As Select (CTAS)模式，该模式的表是由查询的结果来创建，在该模式下，不能创建分区表，不能创建外部表，也不支持数据分桶。  </li>\n</ol>\n<h3 id=\"三、表中的字段的数据类型\"><a href=\"#三、表中的字段的数据类型\" class=\"headerlink\" title=\"三、表中的字段的数据类型\"></a>三、表中的字段的数据类型</h3><h5 id=\"在hive中字段支持5种类型\"><a href=\"#在hive中字段支持5种类型\" class=\"headerlink\" title=\"在hive中字段支持5种类型:\"></a>在hive中字段支持5种类型:</h5><p>1.基本类型（primitive_type）:</p>\n<pre><code> TINYINT\n| SMALLINT\n| INT\n| BIGINT\n| BOOLEAN\n| FLOAT\n| DOUBLE\n| STRING\n| BINARY      \n| TIMESTAMP   \n| DECIMAL    \n| DECIMAL(precision, scale)  \n| DATE        \n| VARCHAR     \n| CHAR \n</code></pre><p>2.数组类型（array_type）<br>3.字典类型(map_type)<br>4.结构类型(struct_type)<br>5.联合类型(union_type)<br>如:  </p>\n<pre><code>CREATE TABLE employees (  \n    name STRING,  \n    salary FLOAT,  \n    subordinates ARRAY&lt;STRING&gt;,  \n    deductions MAP&lt;STRING, FLOAT&gt;,  \n    address STRUCT&lt;street:STRING, city:STRING, state:STRING, zip:INT&gt;,\n    dddd:UNIONTYPE&lt;data_type,data_type,....&gt;\n) PARTITIONED BY (country STRING, state STRING);  \n</code></pre><h3 id=\"四、数据分区\"><a href=\"#四、数据分区\" class=\"headerlink\" title=\"四、数据分区\"></a>四、数据分区</h3><p>数据分区为将数据按照指定字段的值来分别存放，这样在查询时，可以只查某一个分区的数据，以提高数据查询效率，也可以在数据的管理上更有效率。指定分区时，数据将按照分区字段先后的顺序来存放.<br>如：  </p>\n<pre><code> CREATE TABLE employees (.....)\nPARTITIONED BY (pt_dt string)\nROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;\\t&apos;\nSTORED AS TEXTFILE;\n</code></pre><h3 id=\"五、数据分桶\"><a href=\"#五、数据分桶\" class=\"headerlink\" title=\"五、数据分桶\"></a>五、数据分桶</h3><p>#####把表（或者分区）组织成桶（Bucket）有两个理由：<br>1.为获得更高的查询处理效率。桶为表加上了额外的结构，Hive 在处理有些查询时能利用这个结构。具体而言，连接两个在（包含连接列的）相同列上划分了桶的表，可以使用 Map 端连接 （Map-side join）高效的实现。比如JOIN操作。对于JOIN操作两个表有一个相同的列，如果对这两个表都进行了桶操作。那么将保存相同列值的桶进行JOIN操作就可以，可以大大较少JOIN的数据量。  </p>\n<p>2.使取样（sampling）更高效。在处理大规模数据集时，在开发和修改查询的阶段，如果能在数据集的一小部分数据上试运行查询，会带来很多方便。</p>\n<h3 id=\"六、数据导入与数据导出\"><a href=\"#六、数据导入与数据导出\" class=\"headerlink\" title=\"六、数据导入与数据导出\"></a>六、数据导入与数据导出</h3><p>在创建表时，可以指定3个属性[INPUTFORMAT, OUTPUTFORMAT, SERDE],由这些属性来指定数据的导入格式和导出格式<br>首先来理清这三者之间的关系，我们直接引用Hive官方说法：  </p>\n<pre><code>SerDe is a short name for “Serializer and Deserializer.”\nHive uses SerDe (and !FileFormat) to read and write table rows.\nHDFS files –&gt; InputFileFormat –&gt; &lt;key, value&gt; –&gt; Deserializer –&gt; Row object\nRow object –&gt; Serializer –&gt; &lt;key, value&gt; –&gt; OutputFileFormat –&gt; HDFS files\n</code></pre><p>总结一下，当面临一个HDFS上的文件时，Hive将如下处理（以读为例）：</p>\n<pre><code>1.调用InputFormat，将文件切成不同的文档。每篇文档即一行(Row)。  \n2.调用SerDe的Deserializer，将一行(Row)，切分为各个字段。\n</code></pre><p>当HIVE执行INSERT操作，将Row写入文件时，主要调用OutputFormat、SerDe的Seriliazer，顺序与读取相反<br>【INPUTFORMAT】属性的类必须实现org.apache.hadoop.mapred.InputFormat接口<br>【OUTPUTFORMAT】属性的类必须实现org.apache.hadoop.mapreduce.OutputFormat接口<br>【SERDE】属性的类必须实现org.apache.hadoop.hive.serde2接口</p>\n<p>###注：参考文档<br>    <a href=\"https://cwiki.apache.org/confluence/display/Hive/DeveloperGuide\" target=\"_blank\" rel=\"external\">https://cwiki.apache.org/confluence/display/Hive/DeveloperGuide</a><br>    <a href=\"https://hive.apache.org/javadocs/r1.2.1/api/\" target=\"_blank\" rel=\"external\">https://hive.apache.org/javadocs/r1.2.1/api/</a><br>    <a href=\"http://hadoop.apache.org/docs/r2.7.1/api/\" target=\"_blank\" rel=\"external\">http://hadoop.apache.org/docs/r2.7.1/api/</a><br>    <a href=\"https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL\" target=\"_blank\" rel=\"external\">https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"hive表的创建\"><a href=\"#hive表的创建\" class=\"headerlink\" title=\"hive表的创建\"></a>hive表的创建</h2><h3 id=\"一、语法\"><a href=\"#一、语法\" class=\"headerlink\" title=\"一、语法\"></a>一、语法</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\">CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name    -- (Note: TEMPORARY available in Hive 0.14.0 and later)</div><div class=\"line\">  [(col_name data_type [COMMENT col_comment], ...)]</div><div class=\"line\">  [COMMENT table_comment]</div><div class=\"line\">  [PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)]</div><div class=\"line\">  [CLUSTERED BY (col_name, col_name, ...) [SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS]</div><div class=\"line\">  [SKEWED BY (col_name, col_name, ...)                  -- (Note: Available in Hive 0.10.0 and later)]</div><div class=\"line\">     ON ((col_value, col_value, ...), (col_value, col_value, ...), ...)</div><div class=\"line\">     [STORED AS DIRECTORIES]</div><div class=\"line\">  [</div><div class=\"line\">   [ROW FORMAT row_format] </div><div class=\"line\">   [STORED AS file_format]</div><div class=\"line\">     | STORED BY 'storage.handler.class.name' [WITH SERDEPROPERTIES (...)]  -- (Note: Available in Hive 0.6.0 and later)</div><div class=\"line\">  ]</div><div class=\"line\">  [LOCATION hdfs_path]</div><div class=\"line\">  [TBLPROPERTIES (property_name=property_value, ...)]   -- (Note: Available in Hive 0.6.0 and later)</div><div class=\"line\">  [AS select_statement];   -- (Note: Available in Hive 0.5.0 and later; not supported for external tables)</div><div class=\"line\"> </div><div class=\"line\">CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name</div><div class=\"line\">  LIKE existing_table_or_view_name</div><div class=\"line\">  [LOCATION hdfs_path];</div><div class=\"line\"> </div><div class=\"line\">data_type</div><div class=\"line\">  : primitive_type</div><div class=\"line\">  | array_type</div><div class=\"line\">  | map_type</div><div class=\"line\">  | struct_type</div><div class=\"line\">  | union_type  -- (Note: Available in Hive 0.7.0 and later)</div><div class=\"line\"> </div><div class=\"line\">primitive_type</div><div class=\"line\">  : TINYINT</div><div class=\"line\">  | SMALLINT</div><div class=\"line\">  | INT</div><div class=\"line\">  | BIGINT</div><div class=\"line\">  | BOOLEAN</div><div class=\"line\">  | FLOAT</div><div class=\"line\">  | DOUBLE</div><div class=\"line\">  | STRING</div><div class=\"line\">  | BINARY      -- (Note: Available in Hive 0.8.0 and later)</div><div class=\"line\">  | TIMESTAMP   -- (Note: Available in Hive 0.8.0 and later)</div><div class=\"line\">  | DECIMAL     -- (Note: Available in Hive 0.11.0 and later)</div><div class=\"line\">  | DECIMAL(precision, scale)  -- (Note: Available in Hive 0.13.0 and later)</div><div class=\"line\">  | DATE        -- (Note: Available in Hive 0.12.0 and later)</div><div class=\"line\">  | VARCHAR     -- (Note: Available in Hive 0.12.0 and later)</div><div class=\"line\">  | CHAR        -- (Note: Available in Hive 0.13.0 and later)</div><div class=\"line\"> </div><div class=\"line\">array_type</div><div class=\"line\">  : ARRAY &lt; data_type &gt;</div><div class=\"line\"> </div><div class=\"line\">map_type</div><div class=\"line\">  : MAP &lt; primitive_type, data_type &gt;</div><div class=\"line\"> </div><div class=\"line\">struct_type</div><div class=\"line\">  : STRUCT &lt; col_name : data_type [COMMENT col_comment], ...&gt;</div><div class=\"line\"> </div><div class=\"line\">union_type</div><div class=\"line\">   : UNIONTYPE &lt; data_type, data_type, ... &gt;  -- (Note: Available in Hive 0.7.0 and later)</div><div class=\"line\"> </div><div class=\"line\">row_format</div><div class=\"line\">  : DELIMITED [FIELDS TERMINATED BY char [ESCAPED BY char]] [COLLECTION ITEMS TERMINATED BY char]</div><div class=\"line\">        [MAP KEYS TERMINATED BY char] [LINES TERMINATED BY char]</div><div class=\"line\">        [NULL DEFINED AS char]   -- (Note: Available in Hive 0.13 and later)</div><div class=\"line\">  | SERDE serde_name [WITH SERDEPROPERTIES (property_name=property_value, property_name=property_value, ...)]</div><div class=\"line\"> </div><div class=\"line\">file_format:</div><div class=\"line\">  : SEQUENCEFILE</div><div class=\"line\">  | TEXTFILE    -- (Default, depending on hive.default.fileformat configuration)</div><div class=\"line\">  | RCFILE      -- (Note: Available in Hive 0.6.0 and later)</div><div class=\"line\">  | ORC         -- (Note: Available in Hive 0.11.0 and later)</div><div class=\"line\">  | PARQUET     -- (Note: Available in Hive 0.13.0 and later)</div><div class=\"line\">  | AVRO        -- (Note: Available in Hive 0.14.0 and later)</div><div class=\"line\">  | INPUTFORMAT input_format_classname OUTPUTFORMAT output_format_classname</div></pre></td></tr></table></figure>\n<h3 id=\"二、创建表时的4种模式\"><a href=\"#二、创建表时的4种模式\" class=\"headerlink\" title=\"二、创建表时的4种模式\"></a>二、创建表时的4种模式</h3><ol>\n<li>TEMPORARY模式，在该模式下创建的表，只在当前session中有效，当前session关闭时，该表会被hive删除，不支持分区，也不支持创建索引.  </li>\n<li><p>EXTERNAL模式，俗称外部表，该模式的表，数据不由hive管理，删除表时，数据不会被删除，创建表时可以指定数据加载的路径如:  </p>\n<pre><code>CREATE EXTERNAL TABLE [IF NOT EXISTS] [db_name.]table_name\n LIKE existing_table_or_view_name\n[LOCATION hdfs_path];\n</code></pre></li>\n<li>默认模式，俗称管理表，该模式的表，数据由hive管理,删除表时数据也会被删除。</li>\n<li>Create Table As Select (CTAS)模式，该模式的表是由查询的结果来创建，在该模式下，不能创建分区表，不能创建外部表，也不支持数据分桶。  </li>\n</ol>\n<h3 id=\"三、表中的字段的数据类型\"><a href=\"#三、表中的字段的数据类型\" class=\"headerlink\" title=\"三、表中的字段的数据类型\"></a>三、表中的字段的数据类型</h3><h5 id=\"在hive中字段支持5种类型\"><a href=\"#在hive中字段支持5种类型\" class=\"headerlink\" title=\"在hive中字段支持5种类型:\"></a>在hive中字段支持5种类型:</h5><p>1.基本类型（primitive_type）:</p>\n<pre><code> TINYINT\n| SMALLINT\n| INT\n| BIGINT\n| BOOLEAN\n| FLOAT\n| DOUBLE\n| STRING\n| BINARY      \n| TIMESTAMP   \n| DECIMAL    \n| DECIMAL(precision, scale)  \n| DATE        \n| VARCHAR     \n| CHAR \n</code></pre><p>2.数组类型（array_type）<br>3.字典类型(map_type)<br>4.结构类型(struct_type)<br>5.联合类型(union_type)<br>如:  </p>\n<pre><code>CREATE TABLE employees (  \n    name STRING,  \n    salary FLOAT,  \n    subordinates ARRAY&lt;STRING&gt;,  \n    deductions MAP&lt;STRING, FLOAT&gt;,  \n    address STRUCT&lt;street:STRING, city:STRING, state:STRING, zip:INT&gt;,\n    dddd:UNIONTYPE&lt;data_type,data_type,....&gt;\n) PARTITIONED BY (country STRING, state STRING);  \n</code></pre><h3 id=\"四、数据分区\"><a href=\"#四、数据分区\" class=\"headerlink\" title=\"四、数据分区\"></a>四、数据分区</h3><p>数据分区为将数据按照指定字段的值来分别存放，这样在查询时，可以只查某一个分区的数据，以提高数据查询效率，也可以在数据的管理上更有效率。指定分区时，数据将按照分区字段先后的顺序来存放.<br>如：  </p>\n<pre><code> CREATE TABLE employees (.....)\nPARTITIONED BY (pt_dt string)\nROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;\\t&apos;\nSTORED AS TEXTFILE;\n</code></pre><h3 id=\"五、数据分桶\"><a href=\"#五、数据分桶\" class=\"headerlink\" title=\"五、数据分桶\"></a>五、数据分桶</h3><p>#####把表（或者分区）组织成桶（Bucket）有两个理由：<br>1.为获得更高的查询处理效率。桶为表加上了额外的结构，Hive 在处理有些查询时能利用这个结构。具体而言，连接两个在（包含连接列的）相同列上划分了桶的表，可以使用 Map 端连接 （Map-side join）高效的实现。比如JOIN操作。对于JOIN操作两个表有一个相同的列，如果对这两个表都进行了桶操作。那么将保存相同列值的桶进行JOIN操作就可以，可以大大较少JOIN的数据量。  </p>\n<p>2.使取样（sampling）更高效。在处理大规模数据集时，在开发和修改查询的阶段，如果能在数据集的一小部分数据上试运行查询，会带来很多方便。</p>\n<h3 id=\"六、数据导入与数据导出\"><a href=\"#六、数据导入与数据导出\" class=\"headerlink\" title=\"六、数据导入与数据导出\"></a>六、数据导入与数据导出</h3><p>在创建表时，可以指定3个属性[INPUTFORMAT, OUTPUTFORMAT, SERDE],由这些属性来指定数据的导入格式和导出格式<br>首先来理清这三者之间的关系，我们直接引用Hive官方说法：  </p>\n<pre><code>SerDe is a short name for “Serializer and Deserializer.”\nHive uses SerDe (and !FileFormat) to read and write table rows.\nHDFS files –&gt; InputFileFormat –&gt; &lt;key, value&gt; –&gt; Deserializer –&gt; Row object\nRow object –&gt; Serializer –&gt; &lt;key, value&gt; –&gt; OutputFileFormat –&gt; HDFS files\n</code></pre><p>总结一下，当面临一个HDFS上的文件时，Hive将如下处理（以读为例）：</p>\n<pre><code>1.调用InputFormat，将文件切成不同的文档。每篇文档即一行(Row)。  \n2.调用SerDe的Deserializer，将一行(Row)，切分为各个字段。\n</code></pre><p>当HIVE执行INSERT操作，将Row写入文件时，主要调用OutputFormat、SerDe的Seriliazer，顺序与读取相反<br>【INPUTFORMAT】属性的类必须实现org.apache.hadoop.mapred.InputFormat接口<br>【OUTPUTFORMAT】属性的类必须实现org.apache.hadoop.mapreduce.OutputFormat接口<br>【SERDE】属性的类必须实现org.apache.hadoop.hive.serde2接口</p>\n<p>###注：参考文档<br>    <a href=\"https://cwiki.apache.org/confluence/display/Hive/DeveloperGuide\" target=\"_blank\" rel=\"external\">https://cwiki.apache.org/confluence/display/Hive/DeveloperGuide</a><br>    <a href=\"https://hive.apache.org/javadocs/r1.2.1/api/\" target=\"_blank\" rel=\"external\">https://hive.apache.org/javadocs/r1.2.1/api/</a><br>    <a href=\"http://hadoop.apache.org/docs/r2.7.1/api/\" target=\"_blank\" rel=\"external\">http://hadoop.apache.org/docs/r2.7.1/api/</a><br>    <a href=\"https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL\" target=\"_blank\" rel=\"external\">https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL</a></p>\n"},{"title":"centos 6.5安装JDK1.8","date":"2018-05-31T05:57:23.000Z","_content":"\n### 下载安装包\njdk-8u161-linux-x64.tar.gz\n\n### 解压安装包\ntar xvf jdk-8u161-linux-x64.tar.gz\n\n### 拷贝安装包到/usr/local 目录\nmv jdk1.8.0_161 /usr/local/\n### 设置/etc/profile环境变量\n```\nexport GREP_OPTIONS=--color=auto\n\n\nexport JAVA_HOME=/usr/local/jdk1.8.0_161\n\nexport PATH=$JAVA_HOME/bin:$PATH\n\nexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\n```\n\n### source /etc/profile 生效","source":"_posts/jdk1.8安装.md","raw":"---\ntitle: centos 6.5安装JDK1.8\ndate: 2018-05-31 13:57:23\ncategories: \n\t- java\ntags:\n\t- 安装\n---\n\n### 下载安装包\njdk-8u161-linux-x64.tar.gz\n\n### 解压安装包\ntar xvf jdk-8u161-linux-x64.tar.gz\n\n### 拷贝安装包到/usr/local 目录\nmv jdk1.8.0_161 /usr/local/\n### 设置/etc/profile环境变量\n```\nexport GREP_OPTIONS=--color=auto\n\n\nexport JAVA_HOME=/usr/local/jdk1.8.0_161\n\nexport PATH=$JAVA_HOME/bin:$PATH\n\nexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\n```\n\n### source /etc/profile 生效","slug":"jdk1.8安装","published":1,"updated":"2018-05-31T03:06:29.865Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exu000q1fihg1c9jihs","content":"<h3 id=\"下载安装包\"><a href=\"#下载安装包\" class=\"headerlink\" title=\"下载安装包\"></a>下载安装包</h3><p>jdk-8u161-linux-x64.tar.gz</p>\n<h3 id=\"解压安装包\"><a href=\"#解压安装包\" class=\"headerlink\" title=\"解压安装包\"></a>解压安装包</h3><p>tar xvf jdk-8u161-linux-x64.tar.gz</p>\n<h3 id=\"拷贝安装包到-usr-local-目录\"><a href=\"#拷贝安装包到-usr-local-目录\" class=\"headerlink\" title=\"拷贝安装包到/usr/local 目录\"></a>拷贝安装包到/usr/local 目录</h3><p>mv jdk1.8.0_161 /usr/local/</p>\n<h3 id=\"设置-etc-profile环境变量\"><a href=\"#设置-etc-profile环境变量\" class=\"headerlink\" title=\"设置/etc/profile环境变量\"></a>设置/etc/profile环境变量</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">export GREP_OPTIONS=--color=auto</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">export JAVA_HOME=/usr/local/jdk1.8.0_161</div><div class=\"line\"></div><div class=\"line\">export PATH=$JAVA_HOME/bin:$PATH</div><div class=\"line\"></div><div class=\"line\">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</div></pre></td></tr></table></figure>\n<h3 id=\"source-etc-profile-生效\"><a href=\"#source-etc-profile-生效\" class=\"headerlink\" title=\"source /etc/profile 生效\"></a>source /etc/profile 生效</h3>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"下载安装包\"><a href=\"#下载安装包\" class=\"headerlink\" title=\"下载安装包\"></a>下载安装包</h3><p>jdk-8u161-linux-x64.tar.gz</p>\n<h3 id=\"解压安装包\"><a href=\"#解压安装包\" class=\"headerlink\" title=\"解压安装包\"></a>解压安装包</h3><p>tar xvf jdk-8u161-linux-x64.tar.gz</p>\n<h3 id=\"拷贝安装包到-usr-local-目录\"><a href=\"#拷贝安装包到-usr-local-目录\" class=\"headerlink\" title=\"拷贝安装包到/usr/local 目录\"></a>拷贝安装包到/usr/local 目录</h3><p>mv jdk1.8.0_161 /usr/local/</p>\n<h3 id=\"设置-etc-profile环境变量\"><a href=\"#设置-etc-profile环境变量\" class=\"headerlink\" title=\"设置/etc/profile环境变量\"></a>设置/etc/profile环境变量</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">export GREP_OPTIONS=--color=auto</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">export JAVA_HOME=/usr/local/jdk1.8.0_161</div><div class=\"line\"></div><div class=\"line\">export PATH=$JAVA_HOME/bin:$PATH</div><div class=\"line\"></div><div class=\"line\">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</div></pre></td></tr></table></figure>\n<h3 id=\"source-etc-profile-生效\"><a href=\"#source-etc-profile-生效\" class=\"headerlink\" title=\"source /etc/profile 生效\"></a>source /etc/profile 生效</h3>"},{"title":"leetcode算法，查找指定数和的元素的索引","date":"2018-04-04T05:57:23.000Z","_content":"\n### 问题描述\n **给定一个整数数列，找出其中和为特定值的那两个数。  \n 你可以假设每个输入都只会有一种答案，同样的元素不能被重用。**\n\n### 示例:   \n\t给定：nums = [2, 7, 11, 15] , target = 9  \n\t因为：nums[0] + nums[1] = 2 + 7 = 9 \n\t所以返回： [0, 1]\n\n### 实现：\n```java\npublic static int[] code(int [] arr,int num){\n        Map<Integer,Integer> dataIndex = new HashMap<Integer, Integer>();\n\n        for(int i=0,s=arr.length;i<s;i++){\n            int v= num - arr[i]; //如果和相等，即代表减法之中，肯定有一个能找到对应的\n\n            if (v >= 0) {//默认没有负数\n                if(i != 0 && dataIndex.containsKey(v)){ //将前面存储的找到。即为相应的\n                    return new int[]{dataIndex.get(v),i};\n                }\n                dataIndex.put(arr[i], i);//存储值和索引\n            }\n\n        }\n        return null;\n}\n```\n### leetcode最优解：\n支持负数元素，少了判断\n\n```\npublic int[] twoSum(int[] nums, int target) {\n    Map<Integer, Integer> map = new HashMap<>();\n    for (int i = 0; i < nums.length; i++) {\n        int complement = target - nums[i];\n        if (map.containsKey(complement)) {\n            return new int[] { map.get(complement), i };\n        }\n        map.put(nums[i], i);\n    }\n    throw new IllegalArgumentException(\"No two sum solution\");\n}\n```\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/leetcode1.md","raw":"---\ntitle: leetcode算法，查找指定数和的元素的索引\ndate: 2018-04-04 13:57:23\ncategories: \n\t- 算法\ntags:\n\t- 数组\n\t- 查找index\n---\n\n### 问题描述\n **给定一个整数数列，找出其中和为特定值的那两个数。  \n 你可以假设每个输入都只会有一种答案，同样的元素不能被重用。**\n\n### 示例:   \n\t给定：nums = [2, 7, 11, 15] , target = 9  \n\t因为：nums[0] + nums[1] = 2 + 7 = 9 \n\t所以返回： [0, 1]\n\n### 实现：\n```java\npublic static int[] code(int [] arr,int num){\n        Map<Integer,Integer> dataIndex = new HashMap<Integer, Integer>();\n\n        for(int i=0,s=arr.length;i<s;i++){\n            int v= num - arr[i]; //如果和相等，即代表减法之中，肯定有一个能找到对应的\n\n            if (v >= 0) {//默认没有负数\n                if(i != 0 && dataIndex.containsKey(v)){ //将前面存储的找到。即为相应的\n                    return new int[]{dataIndex.get(v),i};\n                }\n                dataIndex.put(arr[i], i);//存储值和索引\n            }\n\n        }\n        return null;\n}\n```\n### leetcode最优解：\n支持负数元素，少了判断\n\n```\npublic int[] twoSum(int[] nums, int target) {\n    Map<Integer, Integer> map = new HashMap<>();\n    for (int i = 0; i < nums.length; i++) {\n        int complement = target - nums[i];\n        if (map.containsKey(complement)) {\n            return new int[] { map.get(complement), i };\n        }\n        map.put(nums[i], i);\n    }\n    throw new IllegalArgumentException(\"No two sum solution\");\n}\n```\n\n\n\n\n\n\n\n\n\n\n\n","slug":"leetcode1","published":1,"updated":"2018-04-06T05:52:55.386Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exv000r1fihcrq04e0t","content":"<h3 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h3><p> <strong>给定一个整数数列，找出其中和为特定值的那两个数。<br> 你可以假设每个输入都只会有一种答案，同样的元素不能被重用。</strong></p>\n<h3 id=\"示例\"><a href=\"#示例\" class=\"headerlink\" title=\"示例:\"></a>示例:</h3><pre><code>给定：nums = [2, 7, 11, 15] , target = 9  \n因为：nums[0] + nums[1] = 2 + 7 = 9 \n所以返回： [0, 1]\n</code></pre><h3 id=\"实现：\"><a href=\"#实现：\" class=\"headerlink\" title=\"实现：\"></a>实现：</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span>[] code(<span class=\"keyword\">int</span> [] arr,<span class=\"keyword\">int</span> num)&#123;</div><div class=\"line\">        Map&lt;Integer,Integer&gt; dataIndex = <span class=\"keyword\">new</span> HashMap&lt;Integer, Integer&gt;();</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>,s=arr.length;i&lt;s;i++)&#123;</div><div class=\"line\">            <span class=\"keyword\">int</span> v= num - arr[i]; <span class=\"comment\">//如果和相等，即代表减法之中，肯定有一个能找到对应的</span></div><div class=\"line\"></div><div class=\"line\">            <span class=\"keyword\">if</span> (v &gt;= <span class=\"number\">0</span>) &#123;<span class=\"comment\">//默认没有负数</span></div><div class=\"line\">                <span class=\"keyword\">if</span>(i != <span class=\"number\">0</span> &amp;&amp; dataIndex.containsKey(v))&#123; <span class=\"comment\">//将前面存储的找到。即为相应的</span></div><div class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[]&#123;dataIndex.get(v),i&#125;;</div><div class=\"line\">                &#125;</div><div class=\"line\">                dataIndex.put(arr[i], i);<span class=\"comment\">//存储值和索引</span></div><div class=\"line\">            &#125;</div><div class=\"line\"></div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"leetcode最优解：\"><a href=\"#leetcode最优解：\" class=\"headerlink\" title=\"leetcode最优解：\"></a>leetcode最优解：</h3><p>支持负数元素，少了判断</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">public int[] twoSum(int[] nums, int target) &#123;</div><div class=\"line\">    Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();</div><div class=\"line\">    for (int i = 0; i &lt; nums.length; i++) &#123;</div><div class=\"line\">        int complement = target - nums[i];</div><div class=\"line\">        if (map.containsKey(complement)) &#123;</div><div class=\"line\">            return new int[] &#123; map.get(complement), i &#125;;</div><div class=\"line\">        &#125;</div><div class=\"line\">        map.put(nums[i], i);</div><div class=\"line\">    &#125;</div><div class=\"line\">    throw new IllegalArgumentException(&quot;No two sum solution&quot;);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h3><p> <strong>给定一个整数数列，找出其中和为特定值的那两个数。<br> 你可以假设每个输入都只会有一种答案，同样的元素不能被重用。</strong></p>\n<h3 id=\"示例\"><a href=\"#示例\" class=\"headerlink\" title=\"示例:\"></a>示例:</h3><pre><code>给定：nums = [2, 7, 11, 15] , target = 9  \n因为：nums[0] + nums[1] = 2 + 7 = 9 \n所以返回： [0, 1]\n</code></pre><h3 id=\"实现：\"><a href=\"#实现：\" class=\"headerlink\" title=\"实现：\"></a>实现：</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span>[] code(<span class=\"keyword\">int</span> [] arr,<span class=\"keyword\">int</span> num)&#123;</div><div class=\"line\">        Map&lt;Integer,Integer&gt; dataIndex = <span class=\"keyword\">new</span> HashMap&lt;Integer, Integer&gt;();</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>,s=arr.length;i&lt;s;i++)&#123;</div><div class=\"line\">            <span class=\"keyword\">int</span> v= num - arr[i]; <span class=\"comment\">//如果和相等，即代表减法之中，肯定有一个能找到对应的</span></div><div class=\"line\"></div><div class=\"line\">            <span class=\"keyword\">if</span> (v &gt;= <span class=\"number\">0</span>) &#123;<span class=\"comment\">//默认没有负数</span></div><div class=\"line\">                <span class=\"keyword\">if</span>(i != <span class=\"number\">0</span> &amp;&amp; dataIndex.containsKey(v))&#123; <span class=\"comment\">//将前面存储的找到。即为相应的</span></div><div class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[]&#123;dataIndex.get(v),i&#125;;</div><div class=\"line\">                &#125;</div><div class=\"line\">                dataIndex.put(arr[i], i);<span class=\"comment\">//存储值和索引</span></div><div class=\"line\">            &#125;</div><div class=\"line\"></div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"leetcode最优解：\"><a href=\"#leetcode最优解：\" class=\"headerlink\" title=\"leetcode最优解：\"></a>leetcode最优解：</h3><p>支持负数元素，少了判断</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">public int[] twoSum(int[] nums, int target) &#123;</div><div class=\"line\">    Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();</div><div class=\"line\">    for (int i = 0; i &lt; nums.length; i++) &#123;</div><div class=\"line\">        int complement = target - nums[i];</div><div class=\"line\">        if (map.containsKey(complement)) &#123;</div><div class=\"line\">            return new int[] &#123; map.get(complement), i &#125;;</div><div class=\"line\">        &#125;</div><div class=\"line\">        map.put(nums[i], i);</div><div class=\"line\">    &#125;</div><div class=\"line\">    throw new IllegalArgumentException(&quot;No two sum solution&quot;);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n"},{"title":"hyperledger 测试部署","date":"2019-08-16T05:57:23.000Z","_content":"\n\n### 下载\n```\ngit clone https://github.com/hyperledger/fabric-samples.git\n```\n### 执行安装程序,安装环境，拉取docker镜像\n```\n\t./bootstrap.sh\n```\n### 启动测试\n```\ndocker-compose -f docker-compose.yml up -d\n\n```\n\n### 查看运行多少镜像\n```\ndocker ps\n```\n#### 切换环境到管理员用户的 MSP ，进入 Peer 节点容器 peerO.orgl.example .com\n\n```\ndocker exec -it -e \"CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/users/Admin@org1.example.com/msp\" peer0.org1.example.com bash\n```\n#### 创建通道\n\n```\npeer channel create -o orderer.example.com:7050 -c mychannel -f /etc/hyperledger/configtx/channel.tx\n```\n#### 加入通道\n```\npeer channel join -b mychannel.block\n```\n#### 退出 Peer 节点容器 peerO.orgl.example .com\n```\nexit\n```\n#### 进入 cli 容器\n```\ndocker exec -it cli /bin/bash\n```\n\n### 给 Peer 节点 peerO.orgl.example.com 安装链码\n```\n-- cp /opt/gopath/src/github.com/chaincode_example02/go/chaincode_example02.go\n-- $GOPATH/src/\n-- peer chaincode install -n mycc -v vO -p github.com/chaincode_example02/go\npeer chaincode install -n mycc -v 1.0 -p github.com/chaincode_example02/go\n```\n\n#### 实例化链码\n\n```\n-- peer chaincode instantiate -o orderer.example.com:7050 -C mychannel -n mycc -v v0 -c '{\"Args\":[\"init\",\"a\",\"100\",\"b\",\"200\"]}'\npeer chaincode instantiate -o orderer.example.com:7050 -C mychannel -n mycc -c '{\"Args\":[\"init\",\"A\",\"10\",\"B\",\"10\"]}' -P \"OR ('Org1MSP.member')\" -v 1.0\n```\n\n#### 查询\n\n```\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"A\"]}'\n```\n#### 转移 调用链码， 从“ a ”转移 IO 到“ b ”：\n```\npeer chaincode invoke -C mychannel -n mycc  -c '{\"Args\":[\"invoke\",\"A\",\"B\",\"10\"]}'\n```\n#### 查询转移后的值\n```\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"A\"]}'\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"B\"]}'\n```\n\n\n\n\n\n\n","source":"_posts/hyperledger部署测试.md","raw":"---\ntitle: hyperledger 测试部署\ndate: 2019-08-16 13:57:23\ncategories: \n\t- 区块链\n\t- hyperledger\ntags:\n\t- hyperledger 测试\n---\n\n\n### 下载\n```\ngit clone https://github.com/hyperledger/fabric-samples.git\n```\n### 执行安装程序,安装环境，拉取docker镜像\n```\n\t./bootstrap.sh\n```\n### 启动测试\n```\ndocker-compose -f docker-compose.yml up -d\n\n```\n\n### 查看运行多少镜像\n```\ndocker ps\n```\n#### 切换环境到管理员用户的 MSP ，进入 Peer 节点容器 peerO.orgl.example .com\n\n```\ndocker exec -it -e \"CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/users/Admin@org1.example.com/msp\" peer0.org1.example.com bash\n```\n#### 创建通道\n\n```\npeer channel create -o orderer.example.com:7050 -c mychannel -f /etc/hyperledger/configtx/channel.tx\n```\n#### 加入通道\n```\npeer channel join -b mychannel.block\n```\n#### 退出 Peer 节点容器 peerO.orgl.example .com\n```\nexit\n```\n#### 进入 cli 容器\n```\ndocker exec -it cli /bin/bash\n```\n\n### 给 Peer 节点 peerO.orgl.example.com 安装链码\n```\n-- cp /opt/gopath/src/github.com/chaincode_example02/go/chaincode_example02.go\n-- $GOPATH/src/\n-- peer chaincode install -n mycc -v vO -p github.com/chaincode_example02/go\npeer chaincode install -n mycc -v 1.0 -p github.com/chaincode_example02/go\n```\n\n#### 实例化链码\n\n```\n-- peer chaincode instantiate -o orderer.example.com:7050 -C mychannel -n mycc -v v0 -c '{\"Args\":[\"init\",\"a\",\"100\",\"b\",\"200\"]}'\npeer chaincode instantiate -o orderer.example.com:7050 -C mychannel -n mycc -c '{\"Args\":[\"init\",\"A\",\"10\",\"B\",\"10\"]}' -P \"OR ('Org1MSP.member')\" -v 1.0\n```\n\n#### 查询\n\n```\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"A\"]}'\n```\n#### 转移 调用链码， 从“ a ”转移 IO 到“ b ”：\n```\npeer chaincode invoke -C mychannel -n mycc  -c '{\"Args\":[\"invoke\",\"A\",\"B\",\"10\"]}'\n```\n#### 查询转移后的值\n```\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"A\"]}'\npeer chaincode query -C mychannel -n mycc -c '{\"Args\":[\"query\",\"B\"]}'\n```\n\n\n\n\n\n\n","slug":"hyperledger部署测试","published":1,"updated":"2019-08-16T02:56:15.546Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exw000u1fihyymywovr","content":"<h3 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">git clone https://github.com/hyperledger/fabric-samples.git</div></pre></td></tr></table></figure>\n<h3 id=\"执行安装程序-安装环境，拉取docker镜像\"><a href=\"#执行安装程序-安装环境，拉取docker镜像\" class=\"headerlink\" title=\"执行安装程序,安装环境，拉取docker镜像\"></a>执行安装程序,安装环境，拉取docker镜像</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./bootstrap.sh</div></pre></td></tr></table></figure>\n<h3 id=\"启动测试\"><a href=\"#启动测试\" class=\"headerlink\" title=\"启动测试\"></a>启动测试</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose.yml up -d</div></pre></td></tr></table></figure>\n<h3 id=\"查看运行多少镜像\"><a href=\"#查看运行多少镜像\" class=\"headerlink\" title=\"查看运行多少镜像\"></a>查看运行多少镜像</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker ps</div></pre></td></tr></table></figure>\n<h4 id=\"切换环境到管理员用户的-MSP-，进入-Peer-节点容器-peerO-orgl-example-com\"><a href=\"#切换环境到管理员用户的-MSP-，进入-Peer-节点容器-peerO-orgl-example-com\" class=\"headerlink\" title=\"切换环境到管理员用户的 MSP ，进入 Peer 节点容器 peerO.orgl.example .com\"></a>切换环境到管理员用户的 MSP ，进入 Peer 节点容器 peerO.orgl.example .com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it -e &quot;CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/users/Admin@org1.example.com/msp&quot; peer0.org1.example.com bash</div></pre></td></tr></table></figure>\n<h4 id=\"创建通道\"><a href=\"#创建通道\" class=\"headerlink\" title=\"创建通道\"></a>创建通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer channel create -o orderer.example.com:7050 -c mychannel -f /etc/hyperledger/configtx/channel.tx</div></pre></td></tr></table></figure>\n<h4 id=\"加入通道\"><a href=\"#加入通道\" class=\"headerlink\" title=\"加入通道\"></a>加入通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer channel join -b mychannel.block</div></pre></td></tr></table></figure>\n<h4 id=\"退出-Peer-节点容器-peerO-orgl-example-com\"><a href=\"#退出-Peer-节点容器-peerO-orgl-example-com\" class=\"headerlink\" title=\"退出 Peer 节点容器 peerO.orgl.example .com\"></a>退出 Peer 节点容器 peerO.orgl.example .com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">exit</div></pre></td></tr></table></figure>\n<h4 id=\"进入-cli-容器\"><a href=\"#进入-cli-容器\" class=\"headerlink\" title=\"进入 cli 容器\"></a>进入 cli 容器</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it cli /bin/bash</div></pre></td></tr></table></figure>\n<h3 id=\"给-Peer-节点-peerO-orgl-example-com-安装链码\"><a href=\"#给-Peer-节点-peerO-orgl-example-com-安装链码\" class=\"headerlink\" title=\"给 Peer 节点 peerO.orgl.example.com 安装链码\"></a>给 Peer 节点 peerO.orgl.example.com 安装链码</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">-- cp /opt/gopath/src/github.com/chaincode_example02/go/chaincode_example02.go</div><div class=\"line\">-- $GOPATH/src/</div><div class=\"line\">-- peer chaincode install -n mycc -v vO -p github.com/chaincode_example02/go</div><div class=\"line\">peer chaincode install -n mycc -v 1.0 -p github.com/chaincode_example02/go</div></pre></td></tr></table></figure>\n<h4 id=\"实例化链码\"><a href=\"#实例化链码\" class=\"headerlink\" title=\"实例化链码\"></a>实例化链码</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">-- peer chaincode instantiate -o orderer.example.com:7050 -C mychannel -n mycc -v v0 -c &apos;&#123;&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;,&quot;100&quot;,&quot;b&quot;,&quot;200&quot;]&#125;&apos;</div><div class=\"line\">peer chaincode instantiate -o orderer.example.com:7050 -C mychannel -n mycc -c &apos;&#123;&quot;Args&quot;:[&quot;init&quot;,&quot;A&quot;,&quot;10&quot;,&quot;B&quot;,&quot;10&quot;]&#125;&apos; -P &quot;OR (&apos;Org1MSP.member&apos;)&quot; -v 1.0</div></pre></td></tr></table></figure>\n<h4 id=\"查询\"><a href=\"#查询\" class=\"headerlink\" title=\"查询\"></a>查询</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode query -C mychannel -n mycc -c &apos;&#123;&quot;Args&quot;:[&quot;query&quot;,&quot;A&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<h4 id=\"转移-调用链码，-从“-a-”转移-IO-到“-b-”：\"><a href=\"#转移-调用链码，-从“-a-”转移-IO-到“-b-”：\" class=\"headerlink\" title=\"转移 调用链码， 从“ a ”转移 IO 到“ b ”：\"></a>转移 调用链码， 从“ a ”转移 IO 到“ b ”：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode invoke -C mychannel -n mycc  -c &apos;&#123;&quot;Args&quot;:[&quot;invoke&quot;,&quot;A&quot;,&quot;B&quot;,&quot;10&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<h4 id=\"查询转移后的值\"><a href=\"#查询转移后的值\" class=\"headerlink\" title=\"查询转移后的值\"></a>查询转移后的值</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode query -C mychannel -n mycc -c &apos;&#123;&quot;Args&quot;:[&quot;query&quot;,&quot;A&quot;]&#125;&apos;</div><div class=\"line\">peer chaincode query -C mychannel -n mycc -c &apos;&#123;&quot;Args&quot;:[&quot;query&quot;,&quot;B&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">git clone https://github.com/hyperledger/fabric-samples.git</div></pre></td></tr></table></figure>\n<h3 id=\"执行安装程序-安装环境，拉取docker镜像\"><a href=\"#执行安装程序-安装环境，拉取docker镜像\" class=\"headerlink\" title=\"执行安装程序,安装环境，拉取docker镜像\"></a>执行安装程序,安装环境，拉取docker镜像</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./bootstrap.sh</div></pre></td></tr></table></figure>\n<h3 id=\"启动测试\"><a href=\"#启动测试\" class=\"headerlink\" title=\"启动测试\"></a>启动测试</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker-compose -f docker-compose.yml up -d</div></pre></td></tr></table></figure>\n<h3 id=\"查看运行多少镜像\"><a href=\"#查看运行多少镜像\" class=\"headerlink\" title=\"查看运行多少镜像\"></a>查看运行多少镜像</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker ps</div></pre></td></tr></table></figure>\n<h4 id=\"切换环境到管理员用户的-MSP-，进入-Peer-节点容器-peerO-orgl-example-com\"><a href=\"#切换环境到管理员用户的-MSP-，进入-Peer-节点容器-peerO-orgl-example-com\" class=\"headerlink\" title=\"切换环境到管理员用户的 MSP ，进入 Peer 节点容器 peerO.orgl.example .com\"></a>切换环境到管理员用户的 MSP ，进入 Peer 节点容器 peerO.orgl.example .com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it -e &quot;CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/users/Admin@org1.example.com/msp&quot; peer0.org1.example.com bash</div></pre></td></tr></table></figure>\n<h4 id=\"创建通道\"><a href=\"#创建通道\" class=\"headerlink\" title=\"创建通道\"></a>创建通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer channel create -o orderer.example.com:7050 -c mychannel -f /etc/hyperledger/configtx/channel.tx</div></pre></td></tr></table></figure>\n<h4 id=\"加入通道\"><a href=\"#加入通道\" class=\"headerlink\" title=\"加入通道\"></a>加入通道</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer channel join -b mychannel.block</div></pre></td></tr></table></figure>\n<h4 id=\"退出-Peer-节点容器-peerO-orgl-example-com\"><a href=\"#退出-Peer-节点容器-peerO-orgl-example-com\" class=\"headerlink\" title=\"退出 Peer 节点容器 peerO.orgl.example .com\"></a>退出 Peer 节点容器 peerO.orgl.example .com</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">exit</div></pre></td></tr></table></figure>\n<h4 id=\"进入-cli-容器\"><a href=\"#进入-cli-容器\" class=\"headerlink\" title=\"进入 cli 容器\"></a>进入 cli 容器</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">docker exec -it cli /bin/bash</div></pre></td></tr></table></figure>\n<h3 id=\"给-Peer-节点-peerO-orgl-example-com-安装链码\"><a href=\"#给-Peer-节点-peerO-orgl-example-com-安装链码\" class=\"headerlink\" title=\"给 Peer 节点 peerO.orgl.example.com 安装链码\"></a>给 Peer 节点 peerO.orgl.example.com 安装链码</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">-- cp /opt/gopath/src/github.com/chaincode_example02/go/chaincode_example02.go</div><div class=\"line\">-- $GOPATH/src/</div><div class=\"line\">-- peer chaincode install -n mycc -v vO -p github.com/chaincode_example02/go</div><div class=\"line\">peer chaincode install -n mycc -v 1.0 -p github.com/chaincode_example02/go</div></pre></td></tr></table></figure>\n<h4 id=\"实例化链码\"><a href=\"#实例化链码\" class=\"headerlink\" title=\"实例化链码\"></a>实例化链码</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">-- peer chaincode instantiate -o orderer.example.com:7050 -C mychannel -n mycc -v v0 -c &apos;&#123;&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;,&quot;100&quot;,&quot;b&quot;,&quot;200&quot;]&#125;&apos;</div><div class=\"line\">peer chaincode instantiate -o orderer.example.com:7050 -C mychannel -n mycc -c &apos;&#123;&quot;Args&quot;:[&quot;init&quot;,&quot;A&quot;,&quot;10&quot;,&quot;B&quot;,&quot;10&quot;]&#125;&apos; -P &quot;OR (&apos;Org1MSP.member&apos;)&quot; -v 1.0</div></pre></td></tr></table></figure>\n<h4 id=\"查询\"><a href=\"#查询\" class=\"headerlink\" title=\"查询\"></a>查询</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode query -C mychannel -n mycc -c &apos;&#123;&quot;Args&quot;:[&quot;query&quot;,&quot;A&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<h4 id=\"转移-调用链码，-从“-a-”转移-IO-到“-b-”：\"><a href=\"#转移-调用链码，-从“-a-”转移-IO-到“-b-”：\" class=\"headerlink\" title=\"转移 调用链码， 从“ a ”转移 IO 到“ b ”：\"></a>转移 调用链码， 从“ a ”转移 IO 到“ b ”：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode invoke -C mychannel -n mycc  -c &apos;&#123;&quot;Args&quot;:[&quot;invoke&quot;,&quot;A&quot;,&quot;B&quot;,&quot;10&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n<h4 id=\"查询转移后的值\"><a href=\"#查询转移后的值\" class=\"headerlink\" title=\"查询转移后的值\"></a>查询转移后的值</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">peer chaincode query -C mychannel -n mycc -c &apos;&#123;&quot;Args&quot;:[&quot;query&quot;,&quot;A&quot;]&#125;&apos;</div><div class=\"line\">peer chaincode query -C mychannel -n mycc -c &apos;&#123;&quot;Args&quot;:[&quot;query&quot;,&quot;B&quot;]&#125;&apos;</div></pre></td></tr></table></figure>\n"},{"title":"java 垃圾回收","date":"2017-07-01T05:39:23.000Z","_content":"\n### 分析对象是否已经死亡\n* 引用计数法\n  优点：实现简单，在远古的jdk版本中是该种方式，python2.7里面的回收也是这种方式\n  缺点：容易内存泄露，对象循环依赖，类似于死锁\n  \n* 可达性分析（一般第一次标记，第二次如果确实没有引用会回收）\n\n### 回收算法\n* 标记-清除算法\n> 可达性分析后，进行标记，然后清除  \n> 缺点：效率不是很高，标记清除后会产生不连续的内存碎片，如果创建大对象时，可分配的连续内存不足时，会提前进行垃圾回收动作。\n  \n* 复制算法\n> 可达性分析后，进行标记，将活着的对象复制到内存的另一块上面，然后将已使用过的内存一次性清除干净。  \n> 优点: 实现简单，运行高效，现在的商用虚拟机一般都用来回收新生代，新生代里面分为eden区和2个survivor,比率一般是8:1，回收时将eden区和一个survivor存活的对象复制到另一个空着的survivor区，\n> 如果空间不够，会向老年代申请空间，采用分配担保的方式。   \n> 缺点：可运行内存缩小为原先的一半，另一半要一直空着，等待下次回收时使用。\n* 标记整理算法\n> 在老年代，将存活的对象，移向一端，然后清理掉边界外的内存。\n* 分代算法\n> 将虚拟机根据对象的存活周期不同将内存划分为几块。一般分为新生代和老年代。在不同的年代，采用不同的算法。   \n\n### 可达性分析\n* 全局性的引用（如常量和静态属性）\n* 执行的上下文（栈帧的本地变量表）\n\n### 垃圾收集器\n\n\n\n\n","source":"_posts/java 垃圾回收.md","raw":"---\ntitle: java 垃圾回收\ndate: 2017-07-01 13:39:23\ncategories: \n\t- java\ntags:\n\t- java\n\t- 垃圾回收\n\t- 读书笔记\n\t- jvm\n---\n\n### 分析对象是否已经死亡\n* 引用计数法\n  优点：实现简单，在远古的jdk版本中是该种方式，python2.7里面的回收也是这种方式\n  缺点：容易内存泄露，对象循环依赖，类似于死锁\n  \n* 可达性分析（一般第一次标记，第二次如果确实没有引用会回收）\n\n### 回收算法\n* 标记-清除算法\n> 可达性分析后，进行标记，然后清除  \n> 缺点：效率不是很高，标记清除后会产生不连续的内存碎片，如果创建大对象时，可分配的连续内存不足时，会提前进行垃圾回收动作。\n  \n* 复制算法\n> 可达性分析后，进行标记，将活着的对象复制到内存的另一块上面，然后将已使用过的内存一次性清除干净。  \n> 优点: 实现简单，运行高效，现在的商用虚拟机一般都用来回收新生代，新生代里面分为eden区和2个survivor,比率一般是8:1，回收时将eden区和一个survivor存活的对象复制到另一个空着的survivor区，\n> 如果空间不够，会向老年代申请空间，采用分配担保的方式。   \n> 缺点：可运行内存缩小为原先的一半，另一半要一直空着，等待下次回收时使用。\n* 标记整理算法\n> 在老年代，将存活的对象，移向一端，然后清理掉边界外的内存。\n* 分代算法\n> 将虚拟机根据对象的存活周期不同将内存划分为几块。一般分为新生代和老年代。在不同的年代，采用不同的算法。   \n\n### 可达性分析\n* 全局性的引用（如常量和静态属性）\n* 执行的上下文（栈帧的本地变量表）\n\n### 垃圾收集器\n\n\n\n\n","slug":"java 垃圾回收","published":1,"updated":"2018-04-09T08:15:59.905Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exy000w1fihm48d1sll","content":"<h3 id=\"分析对象是否已经死亡\"><a href=\"#分析对象是否已经死亡\" class=\"headerlink\" title=\"分析对象是否已经死亡\"></a>分析对象是否已经死亡</h3><ul>\n<li><p>引用计数法<br>优点：实现简单，在远古的jdk版本中是该种方式，python2.7里面的回收也是这种方式<br>缺点：容易内存泄露，对象循环依赖，类似于死锁</p>\n</li>\n<li><p>可达性分析（一般第一次标记，第二次如果确实没有引用会回收）</p>\n</li>\n</ul>\n<h3 id=\"回收算法\"><a href=\"#回收算法\" class=\"headerlink\" title=\"回收算法\"></a>回收算法</h3><ul>\n<li><p>标记-清除算法</p>\n<blockquote>\n<p>可达性分析后，进行标记，然后清除<br>缺点：效率不是很高，标记清除后会产生不连续的内存碎片，如果创建大对象时，可分配的连续内存不足时，会提前进行垃圾回收动作。</p>\n</blockquote>\n</li>\n<li><p>复制算法</p>\n<blockquote>\n<p>可达性分析后，进行标记，将活着的对象复制到内存的另一块上面，然后将已使用过的内存一次性清除干净。<br>优点: 实现简单，运行高效，现在的商用虚拟机一般都用来回收新生代，新生代里面分为eden区和2个survivor,比率一般是8:1，回收时将eden区和一个survivor存活的对象复制到另一个空着的survivor区，<br>如果空间不够，会向老年代申请空间，采用分配担保的方式。<br>缺点：可运行内存缩小为原先的一半，另一半要一直空着，等待下次回收时使用。</p>\n</blockquote>\n</li>\n<li>标记整理算法<blockquote>\n<p>在老年代，将存活的对象，移向一端，然后清理掉边界外的内存。</p>\n</blockquote>\n</li>\n<li>分代算法<blockquote>\n<p>将虚拟机根据对象的存活周期不同将内存划分为几块。一般分为新生代和老年代。在不同的年代，采用不同的算法。   </p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"可达性分析\"><a href=\"#可达性分析\" class=\"headerlink\" title=\"可达性分析\"></a>可达性分析</h3><ul>\n<li>全局性的引用（如常量和静态属性）</li>\n<li>执行的上下文（栈帧的本地变量表）</li>\n</ul>\n<h3 id=\"垃圾收集器\"><a href=\"#垃圾收集器\" class=\"headerlink\" title=\"垃圾收集器\"></a>垃圾收集器</h3>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"分析对象是否已经死亡\"><a href=\"#分析对象是否已经死亡\" class=\"headerlink\" title=\"分析对象是否已经死亡\"></a>分析对象是否已经死亡</h3><ul>\n<li><p>引用计数法<br>优点：实现简单，在远古的jdk版本中是该种方式，python2.7里面的回收也是这种方式<br>缺点：容易内存泄露，对象循环依赖，类似于死锁</p>\n</li>\n<li><p>可达性分析（一般第一次标记，第二次如果确实没有引用会回收）</p>\n</li>\n</ul>\n<h3 id=\"回收算法\"><a href=\"#回收算法\" class=\"headerlink\" title=\"回收算法\"></a>回收算法</h3><ul>\n<li><p>标记-清除算法</p>\n<blockquote>\n<p>可达性分析后，进行标记，然后清除<br>缺点：效率不是很高，标记清除后会产生不连续的内存碎片，如果创建大对象时，可分配的连续内存不足时，会提前进行垃圾回收动作。</p>\n</blockquote>\n</li>\n<li><p>复制算法</p>\n<blockquote>\n<p>可达性分析后，进行标记，将活着的对象复制到内存的另一块上面，然后将已使用过的内存一次性清除干净。<br>优点: 实现简单，运行高效，现在的商用虚拟机一般都用来回收新生代，新生代里面分为eden区和2个survivor,比率一般是8:1，回收时将eden区和一个survivor存活的对象复制到另一个空着的survivor区，<br>如果空间不够，会向老年代申请空间，采用分配担保的方式。<br>缺点：可运行内存缩小为原先的一半，另一半要一直空着，等待下次回收时使用。</p>\n</blockquote>\n</li>\n<li>标记整理算法<blockquote>\n<p>在老年代，将存活的对象，移向一端，然后清理掉边界外的内存。</p>\n</blockquote>\n</li>\n<li>分代算法<blockquote>\n<p>将虚拟机根据对象的存活周期不同将内存划分为几块。一般分为新生代和老年代。在不同的年代，采用不同的算法。   </p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"可达性分析\"><a href=\"#可达性分析\" class=\"headerlink\" title=\"可达性分析\"></a>可达性分析</h3><ul>\n<li>全局性的引用（如常量和静态属性）</li>\n<li>执行的上下文（栈帧的本地变量表）</li>\n</ul>\n<h3 id=\"垃圾收集器\"><a href=\"#垃圾收集器\" class=\"headerlink\" title=\"垃圾收集器\"></a>垃圾收集器</h3>"},{"title":"linux 安装openvpn","date":"2018-06-11T05:39:23.000Z","_content":"\n### 安装openvpn,easy-rsa软件\n```\nyum install -y openvpn easy-rsa\n\n```\n### 拷贝文件\n```\n cp /usr/share/doc/openvpn-2.4.6/sample/sample-config-files/server.conf /etc/openvpn/\n\n cp -r /usr/share/easy-rsa/3.0.3/* /etc/openvpn/\n\n```\n### 设置默认参数 \n```\ncd /etc/openvpn\n\nvim vars\n\nexport KEY_SIZE=4096\nexport KEY_COUNTRY=\"CN\"\nexport KEY_PROVINCE=\"SH\"\nexport KEY_CITY=\"SH\"\nexport KEY_ORG=\"xxx\"\nexport KEY_EMAIL=\"xxx\"\n\n\nchmod +x vars\n\n```\n### 使用easy-rsa生成服务器端证书\n\n```\ncd /etc/openvpn\n\n./easyrsa init-pki  #创建空的pki，创建后会多一个pki的目录，初始化后，不要再初始化了。\n./easyrsa build-ca nopass #创建新的CA，不使用密码，一路回车\n./easyrsa gen-req server nopass #创建服务端证书，一路回车\n./easyrsa sign server server #使用CA证书对服务器端证书，进行签名\n./easyrsa gen-dh #创建 Diffie-Hellman，一种密钥交换算法\n\n```\n### 使用easy-rsa生成客户端证书\n\n```\n./easyrsa gen-req test nopass\n./easyrsa sign client test\n\n```\n### 查看easy-rsa创建的pki目录结构\n```\ntree\n.\n├── ca.crt\n├── certs_by_serial\n│   ├── 4F6A847EF9A70413EA6E24BFD6AAA3CE.pem\n│   └── C2833F45701214C377138DC1303D7935.pem\n├── dh.pem\n├── index.txt\n├── index.txt.attr\n├── index.txt.attr.old\n├── index.txt.old\n├── issued\n│   ├── server.crt\n│   └── test.crt\n├── private\n│   ├── server.key\n│   ├── ca.key\n│   └── test.key\n├── reqs\n│   ├── server.req\n│   └── test.req\n├── serial\n└── serial.old\n\n```\n### 生成ta.key文件\n```\nopenvpn --genkey --secret /etc/openvpn/ta.key\n\n```\n### 创建日志目录\n```\nmkdir -p /var/log/openvpn/\n\n```\n### 编辑服务配置文件 vim /etc/openvpn/server.conf\n```\n;local a.b.c.d\n\n# 设置监听端口，必须要对应的在防火墙里面打开\nport 1194\n\n# 设置用TCP还是UDP协议？\n;proto tcp\nproto tcp\n\n# 设置创建tun的路由IP通道，还是创建tap的以太网通道，由于路由IP容易控制，所以推荐使用tunnel；\n# 但如果如IPX等必须使用第二层才能通过的通讯，则可以用tap方式，tap也就是以太网桥接\n;dev tap\ndev tun\n\n# 这里是重点，必须指定SSL/TLS root certificate (ca),\n# certificate(cert), and private key (key)\n# ca文件是服务端和客户端都必须使用的，但不需要ca.key\n# 服务端和客户端指定各自的.crt和.key\n# 请注意路径,可以使用以配置文件开始为根的相对路径,\n# 也可以使用绝对路径\n# 请小心存放.key密钥文件\n\nca pki/ca.crt\ncert pki/issued/server.crt\nkey pki/private/server.key\n#（默认是2048，如果生成ca的时候修改过dh参数“export KEY_SIZE”则改为对应的数字）\n\ndh pki/dh.pem\n\n# 配置VPN使用的网段，OpenVPN会自动提供基于该网段的DHCP服务，但不能和任何一方的局域网段重复，保证唯一\nserver 10.20.0.0 255.255.255.0\n\n# 维持一个客户端和virtual IP的对应表，以方便客户端重新连接可以获得同样的IP\nifconfig-pool-persist ipp.txt\n\n# 为客户端创建对应的路由，以另其通达公司网内部服务器\n# 但记住，公司网内部服务器也需要有可用路由返回到客户端\n;push \"route 192.168.20.0 255.255.255.0\"\npush \"route 10.X.0.0 255.255.0.0\"\n# （X按照机房网段修改）\n\n# 若客户端希望所有的流量都通过VPN传输,则可以使用该语句\n# 其会自动改变客户端的网关为VPN服务器,推荐关闭\n#一旦设置，请小心服务端的DHCP设置问题\n;push \"redirect-gateway def1 bypass-dhcp\"\n\n# 用OpenVPN的DHCP功能为客户端提供指定的DNS、WINS等\n;push \"dhcp-option DNS 208.67.222.222\"\n;push \"dhcp-option DNS 208.67.220.220\"\n\n# 默认客户端之间是不能直接通讯的，除非把下面的语句注释掉\nclient-to-client\n\n# 下面是一些对安全性增强的措施\n# For extra security beyond that provided by SSL/TLS, create an \"HMAC firewall\"\n# to help block DoS attacks and UDP port flooding.\n#\n# Generate with:\n# openvpn --genkey --secret ta.key\n#\n# The server and each client must have a copy of this key.\n# The second parameter should be 0 on the server and 1 on the clients.\n; tls-auth ta.key 0 # This file is secret\n#(这句要注释掉)\n\n# 使用lzo压缩的通讯,服务端和客户端都必须配置\ncomp-lzo\n\n# 输出短日志,每分钟刷新一次,以显示当前的客户端\nstatus /var/log/openvpn/openvpn-status.log\n\n# 缺省日志会记录在系统日志中，但也可以导向到其他地方\n# 建议调试的使用先不要设置,调试完成后再定义\nlog         /var/log/openvpn/openvpn.log\nlog-append  /var/log/openvpn/openvpn.log\n\n# 设置日志的级别\n#\n# 0 is silent, except for fatal errors\n# 4 is reasonable for general usage\n# 5 and 6 can help to debug connection problems\n# 9 is extremely verbose\nverb 3\n```\n\n### 启动服务：\n```\nservice openvpn start\n#设置开机启动\nchkconfig openvpn on\n```\n### 开启路由转发功能\n```\nvim /etc/sysctl.conf\n\n找到net.ipv4.ip_forward = 0\n把0改成1\nsysctl -p #生效\n\n```\n### 设置防火墙\n```\n# 设置iptables（这一条至关重要，通过配置nat将vpn网段IP转发到server内网）\niptables -t nat -A POSTROUTING -s 10.20.0.0/24 -o eth0 -j MASQUERADE\n# openvpn端口通过\niptables -A INPUT -p TCP --dport 1194 -j ACCEPT\niptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\nservice iptables save\n\n```\n\n\n### 创建客户端文件\n```\ncd /home/test\nvim test.opvn\n```\n填入内容 \n\n```\nclient\ndev tun\nproto tcp\nremote xxx.xxx.xxx.xxx 1194\nca ca.crt\ncert test.crt\nkey test.key\ncomp-lzo\npersist-key\npersist-tun\n```\n### 拷贝客户端文件\n```\ncp /etc/openvpn/pki/ca.crt /home/test\ncp /etc/openvpn/pki/issued/test.crt /home/test\ncp /etc/openvpn/pki/private/test.key /home/test\ncp /etc/openvpn/ta.key /home/test\n```\n\n### 打包下载文件\n\n```\ncd /home/test\nzip test.zip *\nsz test.zip \n```\n下载openvpn客户端，打开test.opvn，即可连上服务器了。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/linux 安装openvpn.md","raw":"---\ntitle: linux 安装openvpn\ndate: 2018-06-11 13:39:23\ncategories: \n\t- 系统\ntags:\n\t- linux\n\t- centos6.5\n\t- openvpn\n\t- \n---\n\n### 安装openvpn,easy-rsa软件\n```\nyum install -y openvpn easy-rsa\n\n```\n### 拷贝文件\n```\n cp /usr/share/doc/openvpn-2.4.6/sample/sample-config-files/server.conf /etc/openvpn/\n\n cp -r /usr/share/easy-rsa/3.0.3/* /etc/openvpn/\n\n```\n### 设置默认参数 \n```\ncd /etc/openvpn\n\nvim vars\n\nexport KEY_SIZE=4096\nexport KEY_COUNTRY=\"CN\"\nexport KEY_PROVINCE=\"SH\"\nexport KEY_CITY=\"SH\"\nexport KEY_ORG=\"xxx\"\nexport KEY_EMAIL=\"xxx\"\n\n\nchmod +x vars\n\n```\n### 使用easy-rsa生成服务器端证书\n\n```\ncd /etc/openvpn\n\n./easyrsa init-pki  #创建空的pki，创建后会多一个pki的目录，初始化后，不要再初始化了。\n./easyrsa build-ca nopass #创建新的CA，不使用密码，一路回车\n./easyrsa gen-req server nopass #创建服务端证书，一路回车\n./easyrsa sign server server #使用CA证书对服务器端证书，进行签名\n./easyrsa gen-dh #创建 Diffie-Hellman，一种密钥交换算法\n\n```\n### 使用easy-rsa生成客户端证书\n\n```\n./easyrsa gen-req test nopass\n./easyrsa sign client test\n\n```\n### 查看easy-rsa创建的pki目录结构\n```\ntree\n.\n├── ca.crt\n├── certs_by_serial\n│   ├── 4F6A847EF9A70413EA6E24BFD6AAA3CE.pem\n│   └── C2833F45701214C377138DC1303D7935.pem\n├── dh.pem\n├── index.txt\n├── index.txt.attr\n├── index.txt.attr.old\n├── index.txt.old\n├── issued\n│   ├── server.crt\n│   └── test.crt\n├── private\n│   ├── server.key\n│   ├── ca.key\n│   └── test.key\n├── reqs\n│   ├── server.req\n│   └── test.req\n├── serial\n└── serial.old\n\n```\n### 生成ta.key文件\n```\nopenvpn --genkey --secret /etc/openvpn/ta.key\n\n```\n### 创建日志目录\n```\nmkdir -p /var/log/openvpn/\n\n```\n### 编辑服务配置文件 vim /etc/openvpn/server.conf\n```\n;local a.b.c.d\n\n# 设置监听端口，必须要对应的在防火墙里面打开\nport 1194\n\n# 设置用TCP还是UDP协议？\n;proto tcp\nproto tcp\n\n# 设置创建tun的路由IP通道，还是创建tap的以太网通道，由于路由IP容易控制，所以推荐使用tunnel；\n# 但如果如IPX等必须使用第二层才能通过的通讯，则可以用tap方式，tap也就是以太网桥接\n;dev tap\ndev tun\n\n# 这里是重点，必须指定SSL/TLS root certificate (ca),\n# certificate(cert), and private key (key)\n# ca文件是服务端和客户端都必须使用的，但不需要ca.key\n# 服务端和客户端指定各自的.crt和.key\n# 请注意路径,可以使用以配置文件开始为根的相对路径,\n# 也可以使用绝对路径\n# 请小心存放.key密钥文件\n\nca pki/ca.crt\ncert pki/issued/server.crt\nkey pki/private/server.key\n#（默认是2048，如果生成ca的时候修改过dh参数“export KEY_SIZE”则改为对应的数字）\n\ndh pki/dh.pem\n\n# 配置VPN使用的网段，OpenVPN会自动提供基于该网段的DHCP服务，但不能和任何一方的局域网段重复，保证唯一\nserver 10.20.0.0 255.255.255.0\n\n# 维持一个客户端和virtual IP的对应表，以方便客户端重新连接可以获得同样的IP\nifconfig-pool-persist ipp.txt\n\n# 为客户端创建对应的路由，以另其通达公司网内部服务器\n# 但记住，公司网内部服务器也需要有可用路由返回到客户端\n;push \"route 192.168.20.0 255.255.255.0\"\npush \"route 10.X.0.0 255.255.0.0\"\n# （X按照机房网段修改）\n\n# 若客户端希望所有的流量都通过VPN传输,则可以使用该语句\n# 其会自动改变客户端的网关为VPN服务器,推荐关闭\n#一旦设置，请小心服务端的DHCP设置问题\n;push \"redirect-gateway def1 bypass-dhcp\"\n\n# 用OpenVPN的DHCP功能为客户端提供指定的DNS、WINS等\n;push \"dhcp-option DNS 208.67.222.222\"\n;push \"dhcp-option DNS 208.67.220.220\"\n\n# 默认客户端之间是不能直接通讯的，除非把下面的语句注释掉\nclient-to-client\n\n# 下面是一些对安全性增强的措施\n# For extra security beyond that provided by SSL/TLS, create an \"HMAC firewall\"\n# to help block DoS attacks and UDP port flooding.\n#\n# Generate with:\n# openvpn --genkey --secret ta.key\n#\n# The server and each client must have a copy of this key.\n# The second parameter should be 0 on the server and 1 on the clients.\n; tls-auth ta.key 0 # This file is secret\n#(这句要注释掉)\n\n# 使用lzo压缩的通讯,服务端和客户端都必须配置\ncomp-lzo\n\n# 输出短日志,每分钟刷新一次,以显示当前的客户端\nstatus /var/log/openvpn/openvpn-status.log\n\n# 缺省日志会记录在系统日志中，但也可以导向到其他地方\n# 建议调试的使用先不要设置,调试完成后再定义\nlog         /var/log/openvpn/openvpn.log\nlog-append  /var/log/openvpn/openvpn.log\n\n# 设置日志的级别\n#\n# 0 is silent, except for fatal errors\n# 4 is reasonable for general usage\n# 5 and 6 can help to debug connection problems\n# 9 is extremely verbose\nverb 3\n```\n\n### 启动服务：\n```\nservice openvpn start\n#设置开机启动\nchkconfig openvpn on\n```\n### 开启路由转发功能\n```\nvim /etc/sysctl.conf\n\n找到net.ipv4.ip_forward = 0\n把0改成1\nsysctl -p #生效\n\n```\n### 设置防火墙\n```\n# 设置iptables（这一条至关重要，通过配置nat将vpn网段IP转发到server内网）\niptables -t nat -A POSTROUTING -s 10.20.0.0/24 -o eth0 -j MASQUERADE\n# openvpn端口通过\niptables -A INPUT -p TCP --dport 1194 -j ACCEPT\niptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\nservice iptables save\n\n```\n\n\n### 创建客户端文件\n```\ncd /home/test\nvim test.opvn\n```\n填入内容 \n\n```\nclient\ndev tun\nproto tcp\nremote xxx.xxx.xxx.xxx 1194\nca ca.crt\ncert test.crt\nkey test.key\ncomp-lzo\npersist-key\npersist-tun\n```\n### 拷贝客户端文件\n```\ncp /etc/openvpn/pki/ca.crt /home/test\ncp /etc/openvpn/pki/issued/test.crt /home/test\ncp /etc/openvpn/pki/private/test.key /home/test\ncp /etc/openvpn/ta.key /home/test\n```\n\n### 打包下载文件\n\n```\ncd /home/test\nzip test.zip *\nsz test.zip \n```\n下载openvpn客户端，打开test.opvn，即可连上服务器了。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"linux 安装openvpn","published":1,"updated":"2019-01-07T14:53:44.036Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0exz000z1fih2h2y4cj9","content":"<h3 id=\"安装openvpn-easy-rsa软件\"><a href=\"#安装openvpn-easy-rsa软件\" class=\"headerlink\" title=\"安装openvpn,easy-rsa软件\"></a>安装openvpn,easy-rsa软件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y openvpn easy-rsa</div></pre></td></tr></table></figure>\n<h3 id=\"拷贝文件\"><a href=\"#拷贝文件\" class=\"headerlink\" title=\"拷贝文件\"></a>拷贝文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp /usr/share/doc/openvpn-2.4.6/sample/sample-config-files/server.conf /etc/openvpn/</div><div class=\"line\"></div><div class=\"line\">cp -r /usr/share/easy-rsa/3.0.3/* /etc/openvpn/</div></pre></td></tr></table></figure>\n<h3 id=\"设置默认参数\"><a href=\"#设置默认参数\" class=\"headerlink\" title=\"设置默认参数\"></a>设置默认参数</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /etc/openvpn</div><div class=\"line\"></div><div class=\"line\">vim vars</div><div class=\"line\"></div><div class=\"line\">export KEY_SIZE=4096</div><div class=\"line\">export KEY_COUNTRY=&quot;CN&quot;</div><div class=\"line\">export KEY_PROVINCE=&quot;SH&quot;</div><div class=\"line\">export KEY_CITY=&quot;SH&quot;</div><div class=\"line\">export KEY_ORG=&quot;xxx&quot;</div><div class=\"line\">export KEY_EMAIL=&quot;xxx&quot;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">chmod +x vars</div></pre></td></tr></table></figure>\n<h3 id=\"使用easy-rsa生成服务器端证书\"><a href=\"#使用easy-rsa生成服务器端证书\" class=\"headerlink\" title=\"使用easy-rsa生成服务器端证书\"></a>使用easy-rsa生成服务器端证书</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /etc/openvpn</div><div class=\"line\"></div><div class=\"line\">./easyrsa init-pki  #创建空的pki，创建后会多一个pki的目录，初始化后，不要再初始化了。</div><div class=\"line\">./easyrsa build-ca nopass #创建新的CA，不使用密码，一路回车</div><div class=\"line\">./easyrsa gen-req server nopass #创建服务端证书，一路回车</div><div class=\"line\">./easyrsa sign server server #使用CA证书对服务器端证书，进行签名</div><div class=\"line\">./easyrsa gen-dh #创建 Diffie-Hellman，一种密钥交换算法</div></pre></td></tr></table></figure>\n<h3 id=\"使用easy-rsa生成客户端证书\"><a href=\"#使用easy-rsa生成客户端证书\" class=\"headerlink\" title=\"使用easy-rsa生成客户端证书\"></a>使用easy-rsa生成客户端证书</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">./easyrsa gen-req test nopass</div><div class=\"line\">./easyrsa sign client test</div></pre></td></tr></table></figure>\n<h3 id=\"查看easy-rsa创建的pki目录结构\"><a href=\"#查看easy-rsa创建的pki目录结构\" class=\"headerlink\" title=\"查看easy-rsa创建的pki目录结构\"></a>查看easy-rsa创建的pki目录结构</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">tree</div><div class=\"line\">.</div><div class=\"line\">├── ca.crt</div><div class=\"line\">├── certs_by_serial</div><div class=\"line\">│   ├── 4F6A847EF9A70413EA6E24BFD6AAA3CE.pem</div><div class=\"line\">│   └── C2833F45701214C377138DC1303D7935.pem</div><div class=\"line\">├── dh.pem</div><div class=\"line\">├── index.txt</div><div class=\"line\">├── index.txt.attr</div><div class=\"line\">├── index.txt.attr.old</div><div class=\"line\">├── index.txt.old</div><div class=\"line\">├── issued</div><div class=\"line\">│   ├── server.crt</div><div class=\"line\">│   └── test.crt</div><div class=\"line\">├── private</div><div class=\"line\">│   ├── server.key</div><div class=\"line\">│   ├── ca.key</div><div class=\"line\">│   └── test.key</div><div class=\"line\">├── reqs</div><div class=\"line\">│   ├── server.req</div><div class=\"line\">│   └── test.req</div><div class=\"line\">├── serial</div><div class=\"line\">└── serial.old</div></pre></td></tr></table></figure>\n<h3 id=\"生成ta-key文件\"><a href=\"#生成ta-key文件\" class=\"headerlink\" title=\"生成ta.key文件\"></a>生成ta.key文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">openvpn --genkey --secret /etc/openvpn/ta.key</div></pre></td></tr></table></figure>\n<h3 id=\"创建日志目录\"><a href=\"#创建日志目录\" class=\"headerlink\" title=\"创建日志目录\"></a>创建日志目录</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir -p /var/log/openvpn/</div></pre></td></tr></table></figure>\n<h3 id=\"编辑服务配置文件-vim-etc-openvpn-server-conf\"><a href=\"#编辑服务配置文件-vim-etc-openvpn-server-conf\" class=\"headerlink\" title=\"编辑服务配置文件 vim /etc/openvpn/server.conf\"></a>编辑服务配置文件 vim /etc/openvpn/server.conf</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div></pre></td><td class=\"code\"><pre><div class=\"line\">;local a.b.c.d</div><div class=\"line\"></div><div class=\"line\"># 设置监听端口，必须要对应的在防火墙里面打开</div><div class=\"line\">port 1194</div><div class=\"line\"></div><div class=\"line\"># 设置用TCP还是UDP协议？</div><div class=\"line\">;proto tcp</div><div class=\"line\">proto tcp</div><div class=\"line\"></div><div class=\"line\"># 设置创建tun的路由IP通道，还是创建tap的以太网通道，由于路由IP容易控制，所以推荐使用tunnel；</div><div class=\"line\"># 但如果如IPX等必须使用第二层才能通过的通讯，则可以用tap方式，tap也就是以太网桥接</div><div class=\"line\">;dev tap</div><div class=\"line\">dev tun</div><div class=\"line\"></div><div class=\"line\"># 这里是重点，必须指定SSL/TLS root certificate (ca),</div><div class=\"line\"># certificate(cert), and private key (key)</div><div class=\"line\"># ca文件是服务端和客户端都必须使用的，但不需要ca.key</div><div class=\"line\"># 服务端和客户端指定各自的.crt和.key</div><div class=\"line\"># 请注意路径,可以使用以配置文件开始为根的相对路径,</div><div class=\"line\"># 也可以使用绝对路径</div><div class=\"line\"># 请小心存放.key密钥文件</div><div class=\"line\"></div><div class=\"line\">ca pki/ca.crt</div><div class=\"line\">cert pki/issued/server.crt</div><div class=\"line\">key pki/private/server.key</div><div class=\"line\">#（默认是2048，如果生成ca的时候修改过dh参数“export KEY_SIZE”则改为对应的数字）</div><div class=\"line\"></div><div class=\"line\">dh pki/dh.pem</div><div class=\"line\"></div><div class=\"line\"># 配置VPN使用的网段，OpenVPN会自动提供基于该网段的DHCP服务，但不能和任何一方的局域网段重复，保证唯一</div><div class=\"line\">server 10.20.0.0 255.255.255.0</div><div class=\"line\"></div><div class=\"line\"># 维持一个客户端和virtual IP的对应表，以方便客户端重新连接可以获得同样的IP</div><div class=\"line\">ifconfig-pool-persist ipp.txt</div><div class=\"line\"></div><div class=\"line\"># 为客户端创建对应的路由，以另其通达公司网内部服务器</div><div class=\"line\"># 但记住，公司网内部服务器也需要有可用路由返回到客户端</div><div class=\"line\">;push &quot;route 192.168.20.0 255.255.255.0&quot;</div><div class=\"line\">push &quot;route 10.X.0.0 255.255.0.0&quot;</div><div class=\"line\"># （X按照机房网段修改）</div><div class=\"line\"></div><div class=\"line\"># 若客户端希望所有的流量都通过VPN传输,则可以使用该语句</div><div class=\"line\"># 其会自动改变客户端的网关为VPN服务器,推荐关闭</div><div class=\"line\">#一旦设置，请小心服务端的DHCP设置问题</div><div class=\"line\">;push &quot;redirect-gateway def1 bypass-dhcp&quot;</div><div class=\"line\"></div><div class=\"line\"># 用OpenVPN的DHCP功能为客户端提供指定的DNS、WINS等</div><div class=\"line\">;push &quot;dhcp-option DNS 208.67.222.222&quot;</div><div class=\"line\">;push &quot;dhcp-option DNS 208.67.220.220&quot;</div><div class=\"line\"></div><div class=\"line\"># 默认客户端之间是不能直接通讯的，除非把下面的语句注释掉</div><div class=\"line\">client-to-client</div><div class=\"line\"></div><div class=\"line\"># 下面是一些对安全性增强的措施</div><div class=\"line\"># For extra security beyond that provided by SSL/TLS, create an &quot;HMAC firewall&quot;</div><div class=\"line\"># to help block DoS attacks and UDP port flooding.</div><div class=\"line\">#</div><div class=\"line\"># Generate with:</div><div class=\"line\"># openvpn --genkey --secret ta.key</div><div class=\"line\">#</div><div class=\"line\"># The server and each client must have a copy of this key.</div><div class=\"line\"># The second parameter should be 0 on the server and 1 on the clients.</div><div class=\"line\">; tls-auth ta.key 0 # This file is secret</div><div class=\"line\">#(这句要注释掉)</div><div class=\"line\"></div><div class=\"line\"># 使用lzo压缩的通讯,服务端和客户端都必须配置</div><div class=\"line\">comp-lzo</div><div class=\"line\"></div><div class=\"line\"># 输出短日志,每分钟刷新一次,以显示当前的客户端</div><div class=\"line\">status /var/log/openvpn/openvpn-status.log</div><div class=\"line\"></div><div class=\"line\"># 缺省日志会记录在系统日志中，但也可以导向到其他地方</div><div class=\"line\"># 建议调试的使用先不要设置,调试完成后再定义</div><div class=\"line\">log         /var/log/openvpn/openvpn.log</div><div class=\"line\">log-append  /var/log/openvpn/openvpn.log</div><div class=\"line\"></div><div class=\"line\"># 设置日志的级别</div><div class=\"line\">#</div><div class=\"line\"># 0 is silent, except for fatal errors</div><div class=\"line\"># 4 is reasonable for general usage</div><div class=\"line\"># 5 and 6 can help to debug connection problems</div><div class=\"line\"># 9 is extremely verbose</div><div class=\"line\">verb 3</div></pre></td></tr></table></figure>\n<h3 id=\"启动服务：\"><a href=\"#启动服务：\" class=\"headerlink\" title=\"启动服务：\"></a>启动服务：</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">service openvpn start</div><div class=\"line\">#设置开机启动</div><div class=\"line\">chkconfig openvpn on</div></pre></td></tr></table></figure>\n<h3 id=\"开启路由转发功能\"><a href=\"#开启路由转发功能\" class=\"headerlink\" title=\"开启路由转发功能\"></a>开启路由转发功能</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/sysctl.conf</div><div class=\"line\"></div><div class=\"line\">找到net.ipv4.ip_forward = 0</div><div class=\"line\">把0改成1</div><div class=\"line\">sysctl -p #生效</div></pre></td></tr></table></figure>\n<h3 id=\"设置防火墙\"><a href=\"#设置防火墙\" class=\"headerlink\" title=\"设置防火墙\"></a>设置防火墙</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 设置iptables（这一条至关重要，通过配置nat将vpn网段IP转发到server内网）</div><div class=\"line\">iptables -t nat -A POSTROUTING -s 10.20.0.0/24 -o eth0 -j MASQUERADE</div><div class=\"line\"># openvpn端口通过</div><div class=\"line\">iptables -A INPUT -p TCP --dport 1194 -j ACCEPT</div><div class=\"line\">iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</div><div class=\"line\">service iptables save</div></pre></td></tr></table></figure>\n<h3 id=\"创建客户端文件\"><a href=\"#创建客户端文件\" class=\"headerlink\" title=\"创建客户端文件\"></a>创建客户端文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /home/test</div><div class=\"line\">vim test.opvn</div></pre></td></tr></table></figure>\n<p>填入内容 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">client</div><div class=\"line\">dev tun</div><div class=\"line\">proto tcp</div><div class=\"line\">remote xxx.xxx.xxx.xxx 1194</div><div class=\"line\">ca ca.crt</div><div class=\"line\">cert test.crt</div><div class=\"line\">key test.key</div><div class=\"line\">comp-lzo</div><div class=\"line\">persist-key</div><div class=\"line\">persist-tun</div></pre></td></tr></table></figure>\n<h3 id=\"拷贝客户端文件\"><a href=\"#拷贝客户端文件\" class=\"headerlink\" title=\"拷贝客户端文件\"></a>拷贝客户端文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp /etc/openvpn/pki/ca.crt /home/test</div><div class=\"line\">cp /etc/openvpn/pki/issued/test.crt /home/test</div><div class=\"line\">cp /etc/openvpn/pki/private/test.key /home/test</div><div class=\"line\">cp /etc/openvpn/ta.key /home/test</div></pre></td></tr></table></figure>\n<h3 id=\"打包下载文件\"><a href=\"#打包下载文件\" class=\"headerlink\" title=\"打包下载文件\"></a>打包下载文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /home/test</div><div class=\"line\">zip test.zip *</div><div class=\"line\">sz test.zip</div></pre></td></tr></table></figure>\n<p>下载openvpn客户端，打开test.opvn，即可连上服务器了。</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"安装openvpn-easy-rsa软件\"><a href=\"#安装openvpn-easy-rsa软件\" class=\"headerlink\" title=\"安装openvpn,easy-rsa软件\"></a>安装openvpn,easy-rsa软件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install -y openvpn easy-rsa</div></pre></td></tr></table></figure>\n<h3 id=\"拷贝文件\"><a href=\"#拷贝文件\" class=\"headerlink\" title=\"拷贝文件\"></a>拷贝文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp /usr/share/doc/openvpn-2.4.6/sample/sample-config-files/server.conf /etc/openvpn/</div><div class=\"line\"></div><div class=\"line\">cp -r /usr/share/easy-rsa/3.0.3/* /etc/openvpn/</div></pre></td></tr></table></figure>\n<h3 id=\"设置默认参数\"><a href=\"#设置默认参数\" class=\"headerlink\" title=\"设置默认参数\"></a>设置默认参数</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /etc/openvpn</div><div class=\"line\"></div><div class=\"line\">vim vars</div><div class=\"line\"></div><div class=\"line\">export KEY_SIZE=4096</div><div class=\"line\">export KEY_COUNTRY=&quot;CN&quot;</div><div class=\"line\">export KEY_PROVINCE=&quot;SH&quot;</div><div class=\"line\">export KEY_CITY=&quot;SH&quot;</div><div class=\"line\">export KEY_ORG=&quot;xxx&quot;</div><div class=\"line\">export KEY_EMAIL=&quot;xxx&quot;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">chmod +x vars</div></pre></td></tr></table></figure>\n<h3 id=\"使用easy-rsa生成服务器端证书\"><a href=\"#使用easy-rsa生成服务器端证书\" class=\"headerlink\" title=\"使用easy-rsa生成服务器端证书\"></a>使用easy-rsa生成服务器端证书</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /etc/openvpn</div><div class=\"line\"></div><div class=\"line\">./easyrsa init-pki  #创建空的pki，创建后会多一个pki的目录，初始化后，不要再初始化了。</div><div class=\"line\">./easyrsa build-ca nopass #创建新的CA，不使用密码，一路回车</div><div class=\"line\">./easyrsa gen-req server nopass #创建服务端证书，一路回车</div><div class=\"line\">./easyrsa sign server server #使用CA证书对服务器端证书，进行签名</div><div class=\"line\">./easyrsa gen-dh #创建 Diffie-Hellman，一种密钥交换算法</div></pre></td></tr></table></figure>\n<h3 id=\"使用easy-rsa生成客户端证书\"><a href=\"#使用easy-rsa生成客户端证书\" class=\"headerlink\" title=\"使用easy-rsa生成客户端证书\"></a>使用easy-rsa生成客户端证书</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">./easyrsa gen-req test nopass</div><div class=\"line\">./easyrsa sign client test</div></pre></td></tr></table></figure>\n<h3 id=\"查看easy-rsa创建的pki目录结构\"><a href=\"#查看easy-rsa创建的pki目录结构\" class=\"headerlink\" title=\"查看easy-rsa创建的pki目录结构\"></a>查看easy-rsa创建的pki目录结构</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div></pre></td><td class=\"code\"><pre><div class=\"line\">tree</div><div class=\"line\">.</div><div class=\"line\">├── ca.crt</div><div class=\"line\">├── certs_by_serial</div><div class=\"line\">│   ├── 4F6A847EF9A70413EA6E24BFD6AAA3CE.pem</div><div class=\"line\">│   └── C2833F45701214C377138DC1303D7935.pem</div><div class=\"line\">├── dh.pem</div><div class=\"line\">├── index.txt</div><div class=\"line\">├── index.txt.attr</div><div class=\"line\">├── index.txt.attr.old</div><div class=\"line\">├── index.txt.old</div><div class=\"line\">├── issued</div><div class=\"line\">│   ├── server.crt</div><div class=\"line\">│   └── test.crt</div><div class=\"line\">├── private</div><div class=\"line\">│   ├── server.key</div><div class=\"line\">│   ├── ca.key</div><div class=\"line\">│   └── test.key</div><div class=\"line\">├── reqs</div><div class=\"line\">│   ├── server.req</div><div class=\"line\">│   └── test.req</div><div class=\"line\">├── serial</div><div class=\"line\">└── serial.old</div></pre></td></tr></table></figure>\n<h3 id=\"生成ta-key文件\"><a href=\"#生成ta-key文件\" class=\"headerlink\" title=\"生成ta.key文件\"></a>生成ta.key文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">openvpn --genkey --secret /etc/openvpn/ta.key</div></pre></td></tr></table></figure>\n<h3 id=\"创建日志目录\"><a href=\"#创建日志目录\" class=\"headerlink\" title=\"创建日志目录\"></a>创建日志目录</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir -p /var/log/openvpn/</div></pre></td></tr></table></figure>\n<h3 id=\"编辑服务配置文件-vim-etc-openvpn-server-conf\"><a href=\"#编辑服务配置文件-vim-etc-openvpn-server-conf\" class=\"headerlink\" title=\"编辑服务配置文件 vim /etc/openvpn/server.conf\"></a>编辑服务配置文件 vim /etc/openvpn/server.conf</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div></pre></td><td class=\"code\"><pre><div class=\"line\">;local a.b.c.d</div><div class=\"line\"></div><div class=\"line\"># 设置监听端口，必须要对应的在防火墙里面打开</div><div class=\"line\">port 1194</div><div class=\"line\"></div><div class=\"line\"># 设置用TCP还是UDP协议？</div><div class=\"line\">;proto tcp</div><div class=\"line\">proto tcp</div><div class=\"line\"></div><div class=\"line\"># 设置创建tun的路由IP通道，还是创建tap的以太网通道，由于路由IP容易控制，所以推荐使用tunnel；</div><div class=\"line\"># 但如果如IPX等必须使用第二层才能通过的通讯，则可以用tap方式，tap也就是以太网桥接</div><div class=\"line\">;dev tap</div><div class=\"line\">dev tun</div><div class=\"line\"></div><div class=\"line\"># 这里是重点，必须指定SSL/TLS root certificate (ca),</div><div class=\"line\"># certificate(cert), and private key (key)</div><div class=\"line\"># ca文件是服务端和客户端都必须使用的，但不需要ca.key</div><div class=\"line\"># 服务端和客户端指定各自的.crt和.key</div><div class=\"line\"># 请注意路径,可以使用以配置文件开始为根的相对路径,</div><div class=\"line\"># 也可以使用绝对路径</div><div class=\"line\"># 请小心存放.key密钥文件</div><div class=\"line\"></div><div class=\"line\">ca pki/ca.crt</div><div class=\"line\">cert pki/issued/server.crt</div><div class=\"line\">key pki/private/server.key</div><div class=\"line\">#（默认是2048，如果生成ca的时候修改过dh参数“export KEY_SIZE”则改为对应的数字）</div><div class=\"line\"></div><div class=\"line\">dh pki/dh.pem</div><div class=\"line\"></div><div class=\"line\"># 配置VPN使用的网段，OpenVPN会自动提供基于该网段的DHCP服务，但不能和任何一方的局域网段重复，保证唯一</div><div class=\"line\">server 10.20.0.0 255.255.255.0</div><div class=\"line\"></div><div class=\"line\"># 维持一个客户端和virtual IP的对应表，以方便客户端重新连接可以获得同样的IP</div><div class=\"line\">ifconfig-pool-persist ipp.txt</div><div class=\"line\"></div><div class=\"line\"># 为客户端创建对应的路由，以另其通达公司网内部服务器</div><div class=\"line\"># 但记住，公司网内部服务器也需要有可用路由返回到客户端</div><div class=\"line\">;push &quot;route 192.168.20.0 255.255.255.0&quot;</div><div class=\"line\">push &quot;route 10.X.0.0 255.255.0.0&quot;</div><div class=\"line\"># （X按照机房网段修改）</div><div class=\"line\"></div><div class=\"line\"># 若客户端希望所有的流量都通过VPN传输,则可以使用该语句</div><div class=\"line\"># 其会自动改变客户端的网关为VPN服务器,推荐关闭</div><div class=\"line\">#一旦设置，请小心服务端的DHCP设置问题</div><div class=\"line\">;push &quot;redirect-gateway def1 bypass-dhcp&quot;</div><div class=\"line\"></div><div class=\"line\"># 用OpenVPN的DHCP功能为客户端提供指定的DNS、WINS等</div><div class=\"line\">;push &quot;dhcp-option DNS 208.67.222.222&quot;</div><div class=\"line\">;push &quot;dhcp-option DNS 208.67.220.220&quot;</div><div class=\"line\"></div><div class=\"line\"># 默认客户端之间是不能直接通讯的，除非把下面的语句注释掉</div><div class=\"line\">client-to-client</div><div class=\"line\"></div><div class=\"line\"># 下面是一些对安全性增强的措施</div><div class=\"line\"># For extra security beyond that provided by SSL/TLS, create an &quot;HMAC firewall&quot;</div><div class=\"line\"># to help block DoS attacks and UDP port flooding.</div><div class=\"line\">#</div><div class=\"line\"># Generate with:</div><div class=\"line\"># openvpn --genkey --secret ta.key</div><div class=\"line\">#</div><div class=\"line\"># The server and each client must have a copy of this key.</div><div class=\"line\"># The second parameter should be 0 on the server and 1 on the clients.</div><div class=\"line\">; tls-auth ta.key 0 # This file is secret</div><div class=\"line\">#(这句要注释掉)</div><div class=\"line\"></div><div class=\"line\"># 使用lzo压缩的通讯,服务端和客户端都必须配置</div><div class=\"line\">comp-lzo</div><div class=\"line\"></div><div class=\"line\"># 输出短日志,每分钟刷新一次,以显示当前的客户端</div><div class=\"line\">status /var/log/openvpn/openvpn-status.log</div><div class=\"line\"></div><div class=\"line\"># 缺省日志会记录在系统日志中，但也可以导向到其他地方</div><div class=\"line\"># 建议调试的使用先不要设置,调试完成后再定义</div><div class=\"line\">log         /var/log/openvpn/openvpn.log</div><div class=\"line\">log-append  /var/log/openvpn/openvpn.log</div><div class=\"line\"></div><div class=\"line\"># 设置日志的级别</div><div class=\"line\">#</div><div class=\"line\"># 0 is silent, except for fatal errors</div><div class=\"line\"># 4 is reasonable for general usage</div><div class=\"line\"># 5 and 6 can help to debug connection problems</div><div class=\"line\"># 9 is extremely verbose</div><div class=\"line\">verb 3</div></pre></td></tr></table></figure>\n<h3 id=\"启动服务：\"><a href=\"#启动服务：\" class=\"headerlink\" title=\"启动服务：\"></a>启动服务：</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">service openvpn start</div><div class=\"line\">#设置开机启动</div><div class=\"line\">chkconfig openvpn on</div></pre></td></tr></table></figure>\n<h3 id=\"开启路由转发功能\"><a href=\"#开启路由转发功能\" class=\"headerlink\" title=\"开启路由转发功能\"></a>开启路由转发功能</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/sysctl.conf</div><div class=\"line\"></div><div class=\"line\">找到net.ipv4.ip_forward = 0</div><div class=\"line\">把0改成1</div><div class=\"line\">sysctl -p #生效</div></pre></td></tr></table></figure>\n<h3 id=\"设置防火墙\"><a href=\"#设置防火墙\" class=\"headerlink\" title=\"设置防火墙\"></a>设置防火墙</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"># 设置iptables（这一条至关重要，通过配置nat将vpn网段IP转发到server内网）</div><div class=\"line\">iptables -t nat -A POSTROUTING -s 10.20.0.0/24 -o eth0 -j MASQUERADE</div><div class=\"line\"># openvpn端口通过</div><div class=\"line\">iptables -A INPUT -p TCP --dport 1194 -j ACCEPT</div><div class=\"line\">iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</div><div class=\"line\">service iptables save</div></pre></td></tr></table></figure>\n<h3 id=\"创建客户端文件\"><a href=\"#创建客户端文件\" class=\"headerlink\" title=\"创建客户端文件\"></a>创建客户端文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /home/test</div><div class=\"line\">vim test.opvn</div></pre></td></tr></table></figure>\n<p>填入内容 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">client</div><div class=\"line\">dev tun</div><div class=\"line\">proto tcp</div><div class=\"line\">remote xxx.xxx.xxx.xxx 1194</div><div class=\"line\">ca ca.crt</div><div class=\"line\">cert test.crt</div><div class=\"line\">key test.key</div><div class=\"line\">comp-lzo</div><div class=\"line\">persist-key</div><div class=\"line\">persist-tun</div></pre></td></tr></table></figure>\n<h3 id=\"拷贝客户端文件\"><a href=\"#拷贝客户端文件\" class=\"headerlink\" title=\"拷贝客户端文件\"></a>拷贝客户端文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp /etc/openvpn/pki/ca.crt /home/test</div><div class=\"line\">cp /etc/openvpn/pki/issued/test.crt /home/test</div><div class=\"line\">cp /etc/openvpn/pki/private/test.key /home/test</div><div class=\"line\">cp /etc/openvpn/ta.key /home/test</div></pre></td></tr></table></figure>\n<h3 id=\"打包下载文件\"><a href=\"#打包下载文件\" class=\"headerlink\" title=\"打包下载文件\"></a>打包下载文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /home/test</div><div class=\"line\">zip test.zip *</div><div class=\"line\">sz test.zip</div></pre></td></tr></table></figure>\n<p>下载openvpn客户端，打开test.opvn，即可连上服务器了。</p>\n"},{"title":"mysql5.7 GTID主从同步","date":"2018-05-31T05:57:23.000Z","_content":"\n### 机器：\ndb1: 10.19.2.11  \ndb2: 10.19.113.140  \n### mysql版本\nServer version: 5.7.21-log MySQL Community Server (GPL)\n\n\n#### db1 my.cnf配置\n```\n\n\n[mysqld]\n#是内存情况配置，理想为 70%的物理内存\ninnodb_buffer_pool_size = 45G\nskip-external-locking\nkey_buffer_size = 384M\nmax_allowed_packet = 1073741824\ntable_open_cache = 512\nsort_buffer_size = 2M\nread_buffer_size = 2M\nread_rnd_buffer_size = 8M\nmyisam_sort_buffer_size = 64M\nthread_cache_size = 8\nquery_cache_size = 32M\n#thread_concurrency = 8\nbinlog_cache_size = 4M\nexpire_logs_days = 10\nmax_connections = 1000\nlog_timestamps=SYSTEM\ndefault-time_zone = '+8:00'\n#\ndatadir=/data/mysql\nsocket=/data/mysql/mysql.sock\nlower_case_table_names=1\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\nsecure-file-priv = \"\"\ntmpdir=/data/tmp\n\nvalidate_password_policy=0\n# 记录慢速查询\nslow_query_log=1\nslow_query_log_file=/data/log/mysql/mysql-slow.log\n# # 慢查询最小值，大于此时间，则为慢查询，单位为秒\nlong_query_time=6\n#GTID 主从同步\ngtid_mode=on\nenforce_gtid_consistency=on\n#唯一的服务辨识号,数值位于 1 到 2^32-1之间.\nserver_id=1\nlog-bin=mysql-bin\nlog-slave-updates=1\nbinlog_format=row\n#当binlog_format=row时，用于记录原始的sql语句,不记录了\n#binlog_rows_query_log_events=on\nslave-skip-errors=all\nauto-increment-offset=1\nauto-increment-increment=2\n#忽略下列的库表\n#replicate-wild-ignore-table=mysql.%\n#replicate-wild-ignore-table=test.%\n#replicate-wild-ignore-table=performance_schema.%\n\n\n[client]\nsocket=/data/mysql/mysql.sock\n```\n#### db2 my.cnf配置\n```\n[mysqld]\n\n#是内存情况配置，理想为 70%的物理内存\ninnodb_buffer_pool_size = 45G\n\nskip-external-locking\nkey_buffer_size = 384M\nmax_allowed_packet = 1073741824\ntable_open_cache = 512\nsort_buffer_size = 2M\nread_buffer_size = 2M\nread_rnd_buffer_size = 8M\nmyisam_sort_buffer_size = 64M\nthread_cache_size = 8\nquery_cache_size = 32M\n#thread_concurrency = 8\nbinlog_cache_size = 4M\nmax_connections = 1000\nlog_timestamps=SYSTEM\ndefault-time_zone = '+8:00'\n#\ndatadir=/data/mysql\nsocket=/data/mysql/mysql.sock\nlower_case_table_names=1\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n\n\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\nsecure-file-priv = \"\"\ntmpdir=/data/tmp\n\nvalidate_password_policy=0\n# 记录慢速查询\nslow_query_log=1\nslow_query_log_file=/data/log/mysql/mysql-slow.log\n# 慢查询最小值，大于此时间，则为慢查询，单位为秒\nlong_query_time=6\n\n#GTID 主从同步\ngtid_mode=on\nenforce_gtid_consistency=on\n#唯一的服务辨识号,数值位于 1 到 2^32-1之间.\nserver_id=2\nlog-bin=mysql-bin\nlog-slave-updates=1\nbinlog_format=row\n#当binlog_format=row时，用于记录原始的sql语句,不记录了\n#binlog_rows_query_log_events=on\nslave-skip-errors=all\n#在主主同步配置时，需要将两台服务器的auto_increment_increment增长量都配置为2，而要把auto_increment_offset分别配置为1和2。这样才可以避免两台服务器同时做更新时自增长字段的值之间发生冲突。参考：http://dev.mysql.com/doc/refman/5.0/en/replication-options-master.html\nauto-increment-offset=2\nauto-increment-increment=2\n##忽略下列的库表\n#replicate-wild-ignore-table=mysql.%\n#replicate-wild-ignore-table=test.%\n#replicate-wild-ignore-table=performance_schema.%\n\n\n\n#\n\n[client]\nsocket=/data/mysql/mysql.sock\n```\n\n\n### db1 创建同步用户\n```\ncreate user 'slave'@'10.19.%.%' identified by 'slave123#@!b11d';\ngrant replication slave on *.* to 'slave'@'10.19.%.%';\nflush privileges;\n\n```\n### mysql 8.13\n```\n\ncreate user 'slave'@'%' identified  WITH mysql_native_password by 'slave1ddd23#@!b11dddd';\ngrant replication slave on *.* to 'slave'@'%';\nflush privileges;\n\n```\n\n\n### db2 上开启同步db1\n```\n\nchange master to master_host='10.19.2.11',\nmaster_user='slave',\nmaster_password='slave123#@!b11d',\nMASTER_AUTO_POSITION=1;\n\nstart slave;\n\n```\n### 查看是否成功\n\nshow master logs;   \nshow master status;  \n\n通过show slave status \\G 查看slave状态   \n\n也可以通过 select user,host from mysql.user; 来查看同步用户是否已经建立好，\n如果建立好，代表已经同步成功。\n\n### 8.13无法复制用户过来在db2新建账号\n```\ncreate user 'slave'@'%' identified  WITH mysql_native_password by 'slave1ddd23#@!b11dddd';\ngrant replication slave on *.* to 'slave'@'%';\nflush privileges;\n\n```\n\n\n\n### db1 上开启同步db2\n```\nchange master to master_host='10.19.113.140',\nmaster_user='slave',\nmaster_password='slave123#@!b11d',\nMASTER_AUTO_POSITION=1;\n\nstart slave;\n\n```\n\n\n### 测试同步复制\n#### db2从db1同步测试\n在db1上执行以下语句：   \n\n```\ncreate database test_db1;\nuse test_db1;\n create table temp(id int primary key not null auto_increment,a int,b int,c int as (a*b));\ninsert into temp (a,b)values(1,2),(3,4),(5,6);\n \n```\n在db2上查看是否正常同步，如果正常，即成功。\n\n\n在db2上执行以下语句：\n#### db1从db2同步测试\n```\ncreate database test_db2;\nuse test_db2;\n create table temp(id int primary key not null auto_increment,a int,b int,c int as (a*b));\ninsert into temp (a,b)values(1,2),(3,4),(5,6);\n \n```\n在db1上查看是否正常同步，如果正常，即成功。\n\n### 停机测试\n1. 停止db2的数据库，在db1上执行\n2. 启动db2，查看是否正常同步，如果正常同步，即成功。\n\n```\ninsert into temp (a,b)values(7,8),(9,10);\n```\n\n### 停止同步slave 模式，然后再启动测试，看数据是否同步\n\n1. 停止db2的slave\n\n\t```\n\tstop slave;\n\t\n\t```\n\t在db1上执行  \n\t\n\t```\n\t\tinsert into temp (a,b)values(11,12);\n\t```\n2. 启动db2，查看是否正常同步，如果正常同步，即成功。  \n\n\t```\n\t  start slave;\n\t\t\t\t\t\n\t```\n\n\n\n\n\n\n\n\n","source":"_posts/mysql5.7GTID主从同步.md","raw":"---\ntitle: mysql5.7 GTID主从同步\ndate: 2018-05-31 13:57:23\ncategories: \n\t- mysql\ntags:\n\t- 安装mysql\n\t- 主从同步\n---\n\n### 机器：\ndb1: 10.19.2.11  \ndb2: 10.19.113.140  \n### mysql版本\nServer version: 5.7.21-log MySQL Community Server (GPL)\n\n\n#### db1 my.cnf配置\n```\n\n\n[mysqld]\n#是内存情况配置，理想为 70%的物理内存\ninnodb_buffer_pool_size = 45G\nskip-external-locking\nkey_buffer_size = 384M\nmax_allowed_packet = 1073741824\ntable_open_cache = 512\nsort_buffer_size = 2M\nread_buffer_size = 2M\nread_rnd_buffer_size = 8M\nmyisam_sort_buffer_size = 64M\nthread_cache_size = 8\nquery_cache_size = 32M\n#thread_concurrency = 8\nbinlog_cache_size = 4M\nexpire_logs_days = 10\nmax_connections = 1000\nlog_timestamps=SYSTEM\ndefault-time_zone = '+8:00'\n#\ndatadir=/data/mysql\nsocket=/data/mysql/mysql.sock\nlower_case_table_names=1\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\nsecure-file-priv = \"\"\ntmpdir=/data/tmp\n\nvalidate_password_policy=0\n# 记录慢速查询\nslow_query_log=1\nslow_query_log_file=/data/log/mysql/mysql-slow.log\n# # 慢查询最小值，大于此时间，则为慢查询，单位为秒\nlong_query_time=6\n#GTID 主从同步\ngtid_mode=on\nenforce_gtid_consistency=on\n#唯一的服务辨识号,数值位于 1 到 2^32-1之间.\nserver_id=1\nlog-bin=mysql-bin\nlog-slave-updates=1\nbinlog_format=row\n#当binlog_format=row时，用于记录原始的sql语句,不记录了\n#binlog_rows_query_log_events=on\nslave-skip-errors=all\nauto-increment-offset=1\nauto-increment-increment=2\n#忽略下列的库表\n#replicate-wild-ignore-table=mysql.%\n#replicate-wild-ignore-table=test.%\n#replicate-wild-ignore-table=performance_schema.%\n\n\n[client]\nsocket=/data/mysql/mysql.sock\n```\n#### db2 my.cnf配置\n```\n[mysqld]\n\n#是内存情况配置，理想为 70%的物理内存\ninnodb_buffer_pool_size = 45G\n\nskip-external-locking\nkey_buffer_size = 384M\nmax_allowed_packet = 1073741824\ntable_open_cache = 512\nsort_buffer_size = 2M\nread_buffer_size = 2M\nread_rnd_buffer_size = 8M\nmyisam_sort_buffer_size = 64M\nthread_cache_size = 8\nquery_cache_size = 32M\n#thread_concurrency = 8\nbinlog_cache_size = 4M\nmax_connections = 1000\nlog_timestamps=SYSTEM\ndefault-time_zone = '+8:00'\n#\ndatadir=/data/mysql\nsocket=/data/mysql/mysql.sock\nlower_case_table_names=1\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n\n\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\nsecure-file-priv = \"\"\ntmpdir=/data/tmp\n\nvalidate_password_policy=0\n# 记录慢速查询\nslow_query_log=1\nslow_query_log_file=/data/log/mysql/mysql-slow.log\n# 慢查询最小值，大于此时间，则为慢查询，单位为秒\nlong_query_time=6\n\n#GTID 主从同步\ngtid_mode=on\nenforce_gtid_consistency=on\n#唯一的服务辨识号,数值位于 1 到 2^32-1之间.\nserver_id=2\nlog-bin=mysql-bin\nlog-slave-updates=1\nbinlog_format=row\n#当binlog_format=row时，用于记录原始的sql语句,不记录了\n#binlog_rows_query_log_events=on\nslave-skip-errors=all\n#在主主同步配置时，需要将两台服务器的auto_increment_increment增长量都配置为2，而要把auto_increment_offset分别配置为1和2。这样才可以避免两台服务器同时做更新时自增长字段的值之间发生冲突。参考：http://dev.mysql.com/doc/refman/5.0/en/replication-options-master.html\nauto-increment-offset=2\nauto-increment-increment=2\n##忽略下列的库表\n#replicate-wild-ignore-table=mysql.%\n#replicate-wild-ignore-table=test.%\n#replicate-wild-ignore-table=performance_schema.%\n\n\n\n#\n\n[client]\nsocket=/data/mysql/mysql.sock\n```\n\n\n### db1 创建同步用户\n```\ncreate user 'slave'@'10.19.%.%' identified by 'slave123#@!b11d';\ngrant replication slave on *.* to 'slave'@'10.19.%.%';\nflush privileges;\n\n```\n### mysql 8.13\n```\n\ncreate user 'slave'@'%' identified  WITH mysql_native_password by 'slave1ddd23#@!b11dddd';\ngrant replication slave on *.* to 'slave'@'%';\nflush privileges;\n\n```\n\n\n### db2 上开启同步db1\n```\n\nchange master to master_host='10.19.2.11',\nmaster_user='slave',\nmaster_password='slave123#@!b11d',\nMASTER_AUTO_POSITION=1;\n\nstart slave;\n\n```\n### 查看是否成功\n\nshow master logs;   \nshow master status;  \n\n通过show slave status \\G 查看slave状态   \n\n也可以通过 select user,host from mysql.user; 来查看同步用户是否已经建立好，\n如果建立好，代表已经同步成功。\n\n### 8.13无法复制用户过来在db2新建账号\n```\ncreate user 'slave'@'%' identified  WITH mysql_native_password by 'slave1ddd23#@!b11dddd';\ngrant replication slave on *.* to 'slave'@'%';\nflush privileges;\n\n```\n\n\n\n### db1 上开启同步db2\n```\nchange master to master_host='10.19.113.140',\nmaster_user='slave',\nmaster_password='slave123#@!b11d',\nMASTER_AUTO_POSITION=1;\n\nstart slave;\n\n```\n\n\n### 测试同步复制\n#### db2从db1同步测试\n在db1上执行以下语句：   \n\n```\ncreate database test_db1;\nuse test_db1;\n create table temp(id int primary key not null auto_increment,a int,b int,c int as (a*b));\ninsert into temp (a,b)values(1,2),(3,4),(5,6);\n \n```\n在db2上查看是否正常同步，如果正常，即成功。\n\n\n在db2上执行以下语句：\n#### db1从db2同步测试\n```\ncreate database test_db2;\nuse test_db2;\n create table temp(id int primary key not null auto_increment,a int,b int,c int as (a*b));\ninsert into temp (a,b)values(1,2),(3,4),(5,6);\n \n```\n在db1上查看是否正常同步，如果正常，即成功。\n\n### 停机测试\n1. 停止db2的数据库，在db1上执行\n2. 启动db2，查看是否正常同步，如果正常同步，即成功。\n\n```\ninsert into temp (a,b)values(7,8),(9,10);\n```\n\n### 停止同步slave 模式，然后再启动测试，看数据是否同步\n\n1. 停止db2的slave\n\n\t```\n\tstop slave;\n\t\n\t```\n\t在db1上执行  \n\t\n\t```\n\t\tinsert into temp (a,b)values(11,12);\n\t```\n2. 启动db2，查看是否正常同步，如果正常同步，即成功。  \n\n\t```\n\t  start slave;\n\t\t\t\t\t\n\t```\n\n\n\n\n\n\n\n\n","slug":"mysql5.7GTID主从同步","published":1,"updated":"2019-01-07T09:30:56.759Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0ey000141fihcx5hke4y","content":"<h3 id=\"机器：\"><a href=\"#机器：\" class=\"headerlink\" title=\"机器：\"></a>机器：</h3><p>db1: 10.19.2.11<br>db2: 10.19.113.140  </p>\n<h3 id=\"mysql版本\"><a href=\"#mysql版本\" class=\"headerlink\" title=\"mysql版本\"></a>mysql版本</h3><p>Server version: 5.7.21-log MySQL Community Server (GPL)</p>\n<h4 id=\"db1-my-cnf配置\"><a href=\"#db1-my-cnf配置\" class=\"headerlink\" title=\"db1 my.cnf配置\"></a>db1 my.cnf配置</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">[mysqld]</div><div class=\"line\">#是内存情况配置，理想为 70%的物理内存</div><div class=\"line\">innodb_buffer_pool_size = 45G</div><div class=\"line\">skip-external-locking</div><div class=\"line\">key_buffer_size = 384M</div><div class=\"line\">max_allowed_packet = 1073741824</div><div class=\"line\">table_open_cache = 512</div><div class=\"line\">sort_buffer_size = 2M</div><div class=\"line\">read_buffer_size = 2M</div><div class=\"line\">read_rnd_buffer_size = 8M</div><div class=\"line\">myisam_sort_buffer_size = 64M</div><div class=\"line\">thread_cache_size = 8</div><div class=\"line\">query_cache_size = 32M</div><div class=\"line\">#thread_concurrency = 8</div><div class=\"line\">binlog_cache_size = 4M</div><div class=\"line\">expire_logs_days = 10</div><div class=\"line\">max_connections = 1000</div><div class=\"line\">log_timestamps=SYSTEM</div><div class=\"line\">default-time_zone = &apos;+8:00&apos;</div><div class=\"line\">#</div><div class=\"line\">datadir=/data/mysql</div><div class=\"line\">socket=/data/mysql/mysql.sock</div><div class=\"line\">lower_case_table_names=1</div><div class=\"line\"># Disabling symbolic-links is recommended to prevent assorted security risks</div><div class=\"line\">symbolic-links=0</div><div class=\"line\"></div><div class=\"line\">log-error=/var/log/mysqld.log</div><div class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</div><div class=\"line\">secure-file-priv = &quot;&quot;</div><div class=\"line\">tmpdir=/data/tmp</div><div class=\"line\"></div><div class=\"line\">validate_password_policy=0</div><div class=\"line\"># 记录慢速查询</div><div class=\"line\">slow_query_log=1</div><div class=\"line\">slow_query_log_file=/data/log/mysql/mysql-slow.log</div><div class=\"line\"># # 慢查询最小值，大于此时间，则为慢查询，单位为秒</div><div class=\"line\">long_query_time=6</div><div class=\"line\">#GTID 主从同步</div><div class=\"line\">gtid_mode=on</div><div class=\"line\">enforce_gtid_consistency=on</div><div class=\"line\">#唯一的服务辨识号,数值位于 1 到 2^32-1之间.</div><div class=\"line\">server_id=1</div><div class=\"line\">log-bin=mysql-bin</div><div class=\"line\">log-slave-updates=1</div><div class=\"line\">binlog_format=row</div><div class=\"line\">#当binlog_format=row时，用于记录原始的sql语句,不记录了</div><div class=\"line\">#binlog_rows_query_log_events=on</div><div class=\"line\">slave-skip-errors=all</div><div class=\"line\">auto-increment-offset=1</div><div class=\"line\">auto-increment-increment=2</div><div class=\"line\">#忽略下列的库表</div><div class=\"line\">#replicate-wild-ignore-table=mysql.%</div><div class=\"line\">#replicate-wild-ignore-table=test.%</div><div class=\"line\">#replicate-wild-ignore-table=performance_schema.%</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">[client]</div><div class=\"line\">socket=/data/mysql/mysql.sock</div></pre></td></tr></table></figure>\n<h4 id=\"db2-my-cnf配置\"><a href=\"#db2-my-cnf配置\" class=\"headerlink\" title=\"db2 my.cnf配置\"></a>db2 my.cnf配置</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div></pre></td><td class=\"code\"><pre><div class=\"line\">[mysqld]</div><div class=\"line\"></div><div class=\"line\">#是内存情况配置，理想为 70%的物理内存</div><div class=\"line\">innodb_buffer_pool_size = 45G</div><div class=\"line\"></div><div class=\"line\">skip-external-locking</div><div class=\"line\">key_buffer_size = 384M</div><div class=\"line\">max_allowed_packet = 1073741824</div><div class=\"line\">table_open_cache = 512</div><div class=\"line\">sort_buffer_size = 2M</div><div class=\"line\">read_buffer_size = 2M</div><div class=\"line\">read_rnd_buffer_size = 8M</div><div class=\"line\">myisam_sort_buffer_size = 64M</div><div class=\"line\">thread_cache_size = 8</div><div class=\"line\">query_cache_size = 32M</div><div class=\"line\">#thread_concurrency = 8</div><div class=\"line\">binlog_cache_size = 4M</div><div class=\"line\">max_connections = 1000</div><div class=\"line\">log_timestamps=SYSTEM</div><div class=\"line\">default-time_zone = &apos;+8:00&apos;</div><div class=\"line\">#</div><div class=\"line\">datadir=/data/mysql</div><div class=\"line\">socket=/data/mysql/mysql.sock</div><div class=\"line\">lower_case_table_names=1</div><div class=\"line\"># Disabling symbolic-links is recommended to prevent assorted security risks</div><div class=\"line\">symbolic-links=0</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">log-error=/var/log/mysqld.log</div><div class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</div><div class=\"line\">secure-file-priv = &quot;&quot;</div><div class=\"line\">tmpdir=/data/tmp</div><div class=\"line\"></div><div class=\"line\">validate_password_policy=0</div><div class=\"line\"># 记录慢速查询</div><div class=\"line\">slow_query_log=1</div><div class=\"line\">slow_query_log_file=/data/log/mysql/mysql-slow.log</div><div class=\"line\"># 慢查询最小值，大于此时间，则为慢查询，单位为秒</div><div class=\"line\">long_query_time=6</div><div class=\"line\"></div><div class=\"line\">#GTID 主从同步</div><div class=\"line\">gtid_mode=on</div><div class=\"line\">enforce_gtid_consistency=on</div><div class=\"line\">#唯一的服务辨识号,数值位于 1 到 2^32-1之间.</div><div class=\"line\">server_id=2</div><div class=\"line\">log-bin=mysql-bin</div><div class=\"line\">log-slave-updates=1</div><div class=\"line\">binlog_format=row</div><div class=\"line\">#当binlog_format=row时，用于记录原始的sql语句,不记录了</div><div class=\"line\">#binlog_rows_query_log_events=on</div><div class=\"line\">slave-skip-errors=all</div><div class=\"line\">#在主主同步配置时，需要将两台服务器的auto_increment_increment增长量都配置为2，而要把auto_increment_offset分别配置为1和2。这样才可以避免两台服务器同时做更新时自增长字段的值之间发生冲突。参考：http://dev.mysql.com/doc/refman/5.0/en/replication-options-master.html</div><div class=\"line\">auto-increment-offset=2</div><div class=\"line\">auto-increment-increment=2</div><div class=\"line\">##忽略下列的库表</div><div class=\"line\">#replicate-wild-ignore-table=mysql.%</div><div class=\"line\">#replicate-wild-ignore-table=test.%</div><div class=\"line\">#replicate-wild-ignore-table=performance_schema.%</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">[client]</div><div class=\"line\">socket=/data/mysql/mysql.sock</div></pre></td></tr></table></figure>\n<h3 id=\"db1-创建同步用户\"><a href=\"#db1-创建同步用户\" class=\"headerlink\" title=\"db1 创建同步用户\"></a>db1 创建同步用户</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">create user &apos;slave&apos;@&apos;10.19.%.%&apos; identified by &apos;slave123#@!b11d&apos;;</div><div class=\"line\">grant replication slave on *.* to &apos;slave&apos;@&apos;10.19.%.%&apos;;</div><div class=\"line\">flush privileges;</div></pre></td></tr></table></figure>\n<h3 id=\"mysql-8-13\"><a href=\"#mysql-8-13\" class=\"headerlink\" title=\"mysql 8.13\"></a>mysql 8.13</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">create user &apos;slave&apos;@&apos;%&apos; identified  WITH mysql_native_password by &apos;slave1ddd23#@!b11dddd&apos;;</div><div class=\"line\">grant replication slave on *.* to &apos;slave&apos;@&apos;%&apos;;</div><div class=\"line\">flush privileges;</div></pre></td></tr></table></figure>\n<h3 id=\"db2-上开启同步db1\"><a href=\"#db2-上开启同步db1\" class=\"headerlink\" title=\"db2 上开启同步db1\"></a>db2 上开启同步db1</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">change master to master_host=&apos;10.19.2.11&apos;,</div><div class=\"line\">master_user=&apos;slave&apos;,</div><div class=\"line\">master_password=&apos;slave123#@!b11d&apos;,</div><div class=\"line\">MASTER_AUTO_POSITION=1;</div><div class=\"line\"></div><div class=\"line\">start slave;</div></pre></td></tr></table></figure>\n<h3 id=\"查看是否成功\"><a href=\"#查看是否成功\" class=\"headerlink\" title=\"查看是否成功\"></a>查看是否成功</h3><p>show master logs;<br>show master status;  </p>\n<p>通过show slave status \\G 查看slave状态   </p>\n<p>也可以通过 select user,host from mysql.user; 来查看同步用户是否已经建立好，<br>如果建立好，代表已经同步成功。</p>\n<h3 id=\"8-13无法复制用户过来在db2新建账号\"><a href=\"#8-13无法复制用户过来在db2新建账号\" class=\"headerlink\" title=\"8.13无法复制用户过来在db2新建账号\"></a>8.13无法复制用户过来在db2新建账号</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">create user &apos;slave&apos;@&apos;%&apos; identified  WITH mysql_native_password by &apos;slave1ddd23#@!b11dddd&apos;;</div><div class=\"line\">grant replication slave on *.* to &apos;slave&apos;@&apos;%&apos;;</div><div class=\"line\">flush privileges;</div></pre></td></tr></table></figure>\n<h3 id=\"db1-上开启同步db2\"><a href=\"#db1-上开启同步db2\" class=\"headerlink\" title=\"db1 上开启同步db2\"></a>db1 上开启同步db2</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">change master to master_host=&apos;10.19.113.140&apos;,</div><div class=\"line\">master_user=&apos;slave&apos;,</div><div class=\"line\">master_password=&apos;slave123#@!b11d&apos;,</div><div class=\"line\">MASTER_AUTO_POSITION=1;</div><div class=\"line\"></div><div class=\"line\">start slave;</div></pre></td></tr></table></figure>\n<h3 id=\"测试同步复制\"><a href=\"#测试同步复制\" class=\"headerlink\" title=\"测试同步复制\"></a>测试同步复制</h3><h4 id=\"db2从db1同步测试\"><a href=\"#db2从db1同步测试\" class=\"headerlink\" title=\"db2从db1同步测试\"></a>db2从db1同步测试</h4><p>在db1上执行以下语句：   </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">create database test_db1;</div><div class=\"line\">use test_db1;</div><div class=\"line\"> create table temp(id int primary key not null auto_increment,a int,b int,c int as (a*b));</div><div class=\"line\">insert into temp (a,b)values(1,2),(3,4),(5,6);</div></pre></td></tr></table></figure>\n<p>在db2上查看是否正常同步，如果正常，即成功。</p>\n<p>在db2上执行以下语句：</p>\n<h4 id=\"db1从db2同步测试\"><a href=\"#db1从db2同步测试\" class=\"headerlink\" title=\"db1从db2同步测试\"></a>db1从db2同步测试</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">create database test_db2;</div><div class=\"line\">use test_db2;</div><div class=\"line\"> create table temp(id int primary key not null auto_increment,a int,b int,c int as (a*b));</div><div class=\"line\">insert into temp (a,b)values(1,2),(3,4),(5,6);</div></pre></td></tr></table></figure>\n<p>在db1上查看是否正常同步，如果正常，即成功。</p>\n<h3 id=\"停机测试\"><a href=\"#停机测试\" class=\"headerlink\" title=\"停机测试\"></a>停机测试</h3><ol>\n<li>停止db2的数据库，在db1上执行</li>\n<li>启动db2，查看是否正常同步，如果正常同步，即成功。</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">insert into temp (a,b)values(7,8),(9,10);</div></pre></td></tr></table></figure>\n<h3 id=\"停止同步slave-模式，然后再启动测试，看数据是否同步\"><a href=\"#停止同步slave-模式，然后再启动测试，看数据是否同步\" class=\"headerlink\" title=\"停止同步slave 模式，然后再启动测试，看数据是否同步\"></a>停止同步slave 模式，然后再启动测试，看数据是否同步</h3><ol>\n<li><p>停止db2的slave</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">stop slave;</div></pre></td></tr></table></figure>\n<p> 在db1上执行  </p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">insert into temp (a,b)values(11,12);</div></pre></td></tr></table></figure>\n</li>\n<li><p>启动db2，查看是否正常同步，如果正常同步，即成功。  </p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">start slave;</div></pre></td></tr></table></figure>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"机器：\"><a href=\"#机器：\" class=\"headerlink\" title=\"机器：\"></a>机器：</h3><p>db1: 10.19.2.11<br>db2: 10.19.113.140  </p>\n<h3 id=\"mysql版本\"><a href=\"#mysql版本\" class=\"headerlink\" title=\"mysql版本\"></a>mysql版本</h3><p>Server version: 5.7.21-log MySQL Community Server (GPL)</p>\n<h4 id=\"db1-my-cnf配置\"><a href=\"#db1-my-cnf配置\" class=\"headerlink\" title=\"db1 my.cnf配置\"></a>db1 my.cnf配置</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">[mysqld]</div><div class=\"line\">#是内存情况配置，理想为 70%的物理内存</div><div class=\"line\">innodb_buffer_pool_size = 45G</div><div class=\"line\">skip-external-locking</div><div class=\"line\">key_buffer_size = 384M</div><div class=\"line\">max_allowed_packet = 1073741824</div><div class=\"line\">table_open_cache = 512</div><div class=\"line\">sort_buffer_size = 2M</div><div class=\"line\">read_buffer_size = 2M</div><div class=\"line\">read_rnd_buffer_size = 8M</div><div class=\"line\">myisam_sort_buffer_size = 64M</div><div class=\"line\">thread_cache_size = 8</div><div class=\"line\">query_cache_size = 32M</div><div class=\"line\">#thread_concurrency = 8</div><div class=\"line\">binlog_cache_size = 4M</div><div class=\"line\">expire_logs_days = 10</div><div class=\"line\">max_connections = 1000</div><div class=\"line\">log_timestamps=SYSTEM</div><div class=\"line\">default-time_zone = &apos;+8:00&apos;</div><div class=\"line\">#</div><div class=\"line\">datadir=/data/mysql</div><div class=\"line\">socket=/data/mysql/mysql.sock</div><div class=\"line\">lower_case_table_names=1</div><div class=\"line\"># Disabling symbolic-links is recommended to prevent assorted security risks</div><div class=\"line\">symbolic-links=0</div><div class=\"line\"></div><div class=\"line\">log-error=/var/log/mysqld.log</div><div class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</div><div class=\"line\">secure-file-priv = &quot;&quot;</div><div class=\"line\">tmpdir=/data/tmp</div><div class=\"line\"></div><div class=\"line\">validate_password_policy=0</div><div class=\"line\"># 记录慢速查询</div><div class=\"line\">slow_query_log=1</div><div class=\"line\">slow_query_log_file=/data/log/mysql/mysql-slow.log</div><div class=\"line\"># # 慢查询最小值，大于此时间，则为慢查询，单位为秒</div><div class=\"line\">long_query_time=6</div><div class=\"line\">#GTID 主从同步</div><div class=\"line\">gtid_mode=on</div><div class=\"line\">enforce_gtid_consistency=on</div><div class=\"line\">#唯一的服务辨识号,数值位于 1 到 2^32-1之间.</div><div class=\"line\">server_id=1</div><div class=\"line\">log-bin=mysql-bin</div><div class=\"line\">log-slave-updates=1</div><div class=\"line\">binlog_format=row</div><div class=\"line\">#当binlog_format=row时，用于记录原始的sql语句,不记录了</div><div class=\"line\">#binlog_rows_query_log_events=on</div><div class=\"line\">slave-skip-errors=all</div><div class=\"line\">auto-increment-offset=1</div><div class=\"line\">auto-increment-increment=2</div><div class=\"line\">#忽略下列的库表</div><div class=\"line\">#replicate-wild-ignore-table=mysql.%</div><div class=\"line\">#replicate-wild-ignore-table=test.%</div><div class=\"line\">#replicate-wild-ignore-table=performance_schema.%</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">[client]</div><div class=\"line\">socket=/data/mysql/mysql.sock</div></pre></td></tr></table></figure>\n<h4 id=\"db2-my-cnf配置\"><a href=\"#db2-my-cnf配置\" class=\"headerlink\" title=\"db2 my.cnf配置\"></a>db2 my.cnf配置</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div></pre></td><td class=\"code\"><pre><div class=\"line\">[mysqld]</div><div class=\"line\"></div><div class=\"line\">#是内存情况配置，理想为 70%的物理内存</div><div class=\"line\">innodb_buffer_pool_size = 45G</div><div class=\"line\"></div><div class=\"line\">skip-external-locking</div><div class=\"line\">key_buffer_size = 384M</div><div class=\"line\">max_allowed_packet = 1073741824</div><div class=\"line\">table_open_cache = 512</div><div class=\"line\">sort_buffer_size = 2M</div><div class=\"line\">read_buffer_size = 2M</div><div class=\"line\">read_rnd_buffer_size = 8M</div><div class=\"line\">myisam_sort_buffer_size = 64M</div><div class=\"line\">thread_cache_size = 8</div><div class=\"line\">query_cache_size = 32M</div><div class=\"line\">#thread_concurrency = 8</div><div class=\"line\">binlog_cache_size = 4M</div><div class=\"line\">max_connections = 1000</div><div class=\"line\">log_timestamps=SYSTEM</div><div class=\"line\">default-time_zone = &apos;+8:00&apos;</div><div class=\"line\">#</div><div class=\"line\">datadir=/data/mysql</div><div class=\"line\">socket=/data/mysql/mysql.sock</div><div class=\"line\">lower_case_table_names=1</div><div class=\"line\"># Disabling symbolic-links is recommended to prevent assorted security risks</div><div class=\"line\">symbolic-links=0</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">log-error=/var/log/mysqld.log</div><div class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</div><div class=\"line\">secure-file-priv = &quot;&quot;</div><div class=\"line\">tmpdir=/data/tmp</div><div class=\"line\"></div><div class=\"line\">validate_password_policy=0</div><div class=\"line\"># 记录慢速查询</div><div class=\"line\">slow_query_log=1</div><div class=\"line\">slow_query_log_file=/data/log/mysql/mysql-slow.log</div><div class=\"line\"># 慢查询最小值，大于此时间，则为慢查询，单位为秒</div><div class=\"line\">long_query_time=6</div><div class=\"line\"></div><div class=\"line\">#GTID 主从同步</div><div class=\"line\">gtid_mode=on</div><div class=\"line\">enforce_gtid_consistency=on</div><div class=\"line\">#唯一的服务辨识号,数值位于 1 到 2^32-1之间.</div><div class=\"line\">server_id=2</div><div class=\"line\">log-bin=mysql-bin</div><div class=\"line\">log-slave-updates=1</div><div class=\"line\">binlog_format=row</div><div class=\"line\">#当binlog_format=row时，用于记录原始的sql语句,不记录了</div><div class=\"line\">#binlog_rows_query_log_events=on</div><div class=\"line\">slave-skip-errors=all</div><div class=\"line\">#在主主同步配置时，需要将两台服务器的auto_increment_increment增长量都配置为2，而要把auto_increment_offset分别配置为1和2。这样才可以避免两台服务器同时做更新时自增长字段的值之间发生冲突。参考：http://dev.mysql.com/doc/refman/5.0/en/replication-options-master.html</div><div class=\"line\">auto-increment-offset=2</div><div class=\"line\">auto-increment-increment=2</div><div class=\"line\">##忽略下列的库表</div><div class=\"line\">#replicate-wild-ignore-table=mysql.%</div><div class=\"line\">#replicate-wild-ignore-table=test.%</div><div class=\"line\">#replicate-wild-ignore-table=performance_schema.%</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">#</div><div class=\"line\"></div><div class=\"line\">[client]</div><div class=\"line\">socket=/data/mysql/mysql.sock</div></pre></td></tr></table></figure>\n<h3 id=\"db1-创建同步用户\"><a href=\"#db1-创建同步用户\" class=\"headerlink\" title=\"db1 创建同步用户\"></a>db1 创建同步用户</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">create user &apos;slave&apos;@&apos;10.19.%.%&apos; identified by &apos;slave123#@!b11d&apos;;</div><div class=\"line\">grant replication slave on *.* to &apos;slave&apos;@&apos;10.19.%.%&apos;;</div><div class=\"line\">flush privileges;</div></pre></td></tr></table></figure>\n<h3 id=\"mysql-8-13\"><a href=\"#mysql-8-13\" class=\"headerlink\" title=\"mysql 8.13\"></a>mysql 8.13</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">create user &apos;slave&apos;@&apos;%&apos; identified  WITH mysql_native_password by &apos;slave1ddd23#@!b11dddd&apos;;</div><div class=\"line\">grant replication slave on *.* to &apos;slave&apos;@&apos;%&apos;;</div><div class=\"line\">flush privileges;</div></pre></td></tr></table></figure>\n<h3 id=\"db2-上开启同步db1\"><a href=\"#db2-上开启同步db1\" class=\"headerlink\" title=\"db2 上开启同步db1\"></a>db2 上开启同步db1</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">change master to master_host=&apos;10.19.2.11&apos;,</div><div class=\"line\">master_user=&apos;slave&apos;,</div><div class=\"line\">master_password=&apos;slave123#@!b11d&apos;,</div><div class=\"line\">MASTER_AUTO_POSITION=1;</div><div class=\"line\"></div><div class=\"line\">start slave;</div></pre></td></tr></table></figure>\n<h3 id=\"查看是否成功\"><a href=\"#查看是否成功\" class=\"headerlink\" title=\"查看是否成功\"></a>查看是否成功</h3><p>show master logs;<br>show master status;  </p>\n<p>通过show slave status \\G 查看slave状态   </p>\n<p>也可以通过 select user,host from mysql.user; 来查看同步用户是否已经建立好，<br>如果建立好，代表已经同步成功。</p>\n<h3 id=\"8-13无法复制用户过来在db2新建账号\"><a href=\"#8-13无法复制用户过来在db2新建账号\" class=\"headerlink\" title=\"8.13无法复制用户过来在db2新建账号\"></a>8.13无法复制用户过来在db2新建账号</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">create user &apos;slave&apos;@&apos;%&apos; identified  WITH mysql_native_password by &apos;slave1ddd23#@!b11dddd&apos;;</div><div class=\"line\">grant replication slave on *.* to &apos;slave&apos;@&apos;%&apos;;</div><div class=\"line\">flush privileges;</div></pre></td></tr></table></figure>\n<h3 id=\"db1-上开启同步db2\"><a href=\"#db1-上开启同步db2\" class=\"headerlink\" title=\"db1 上开启同步db2\"></a>db1 上开启同步db2</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">change master to master_host=&apos;10.19.113.140&apos;,</div><div class=\"line\">master_user=&apos;slave&apos;,</div><div class=\"line\">master_password=&apos;slave123#@!b11d&apos;,</div><div class=\"line\">MASTER_AUTO_POSITION=1;</div><div class=\"line\"></div><div class=\"line\">start slave;</div></pre></td></tr></table></figure>\n<h3 id=\"测试同步复制\"><a href=\"#测试同步复制\" class=\"headerlink\" title=\"测试同步复制\"></a>测试同步复制</h3><h4 id=\"db2从db1同步测试\"><a href=\"#db2从db1同步测试\" class=\"headerlink\" title=\"db2从db1同步测试\"></a>db2从db1同步测试</h4><p>在db1上执行以下语句：   </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">create database test_db1;</div><div class=\"line\">use test_db1;</div><div class=\"line\"> create table temp(id int primary key not null auto_increment,a int,b int,c int as (a*b));</div><div class=\"line\">insert into temp (a,b)values(1,2),(3,4),(5,6);</div></pre></td></tr></table></figure>\n<p>在db2上查看是否正常同步，如果正常，即成功。</p>\n<p>在db2上执行以下语句：</p>\n<h4 id=\"db1从db2同步测试\"><a href=\"#db1从db2同步测试\" class=\"headerlink\" title=\"db1从db2同步测试\"></a>db1从db2同步测试</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">create database test_db2;</div><div class=\"line\">use test_db2;</div><div class=\"line\"> create table temp(id int primary key not null auto_increment,a int,b int,c int as (a*b));</div><div class=\"line\">insert into temp (a,b)values(1,2),(3,4),(5,6);</div></pre></td></tr></table></figure>\n<p>在db1上查看是否正常同步，如果正常，即成功。</p>\n<h3 id=\"停机测试\"><a href=\"#停机测试\" class=\"headerlink\" title=\"停机测试\"></a>停机测试</h3><ol>\n<li>停止db2的数据库，在db1上执行</li>\n<li>启动db2，查看是否正常同步，如果正常同步，即成功。</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">insert into temp (a,b)values(7,8),(9,10);</div></pre></td></tr></table></figure>\n<h3 id=\"停止同步slave-模式，然后再启动测试，看数据是否同步\"><a href=\"#停止同步slave-模式，然后再启动测试，看数据是否同步\" class=\"headerlink\" title=\"停止同步slave 模式，然后再启动测试，看数据是否同步\"></a>停止同步slave 模式，然后再启动测试，看数据是否同步</h3><ol>\n<li><p>停止db2的slave</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">stop slave;</div></pre></td></tr></table></figure>\n<p> 在db1上执行  </p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">insert into temp (a,b)values(11,12);</div></pre></td></tr></table></figure>\n</li>\n<li><p>启动db2，查看是否正常同步，如果正常同步，即成功。  </p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">start slave;</div></pre></td></tr></table></figure>\n</li>\n</ol>\n"},{"title":"centos 6.5 安装mysql 5.7","date":"2018-05-31T05:57:23.000Z","_content":"\n### centos 6.5 安装mysql 5.7\n```\n#!/bin/bash\nyum -y remove mysql-libs*\n\nyum install -y numactl\nyum install -y perl\nyum install -y libaio\nrpm -ivh mysql-community-common-5.7.21-1.el6.x86_64.rpm\nrpm -ivh mysql-community-libs-5.7.21-1.el6.x86_64.rpm\nrpm -ivh mysql-community-client-5.7.21-1.el6.x86_64.rpm\nrpm -ivh mysql-community-server-5.7.21-1.el6.x86_64.rpm\nservice mysqld start\nmkdir /data/mysql\nmkdir /data/tmp\nchmod 777 /data/tmp\nmkdir -p /data/log/mysql/\nchown mysql:mysql /data/mysql\nchown mysql:mysql /data/log/mysql/\n```\n\n\n\n\n\n\n### 修改myql5.7密码\n#### 进入安全模式\n\tservice mysqld stop\n\tmysqld_safe --skip-grant-tables &\n#### 修改密码\n```\n\nuse mysql;\n\n \nset global validate_password_policy=0;\n \n  SET PASSWORD = PASSWORD('bits@20180528!hhhaj11ddh~');\n    ALTER USER 'root'@'localhost' IDENTIFIED BY 'bits@asdfasdf2019019';\n\n  \nflush privileges;\nquit;\n\n\n\n\n\n set password=password(\"11@20180528!hzhz1d1dzh~\");\n\nservice mysqld stop\nservice mysqld start\n```\n\n\n\n### 修改8.0密码\n\n```\nmysqld --initialize-insecure --user=mysql\n\nuse mysql；\n\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '新密码';\nFLUSH PRIVILEGES;\n\n\n```\n\n\n### 添加用户\n```\nset global validate_password_policy=0;\nDelete FROM user Where User='xcredit' and Host='%';\n\nflush privileges;\n\ncreate user dd identified by 'Cq&asdfasd9!#jq^J4K';\n\n\n\nGRANT ALL PRIVILEGES ON *.* TO 'dd'@'%' WITH GRANT OPTION;\n\n\nflush privileges;\n\n\n\n\n```\n\n### 设置root能远程访问\n```\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;\n\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'dd@201dafds90ddf19' WITH GRANT OPTION;\n\nFLUSH PRIVILEGES\n```\n\n","source":"_posts/mysql安装.md","raw":"\n---\ntitle: centos 6.5 安装mysql 5.7\ndate: 2018-05-31 13:57:23\ncategories: \n\t- mysql\ntags:\n\t- 安装mysql\n---\n\n### centos 6.5 安装mysql 5.7\n```\n#!/bin/bash\nyum -y remove mysql-libs*\n\nyum install -y numactl\nyum install -y perl\nyum install -y libaio\nrpm -ivh mysql-community-common-5.7.21-1.el6.x86_64.rpm\nrpm -ivh mysql-community-libs-5.7.21-1.el6.x86_64.rpm\nrpm -ivh mysql-community-client-5.7.21-1.el6.x86_64.rpm\nrpm -ivh mysql-community-server-5.7.21-1.el6.x86_64.rpm\nservice mysqld start\nmkdir /data/mysql\nmkdir /data/tmp\nchmod 777 /data/tmp\nmkdir -p /data/log/mysql/\nchown mysql:mysql /data/mysql\nchown mysql:mysql /data/log/mysql/\n```\n\n\n\n\n\n\n### 修改myql5.7密码\n#### 进入安全模式\n\tservice mysqld stop\n\tmysqld_safe --skip-grant-tables &\n#### 修改密码\n```\n\nuse mysql;\n\n \nset global validate_password_policy=0;\n \n  SET PASSWORD = PASSWORD('bits@20180528!hhhaj11ddh~');\n    ALTER USER 'root'@'localhost' IDENTIFIED BY 'bits@asdfasdf2019019';\n\n  \nflush privileges;\nquit;\n\n\n\n\n\n set password=password(\"11@20180528!hzhz1d1dzh~\");\n\nservice mysqld stop\nservice mysqld start\n```\n\n\n\n### 修改8.0密码\n\n```\nmysqld --initialize-insecure --user=mysql\n\nuse mysql；\n\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '新密码';\nFLUSH PRIVILEGES;\n\n\n```\n\n\n### 添加用户\n```\nset global validate_password_policy=0;\nDelete FROM user Where User='xcredit' and Host='%';\n\nflush privileges;\n\ncreate user dd identified by 'Cq&asdfasd9!#jq^J4K';\n\n\n\nGRANT ALL PRIVILEGES ON *.* TO 'dd'@'%' WITH GRANT OPTION;\n\n\nflush privileges;\n\n\n\n\n```\n\n### 设置root能远程访问\n```\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;\n\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'dd@201dafds90ddf19' WITH GRANT OPTION;\n\nFLUSH PRIVILEGES\n```\n\n","slug":"mysql安装","published":1,"updated":"2019-03-11T08:47:35.805Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0ey100171fiheftspurf","content":"<h3 id=\"centos-6-5-安装mysql-5-7\"><a href=\"#centos-6-5-安装mysql-5-7\" class=\"headerlink\" title=\"centos 6.5 安装mysql 5.7\"></a>centos 6.5 安装mysql 5.7</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/bin/bash</div><div class=\"line\">yum -y remove mysql-libs*</div><div class=\"line\"></div><div class=\"line\">yum install -y numactl</div><div class=\"line\">yum install -y perl</div><div class=\"line\">yum install -y libaio</div><div class=\"line\">rpm -ivh mysql-community-common-5.7.21-1.el6.x86_64.rpm</div><div class=\"line\">rpm -ivh mysql-community-libs-5.7.21-1.el6.x86_64.rpm</div><div class=\"line\">rpm -ivh mysql-community-client-5.7.21-1.el6.x86_64.rpm</div><div class=\"line\">rpm -ivh mysql-community-server-5.7.21-1.el6.x86_64.rpm</div><div class=\"line\">service mysqld start</div><div class=\"line\">mkdir /data/mysql</div><div class=\"line\">mkdir /data/tmp</div><div class=\"line\">chmod 777 /data/tmp</div><div class=\"line\">mkdir -p /data/log/mysql/</div><div class=\"line\">chown mysql:mysql /data/mysql</div><div class=\"line\">chown mysql:mysql /data/log/mysql/</div></pre></td></tr></table></figure>\n<h3 id=\"修改myql5-7密码\"><a href=\"#修改myql5-7密码\" class=\"headerlink\" title=\"修改myql5.7密码\"></a>修改myql5.7密码</h3><h4 id=\"进入安全模式\"><a href=\"#进入安全模式\" class=\"headerlink\" title=\"进入安全模式\"></a>进入安全模式</h4><pre><code>service mysqld stop\nmysqld_safe --skip-grant-tables &amp;\n</code></pre><h4 id=\"修改密码\"><a href=\"#修改密码\" class=\"headerlink\" title=\"修改密码\"></a>修改密码</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">use mysql;</div><div class=\"line\"></div><div class=\"line\"> </div><div class=\"line\">set global validate_password_policy=0;</div><div class=\"line\"> </div><div class=\"line\">  SET PASSWORD = PASSWORD(&apos;bits@20180528!hhhaj11ddh~&apos;);</div><div class=\"line\">    ALTER USER &apos;root&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;bits@asdfasdf2019019&apos;;</div><div class=\"line\"></div><div class=\"line\">  </div><div class=\"line\">flush privileges;</div><div class=\"line\">quit;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"> set password=password(&quot;11@20180528!hzhz1d1dzh~&quot;);</div><div class=\"line\"></div><div class=\"line\">service mysqld stop</div><div class=\"line\">service mysqld start</div></pre></td></tr></table></figure>\n<h3 id=\"修改8-0密码\"><a href=\"#修改8-0密码\" class=\"headerlink\" title=\"修改8.0密码\"></a>修改8.0密码</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqld --initialize-insecure --user=mysql</div><div class=\"line\"></div><div class=\"line\">use mysql；</div><div class=\"line\"></div><div class=\"line\">ALTER USER &apos;root&apos;@&apos;localhost&apos; IDENTIFIED WITH mysql_native_password BY &apos;新密码&apos;;</div><div class=\"line\">FLUSH PRIVILEGES;</div></pre></td></tr></table></figure>\n<h3 id=\"添加用户\"><a href=\"#添加用户\" class=\"headerlink\" title=\"添加用户\"></a>添加用户</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">set global validate_password_policy=0;</div><div class=\"line\">Delete FROM user Where User=&apos;xcredit&apos; and Host=&apos;%&apos;;</div><div class=\"line\"></div><div class=\"line\">flush privileges;</div><div class=\"line\"></div><div class=\"line\">create user dd identified by &apos;Cq&amp;asdfasd9!#jq^J4K&apos;;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &apos;dd&apos;@&apos;%&apos; WITH GRANT OPTION;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">flush privileges;</div></pre></td></tr></table></figure>\n<h3 id=\"设置root能远程访问\"><a href=\"#设置root能远程访问\" class=\"headerlink\" title=\"设置root能远程访问\"></a>设置root能远程访问</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos; WITH GRANT OPTION;</div><div class=\"line\"></div><div class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos; IDENTIFIED BY &apos;dd@201dafds90ddf19&apos; WITH GRANT OPTION;</div><div class=\"line\"></div><div class=\"line\">FLUSH PRIVILEGES</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"centos-6-5-安装mysql-5-7\"><a href=\"#centos-6-5-安装mysql-5-7\" class=\"headerlink\" title=\"centos 6.5 安装mysql 5.7\"></a>centos 6.5 安装mysql 5.7</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/bin/bash</div><div class=\"line\">yum -y remove mysql-libs*</div><div class=\"line\"></div><div class=\"line\">yum install -y numactl</div><div class=\"line\">yum install -y perl</div><div class=\"line\">yum install -y libaio</div><div class=\"line\">rpm -ivh mysql-community-common-5.7.21-1.el6.x86_64.rpm</div><div class=\"line\">rpm -ivh mysql-community-libs-5.7.21-1.el6.x86_64.rpm</div><div class=\"line\">rpm -ivh mysql-community-client-5.7.21-1.el6.x86_64.rpm</div><div class=\"line\">rpm -ivh mysql-community-server-5.7.21-1.el6.x86_64.rpm</div><div class=\"line\">service mysqld start</div><div class=\"line\">mkdir /data/mysql</div><div class=\"line\">mkdir /data/tmp</div><div class=\"line\">chmod 777 /data/tmp</div><div class=\"line\">mkdir -p /data/log/mysql/</div><div class=\"line\">chown mysql:mysql /data/mysql</div><div class=\"line\">chown mysql:mysql /data/log/mysql/</div></pre></td></tr></table></figure>\n<h3 id=\"修改myql5-7密码\"><a href=\"#修改myql5-7密码\" class=\"headerlink\" title=\"修改myql5.7密码\"></a>修改myql5.7密码</h3><h4 id=\"进入安全模式\"><a href=\"#进入安全模式\" class=\"headerlink\" title=\"进入安全模式\"></a>进入安全模式</h4><pre><code>service mysqld stop\nmysqld_safe --skip-grant-tables &amp;\n</code></pre><h4 id=\"修改密码\"><a href=\"#修改密码\" class=\"headerlink\" title=\"修改密码\"></a>修改密码</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">use mysql;</div><div class=\"line\"></div><div class=\"line\"> </div><div class=\"line\">set global validate_password_policy=0;</div><div class=\"line\"> </div><div class=\"line\">  SET PASSWORD = PASSWORD(&apos;bits@20180528!hhhaj11ddh~&apos;);</div><div class=\"line\">    ALTER USER &apos;root&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;bits@asdfasdf2019019&apos;;</div><div class=\"line\"></div><div class=\"line\">  </div><div class=\"line\">flush privileges;</div><div class=\"line\">quit;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"> set password=password(&quot;11@20180528!hzhz1d1dzh~&quot;);</div><div class=\"line\"></div><div class=\"line\">service mysqld stop</div><div class=\"line\">service mysqld start</div></pre></td></tr></table></figure>\n<h3 id=\"修改8-0密码\"><a href=\"#修改8-0密码\" class=\"headerlink\" title=\"修改8.0密码\"></a>修改8.0密码</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysqld --initialize-insecure --user=mysql</div><div class=\"line\"></div><div class=\"line\">use mysql；</div><div class=\"line\"></div><div class=\"line\">ALTER USER &apos;root&apos;@&apos;localhost&apos; IDENTIFIED WITH mysql_native_password BY &apos;新密码&apos;;</div><div class=\"line\">FLUSH PRIVILEGES;</div></pre></td></tr></table></figure>\n<h3 id=\"添加用户\"><a href=\"#添加用户\" class=\"headerlink\" title=\"添加用户\"></a>添加用户</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">set global validate_password_policy=0;</div><div class=\"line\">Delete FROM user Where User=&apos;xcredit&apos; and Host=&apos;%&apos;;</div><div class=\"line\"></div><div class=\"line\">flush privileges;</div><div class=\"line\"></div><div class=\"line\">create user dd identified by &apos;Cq&amp;asdfasd9!#jq^J4K&apos;;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &apos;dd&apos;@&apos;%&apos; WITH GRANT OPTION;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">flush privileges;</div></pre></td></tr></table></figure>\n<h3 id=\"设置root能远程访问\"><a href=\"#设置root能远程访问\" class=\"headerlink\" title=\"设置root能远程访问\"></a>设置root能远程访问</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos; WITH GRANT OPTION;</div><div class=\"line\"></div><div class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos; IDENTIFIED BY &apos;dd@201dafds90ddf19&apos; WITH GRANT OPTION;</div><div class=\"line\"></div><div class=\"line\">FLUSH PRIVILEGES</div></pre></td></tr></table></figure>\n"},{"title":"linux 磁盘格式化","date":"2018-06-11T05:39:23.000Z","_content":"\n\n### 卸载硬盘\n```\numount -v 挂载路径\n```\n\n如果磁盘busy\n\n```\nlsof |grep 挂载路径\n\n```\n找出正在使用磁盘的进程，kill掉。\n\n### 查看磁盘分区格式\n```\ndf -T\n\n```\n\n### 格式化磁盘分区\n```\nmkfs -t ext4 /dev/sdb\n\n```\n\n\n","source":"_posts/linux磁盘格式化.md","raw":"---\ntitle: linux 磁盘格式化\ndate: 2018-06-11 13:39:23\ncategories: \n\t- 系统\ntags:\n\t- linux\n\t- centos6.5\n---\n\n\n### 卸载硬盘\n```\numount -v 挂载路径\n```\n\n如果磁盘busy\n\n```\nlsof |grep 挂载路径\n\n```\n找出正在使用磁盘的进程，kill掉。\n\n### 查看磁盘分区格式\n```\ndf -T\n\n```\n\n### 格式化磁盘分区\n```\nmkfs -t ext4 /dev/sdb\n\n```\n\n\n","slug":"linux磁盘格式化","published":1,"updated":"2018-06-11T06:27:25.399Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0ey5001b1fih9amyw4i2","content":"<h3 id=\"卸载硬盘\"><a href=\"#卸载硬盘\" class=\"headerlink\" title=\"卸载硬盘\"></a>卸载硬盘</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">umount -v 挂载路径</div></pre></td></tr></table></figure>\n<p>如果磁盘busy</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">lsof |grep 挂载路径</div></pre></td></tr></table></figure>\n<p>找出正在使用磁盘的进程，kill掉。</p>\n<h3 id=\"查看磁盘分区格式\"><a href=\"#查看磁盘分区格式\" class=\"headerlink\" title=\"查看磁盘分区格式\"></a>查看磁盘分区格式</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">df -T</div></pre></td></tr></table></figure>\n<h3 id=\"格式化磁盘分区\"><a href=\"#格式化磁盘分区\" class=\"headerlink\" title=\"格式化磁盘分区\"></a>格式化磁盘分区</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkfs -t ext4 /dev/sdb</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"卸载硬盘\"><a href=\"#卸载硬盘\" class=\"headerlink\" title=\"卸载硬盘\"></a>卸载硬盘</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">umount -v 挂载路径</div></pre></td></tr></table></figure>\n<p>如果磁盘busy</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">lsof |grep 挂载路径</div></pre></td></tr></table></figure>\n<p>找出正在使用磁盘的进程，kill掉。</p>\n<h3 id=\"查看磁盘分区格式\"><a href=\"#查看磁盘分区格式\" class=\"headerlink\" title=\"查看磁盘分区格式\"></a>查看磁盘分区格式</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">df -T</div></pre></td></tr></table></figure>\n<h3 id=\"格式化磁盘分区\"><a href=\"#格式化磁盘分区\" class=\"headerlink\" title=\"格式化磁盘分区\"></a>格式化磁盘分区</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkfs -t ext4 /dev/sdb</div></pre></td></tr></table></figure>\n"},{"title":"Spark 运行Bug","date":"2018-06-26T05:57:23.000Z","_content":"## Spark 运行Bug\nspark-shell执行命令出现以下错误提示：\n\njava.io.IOException: Cannot run program “/etc/hadoop/conf.cloudera.yarn/topology.py” (in directory “/home/108857”): error=2。\n\n这个算是Cloudera 的bug ， 把datanode上的 /etc/hadoop/conf.cloudera.yarn/topology* 复制到执行spark-shell的机器上即可。\n\n\n\n## spark pyspark \n```\n\nfrom pyspark.sql import HiveContext\nsqc = HiveContext(sc)\n\nsqc.sql(\"use xcredit\").show()\nsqc.sql(select * from xxx.xxx).show()\n\n\n```\n\n## spark spark-shell \n\n```\n\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\nimport org.apache.spark.sql.hive.HiveContext\n\nval sqlContext = new HiveContext(sc)\nimport sqlContext.implicits._\n\nsqlContext.sql(\" SELECT * FROM xxx.xxx limit 10\").collect().foreach(println)\n\n\n\n\n\n\nsqlContext.sql(\"insert overwrite local directory '/data/spark_test' row format delimited fields terminated by ',' select ln.index_digest,ln.begin_date,count(distinct lt.p_id) as c  from tb_distinct_analyze_loan ln join tb_distinct_analyze_loan lt\non ln.index_digest = lt.index_digest where ln.begin_date>=date_sub(current_date, 1095) and lt.begin_date>=date_sub(current_date, 1095) and\n((ln.begin_date < lt.end_date and ln.begin_date >= lt.begin_date) or\n(ln.end_date >= lt.begin_date and ln.end_date <= lt.end_date)) group by  ln.index_digest,ln.begin_date \")\n\n\n```","source":"_posts/spark pyspark .md","raw":"---\ntitle: Spark 运行Bug\ndate: 2018-06-26 13:57:23\ncategories: \n\t- 大数据\n\t- spark\ntags:\n\t- spark\n\t- pyspark\n---\n## Spark 运行Bug\nspark-shell执行命令出现以下错误提示：\n\njava.io.IOException: Cannot run program “/etc/hadoop/conf.cloudera.yarn/topology.py” (in directory “/home/108857”): error=2。\n\n这个算是Cloudera 的bug ， 把datanode上的 /etc/hadoop/conf.cloudera.yarn/topology* 复制到执行spark-shell的机器上即可。\n\n\n\n## spark pyspark \n```\n\nfrom pyspark.sql import HiveContext\nsqc = HiveContext(sc)\n\nsqc.sql(\"use xcredit\").show()\nsqc.sql(select * from xxx.xxx).show()\n\n\n```\n\n## spark spark-shell \n\n```\n\n\nimport org.apache.spark.SparkConf\nimport org.apache.spark.SparkContext\nimport org.apache.spark.sql.hive.HiveContext\n\nval sqlContext = new HiveContext(sc)\nimport sqlContext.implicits._\n\nsqlContext.sql(\" SELECT * FROM xxx.xxx limit 10\").collect().foreach(println)\n\n\n\n\n\n\nsqlContext.sql(\"insert overwrite local directory '/data/spark_test' row format delimited fields terminated by ',' select ln.index_digest,ln.begin_date,count(distinct lt.p_id) as c  from tb_distinct_analyze_loan ln join tb_distinct_analyze_loan lt\non ln.index_digest = lt.index_digest where ln.begin_date>=date_sub(current_date, 1095) and lt.begin_date>=date_sub(current_date, 1095) and\n((ln.begin_date < lt.end_date and ln.begin_date >= lt.begin_date) or\n(ln.end_date >= lt.begin_date and ln.end_date <= lt.end_date)) group by  ln.index_digest,ln.begin_date \")\n\n\n```","slug":"spark pyspark ","published":1,"updated":"2018-06-26T02:47:07.041Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0ey7001d1fihdrv5z3kj","content":"<h2 id=\"Spark-运行Bug\"><a href=\"#Spark-运行Bug\" class=\"headerlink\" title=\"Spark 运行Bug\"></a>Spark 运行Bug</h2><p>spark-shell执行命令出现以下错误提示：</p>\n<p>java.io.IOException: Cannot run program “/etc/hadoop/conf.cloudera.yarn/topology.py” (in directory “/home/108857”): error=2。</p>\n<p>这个算是Cloudera 的bug ， 把datanode上的 /etc/hadoop/conf.cloudera.yarn/topology* 复制到执行spark-shell的机器上即可。</p>\n<h2 id=\"spark-pyspark\"><a href=\"#spark-pyspark\" class=\"headerlink\" title=\"spark pyspark\"></a>spark pyspark</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">from pyspark.sql import HiveContext</div><div class=\"line\">sqc = HiveContext(sc)</div><div class=\"line\"></div><div class=\"line\">sqc.sql(&quot;use xcredit&quot;).show()</div><div class=\"line\">sqc.sql(select * from xxx.xxx).show()</div></pre></td></tr></table></figure>\n<h2 id=\"spark-spark-shell\"><a href=\"#spark-spark-shell\" class=\"headerlink\" title=\"spark spark-shell\"></a>spark spark-shell</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">import org.apache.spark.SparkConf</div><div class=\"line\">import org.apache.spark.SparkContext</div><div class=\"line\">import org.apache.spark.sql.hive.HiveContext</div><div class=\"line\"></div><div class=\"line\">val sqlContext = new HiveContext(sc)</div><div class=\"line\">import sqlContext.implicits._</div><div class=\"line\"></div><div class=\"line\">sqlContext.sql(&quot; SELECT * FROM xxx.xxx limit 10&quot;).collect().foreach(println)</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">sqlContext.sql(&quot;insert overwrite local directory &apos;/data/spark_test&apos; row format delimited fields terminated by &apos;,&apos; select ln.index_digest,ln.begin_date,count(distinct lt.p_id) as c  from tb_distinct_analyze_loan ln join tb_distinct_analyze_loan lt</div><div class=\"line\">on ln.index_digest = lt.index_digest where ln.begin_date&gt;=date_sub(current_date, 1095) and lt.begin_date&gt;=date_sub(current_date, 1095) and</div><div class=\"line\">((ln.begin_date &lt; lt.end_date and ln.begin_date &gt;= lt.begin_date) or</div><div class=\"line\">(ln.end_date &gt;= lt.begin_date and ln.end_date &lt;= lt.end_date)) group by  ln.index_digest,ln.begin_date &quot;)</div></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Spark-运行Bug\"><a href=\"#Spark-运行Bug\" class=\"headerlink\" title=\"Spark 运行Bug\"></a>Spark 运行Bug</h2><p>spark-shell执行命令出现以下错误提示：</p>\n<p>java.io.IOException: Cannot run program “/etc/hadoop/conf.cloudera.yarn/topology.py” (in directory “/home/108857”): error=2。</p>\n<p>这个算是Cloudera 的bug ， 把datanode上的 /etc/hadoop/conf.cloudera.yarn/topology* 复制到执行spark-shell的机器上即可。</p>\n<h2 id=\"spark-pyspark\"><a href=\"#spark-pyspark\" class=\"headerlink\" title=\"spark pyspark\"></a>spark pyspark</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\">from pyspark.sql import HiveContext</div><div class=\"line\">sqc = HiveContext(sc)</div><div class=\"line\"></div><div class=\"line\">sqc.sql(&quot;use xcredit&quot;).show()</div><div class=\"line\">sqc.sql(select * from xxx.xxx).show()</div></pre></td></tr></table></figure>\n<h2 id=\"spark-spark-shell\"><a href=\"#spark-spark-shell\" class=\"headerlink\" title=\"spark spark-shell\"></a>spark spark-shell</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">import org.apache.spark.SparkConf</div><div class=\"line\">import org.apache.spark.SparkContext</div><div class=\"line\">import org.apache.spark.sql.hive.HiveContext</div><div class=\"line\"></div><div class=\"line\">val sqlContext = new HiveContext(sc)</div><div class=\"line\">import sqlContext.implicits._</div><div class=\"line\"></div><div class=\"line\">sqlContext.sql(&quot; SELECT * FROM xxx.xxx limit 10&quot;).collect().foreach(println)</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">sqlContext.sql(&quot;insert overwrite local directory &apos;/data/spark_test&apos; row format delimited fields terminated by &apos;,&apos; select ln.index_digest,ln.begin_date,count(distinct lt.p_id) as c  from tb_distinct_analyze_loan ln join tb_distinct_analyze_loan lt</div><div class=\"line\">on ln.index_digest = lt.index_digest where ln.begin_date&gt;=date_sub(current_date, 1095) and lt.begin_date&gt;=date_sub(current_date, 1095) and</div><div class=\"line\">((ln.begin_date &lt; lt.end_date and ln.begin_date &gt;= lt.begin_date) or</div><div class=\"line\">(ln.end_date &gt;= lt.begin_date and ln.end_date &lt;= lt.end_date)) group by  ln.index_digest,ln.begin_date &quot;)</div></pre></td></tr></table></figure>"},{"title":"记一次nginx，https502异常","date":"2018-04-04T05:57:23.000Z","_content":"\n##   出现异常的方式\n相同配置的两台nginx服务器，其中一台访问正常。其中一台访问的时候，浏览器502.由于证书都是自签名，并且配置文件和证书文件都是直接拷贝过去，基本排查配置的问题。\n\n### 错误机器的异常日志/var/log/nginx/error.log\n隐藏了部分IP和host,采用xxxx代替，其中基本错误都是这种类型\n\n```\n\t2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://10.1.152.9:8444/platformService?wsdl\", host: \"xxxx\"   \n\t2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://10.1.152.9:8445/platformService?wsdl\", host: \"xxxx\"\n\t2018/04/04 13:53:55 [error] 5342#0: *3571 no live upstreams while connecting to upstream, client: xxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://jk/platformService?wsdl\", host: \"xxxxx\"   \n\t2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://10.1.152.9:8444/platformService?wsdl\", host: \"xxxxx\"   \n\t2018/04/04 13:53:56 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://10.1.152.9:8445/platformService?wsdl\", host: \"xxxx\"   \n\t2018/04/04 13:53:56 [error] 5342#0: *3468 no live upstreams while connecting to upstream, client: xxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://jk/platformService?wsdl\", host: \"xxxxx\"   \n\t \n```\n正常机器没有出现异常。\n\n### 解决问题思路\n可以看出，在访问 https://10.1.152.9:8444/platformService?wsdl 内部地址时，出现了异常，那该地址去控制台访问，  \nwget https://10.1.152.9:8444/platformService?wsdl，发现异常如下：\n\n```\n\tOpenSSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group\n\tOpenSSL: error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib\n\t无法建立 SSL 连接。\n\n```\n在正常机器 10.1.152.8 访问 wget https://10.1.152.8:8444/platformService?wsdl：\n\n```\n正在连接 10.1.152.8:8444... 已连接。\n错误: 无法验证 10.1.152.8 的由 “/C=CN/O=WoSign CA Limited/CN=CA xxxxx G2” 颁发的证书:\n  \t颁发的证书已经过期。\n   \t 错误: certificate common name “xxxx” doesn't match requested host name “10.1.152.8”.\n要以不安全的方式连接至 10.1.152.8，使用‘--no-check-certificate’。\n\t\n```\n由于不是很严格的自签名证书，正常的异常。\n### 解决方法：\n**系统版本号:RHEL / CentOS 6.5**      \n**Root Cause:** The OpenSSL library available and installed by default on RHEL/CentOS 6.5 has a bug. Refer to \t[BUG](https://bugzilla.redhat.com/show_bug.cgi?id=1025598) for detailed information on the bug.  \n大意是该版本的系统的openssl有bug需要升级  \n1.查看系统openssl版本:\n\n```\n rpm -qa | grep openssl\n openssl-1.0.1e-15.el6.x86_64\n```\n2.升级系统版本：  \n```：\n\tyum -y upgrade openssl\n\topenssl-1.0.1e-57.el6.x86_64\n```  \n\n升级后浏览器访问恢复正常！\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/nginx-openssl版本问题.md","raw":"---\ntitle: 记一次nginx，https502异常\ndate: 2018-04-04 13:57:23\ncategories: \n\t- nginx\ntags:\n\t- nginx\n\t- openssl\n---\n\n##   出现异常的方式\n相同配置的两台nginx服务器，其中一台访问正常。其中一台访问的时候，浏览器502.由于证书都是自签名，并且配置文件和证书文件都是直接拷贝过去，基本排查配置的问题。\n\n### 错误机器的异常日志/var/log/nginx/error.log\n隐藏了部分IP和host,采用xxxx代替，其中基本错误都是这种类型\n\n```\n\t2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://10.1.152.9:8444/platformService?wsdl\", host: \"xxxx\"   \n\t2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://10.1.152.9:8445/platformService?wsdl\", host: \"xxxx\"\n\t2018/04/04 13:53:55 [error] 5342#0: *3571 no live upstreams while connecting to upstream, client: xxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://jk/platformService?wsdl\", host: \"xxxxx\"   \n\t2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://10.1.152.9:8444/platformService?wsdl\", host: \"xxxxx\"   \n\t2018/04/04 13:53:56 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://10.1.152.9:8445/platformService?wsdl\", host: \"xxxx\"   \n\t2018/04/04 13:53:56 [error] 5342#0: *3468 no live upstreams while connecting to upstream, client: xxxx, server: xxxx, request: \"POST /platformService?wsdl HTTP/1.1\", upstream: \"https://jk/platformService?wsdl\", host: \"xxxxx\"   \n\t \n```\n正常机器没有出现异常。\n\n### 解决问题思路\n可以看出，在访问 https://10.1.152.9:8444/platformService?wsdl 内部地址时，出现了异常，那该地址去控制台访问，  \nwget https://10.1.152.9:8444/platformService?wsdl，发现异常如下：\n\n```\n\tOpenSSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group\n\tOpenSSL: error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib\n\t无法建立 SSL 连接。\n\n```\n在正常机器 10.1.152.8 访问 wget https://10.1.152.8:8444/platformService?wsdl：\n\n```\n正在连接 10.1.152.8:8444... 已连接。\n错误: 无法验证 10.1.152.8 的由 “/C=CN/O=WoSign CA Limited/CN=CA xxxxx G2” 颁发的证书:\n  \t颁发的证书已经过期。\n   \t 错误: certificate common name “xxxx” doesn't match requested host name “10.1.152.8”.\n要以不安全的方式连接至 10.1.152.8，使用‘--no-check-certificate’。\n\t\n```\n由于不是很严格的自签名证书，正常的异常。\n### 解决方法：\n**系统版本号:RHEL / CentOS 6.5**      \n**Root Cause:** The OpenSSL library available and installed by default on RHEL/CentOS 6.5 has a bug. Refer to \t[BUG](https://bugzilla.redhat.com/show_bug.cgi?id=1025598) for detailed information on the bug.  \n大意是该版本的系统的openssl有bug需要升级  \n1.查看系统openssl版本:\n\n```\n rpm -qa | grep openssl\n openssl-1.0.1e-15.el6.x86_64\n```\n2.升级系统版本：  \n```：\n\tyum -y upgrade openssl\n\topenssl-1.0.1e-57.el6.x86_64\n```  \n\n升级后浏览器访问恢复正常！\n\n\n\n\n\n\n\n\n\n\n","slug":"nginx-openssl版本问题","published":1,"updated":"2018-04-04T07:03:22.900Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0ey9001i1fihzta9d96s","content":"<h2 id=\"出现异常的方式\"><a href=\"#出现异常的方式\" class=\"headerlink\" title=\"出现异常的方式\"></a>出现异常的方式</h2><p>相同配置的两台nginx服务器，其中一台访问正常。其中一台访问的时候，浏览器502.由于证书都是自签名，并且配置文件和证书文件都是直接拷贝过去，基本排查配置的问题。</p>\n<h3 id=\"错误机器的异常日志-var-log-nginx-error-log\"><a href=\"#错误机器的异常日志-var-log-nginx-error-log\" class=\"headerlink\" title=\"错误机器的异常日志/var/log/nginx/error.log\"></a>错误机器的异常日志/var/log/nginx/error.log</h3><p>隐藏了部分IP和host,采用xxxx代替，其中基本错误都是这种类型</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://10.1.152.9:8444/platformService?wsdl&quot;, host: &quot;xxxx&quot;   </div><div class=\"line\">2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://10.1.152.9:8445/platformService?wsdl&quot;, host: &quot;xxxx&quot;</div><div class=\"line\">2018/04/04 13:53:55 [error] 5342#0: *3571 no live upstreams while connecting to upstream, client: xxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://jk/platformService?wsdl&quot;, host: &quot;xxxxx&quot;   </div><div class=\"line\">2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://10.1.152.9:8444/platformService?wsdl&quot;, host: &quot;xxxxx&quot;   </div><div class=\"line\">2018/04/04 13:53:56 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://10.1.152.9:8445/platformService?wsdl&quot;, host: &quot;xxxx&quot;   </div><div class=\"line\">2018/04/04 13:53:56 [error] 5342#0: *3468 no live upstreams while connecting to upstream, client: xxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://jk/platformService?wsdl&quot;, host: &quot;xxxxx&quot;</div></pre></td></tr></table></figure>\n<p>正常机器没有出现异常。</p>\n<h3 id=\"解决问题思路\"><a href=\"#解决问题思路\" class=\"headerlink\" title=\"解决问题思路\"></a>解决问题思路</h3><p>可以看出，在访问 <a href=\"https://10.1.152.9:8444/platformService?wsdl\" target=\"_blank\" rel=\"external\">https://10.1.152.9:8444/platformService?wsdl</a> 内部地址时，出现了异常，那该地址去控制台访问，<br>wget <a href=\"https://10.1.152.9:8444/platformService?wsdl，发现异常如下：\" target=\"_blank\" rel=\"external\">https://10.1.152.9:8444/platformService?wsdl，发现异常如下：</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">OpenSSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group</div><div class=\"line\">OpenSSL: error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib</div><div class=\"line\">无法建立 SSL 连接。</div></pre></td></tr></table></figure>\n<p>在正常机器 10.1.152.8 访问 wget <a href=\"https://10.1.152.8:8444/platformService?wsdl：\" target=\"_blank\" rel=\"external\">https://10.1.152.8:8444/platformService?wsdl：</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">正在连接 10.1.152.8:8444... 已连接。</div><div class=\"line\">错误: 无法验证 10.1.152.8 的由 “/C=CN/O=WoSign CA Limited/CN=CA xxxxx G2” 颁发的证书:</div><div class=\"line\">  \t颁发的证书已经过期。</div><div class=\"line\">   \t 错误: certificate common name “xxxx” doesn&apos;t match requested host name “10.1.152.8”.</div><div class=\"line\">要以不安全的方式连接至 10.1.152.8，使用‘--no-check-certificate’。</div></pre></td></tr></table></figure>\n<p>由于不是很严格的自签名证书，正常的异常。</p>\n<h3 id=\"解决方法：\"><a href=\"#解决方法：\" class=\"headerlink\" title=\"解决方法：\"></a>解决方法：</h3><p><strong>系统版本号:RHEL / CentOS 6.5</strong><br><strong>Root Cause:</strong> The OpenSSL library available and installed by default on RHEL/CentOS 6.5 has a bug. Refer to     <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=1025598\" target=\"_blank\" rel=\"external\">BUG</a> for detailed information on the bug.<br>大意是该版本的系统的openssl有bug需要升级<br>1.查看系统openssl版本:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -qa | grep openssl</div><div class=\"line\">openssl-1.0.1e-15.el6.x86_64</div></pre></td></tr></table></figure>\n<p>2.升级系统版本：  </p>\n<pre><code class=\"：\">yum -y upgrade openssl\nopenssl-1.0.1e-57.el6.x86_64\n</code></pre>\n<p>升级后浏览器访问恢复正常！</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"出现异常的方式\"><a href=\"#出现异常的方式\" class=\"headerlink\" title=\"出现异常的方式\"></a>出现异常的方式</h2><p>相同配置的两台nginx服务器，其中一台访问正常。其中一台访问的时候，浏览器502.由于证书都是自签名，并且配置文件和证书文件都是直接拷贝过去，基本排查配置的问题。</p>\n<h3 id=\"错误机器的异常日志-var-log-nginx-error-log\"><a href=\"#错误机器的异常日志-var-log-nginx-error-log\" class=\"headerlink\" title=\"错误机器的异常日志/var/log/nginx/error.log\"></a>错误机器的异常日志/var/log/nginx/error.log</h3><p>隐藏了部分IP和host,采用xxxx代替，其中基本错误都是这种类型</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://10.1.152.9:8444/platformService?wsdl&quot;, host: &quot;xxxx&quot;   </div><div class=\"line\">2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://10.1.152.9:8445/platformService?wsdl&quot;, host: &quot;xxxx&quot;</div><div class=\"line\">2018/04/04 13:53:55 [error] 5342#0: *3571 no live upstreams while connecting to upstream, client: xxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://jk/platformService?wsdl&quot;, host: &quot;xxxxx&quot;   </div><div class=\"line\">2018/04/04 13:53:55 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://10.1.152.9:8444/platformService?wsdl&quot;, host: &quot;xxxxx&quot;   </div><div class=\"line\">2018/04/04 13:53:56 [error] 5342#0: *3468 SSL_do_handshake() failed (SSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib) while SSL handshaking to upstream, client: xxxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://10.1.152.9:8445/platformService?wsdl&quot;, host: &quot;xxxx&quot;   </div><div class=\"line\">2018/04/04 13:53:56 [error] 5342#0: *3468 no live upstreams while connecting to upstream, client: xxxx, server: xxxx, request: &quot;POST /platformService?wsdl HTTP/1.1&quot;, upstream: &quot;https://jk/platformService?wsdl&quot;, host: &quot;xxxxx&quot;</div></pre></td></tr></table></figure>\n<p>正常机器没有出现异常。</p>\n<h3 id=\"解决问题思路\"><a href=\"#解决问题思路\" class=\"headerlink\" title=\"解决问题思路\"></a>解决问题思路</h3><p>可以看出，在访问 <a href=\"https://10.1.152.9:8444/platformService?wsdl\" target=\"_blank\" rel=\"external\">https://10.1.152.9:8444/platformService?wsdl</a> 内部地址时，出现了异常，那该地址去控制台访问，<br>wget <a href=\"https://10.1.152.9:8444/platformService?wsdl，发现异常如下：\" target=\"_blank\" rel=\"external\">https://10.1.152.9:8444/platformService?wsdl，发现异常如下：</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">OpenSSL: error:100AE081:elliptic curve routines:EC_GROUP_new_by_curve_name:unknown group</div><div class=\"line\">OpenSSL: error:1408D010:SSL routines:SSL3_GET_KEY_EXCHANGE:EC lib</div><div class=\"line\">无法建立 SSL 连接。</div></pre></td></tr></table></figure>\n<p>在正常机器 10.1.152.8 访问 wget <a href=\"https://10.1.152.8:8444/platformService?wsdl：\" target=\"_blank\" rel=\"external\">https://10.1.152.8:8444/platformService?wsdl：</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">正在连接 10.1.152.8:8444... 已连接。</div><div class=\"line\">错误: 无法验证 10.1.152.8 的由 “/C=CN/O=WoSign CA Limited/CN=CA xxxxx G2” 颁发的证书:</div><div class=\"line\">  \t颁发的证书已经过期。</div><div class=\"line\">   \t 错误: certificate common name “xxxx” doesn&apos;t match requested host name “10.1.152.8”.</div><div class=\"line\">要以不安全的方式连接至 10.1.152.8，使用‘--no-check-certificate’。</div></pre></td></tr></table></figure>\n<p>由于不是很严格的自签名证书，正常的异常。</p>\n<h3 id=\"解决方法：\"><a href=\"#解决方法：\" class=\"headerlink\" title=\"解决方法：\"></a>解决方法：</h3><p><strong>系统版本号:RHEL / CentOS 6.5</strong><br><strong>Root Cause:</strong> The OpenSSL library available and installed by default on RHEL/CentOS 6.5 has a bug. Refer to     <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=1025598\" target=\"_blank\" rel=\"external\">BUG</a> for detailed information on the bug.<br>大意是该版本的系统的openssl有bug需要升级<br>1.查看系统openssl版本:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm -qa | grep openssl</div><div class=\"line\">openssl-1.0.1e-15.el6.x86_64</div></pre></td></tr></table></figure>\n<p>2.升级系统版本：  </p>\n<pre><code class=\"：\">yum -y upgrade openssl\nopenssl-1.0.1e-57.el6.x86_64\n</code></pre>\n<p>升级后浏览器访问恢复正常！</p>\n"},{"title":"centos 6.5安装php环境","date":"2018-05-31T05:57:23.000Z","_content":"\n## php启动设置\n\n安装apache2\n\nyum -y install httpd\n\n查看版本\nhttpd -v\n\nyum -y install libavahi*\n\n\nyum -y install php\n安装第三方包：\n\nyum -y install php-gd libjpeg* php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-mcrypt php-bcmath php-mhash libmcrypt\n\n\nmysql-community-libs-compat-5.7.21-1.el6.x86_64.rpm\nphp-mysql-5.3.3-49.el6.x86_64.rpm\n","source":"_posts/php启动设置.md","raw":"---\ntitle: centos 6.5安装php环境 \ndate: 2018-05-31 13:57:23\ncategories: \n\t- php\ntags:\n\t- php\n---\n\n## php启动设置\n\n安装apache2\n\nyum -y install httpd\n\n查看版本\nhttpd -v\n\nyum -y install libavahi*\n\n\nyum -y install php\n安装第三方包：\n\nyum -y install php-gd libjpeg* php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-mcrypt php-bcmath php-mhash libmcrypt\n\n\nmysql-community-libs-compat-5.7.21-1.el6.x86_64.rpm\nphp-mysql-5.3.3-49.el6.x86_64.rpm\n","slug":"php启动设置","published":1,"updated":"2018-06-19T09:30:46.165Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0eya001l1fihp4yzim7u","content":"<h2 id=\"php启动设置\"><a href=\"#php启动设置\" class=\"headerlink\" title=\"php启动设置\"></a>php启动设置</h2><p>安装apache2</p>\n<p>yum -y install httpd</p>\n<p>查看版本<br>httpd -v</p>\n<p>yum -y install libavahi*</p>\n<p>yum -y install php<br>安装第三方包：</p>\n<p>yum -y install php-gd libjpeg* php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-mcrypt php-bcmath php-mhash libmcrypt</p>\n<p>mysql-community-libs-compat-5.7.21-1.el6.x86_64.rpm<br>php-mysql-5.3.3-49.el6.x86_64.rpm</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"php启动设置\"><a href=\"#php启动设置\" class=\"headerlink\" title=\"php启动设置\"></a>php启动设置</h2><p>安装apache2</p>\n<p>yum -y install httpd</p>\n<p>查看版本<br>httpd -v</p>\n<p>yum -y install libavahi*</p>\n<p>yum -y install php<br>安装第三方包：</p>\n<p>yum -y install php-gd libjpeg* php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc php-mbstring php-mcrypt php-bcmath php-mhash libmcrypt</p>\n<p>mysql-community-libs-compat-5.7.21-1.el6.x86_64.rpm<br>php-mysql-5.3.3-49.el6.x86_64.rpm</p>\n"},{"title":"mysql导出数据","date":"2018-05-31T05:57:23.000Z","_content":"\n### mysql导出所有数据库，会包含mysql本身的库\nmysqldump -u root -p --all-databases > alldb.sql\n\n### 导入：\nmysql -u root -p < alldb.sql\n\n\n### 导出指定的库\nmysqldump -u root -p --databases 数据库1 数据库2 | gzip > alldb.sql.gz\n\n### 导入指定的\ngunzip < myfile.sql.gz | mysql -u root -p \n\n### 导出某张表的数据\nmysqldump [options] db_name [table_name……]","source":"_posts/mysql导出数据.md","raw":"---\ntitle: mysql导出数据\ndate: 2018-05-31 13:57:23\ncategories: \n\t- mysql\ntags:\n\t- 导出数据\n---\n\n### mysql导出所有数据库，会包含mysql本身的库\nmysqldump -u root -p --all-databases > alldb.sql\n\n### 导入：\nmysql -u root -p < alldb.sql\n\n\n### 导出指定的库\nmysqldump -u root -p --databases 数据库1 数据库2 | gzip > alldb.sql.gz\n\n### 导入指定的\ngunzip < myfile.sql.gz | mysql -u root -p \n\n### 导出某张表的数据\nmysqldump [options] db_name [table_name……]","slug":"mysql导出数据","published":1,"updated":"2018-06-02T10:37:58.531Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0eyd001p1fih8crnt7as","content":"<h3 id=\"mysql导出所有数据库，会包含mysql本身的库\"><a href=\"#mysql导出所有数据库，会包含mysql本身的库\" class=\"headerlink\" title=\"mysql导出所有数据库，会包含mysql本身的库\"></a>mysql导出所有数据库，会包含mysql本身的库</h3><p>mysqldump -u root -p –all-databases &gt; alldb.sql</p>\n<h3 id=\"导入：\"><a href=\"#导入：\" class=\"headerlink\" title=\"导入：\"></a>导入：</h3><p>mysql -u root -p &lt; alldb.sql</p>\n<h3 id=\"导出指定的库\"><a href=\"#导出指定的库\" class=\"headerlink\" title=\"导出指定的库\"></a>导出指定的库</h3><p>mysqldump -u root -p –databases 数据库1 数据库2 | gzip &gt; alldb.sql.gz</p>\n<h3 id=\"导入指定的\"><a href=\"#导入指定的\" class=\"headerlink\" title=\"导入指定的\"></a>导入指定的</h3><p>gunzip &lt; myfile.sql.gz | mysql -u root -p </p>\n<h3 id=\"导出某张表的数据\"><a href=\"#导出某张表的数据\" class=\"headerlink\" title=\"导出某张表的数据\"></a>导出某张表的数据</h3><p>mysqldump [options] db_name [table_name……]</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"mysql导出所有数据库，会包含mysql本身的库\"><a href=\"#mysql导出所有数据库，会包含mysql本身的库\" class=\"headerlink\" title=\"mysql导出所有数据库，会包含mysql本身的库\"></a>mysql导出所有数据库，会包含mysql本身的库</h3><p>mysqldump -u root -p –all-databases &gt; alldb.sql</p>\n<h3 id=\"导入：\"><a href=\"#导入：\" class=\"headerlink\" title=\"导入：\"></a>导入：</h3><p>mysql -u root -p &lt; alldb.sql</p>\n<h3 id=\"导出指定的库\"><a href=\"#导出指定的库\" class=\"headerlink\" title=\"导出指定的库\"></a>导出指定的库</h3><p>mysqldump -u root -p –databases 数据库1 数据库2 | gzip &gt; alldb.sql.gz</p>\n<h3 id=\"导入指定的\"><a href=\"#导入指定的\" class=\"headerlink\" title=\"导入指定的\"></a>导入指定的</h3><p>gunzip &lt; myfile.sql.gz | mysql -u root -p </p>\n<h3 id=\"导出某张表的数据\"><a href=\"#导出某张表的数据\" class=\"headerlink\" title=\"导出某张表的数据\"></a>导出某张表的数据</h3><p>mysqldump [options] db_name [table_name……]</p>\n"},{"title":"单向散列函数","date":"2019-03-29T05:57:23.000Z","_content":"\n### 单向散列函数的说明\n1. 单向散列函数也称为消息摘要函数, 哈希函数 或者 杂凑函数  \n2. 单向散列函数输出的散列值又称为消息摘要 或者 指纹\n\n### 单向散列函数的特点\n\n1. 加密后密文的长度是定长的(即对任意长度的消息三列,得到的散列值是定长的)\n2. 散列计算速度快,非常高效\n3. 如果明文不一样，那么散列后的结果一定不一样\n4. 如果明文一样，那么加密后的密文一定一样（对相同数据加密，加密后的密文一样）\n5. 所有的加密算法是公开的\n6. 具备单向性,不可以逆推反算\n\n### 单项散列函数的经典算法\n1. MD4 \n2. MD5\n3. SHA1\n4. SHA256\n5. SHA512  \n\nMD5和SHA256是非常常用的两种单向散列函数，虽然MD5在2005年已经被中国密码学家王小云攻破，但是也还是在被大规模使用，现在比较常用的是SHA256算法，安全性暂时未有被破解。在BITS系统中，所有的索引都是通过sha256进行加密，即便知道了索引，在不知道原文的情况下，对知道者来说，也只是是一串无意义的字符串。\n### 单向散列函数的常见应用场景\n1. 数据库中保存用户密码\n比如前段时间频频爆出一些公司的数据库被爆，用户的账户密码以明文存在，大量资料流出这样的做法是极其不负责和危险的。\n最好的方法就是将用户的密码通过单向散列函数输出到数据库，每次登录时对比散列值即可。由于单向散列函数的不可逆性，就算数据库被盗取，也没有办法得到用户的信息。\n（某些自称破解单向散列函数的网站使用的方法其实是低级的穷举法，保存大量常用明文的散列值，这样做是很愚蠢的。有很多方法可以应对，比如一种叫做“加盐”的常用方法，将用户的信息后面统一加上诸如$%*^&这样的字符，然后计算散列值存入数据库中，或者可以计算散列值的散列值，这样可以保证绝对的安全性。）\n\n2. 防止文件篡改\n目前大部分提供下载服务的网站都有提供文件的SHA256值，这是因为单向散列函数具备防篡改的效果，若是下载的文件的SHA256和网站提供的值不符，则可能此文件已经遭到了修改，可能含有病毒或者是盗版等等。。。接下来的代码中我们也会来实现计算文件的SHA256值。\n\n3. 数字签名\n在进行数字签名时也会使用单向散列函数。\n数字签名是现实社会中的签名和盖章这样行为在数字世界中的实现。数字签名的处理过程非常耗时，因此一般不会对整个消息内容直接使用数字签名，而是先通过单向散列函数计算出消息的散列值，然后再对这个散列值使用私钥加密，得到的就是数字签名。\n\n4. 伪随机数生成器\n使用单向散列函数可以构造伪随机数生成器。\n密码技术中所使用的随机数需要具备“事实上不可能根据过去的随机数列预测未来的随机数列”这样的性质。为了保证不可预测性，可以利用单向散列函数的单向性。\n\n5. 秒传\n很多诸如某云盘，某网盘这样的公司利用单向散列函数的特性实现秒传的效果。\n单向散列函数就像文件的指纹一样，当用户上传文件时，首先计算一下此文件的单向散列值，将此值在数据库中进行查找，若存在相同值，证明此用户上传的文件已经存在相同的，所以无需上传，共享即可。如此可大幅降低服务器负载，大幅缩减存储空间，实现去重的效果。\n\n\n### 参考资料\n什么是散列函数：https://web.archive.org/web/20061206022506/http://www.rsasecurity.com/rsalabs/node.asp?id=2176\n散列函数：https://zh.wikipedia.org/wiki/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B8\nsha家族：https://zh.wikipedia.org/wiki/SHA%E5%AE%B6%E6%97%8F\n彩虹表：https://zh.wikipedia.org/wiki/%E5%BD%A9%E8%99%B9%E8%A1%A8\n\n","source":"_posts/单向散列函数.md","raw":"---\ntitle: 单向散列函数\ndate: 2019-03-29 13:57:23\ncategories: \n\t- 密码学\ntags:\n\t- hash\n---\n\n### 单向散列函数的说明\n1. 单向散列函数也称为消息摘要函数, 哈希函数 或者 杂凑函数  \n2. 单向散列函数输出的散列值又称为消息摘要 或者 指纹\n\n### 单向散列函数的特点\n\n1. 加密后密文的长度是定长的(即对任意长度的消息三列,得到的散列值是定长的)\n2. 散列计算速度快,非常高效\n3. 如果明文不一样，那么散列后的结果一定不一样\n4. 如果明文一样，那么加密后的密文一定一样（对相同数据加密，加密后的密文一样）\n5. 所有的加密算法是公开的\n6. 具备单向性,不可以逆推反算\n\n### 单项散列函数的经典算法\n1. MD4 \n2. MD5\n3. SHA1\n4. SHA256\n5. SHA512  \n\nMD5和SHA256是非常常用的两种单向散列函数，虽然MD5在2005年已经被中国密码学家王小云攻破，但是也还是在被大规模使用，现在比较常用的是SHA256算法，安全性暂时未有被破解。在BITS系统中，所有的索引都是通过sha256进行加密，即便知道了索引，在不知道原文的情况下，对知道者来说，也只是是一串无意义的字符串。\n### 单向散列函数的常见应用场景\n1. 数据库中保存用户密码\n比如前段时间频频爆出一些公司的数据库被爆，用户的账户密码以明文存在，大量资料流出这样的做法是极其不负责和危险的。\n最好的方法就是将用户的密码通过单向散列函数输出到数据库，每次登录时对比散列值即可。由于单向散列函数的不可逆性，就算数据库被盗取，也没有办法得到用户的信息。\n（某些自称破解单向散列函数的网站使用的方法其实是低级的穷举法，保存大量常用明文的散列值，这样做是很愚蠢的。有很多方法可以应对，比如一种叫做“加盐”的常用方法，将用户的信息后面统一加上诸如$%*^&这样的字符，然后计算散列值存入数据库中，或者可以计算散列值的散列值，这样可以保证绝对的安全性。）\n\n2. 防止文件篡改\n目前大部分提供下载服务的网站都有提供文件的SHA256值，这是因为单向散列函数具备防篡改的效果，若是下载的文件的SHA256和网站提供的值不符，则可能此文件已经遭到了修改，可能含有病毒或者是盗版等等。。。接下来的代码中我们也会来实现计算文件的SHA256值。\n\n3. 数字签名\n在进行数字签名时也会使用单向散列函数。\n数字签名是现实社会中的签名和盖章这样行为在数字世界中的实现。数字签名的处理过程非常耗时，因此一般不会对整个消息内容直接使用数字签名，而是先通过单向散列函数计算出消息的散列值，然后再对这个散列值使用私钥加密，得到的就是数字签名。\n\n4. 伪随机数生成器\n使用单向散列函数可以构造伪随机数生成器。\n密码技术中所使用的随机数需要具备“事实上不可能根据过去的随机数列预测未来的随机数列”这样的性质。为了保证不可预测性，可以利用单向散列函数的单向性。\n\n5. 秒传\n很多诸如某云盘，某网盘这样的公司利用单向散列函数的特性实现秒传的效果。\n单向散列函数就像文件的指纹一样，当用户上传文件时，首先计算一下此文件的单向散列值，将此值在数据库中进行查找，若存在相同值，证明此用户上传的文件已经存在相同的，所以无需上传，共享即可。如此可大幅降低服务器负载，大幅缩减存储空间，实现去重的效果。\n\n\n### 参考资料\n什么是散列函数：https://web.archive.org/web/20061206022506/http://www.rsasecurity.com/rsalabs/node.asp?id=2176\n散列函数：https://zh.wikipedia.org/wiki/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B8\nsha家族：https://zh.wikipedia.org/wiki/SHA%E5%AE%B6%E6%97%8F\n彩虹表：https://zh.wikipedia.org/wiki/%E5%BD%A9%E8%99%B9%E8%A1%A8\n\n","slug":"单向散列函数","published":1,"updated":"2019-03-29T05:58:08.659Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0eye001q1fihzcx17w8j","content":"<h3 id=\"单向散列函数的说明\"><a href=\"#单向散列函数的说明\" class=\"headerlink\" title=\"单向散列函数的说明\"></a>单向散列函数的说明</h3><ol>\n<li>单向散列函数也称为消息摘要函数, 哈希函数 或者 杂凑函数  </li>\n<li>单向散列函数输出的散列值又称为消息摘要 或者 指纹</li>\n</ol>\n<h3 id=\"单向散列函数的特点\"><a href=\"#单向散列函数的特点\" class=\"headerlink\" title=\"单向散列函数的特点\"></a>单向散列函数的特点</h3><ol>\n<li>加密后密文的长度是定长的(即对任意长度的消息三列,得到的散列值是定长的)</li>\n<li>散列计算速度快,非常高效</li>\n<li>如果明文不一样，那么散列后的结果一定不一样</li>\n<li>如果明文一样，那么加密后的密文一定一样（对相同数据加密，加密后的密文一样）</li>\n<li>所有的加密算法是公开的</li>\n<li>具备单向性,不可以逆推反算</li>\n</ol>\n<h3 id=\"单项散列函数的经典算法\"><a href=\"#单项散列函数的经典算法\" class=\"headerlink\" title=\"单项散列函数的经典算法\"></a>单项散列函数的经典算法</h3><ol>\n<li>MD4 </li>\n<li>MD5</li>\n<li>SHA1</li>\n<li>SHA256</li>\n<li>SHA512  </li>\n</ol>\n<p>MD5和SHA256是非常常用的两种单向散列函数，虽然MD5在2005年已经被中国密码学家王小云攻破，但是也还是在被大规模使用，现在比较常用的是SHA256算法，安全性暂时未有被破解。在BITS系统中，所有的索引都是通过sha256进行加密，即便知道了索引，在不知道原文的情况下，对知道者来说，也只是是一串无意义的字符串。</p>\n<h3 id=\"单向散列函数的常见应用场景\"><a href=\"#单向散列函数的常见应用场景\" class=\"headerlink\" title=\"单向散列函数的常见应用场景\"></a>单向散列函数的常见应用场景</h3><ol>\n<li><p>数据库中保存用户密码<br>比如前段时间频频爆出一些公司的数据库被爆，用户的账户密码以明文存在，大量资料流出这样的做法是极其不负责和危险的。<br>最好的方法就是将用户的密码通过单向散列函数输出到数据库，每次登录时对比散列值即可。由于单向散列函数的不可逆性，就算数据库被盗取，也没有办法得到用户的信息。<br>（某些自称破解单向散列函数的网站使用的方法其实是低级的穷举法，保存大量常用明文的散列值，这样做是很愚蠢的。有很多方法可以应对，比如一种叫做“加盐”的常用方法，将用户的信息后面统一加上诸如$%*^&amp;这样的字符，然后计算散列值存入数据库中，或者可以计算散列值的散列值，这样可以保证绝对的安全性。）</p>\n</li>\n<li><p>防止文件篡改<br>目前大部分提供下载服务的网站都有提供文件的SHA256值，这是因为单向散列函数具备防篡改的效果，若是下载的文件的SHA256和网站提供的值不符，则可能此文件已经遭到了修改，可能含有病毒或者是盗版等等。。。接下来的代码中我们也会来实现计算文件的SHA256值。</p>\n</li>\n<li><p>数字签名<br>在进行数字签名时也会使用单向散列函数。<br>数字签名是现实社会中的签名和盖章这样行为在数字世界中的实现。数字签名的处理过程非常耗时，因此一般不会对整个消息内容直接使用数字签名，而是先通过单向散列函数计算出消息的散列值，然后再对这个散列值使用私钥加密，得到的就是数字签名。</p>\n</li>\n<li><p>伪随机数生成器<br>使用单向散列函数可以构造伪随机数生成器。<br>密码技术中所使用的随机数需要具备“事实上不可能根据过去的随机数列预测未来的随机数列”这样的性质。为了保证不可预测性，可以利用单向散列函数的单向性。</p>\n</li>\n<li><p>秒传<br>很多诸如某云盘，某网盘这样的公司利用单向散列函数的特性实现秒传的效果。<br>单向散列函数就像文件的指纹一样，当用户上传文件时，首先计算一下此文件的单向散列值，将此值在数据库中进行查找，若存在相同值，证明此用户上传的文件已经存在相同的，所以无需上传，共享即可。如此可大幅降低服务器负载，大幅缩减存储空间，实现去重的效果。</p>\n</li>\n</ol>\n<h3 id=\"参考资料\"><a href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"></a>参考资料</h3><p>什么是散列函数：<a href=\"https://web.archive.org/web/20061206022506/http://www.rsasecurity.com/rsalabs/node.asp?id=2176\" target=\"_blank\" rel=\"external\">https://web.archive.org/web/20061206022506/http://www.rsasecurity.com/rsalabs/node.asp?id=2176</a><br>散列函数：<a href=\"https://zh.wikipedia.org/wiki/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B8\" target=\"_blank\" rel=\"external\">https://zh.wikipedia.org/wiki/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B8</a><br>sha家族：<a href=\"https://zh.wikipedia.org/wiki/SHA%E5%AE%B6%E6%97%8F\" target=\"_blank\" rel=\"external\">https://zh.wikipedia.org/wiki/SHA%E5%AE%B6%E6%97%8F</a><br>彩虹表：<a href=\"https://zh.wikipedia.org/wiki/%E5%BD%A9%E8%99%B9%E8%A1%A8\" target=\"_blank\" rel=\"external\">https://zh.wikipedia.org/wiki/%E5%BD%A9%E8%99%B9%E8%A1%A8</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"单向散列函数的说明\"><a href=\"#单向散列函数的说明\" class=\"headerlink\" title=\"单向散列函数的说明\"></a>单向散列函数的说明</h3><ol>\n<li>单向散列函数也称为消息摘要函数, 哈希函数 或者 杂凑函数  </li>\n<li>单向散列函数输出的散列值又称为消息摘要 或者 指纹</li>\n</ol>\n<h3 id=\"单向散列函数的特点\"><a href=\"#单向散列函数的特点\" class=\"headerlink\" title=\"单向散列函数的特点\"></a>单向散列函数的特点</h3><ol>\n<li>加密后密文的长度是定长的(即对任意长度的消息三列,得到的散列值是定长的)</li>\n<li>散列计算速度快,非常高效</li>\n<li>如果明文不一样，那么散列后的结果一定不一样</li>\n<li>如果明文一样，那么加密后的密文一定一样（对相同数据加密，加密后的密文一样）</li>\n<li>所有的加密算法是公开的</li>\n<li>具备单向性,不可以逆推反算</li>\n</ol>\n<h3 id=\"单项散列函数的经典算法\"><a href=\"#单项散列函数的经典算法\" class=\"headerlink\" title=\"单项散列函数的经典算法\"></a>单项散列函数的经典算法</h3><ol>\n<li>MD4 </li>\n<li>MD5</li>\n<li>SHA1</li>\n<li>SHA256</li>\n<li>SHA512  </li>\n</ol>\n<p>MD5和SHA256是非常常用的两种单向散列函数，虽然MD5在2005年已经被中国密码学家王小云攻破，但是也还是在被大规模使用，现在比较常用的是SHA256算法，安全性暂时未有被破解。在BITS系统中，所有的索引都是通过sha256进行加密，即便知道了索引，在不知道原文的情况下，对知道者来说，也只是是一串无意义的字符串。</p>\n<h3 id=\"单向散列函数的常见应用场景\"><a href=\"#单向散列函数的常见应用场景\" class=\"headerlink\" title=\"单向散列函数的常见应用场景\"></a>单向散列函数的常见应用场景</h3><ol>\n<li><p>数据库中保存用户密码<br>比如前段时间频频爆出一些公司的数据库被爆，用户的账户密码以明文存在，大量资料流出这样的做法是极其不负责和危险的。<br>最好的方法就是将用户的密码通过单向散列函数输出到数据库，每次登录时对比散列值即可。由于单向散列函数的不可逆性，就算数据库被盗取，也没有办法得到用户的信息。<br>（某些自称破解单向散列函数的网站使用的方法其实是低级的穷举法，保存大量常用明文的散列值，这样做是很愚蠢的。有很多方法可以应对，比如一种叫做“加盐”的常用方法，将用户的信息后面统一加上诸如$%*^&amp;这样的字符，然后计算散列值存入数据库中，或者可以计算散列值的散列值，这样可以保证绝对的安全性。）</p>\n</li>\n<li><p>防止文件篡改<br>目前大部分提供下载服务的网站都有提供文件的SHA256值，这是因为单向散列函数具备防篡改的效果，若是下载的文件的SHA256和网站提供的值不符，则可能此文件已经遭到了修改，可能含有病毒或者是盗版等等。。。接下来的代码中我们也会来实现计算文件的SHA256值。</p>\n</li>\n<li><p>数字签名<br>在进行数字签名时也会使用单向散列函数。<br>数字签名是现实社会中的签名和盖章这样行为在数字世界中的实现。数字签名的处理过程非常耗时，因此一般不会对整个消息内容直接使用数字签名，而是先通过单向散列函数计算出消息的散列值，然后再对这个散列值使用私钥加密，得到的就是数字签名。</p>\n</li>\n<li><p>伪随机数生成器<br>使用单向散列函数可以构造伪随机数生成器。<br>密码技术中所使用的随机数需要具备“事实上不可能根据过去的随机数列预测未来的随机数列”这样的性质。为了保证不可预测性，可以利用单向散列函数的单向性。</p>\n</li>\n<li><p>秒传<br>很多诸如某云盘，某网盘这样的公司利用单向散列函数的特性实现秒传的效果。<br>单向散列函数就像文件的指纹一样，当用户上传文件时，首先计算一下此文件的单向散列值，将此值在数据库中进行查找，若存在相同值，证明此用户上传的文件已经存在相同的，所以无需上传，共享即可。如此可大幅降低服务器负载，大幅缩减存储空间，实现去重的效果。</p>\n</li>\n</ol>\n<h3 id=\"参考资料\"><a href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"></a>参考资料</h3><p>什么是散列函数：<a href=\"https://web.archive.org/web/20061206022506/http://www.rsasecurity.com/rsalabs/node.asp?id=2176\" target=\"_blank\" rel=\"external\">https://web.archive.org/web/20061206022506/http://www.rsasecurity.com/rsalabs/node.asp?id=2176</a><br>散列函数：<a href=\"https://zh.wikipedia.org/wiki/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B8\" target=\"_blank\" rel=\"external\">https://zh.wikipedia.org/wiki/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B8</a><br>sha家族：<a href=\"https://zh.wikipedia.org/wiki/SHA%E5%AE%B6%E6%97%8F\" target=\"_blank\" rel=\"external\">https://zh.wikipedia.org/wiki/SHA%E5%AE%B6%E6%97%8F</a><br>彩虹表：<a href=\"https://zh.wikipedia.org/wiki/%E5%BD%A9%E8%99%B9%E8%A1%A8\" target=\"_blank\" rel=\"external\">https://zh.wikipedia.org/wiki/%E5%BD%A9%E8%99%B9%E8%A1%A8</a></p>\n"},{"title":"在现实编程中使用fluent风格","date":"2017-05-01T05:39:23.000Z","_content":"\n\n## 在现实编程中使用fluent风格\n\n### 需求：\n\t根据相应的条件查找对应的imsi,其中条件有多个满足即返回结果，如果不满足对对数据进行过滤，交由后续处理。\n\t条件:\n\t1.电话号码匹配，返回匹配结果，即匹配的imsi\n\t2.根据电话号码生成imsi前缀，匹配imsi，如果多条，需进行后续处理\n\t3.根据银行，卡号匹配imsi,如果多条，需进行后续处理\n\t4.根据地区，匹配imsi,如果多条，需进行后续处理\n\t5.根据姓名的摘要，匹配imsi，如果多条，即认为数据没有命中\n### 设计：\n在前面的条件中，所有的步骤都能结束整个查找流程，在上述的查找流程中，我引入了责任链的模式，该模式的类图为：  \n![](/images/6rM7Vv.png)  \n职责链模式：使多个对象都有机会处理请求，将多个对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理他为止，使用该模式，可对查询条件进行组合，或者添加新的查询条件，而不影响别已有的结构。\n### 使用：\n```java\npublic IMatcher buildMatchChain(String phone,String name,String areaCode,String bank,String card) throws Exception{\n\t\tbank = BankCache.getInstance().get(bank);\n\t\tIMatcher imsiUserNameMatch = new ImsiUserNameMatch(name);  //匹配姓名\n\t\t\n\t\tIMatcher imsiAreaMatch = new ImsiAreaMatch(areaCode);  //匹配地区\n\t\timsiAreaMatch.setNext(imsiUserNameMatch);\n//\t\t\n\t\tIMatcher preFixphoneImsiCardMatch = new PrefixPhoneImsiCardMatch(phone,bank, card); //匹配银行卡号\n\t\tpreFixphoneImsiCardMatch.setNext(imsiAreaMatch);\n\t\t\n\t\tIMatcher phoneImsiMatch = new PhoneImsiMatch(phone);//匹配手机号和IMSI\n\t\tphoneImsiMatch.setNext(preFixphoneImsiCardMatch);\n\t\treturn phoneImsiMatch;\n\t}\n```\n#### 使用fluent风格：\n```java\n\tpublic IMatcher buildMatchChain2(String phone,String name,String areaCode,String bank,String card) throws Exception{\n\t\tbank = BankCache.getInstance().get(bank);\n\t\treturn new PhoneImsiMatch(phone)\n\t\t\t\t  .setNext(new PrefixPhoneImsiCardMatch(phone,bank, card))\n\t\t\t\t  .setNext(new ImsiAreaMatch(areaCode))\n\t\t\t\t  .setNext(new ImsiUserNameMatch(name));\n\t}\n```\n### fluent风格在知名开源框架中的使用：\n1.在google guava中，各种api接口都是采用该风格  \n2.在netty api中，也是采用该种风格  \n3.在apache curator,也是采用风格  \n","source":"_posts/在现实编程中使用fluent模式.md","raw":"---\ntitle: 在现实编程中使用fluent风格\ndate: 2017-05-01 13:39:23\ncategories: \n\t- 设计模式\ntags:\n\t- java\n---\n\n\n## 在现实编程中使用fluent风格\n\n### 需求：\n\t根据相应的条件查找对应的imsi,其中条件有多个满足即返回结果，如果不满足对对数据进行过滤，交由后续处理。\n\t条件:\n\t1.电话号码匹配，返回匹配结果，即匹配的imsi\n\t2.根据电话号码生成imsi前缀，匹配imsi，如果多条，需进行后续处理\n\t3.根据银行，卡号匹配imsi,如果多条，需进行后续处理\n\t4.根据地区，匹配imsi,如果多条，需进行后续处理\n\t5.根据姓名的摘要，匹配imsi，如果多条，即认为数据没有命中\n### 设计：\n在前面的条件中，所有的步骤都能结束整个查找流程，在上述的查找流程中，我引入了责任链的模式，该模式的类图为：  \n![](/images/6rM7Vv.png)  \n职责链模式：使多个对象都有机会处理请求，将多个对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理他为止，使用该模式，可对查询条件进行组合，或者添加新的查询条件，而不影响别已有的结构。\n### 使用：\n```java\npublic IMatcher buildMatchChain(String phone,String name,String areaCode,String bank,String card) throws Exception{\n\t\tbank = BankCache.getInstance().get(bank);\n\t\tIMatcher imsiUserNameMatch = new ImsiUserNameMatch(name);  //匹配姓名\n\t\t\n\t\tIMatcher imsiAreaMatch = new ImsiAreaMatch(areaCode);  //匹配地区\n\t\timsiAreaMatch.setNext(imsiUserNameMatch);\n//\t\t\n\t\tIMatcher preFixphoneImsiCardMatch = new PrefixPhoneImsiCardMatch(phone,bank, card); //匹配银行卡号\n\t\tpreFixphoneImsiCardMatch.setNext(imsiAreaMatch);\n\t\t\n\t\tIMatcher phoneImsiMatch = new PhoneImsiMatch(phone);//匹配手机号和IMSI\n\t\tphoneImsiMatch.setNext(preFixphoneImsiCardMatch);\n\t\treturn phoneImsiMatch;\n\t}\n```\n#### 使用fluent风格：\n```java\n\tpublic IMatcher buildMatchChain2(String phone,String name,String areaCode,String bank,String card) throws Exception{\n\t\tbank = BankCache.getInstance().get(bank);\n\t\treturn new PhoneImsiMatch(phone)\n\t\t\t\t  .setNext(new PrefixPhoneImsiCardMatch(phone,bank, card))\n\t\t\t\t  .setNext(new ImsiAreaMatch(areaCode))\n\t\t\t\t  .setNext(new ImsiUserNameMatch(name));\n\t}\n```\n### fluent风格在知名开源框架中的使用：\n1.在google guava中，各种api接口都是采用该风格  \n2.在netty api中，也是采用该种风格  \n3.在apache curator,也是采用风格  \n","slug":"在现实编程中使用fluent模式","published":1,"updated":"2017-05-20T10:06:44.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0eyf001u1fih2myj85os","content":"<h2 id=\"在现实编程中使用fluent风格\"><a href=\"#在现实编程中使用fluent风格\" class=\"headerlink\" title=\"在现实编程中使用fluent风格\"></a>在现实编程中使用fluent风格</h2><h3 id=\"需求：\"><a href=\"#需求：\" class=\"headerlink\" title=\"需求：\"></a>需求：</h3><pre><code>根据相应的条件查找对应的imsi,其中条件有多个满足即返回结果，如果不满足对对数据进行过滤，交由后续处理。\n条件:\n1.电话号码匹配，返回匹配结果，即匹配的imsi\n2.根据电话号码生成imsi前缀，匹配imsi，如果多条，需进行后续处理\n3.根据银行，卡号匹配imsi,如果多条，需进行后续处理\n4.根据地区，匹配imsi,如果多条，需进行后续处理\n5.根据姓名的摘要，匹配imsi，如果多条，即认为数据没有命中\n</code></pre><h3 id=\"设计：\"><a href=\"#设计：\" class=\"headerlink\" title=\"设计：\"></a>设计：</h3><p>在前面的条件中，所有的步骤都能结束整个查找流程，在上述的查找流程中，我引入了责任链的模式，该模式的类图为：<br><img src=\"/images/6rM7Vv.png\" alt=\"\"><br>职责链模式：使多个对象都有机会处理请求，将多个对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理他为止，使用该模式，可对查询条件进行组合，或者添加新的查询条件，而不影响别已有的结构。</p>\n<h3 id=\"使用：\"><a href=\"#使用：\" class=\"headerlink\" title=\"使用：\"></a>使用：</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> IMatcher <span class=\"title\">buildMatchChain</span><span class=\"params\">(String phone,String name,String areaCode,String bank,String card)</span> <span class=\"keyword\">throws</span> Exception</span>&#123;</div><div class=\"line\">\t\tbank = BankCache.getInstance().get(bank);</div><div class=\"line\">\t\tIMatcher imsiUserNameMatch = <span class=\"keyword\">new</span> ImsiUserNameMatch(name);  <span class=\"comment\">//匹配姓名</span></div><div class=\"line\">\t\t</div><div class=\"line\">\t\tIMatcher imsiAreaMatch = <span class=\"keyword\">new</span> ImsiAreaMatch(areaCode);  <span class=\"comment\">//匹配地区</span></div><div class=\"line\">\t\timsiAreaMatch.setNext(imsiUserNameMatch);</div><div class=\"line\"><span class=\"comment\">//\t\t</span></div><div class=\"line\">\t\tIMatcher preFixphoneImsiCardMatch = <span class=\"keyword\">new</span> PrefixPhoneImsiCardMatch(phone,bank, card); <span class=\"comment\">//匹配银行卡号</span></div><div class=\"line\">\t\tpreFixphoneImsiCardMatch.setNext(imsiAreaMatch);</div><div class=\"line\">\t\t</div><div class=\"line\">\t\tIMatcher phoneImsiMatch = <span class=\"keyword\">new</span> PhoneImsiMatch(phone);<span class=\"comment\">//匹配手机号和IMSI</span></div><div class=\"line\">\t\tphoneImsiMatch.setNext(preFixphoneImsiCardMatch);</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> phoneImsiMatch;</div><div class=\"line\">\t&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"使用fluent风格：\"><a href=\"#使用fluent风格：\" class=\"headerlink\" title=\"使用fluent风格：\"></a>使用fluent风格：</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> IMatcher <span class=\"title\">buildMatchChain2</span><span class=\"params\">(String phone,String name,String areaCode,String bank,String card)</span> <span class=\"keyword\">throws</span> Exception</span>&#123;</div><div class=\"line\">\tbank = BankCache.getInstance().get(bank);</div><div class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">new</span> PhoneImsiMatch(phone)</div><div class=\"line\">\t\t\t  .setNext(<span class=\"keyword\">new</span> PrefixPhoneImsiCardMatch(phone,bank, card))</div><div class=\"line\">\t\t\t  .setNext(<span class=\"keyword\">new</span> ImsiAreaMatch(areaCode))</div><div class=\"line\">\t\t\t  .setNext(<span class=\"keyword\">new</span> ImsiUserNameMatch(name));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"fluent风格在知名开源框架中的使用：\"><a href=\"#fluent风格在知名开源框架中的使用：\" class=\"headerlink\" title=\"fluent风格在知名开源框架中的使用：\"></a>fluent风格在知名开源框架中的使用：</h3><p>1.在google guava中，各种api接口都是采用该风格<br>2.在netty api中，也是采用该种风格<br>3.在apache curator,也是采用风格  </p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"在现实编程中使用fluent风格\"><a href=\"#在现实编程中使用fluent风格\" class=\"headerlink\" title=\"在现实编程中使用fluent风格\"></a>在现实编程中使用fluent风格</h2><h3 id=\"需求：\"><a href=\"#需求：\" class=\"headerlink\" title=\"需求：\"></a>需求：</h3><pre><code>根据相应的条件查找对应的imsi,其中条件有多个满足即返回结果，如果不满足对对数据进行过滤，交由后续处理。\n条件:\n1.电话号码匹配，返回匹配结果，即匹配的imsi\n2.根据电话号码生成imsi前缀，匹配imsi，如果多条，需进行后续处理\n3.根据银行，卡号匹配imsi,如果多条，需进行后续处理\n4.根据地区，匹配imsi,如果多条，需进行后续处理\n5.根据姓名的摘要，匹配imsi，如果多条，即认为数据没有命中\n</code></pre><h3 id=\"设计：\"><a href=\"#设计：\" class=\"headerlink\" title=\"设计：\"></a>设计：</h3><p>在前面的条件中，所有的步骤都能结束整个查找流程，在上述的查找流程中，我引入了责任链的模式，该模式的类图为：<br><img src=\"/images/6rM7Vv.png\" alt=\"\"><br>职责链模式：使多个对象都有机会处理请求，将多个对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理他为止，使用该模式，可对查询条件进行组合，或者添加新的查询条件，而不影响别已有的结构。</p>\n<h3 id=\"使用：\"><a href=\"#使用：\" class=\"headerlink\" title=\"使用：\"></a>使用：</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> IMatcher <span class=\"title\">buildMatchChain</span><span class=\"params\">(String phone,String name,String areaCode,String bank,String card)</span> <span class=\"keyword\">throws</span> Exception</span>&#123;</div><div class=\"line\">\t\tbank = BankCache.getInstance().get(bank);</div><div class=\"line\">\t\tIMatcher imsiUserNameMatch = <span class=\"keyword\">new</span> ImsiUserNameMatch(name);  <span class=\"comment\">//匹配姓名</span></div><div class=\"line\">\t\t</div><div class=\"line\">\t\tIMatcher imsiAreaMatch = <span class=\"keyword\">new</span> ImsiAreaMatch(areaCode);  <span class=\"comment\">//匹配地区</span></div><div class=\"line\">\t\timsiAreaMatch.setNext(imsiUserNameMatch);</div><div class=\"line\"><span class=\"comment\">//\t\t</span></div><div class=\"line\">\t\tIMatcher preFixphoneImsiCardMatch = <span class=\"keyword\">new</span> PrefixPhoneImsiCardMatch(phone,bank, card); <span class=\"comment\">//匹配银行卡号</span></div><div class=\"line\">\t\tpreFixphoneImsiCardMatch.setNext(imsiAreaMatch);</div><div class=\"line\">\t\t</div><div class=\"line\">\t\tIMatcher phoneImsiMatch = <span class=\"keyword\">new</span> PhoneImsiMatch(phone);<span class=\"comment\">//匹配手机号和IMSI</span></div><div class=\"line\">\t\tphoneImsiMatch.setNext(preFixphoneImsiCardMatch);</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> phoneImsiMatch;</div><div class=\"line\">\t&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"使用fluent风格：\"><a href=\"#使用fluent风格：\" class=\"headerlink\" title=\"使用fluent风格：\"></a>使用fluent风格：</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> IMatcher <span class=\"title\">buildMatchChain2</span><span class=\"params\">(String phone,String name,String areaCode,String bank,String card)</span> <span class=\"keyword\">throws</span> Exception</span>&#123;</div><div class=\"line\">\tbank = BankCache.getInstance().get(bank);</div><div class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">new</span> PhoneImsiMatch(phone)</div><div class=\"line\">\t\t\t  .setNext(<span class=\"keyword\">new</span> PrefixPhoneImsiCardMatch(phone,bank, card))</div><div class=\"line\">\t\t\t  .setNext(<span class=\"keyword\">new</span> ImsiAreaMatch(areaCode))</div><div class=\"line\">\t\t\t  .setNext(<span class=\"keyword\">new</span> ImsiUserNameMatch(name));</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"fluent风格在知名开源框架中的使用：\"><a href=\"#fluent风格在知名开源框架中的使用：\" class=\"headerlink\" title=\"fluent风格在知名开源框架中的使用：\"></a>fluent风格在知名开源框架中的使用：</h3><p>1.在google guava中，各种api接口都是采用该风格<br>2.在netty api中，也是采用该种风格<br>3.在apache curator,也是采用风格  </p>\n"},{"title":"编写第一个hyperledger区块链应用.md","date":"2019-08-30T04:57:23.000Z","_content":"\n\n### 使用GO语言开发区块链应用\n\n```\npackage query\n\n//引入hypeledger 相关包\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n\t\"github.com/hyperledger/fabric/common/flogging\"\n\t\"github.com/hyperledger/fabric/core/chaincode/shim\"\n\t\"github.com/hyperledger/fabric/protos/peer\"\n\t\"strconv\"\n)\nvar chaincodeLogger = flogging.MustGetLogger(\"QueryChaincode\")\n\n// 设置存证的索引的前缀，用来隔离别的应用的数据\nconst Query_Prefix = \"Query_\"\n\n//定义存证链，需要进行存证的数据\ntype QueryData struct {\n\tQueryId  int `json:\"queryId\"`\n\tIndexDigest string `json:\"indexDigest\"`\n\tProvideQueryOrg string  `json:\"provideQueryOrg\"`\n\tOfferOrg string `json:\"offerOrg\"`\n\tQueryTime string `json:\"queryTime\"`\n\tQueryType int  `json:\"queryType\"`\n\tQueryResult int `json:\"queryResult\"`\n\tQuerySerial string `json:\"querySerial\"`\n\tHit int `json:\"hit\"`\n}\n\n\ntype QueryChainCode struct {\n\n}\n\n// 应用返回的数据结构\ntype ChaincodeRet struct {\n\tCode int `json:code`\n\tMessage  string `json:message`\n\tData interface{} `json:data`\n}\n\n//进行初始化，改方法实现了Chaincode接口的Init方法\n//GO语言的接口，只要你实现了改接口的方法，就可以认为是该接口的实现类。\n//如果它看起来像鸭子，走起来像鸭子，叫起来像鸭子，它就是鸭子。\n//这也是与JAVA不一样的地方，JAVA必须要关键字来指定实现某个接口\nfunc (a *QueryChainCode) Init(stub shim.ChaincodeStubInterface) peer.Response {\n\treturn shim.Success(nil)\n}\n\n//进行初始化，改方法实现了Chaincode接口的Init方法\nfunc (a *QueryChainCode) Invoke(stub shim.ChaincodeStubInterface) peer.Response {\n\t//获取调用方法的名称和参数\n\tfun,args := stub.GetFunctionAndParameters()\n\tif fun ==\"query\"{\n\t\t//通过key查询数据\n\t\treturn a.getDataById(stub,args[0])\n\t} else if fun == \"put\"{\n\t\tvar data QueryData\n\t\terr := json.Unmarshal([]byte(args[0]), &data)\n\t\tif err != nil{\n\t\t\tfmt.Println(err)\n\t\t\treturn shim.Error(\"保存数据报错\"+err.Error())\n\t\t}\n\t\t//保存数据\n\t\treturn a.putData(stub,data)\n\t}\n\n\treturn shim.Error(\"找不到方法！\")\n}\n\n\n\n\n\nfunc (a *QueryChainCode) getDataById(stub shim.ChaincodeStubInterface,queryId string)peer.Response  {\n\tvar data QueryData\n\t//将ID加上前缀再进行查询\n\tkey := Query_Prefix+queryId\n\tb ,err := stub.GetState(key)\n\tif b == nil{\n\t\treturn shim.Error(\"null\")\n\t}\n\terr = json.Unmarshal(b,&data)\n\tif err !=nil{\n\t\treturn shim.Error(\"null\")\n\t}\n\treturn shim.Success(getRetByte(0,\"\",data))\n}\n\n\n\nfunc (a *QueryChainCode) putData(stub shim.ChaincodeStubInterface,data QueryData) peer.Response{\n\td,err := json.Marshal(data)\n\tif err !=nil {\n\t\treturn shim.Error(\"null\")\n\t}\n\ttxId :=\tstub.GetTxID()\n\t//将ID加上前缀进行保存\n\terr = stub.PutState(Query_Prefix+ strconv.Itoa(data.QueryId),d)\n\tif err != nil{\n\t\treturn shim.Error(\"null\")\n\t}\n\tfmt.Println(stub.GetChannelID())\n\t//将TXID返回給调用方，方便跟业务数据进行对应\n\treturn shim.Success(getRetByte(0,\"\",txId))\n}\n\n\nfunc getRetByte(code int,msg string,data interface{}) []byte {\n\tvar r ChaincodeRet\n\tr.Code = code\n\tr.Message= msg\n\tr.Data = data\n\t//将数据封装成JSON对象返回給调用方\n\tb,err := json.Marshal(r)\n\n\tif err!=nil {\n\t\tfmt.Println(\"marshal Ret failed\"+err.Error())\n\t\treturn nil\n\t}\n\treturn b\n}\n\n\n\n```\n\n\n\n\n\n","source":"_posts/编写第一个hyperledger区块链应用.md","raw":"---\ntitle: 编写第一个hyperledger区块链应用.md\ndate: 2019-08-30 12:57:23\ncategories: \n\t- 区块链\n\t- hyperledger\ntags:\n\t- hyperledger 应用\n---\n\n\n### 使用GO语言开发区块链应用\n\n```\npackage query\n\n//引入hypeledger 相关包\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n\t\"github.com/hyperledger/fabric/common/flogging\"\n\t\"github.com/hyperledger/fabric/core/chaincode/shim\"\n\t\"github.com/hyperledger/fabric/protos/peer\"\n\t\"strconv\"\n)\nvar chaincodeLogger = flogging.MustGetLogger(\"QueryChaincode\")\n\n// 设置存证的索引的前缀，用来隔离别的应用的数据\nconst Query_Prefix = \"Query_\"\n\n//定义存证链，需要进行存证的数据\ntype QueryData struct {\n\tQueryId  int `json:\"queryId\"`\n\tIndexDigest string `json:\"indexDigest\"`\n\tProvideQueryOrg string  `json:\"provideQueryOrg\"`\n\tOfferOrg string `json:\"offerOrg\"`\n\tQueryTime string `json:\"queryTime\"`\n\tQueryType int  `json:\"queryType\"`\n\tQueryResult int `json:\"queryResult\"`\n\tQuerySerial string `json:\"querySerial\"`\n\tHit int `json:\"hit\"`\n}\n\n\ntype QueryChainCode struct {\n\n}\n\n// 应用返回的数据结构\ntype ChaincodeRet struct {\n\tCode int `json:code`\n\tMessage  string `json:message`\n\tData interface{} `json:data`\n}\n\n//进行初始化，改方法实现了Chaincode接口的Init方法\n//GO语言的接口，只要你实现了改接口的方法，就可以认为是该接口的实现类。\n//如果它看起来像鸭子，走起来像鸭子，叫起来像鸭子，它就是鸭子。\n//这也是与JAVA不一样的地方，JAVA必须要关键字来指定实现某个接口\nfunc (a *QueryChainCode) Init(stub shim.ChaincodeStubInterface) peer.Response {\n\treturn shim.Success(nil)\n}\n\n//进行初始化，改方法实现了Chaincode接口的Init方法\nfunc (a *QueryChainCode) Invoke(stub shim.ChaincodeStubInterface) peer.Response {\n\t//获取调用方法的名称和参数\n\tfun,args := stub.GetFunctionAndParameters()\n\tif fun ==\"query\"{\n\t\t//通过key查询数据\n\t\treturn a.getDataById(stub,args[0])\n\t} else if fun == \"put\"{\n\t\tvar data QueryData\n\t\terr := json.Unmarshal([]byte(args[0]), &data)\n\t\tif err != nil{\n\t\t\tfmt.Println(err)\n\t\t\treturn shim.Error(\"保存数据报错\"+err.Error())\n\t\t}\n\t\t//保存数据\n\t\treturn a.putData(stub,data)\n\t}\n\n\treturn shim.Error(\"找不到方法！\")\n}\n\n\n\n\n\nfunc (a *QueryChainCode) getDataById(stub shim.ChaincodeStubInterface,queryId string)peer.Response  {\n\tvar data QueryData\n\t//将ID加上前缀再进行查询\n\tkey := Query_Prefix+queryId\n\tb ,err := stub.GetState(key)\n\tif b == nil{\n\t\treturn shim.Error(\"null\")\n\t}\n\terr = json.Unmarshal(b,&data)\n\tif err !=nil{\n\t\treturn shim.Error(\"null\")\n\t}\n\treturn shim.Success(getRetByte(0,\"\",data))\n}\n\n\n\nfunc (a *QueryChainCode) putData(stub shim.ChaincodeStubInterface,data QueryData) peer.Response{\n\td,err := json.Marshal(data)\n\tif err !=nil {\n\t\treturn shim.Error(\"null\")\n\t}\n\ttxId :=\tstub.GetTxID()\n\t//将ID加上前缀进行保存\n\terr = stub.PutState(Query_Prefix+ strconv.Itoa(data.QueryId),d)\n\tif err != nil{\n\t\treturn shim.Error(\"null\")\n\t}\n\tfmt.Println(stub.GetChannelID())\n\t//将TXID返回給调用方，方便跟业务数据进行对应\n\treturn shim.Success(getRetByte(0,\"\",txId))\n}\n\n\nfunc getRetByte(code int,msg string,data interface{}) []byte {\n\tvar r ChaincodeRet\n\tr.Code = code\n\tr.Message= msg\n\tr.Data = data\n\t//将数据封装成JSON对象返回給调用方\n\tb,err := json.Marshal(r)\n\n\tif err!=nil {\n\t\tfmt.Println(\"marshal Ret failed\"+err.Error())\n\t\treturn nil\n\t}\n\treturn b\n}\n\n\n\n```\n\n\n\n\n\n","slug":"编写第一个hyperledger区块链应用","published":1,"updated":"2019-08-30T07:26:11.640Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0eyi001w1fihnxioj152","content":"<h3 id=\"使用GO语言开发区块链应用\"><a href=\"#使用GO语言开发区块链应用\" class=\"headerlink\" title=\"使用GO语言开发区块链应用\"></a>使用GO语言开发区块链应用</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div></pre></td><td class=\"code\"><pre><div class=\"line\">package query</div><div class=\"line\"></div><div class=\"line\">//引入hypeledger 相关包</div><div class=\"line\">import (</div><div class=\"line\">\t&quot;encoding/json&quot;</div><div class=\"line\">\t&quot;fmt&quot;</div><div class=\"line\">\t&quot;github.com/hyperledger/fabric/common/flogging&quot;</div><div class=\"line\">\t&quot;github.com/hyperledger/fabric/core/chaincode/shim&quot;</div><div class=\"line\">\t&quot;github.com/hyperledger/fabric/protos/peer&quot;</div><div class=\"line\">\t&quot;strconv&quot;</div><div class=\"line\">)</div><div class=\"line\">var chaincodeLogger = flogging.MustGetLogger(&quot;QueryChaincode&quot;)</div><div class=\"line\"></div><div class=\"line\">// 设置存证的索引的前缀，用来隔离别的应用的数据</div><div class=\"line\">const Query_Prefix = &quot;Query_&quot;</div><div class=\"line\"></div><div class=\"line\">//定义存证链，需要进行存证的数据</div><div class=\"line\">type QueryData struct &#123;</div><div class=\"line\">\tQueryId  int `json:&quot;queryId&quot;`</div><div class=\"line\">\tIndexDigest string `json:&quot;indexDigest&quot;`</div><div class=\"line\">\tProvideQueryOrg string  `json:&quot;provideQueryOrg&quot;`</div><div class=\"line\">\tOfferOrg string `json:&quot;offerOrg&quot;`</div><div class=\"line\">\tQueryTime string `json:&quot;queryTime&quot;`</div><div class=\"line\">\tQueryType int  `json:&quot;queryType&quot;`</div><div class=\"line\">\tQueryResult int `json:&quot;queryResult&quot;`</div><div class=\"line\">\tQuerySerial string `json:&quot;querySerial&quot;`</div><div class=\"line\">\tHit int `json:&quot;hit&quot;`</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">type QueryChainCode struct &#123;</div><div class=\"line\"></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">// 应用返回的数据结构</div><div class=\"line\">type ChaincodeRet struct &#123;</div><div class=\"line\">\tCode int `json:code`</div><div class=\"line\">\tMessage  string `json:message`</div><div class=\"line\">\tData interface&#123;&#125; `json:data`</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">//进行初始化，改方法实现了Chaincode接口的Init方法</div><div class=\"line\">//GO语言的接口，只要你实现了改接口的方法，就可以认为是该接口的实现类。</div><div class=\"line\">//如果它看起来像鸭子，走起来像鸭子，叫起来像鸭子，它就是鸭子。</div><div class=\"line\">//这也是与JAVA不一样的地方，JAVA必须要关键字来指定实现某个接口</div><div class=\"line\">func (a *QueryChainCode) Init(stub shim.ChaincodeStubInterface) peer.Response &#123;</div><div class=\"line\">\treturn shim.Success(nil)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">//进行初始化，改方法实现了Chaincode接口的Init方法</div><div class=\"line\">func (a *QueryChainCode) Invoke(stub shim.ChaincodeStubInterface) peer.Response &#123;</div><div class=\"line\">\t//获取调用方法的名称和参数</div><div class=\"line\">\tfun,args := stub.GetFunctionAndParameters()</div><div class=\"line\">\tif fun ==&quot;query&quot;&#123;</div><div class=\"line\">\t\t//通过key查询数据</div><div class=\"line\">\t\treturn a.getDataById(stub,args[0])</div><div class=\"line\">\t&#125; else if fun == &quot;put&quot;&#123;</div><div class=\"line\">\t\tvar data QueryData</div><div class=\"line\">\t\terr := json.Unmarshal([]byte(args[0]), &amp;data)</div><div class=\"line\">\t\tif err != nil&#123;</div><div class=\"line\">\t\t\tfmt.Println(err)</div><div class=\"line\">\t\t\treturn shim.Error(&quot;保存数据报错&quot;+err.Error())</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t//保存数据</div><div class=\"line\">\t\treturn a.putData(stub,data)</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\treturn shim.Error(&quot;找不到方法！&quot;)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">func (a *QueryChainCode) getDataById(stub shim.ChaincodeStubInterface,queryId string)peer.Response  &#123;</div><div class=\"line\">\tvar data QueryData</div><div class=\"line\">\t//将ID加上前缀再进行查询</div><div class=\"line\">\tkey := Query_Prefix+queryId</div><div class=\"line\">\tb ,err := stub.GetState(key)</div><div class=\"line\">\tif b == nil&#123;</div><div class=\"line\">\t\treturn shim.Error(&quot;null&quot;)</div><div class=\"line\">\t&#125;</div><div class=\"line\">\terr = json.Unmarshal(b,&amp;data)</div><div class=\"line\">\tif err !=nil&#123;</div><div class=\"line\">\t\treturn shim.Error(&quot;null&quot;)</div><div class=\"line\">\t&#125;</div><div class=\"line\">\treturn shim.Success(getRetByte(0,&quot;&quot;,data))</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">func (a *QueryChainCode) putData(stub shim.ChaincodeStubInterface,data QueryData) peer.Response&#123;</div><div class=\"line\">\td,err := json.Marshal(data)</div><div class=\"line\">\tif err !=nil &#123;</div><div class=\"line\">\t\treturn shim.Error(&quot;null&quot;)</div><div class=\"line\">\t&#125;</div><div class=\"line\">\ttxId :=\tstub.GetTxID()</div><div class=\"line\">\t//将ID加上前缀进行保存</div><div class=\"line\">\terr = stub.PutState(Query_Prefix+ strconv.Itoa(data.QueryId),d)</div><div class=\"line\">\tif err != nil&#123;</div><div class=\"line\">\t\treturn shim.Error(&quot;null&quot;)</div><div class=\"line\">\t&#125;</div><div class=\"line\">\tfmt.Println(stub.GetChannelID())</div><div class=\"line\">\t//将TXID返回給调用方，方便跟业务数据进行对应</div><div class=\"line\">\treturn shim.Success(getRetByte(0,&quot;&quot;,txId))</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">func getRetByte(code int,msg string,data interface&#123;&#125;) []byte &#123;</div><div class=\"line\">\tvar r ChaincodeRet</div><div class=\"line\">\tr.Code = code</div><div class=\"line\">\tr.Message= msg</div><div class=\"line\">\tr.Data = data</div><div class=\"line\">\t//将数据封装成JSON对象返回給调用方</div><div class=\"line\">\tb,err := json.Marshal(r)</div><div class=\"line\"></div><div class=\"line\">\tif err!=nil &#123;</div><div class=\"line\">\t\tfmt.Println(&quot;marshal Ret failed&quot;+err.Error())</div><div class=\"line\">\t\treturn nil</div><div class=\"line\">\t&#125;</div><div class=\"line\">\treturn b</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"使用GO语言开发区块链应用\"><a href=\"#使用GO语言开发区块链应用\" class=\"headerlink\" title=\"使用GO语言开发区块链应用\"></a>使用GO语言开发区块链应用</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div></pre></td><td class=\"code\"><pre><div class=\"line\">package query</div><div class=\"line\"></div><div class=\"line\">//引入hypeledger 相关包</div><div class=\"line\">import (</div><div class=\"line\">\t&quot;encoding/json&quot;</div><div class=\"line\">\t&quot;fmt&quot;</div><div class=\"line\">\t&quot;github.com/hyperledger/fabric/common/flogging&quot;</div><div class=\"line\">\t&quot;github.com/hyperledger/fabric/core/chaincode/shim&quot;</div><div class=\"line\">\t&quot;github.com/hyperledger/fabric/protos/peer&quot;</div><div class=\"line\">\t&quot;strconv&quot;</div><div class=\"line\">)</div><div class=\"line\">var chaincodeLogger = flogging.MustGetLogger(&quot;QueryChaincode&quot;)</div><div class=\"line\"></div><div class=\"line\">// 设置存证的索引的前缀，用来隔离别的应用的数据</div><div class=\"line\">const Query_Prefix = &quot;Query_&quot;</div><div class=\"line\"></div><div class=\"line\">//定义存证链，需要进行存证的数据</div><div class=\"line\">type QueryData struct &#123;</div><div class=\"line\">\tQueryId  int `json:&quot;queryId&quot;`</div><div class=\"line\">\tIndexDigest string `json:&quot;indexDigest&quot;`</div><div class=\"line\">\tProvideQueryOrg string  `json:&quot;provideQueryOrg&quot;`</div><div class=\"line\">\tOfferOrg string `json:&quot;offerOrg&quot;`</div><div class=\"line\">\tQueryTime string `json:&quot;queryTime&quot;`</div><div class=\"line\">\tQueryType int  `json:&quot;queryType&quot;`</div><div class=\"line\">\tQueryResult int `json:&quot;queryResult&quot;`</div><div class=\"line\">\tQuerySerial string `json:&quot;querySerial&quot;`</div><div class=\"line\">\tHit int `json:&quot;hit&quot;`</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">type QueryChainCode struct &#123;</div><div class=\"line\"></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">// 应用返回的数据结构</div><div class=\"line\">type ChaincodeRet struct &#123;</div><div class=\"line\">\tCode int `json:code`</div><div class=\"line\">\tMessage  string `json:message`</div><div class=\"line\">\tData interface&#123;&#125; `json:data`</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">//进行初始化，改方法实现了Chaincode接口的Init方法</div><div class=\"line\">//GO语言的接口，只要你实现了改接口的方法，就可以认为是该接口的实现类。</div><div class=\"line\">//如果它看起来像鸭子，走起来像鸭子，叫起来像鸭子，它就是鸭子。</div><div class=\"line\">//这也是与JAVA不一样的地方，JAVA必须要关键字来指定实现某个接口</div><div class=\"line\">func (a *QueryChainCode) Init(stub shim.ChaincodeStubInterface) peer.Response &#123;</div><div class=\"line\">\treturn shim.Success(nil)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">//进行初始化，改方法实现了Chaincode接口的Init方法</div><div class=\"line\">func (a *QueryChainCode) Invoke(stub shim.ChaincodeStubInterface) peer.Response &#123;</div><div class=\"line\">\t//获取调用方法的名称和参数</div><div class=\"line\">\tfun,args := stub.GetFunctionAndParameters()</div><div class=\"line\">\tif fun ==&quot;query&quot;&#123;</div><div class=\"line\">\t\t//通过key查询数据</div><div class=\"line\">\t\treturn a.getDataById(stub,args[0])</div><div class=\"line\">\t&#125; else if fun == &quot;put&quot;&#123;</div><div class=\"line\">\t\tvar data QueryData</div><div class=\"line\">\t\terr := json.Unmarshal([]byte(args[0]), &amp;data)</div><div class=\"line\">\t\tif err != nil&#123;</div><div class=\"line\">\t\t\tfmt.Println(err)</div><div class=\"line\">\t\t\treturn shim.Error(&quot;保存数据报错&quot;+err.Error())</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t\t//保存数据</div><div class=\"line\">\t\treturn a.putData(stub,data)</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\treturn shim.Error(&quot;找不到方法！&quot;)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">func (a *QueryChainCode) getDataById(stub shim.ChaincodeStubInterface,queryId string)peer.Response  &#123;</div><div class=\"line\">\tvar data QueryData</div><div class=\"line\">\t//将ID加上前缀再进行查询</div><div class=\"line\">\tkey := Query_Prefix+queryId</div><div class=\"line\">\tb ,err := stub.GetState(key)</div><div class=\"line\">\tif b == nil&#123;</div><div class=\"line\">\t\treturn shim.Error(&quot;null&quot;)</div><div class=\"line\">\t&#125;</div><div class=\"line\">\terr = json.Unmarshal(b,&amp;data)</div><div class=\"line\">\tif err !=nil&#123;</div><div class=\"line\">\t\treturn shim.Error(&quot;null&quot;)</div><div class=\"line\">\t&#125;</div><div class=\"line\">\treturn shim.Success(getRetByte(0,&quot;&quot;,data))</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">func (a *QueryChainCode) putData(stub shim.ChaincodeStubInterface,data QueryData) peer.Response&#123;</div><div class=\"line\">\td,err := json.Marshal(data)</div><div class=\"line\">\tif err !=nil &#123;</div><div class=\"line\">\t\treturn shim.Error(&quot;null&quot;)</div><div class=\"line\">\t&#125;</div><div class=\"line\">\ttxId :=\tstub.GetTxID()</div><div class=\"line\">\t//将ID加上前缀进行保存</div><div class=\"line\">\terr = stub.PutState(Query_Prefix+ strconv.Itoa(data.QueryId),d)</div><div class=\"line\">\tif err != nil&#123;</div><div class=\"line\">\t\treturn shim.Error(&quot;null&quot;)</div><div class=\"line\">\t&#125;</div><div class=\"line\">\tfmt.Println(stub.GetChannelID())</div><div class=\"line\">\t//将TXID返回給调用方，方便跟业务数据进行对应</div><div class=\"line\">\treturn shim.Success(getRetByte(0,&quot;&quot;,txId))</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">func getRetByte(code int,msg string,data interface&#123;&#125;) []byte &#123;</div><div class=\"line\">\tvar r ChaincodeRet</div><div class=\"line\">\tr.Code = code</div><div class=\"line\">\tr.Message= msg</div><div class=\"line\">\tr.Data = data</div><div class=\"line\">\t//将数据封装成JSON对象返回給调用方</div><div class=\"line\">\tb,err := json.Marshal(r)</div><div class=\"line\"></div><div class=\"line\">\tif err!=nil &#123;</div><div class=\"line\">\t\tfmt.Println(&quot;marshal Ret failed&quot;+err.Error())</div><div class=\"line\">\t\treturn nil</div><div class=\"line\">\t&#125;</div><div class=\"line\">\treturn b</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n"},{"title":"2岁半in上海","date":"2017-07-01T05:39:23.000Z","_content":"\n## 2岁半in上海\n\n#### 场景一\n妈：我叫什么名字啊\n女儿：葫芦娃\n妈：错了，我叫什么名字啊\n女儿：王秀丽\n妈：你叫什么名字啊\n女儿：王秀丽\n妈：错了，你叫什么名字啊\n女儿：葫芦娃\n妈：。。。错了，你叫什么名字啊\n女儿：华欣晴。。。\n妈：爸爸叫什么名字啊\n女儿：葫芦娃。。。。\n只剩下在风中凌乱的爸爸..\n#### 场景二\n小华要洗澡的时候，脱衣服，从口袋里面掏出一大把硬币，\n原来我一个杯子里面的硬币全部被她收走。。\n真的是泼出去的水啊\n#### 场景三\n在老家来上海前，我抱者她在椅子上看动画片，本人喜欢吃蚕豆，刚好看到地上不远处有一颗，以为是她丢的，\n遂让她捡起来，告诉她勤俭节约的道理，结果叫了几次也没有动静，自己动手，捡来发现是一颗石头。。她在那\n笑着说，是我丢的。。。。\n\n\n","source":"_posts/小华日常.md","raw":"---\ntitle: 2岁半in上海\ndate: 2017-07-01 13:39:23\ncategories: \n\t- 日常生活\ntags:\n\t- 小华二三事\n---\n\n## 2岁半in上海\n\n#### 场景一\n妈：我叫什么名字啊\n女儿：葫芦娃\n妈：错了，我叫什么名字啊\n女儿：王秀丽\n妈：你叫什么名字啊\n女儿：王秀丽\n妈：错了，你叫什么名字啊\n女儿：葫芦娃\n妈：。。。错了，你叫什么名字啊\n女儿：华欣晴。。。\n妈：爸爸叫什么名字啊\n女儿：葫芦娃。。。。\n只剩下在风中凌乱的爸爸..\n#### 场景二\n小华要洗澡的时候，脱衣服，从口袋里面掏出一大把硬币，\n原来我一个杯子里面的硬币全部被她收走。。\n真的是泼出去的水啊\n#### 场景三\n在老家来上海前，我抱者她在椅子上看动画片，本人喜欢吃蚕豆，刚好看到地上不远处有一颗，以为是她丢的，\n遂让她捡起来，告诉她勤俭节约的道理，结果叫了几次也没有动静，自己动手，捡来发现是一颗石头。。她在那\n笑着说，是我丢的。。。。\n\n\n","slug":"小华日常","published":1,"updated":"2017-10-11T02:05:54.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck3st0eyk00201fihwbje81f5","content":"<h2 id=\"2岁半in上海\"><a href=\"#2岁半in上海\" class=\"headerlink\" title=\"2岁半in上海\"></a>2岁半in上海</h2><h4 id=\"场景一\"><a href=\"#场景一\" class=\"headerlink\" title=\"场景一\"></a>场景一</h4><p>妈：我叫什么名字啊<br>女儿：葫芦娃<br>妈：错了，我叫什么名字啊<br>女儿：王秀丽<br>妈：你叫什么名字啊<br>女儿：王秀丽<br>妈：错了，你叫什么名字啊<br>女儿：葫芦娃<br>妈：。。。错了，你叫什么名字啊<br>女儿：华欣晴。。。<br>妈：爸爸叫什么名字啊<br>女儿：葫芦娃。。。。<br>只剩下在风中凌乱的爸爸..</p>\n<h4 id=\"场景二\"><a href=\"#场景二\" class=\"headerlink\" title=\"场景二\"></a>场景二</h4><p>小华要洗澡的时候，脱衣服，从口袋里面掏出一大把硬币，<br>原来我一个杯子里面的硬币全部被她收走。。<br>真的是泼出去的水啊</p>\n<h4 id=\"场景三\"><a href=\"#场景三\" class=\"headerlink\" title=\"场景三\"></a>场景三</h4><p>在老家来上海前，我抱者她在椅子上看动画片，本人喜欢吃蚕豆，刚好看到地上不远处有一颗，以为是她丢的，<br>遂让她捡起来，告诉她勤俭节约的道理，结果叫了几次也没有动静，自己动手，捡来发现是一颗石头。。她在那<br>笑着说，是我丢的。。。。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"2岁半in上海\"><a href=\"#2岁半in上海\" class=\"headerlink\" title=\"2岁半in上海\"></a>2岁半in上海</h2><h4 id=\"场景一\"><a href=\"#场景一\" class=\"headerlink\" title=\"场景一\"></a>场景一</h4><p>妈：我叫什么名字啊<br>女儿：葫芦娃<br>妈：错了，我叫什么名字啊<br>女儿：王秀丽<br>妈：你叫什么名字啊<br>女儿：王秀丽<br>妈：错了，你叫什么名字啊<br>女儿：葫芦娃<br>妈：。。。错了，你叫什么名字啊<br>女儿：华欣晴。。。<br>妈：爸爸叫什么名字啊<br>女儿：葫芦娃。。。。<br>只剩下在风中凌乱的爸爸..</p>\n<h4 id=\"场景二\"><a href=\"#场景二\" class=\"headerlink\" title=\"场景二\"></a>场景二</h4><p>小华要洗澡的时候，脱衣服，从口袋里面掏出一大把硬币，<br>原来我一个杯子里面的硬币全部被她收走。。<br>真的是泼出去的水啊</p>\n<h4 id=\"场景三\"><a href=\"#场景三\" class=\"headerlink\" title=\"场景三\"></a>场景三</h4><p>在老家来上海前，我抱者她在椅子上看动画片，本人喜欢吃蚕豆，刚好看到地上不远处有一颗，以为是她丢的，<br>遂让她捡起来，告诉她勤俭节约的道理，结果叫了几次也没有动静，自己动手，捡来发现是一颗石头。。她在那<br>笑着说，是我丢的。。。。</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ck3st0exj00081fihuhekvn2k","category_id":"ck3st0exe00051fihkl1io1jp","_id":"ck3st0exq000e1fihthd1t49f"},{"post_id":"ck3st0ex400011fihy729g474","category_id":"ck3st0exe00051fihkl1io1jp","_id":"ck3st0exs000i1fihr7pdc7l4"},{"post_id":"ck3st0exq000d1fihamp1vkex","category_id":"ck3st0exo000a1fihdh0rw96h","_id":"ck3st0ext000l1fihb4jg1nl8"},{"post_id":"ck3st0exb00031fihcsobtpfo","category_id":"ck3st0exo000a1fihdh0rw96h","_id":"ck3st0exu000p1fihli2fe9qj"},{"post_id":"ck3st0exr000f1fiht7r2cbaz","category_id":"ck3st0exe00051fihkl1io1jp","_id":"ck3st0exz000x1fihcskjs1tj"},{"post_id":"ck3st0exr000f1fiht7r2cbaz","category_id":"ck3st0exu000n1fih1fue6jmv","_id":"ck3st0ey000121fihvlidz6nh"},{"post_id":"ck3st0exw000u1fihyymywovr","category_id":"ck3st0exe00051fihkl1io1jp","_id":"ck3st0ey000151fihjs4c75dh"},{"post_id":"ck3st0exw000u1fihyymywovr","category_id":"ck3st0exu000n1fih1fue6jmv","_id":"ck3st0ey3001a1fihl6qibfmq"},{"post_id":"ck3st0exm00091fih4qgacqse","category_id":"ck3st0exr000g1fihsp5dgvfc","_id":"ck3st0ey8001e1fihj1fc16lt"},{"post_id":"ck3st0exm00091fih4qgacqse","category_id":"ck3st0exz00101fihidcd0qjs","_id":"ck3st0eya001j1fihnk1oc0sq"},{"post_id":"ck3st0ext000m1fihacbz21ml","category_id":"ck3st0exv000s1fihfw5217sw","_id":"ck3st0eyd001m1fihu3ntqmjk"},{"post_id":"ck3st0exu000q1fihg1c9jihs","category_id":"ck3st0ey8001f1fih15iu72dq","_id":"ck3st0eyf001r1fih1j98aw5s"},{"post_id":"ck3st0exv000r1fihcrq04e0t","category_id":"ck3st0eyd001n1fihqr997b8t","_id":"ck3st0eyi001x1fihnhfhu6mw"},{"post_id":"ck3st0exy000w1fihm48d1sll","category_id":"ck3st0ey8001f1fih15iu72dq","_id":"ck3st0eyl00231fih9wyjuo1y"},{"post_id":"ck3st0eyi001w1fihnxioj152","category_id":"ck3st0exe00051fihkl1io1jp","_id":"ck3st0eym00271fihakz77yok"},{"post_id":"ck3st0eyi001w1fihnxioj152","category_id":"ck3st0exu000n1fih1fue6jmv","_id":"ck3st0eym00281fihl2jw6vhc"},{"post_id":"ck3st0exs000j1fihhba8n117","category_id":"ck3st0exv000s1fihfw5217sw","_id":"ck3st0eyn002a1fih1wwvnmm3"},{"post_id":"ck3st0exs000j1fihhba8n117","category_id":"ck3st0eyj001z1fihkfqrjlo5","_id":"ck3st0eyo002d1fihyci3zxol"},{"post_id":"ck3st0exz000z1fih2h2y4cj9","category_id":"ck3st0eyl00251fihyskrikam","_id":"ck3st0eyp002g1fihydhfsmd5"},{"post_id":"ck3st0ey000141fihcx5hke4y","category_id":"ck3st0eyn00291fihon5snfg4","_id":"ck3st0eyr002j1fih2qpv5b4n"},{"post_id":"ck3st0ey100171fiheftspurf","category_id":"ck3st0eyn00291fihon5snfg4","_id":"ck3st0eyt002o1fihp2z9el33"},{"post_id":"ck3st0ey5001b1fih9amyw4i2","category_id":"ck3st0eyl00251fihyskrikam","_id":"ck3st0eyt002r1fihude2zhrc"},{"post_id":"ck3st0ey7001d1fihdrv5z3kj","category_id":"ck3st0exv000s1fihfw5217sw","_id":"ck3st0eyu002v1fihwgzeekax"},{"post_id":"ck3st0ey7001d1fihdrv5z3kj","category_id":"ck3st0eyj001z1fihkfqrjlo5","_id":"ck3st0eyu002y1fih9b8p09r2"},{"post_id":"ck3st0ey9001i1fihzta9d96s","category_id":"ck3st0eyt002s1fihp4uc9uh0","_id":"ck3st0eyu00311fihpzrv9fwp"},{"post_id":"ck3st0eya001l1fihp4yzim7u","category_id":"ck3st0eyu002w1fihhsduhyn4","_id":"ck3st0eyv00341fihkq4in0f7"},{"post_id":"ck3st0eyd001p1fih8crnt7as","category_id":"ck3st0eyn00291fihon5snfg4","_id":"ck3st0eyw00371fihm191j3f1"},{"post_id":"ck3st0eye001q1fihzcx17w8j","category_id":"ck3st0eyv00351fihav4sid4w","_id":"ck3st0eyw003a1fihh9w237ak"},{"post_id":"ck3st0eyf001u1fih2myj85os","category_id":"ck3st0eyw00381fih3yq4ub3o","_id":"ck3st0eyx003d1fihi0asnbfx"},{"post_id":"ck3st0eyk00201fihwbje81f5","category_id":"ck3st0eyw003b1fihp9q7op0s","_id":"ck3st0eyy003i1fihlqg8bagg"}],"PostTag":[{"post_id":"ck3st0ex400011fihy729g474","tag_id":"ck3st0exg00061fihx5uokqls","_id":"ck3st0exp000c1fihtsckigwi"},{"post_id":"ck3st0exr000f1fiht7r2cbaz","tag_id":"ck3st0exg00061fihx5uokqls","_id":"ck3st0ext000k1fih8w8r0rnh"},{"post_id":"ck3st0exb00031fihcsobtpfo","tag_id":"ck3st0exp000b1fihmdx208v8","_id":"ck3st0exx000v1fihtosqbsf3"},{"post_id":"ck3st0exb00031fihcsobtpfo","tag_id":"ck3st0exr000h1fihgsglldj3","_id":"ck3st0exz000y1fihl34pe4hj"},{"post_id":"ck3st0exb00031fihcsobtpfo","tag_id":"ck3st0exu000o1fihfa56gd8t","_id":"ck3st0ey000131fihm1lg28gq"},{"post_id":"ck3st0exj00081fihuhekvn2k","tag_id":"ck3st0exv000t1fih2gbmos68","_id":"ck3st0ey100161fiheo4wpi1i"},{"post_id":"ck3st0exm00091fih4qgacqse","tag_id":"ck3st0exz00111fih7l2f3np2","_id":"ck3st0ey6001c1fih05omj9a6"},{"post_id":"ck3st0ey5001b1fih9amyw4i2","tag_id":"ck3st0exp000b1fihmdx208v8","_id":"ck3st0ey9001h1fih53tltrot"},{"post_id":"ck3st0ey5001b1fih9amyw4i2","tag_id":"ck3st0exr000h1fihgsglldj3","_id":"ck3st0eya001k1fihrk030u3m"},{"post_id":"ck3st0exq000d1fihamp1vkex","tag_id":"ck3st0exp000b1fihmdx208v8","_id":"ck3st0eyh001v1fihmxqzp0zr"},{"post_id":"ck3st0exq000d1fihamp1vkex","tag_id":"ck3st0exr000h1fihgsglldj3","_id":"ck3st0eyj001y1fihc832bqqx"},{"post_id":"ck3st0exq000d1fihamp1vkex","tag_id":"ck3st0ey9001g1fihgn12ikao","_id":"ck3st0eyl00221fiht4ov5tff"},{"post_id":"ck3st0exq000d1fihamp1vkex","tag_id":"ck3st0eyd001o1fihnyjpf1wb","_id":"ck3st0eyl00241fihdrijjicd"},{"post_id":"ck3st0exs000j1fihhba8n117","tag_id":"ck3st0eyf001t1fihirf4kltd","_id":"ck3st0eyn002c1fihi23kpxz9"},{"post_id":"ck3st0exs000j1fihhba8n117","tag_id":"ck3st0eyk00211fihddi69fcr","_id":"ck3st0eyo002e1fihzm8sqmak"},{"post_id":"ck3st0exs000j1fihhba8n117","tag_id":"ck3st0eym00261fih625crox0","_id":"ck3st0eyq002i1fihxhkeqf8i"},{"post_id":"ck3st0ext000m1fihacbz21ml","tag_id":"ck3st0eyk00211fihddi69fcr","_id":"ck3st0eyr002k1fihm0s7db2n"},{"post_id":"ck3st0exu000q1fihg1c9jihs","tag_id":"ck3st0eyp002h1fih239b6lu3","_id":"ck3st0eys002n1fihrv3ppaxo"},{"post_id":"ck3st0exv000r1fihcrq04e0t","tag_id":"ck3st0eys002m1fih5o4jedg9","_id":"ck3st0eyu002u1fihqefg7sui"},{"post_id":"ck3st0exv000r1fihcrq04e0t","tag_id":"ck3st0eyt002q1fihl9ao4mw2","_id":"ck3st0eyu002x1fihcpijjd05"},{"post_id":"ck3st0exw000u1fihyymywovr","tag_id":"ck3st0eyu002t1fihtfxnwast","_id":"ck3st0eyu00301fiheklxzbl6"},{"post_id":"ck3st0exy000w1fihm48d1sll","tag_id":"ck3st0eyu002z1fihx1bg6bgl","_id":"ck3st0eyx003e1fihcg0vtq7i"},{"post_id":"ck3st0exy000w1fihm48d1sll","tag_id":"ck3st0eyv00331fihwq4zvk7s","_id":"ck3st0eyy003f1fihfq6s0zg4"},{"post_id":"ck3st0exy000w1fihm48d1sll","tag_id":"ck3st0eyv00361fih63zsakvr","_id":"ck3st0eyy003h1fihwf3g19sx"},{"post_id":"ck3st0exy000w1fihm48d1sll","tag_id":"ck3st0eyw00391fih1e5pfnco","_id":"ck3st0eyy003j1fihrvq02bzq"},{"post_id":"ck3st0exz000z1fih2h2y4cj9","tag_id":"ck3st0exp000b1fihmdx208v8","_id":"ck3st0eyz003l1fihmonei13x"},{"post_id":"ck3st0exz000z1fih2h2y4cj9","tag_id":"ck3st0exr000h1fihgsglldj3","_id":"ck3st0eyz003m1fihz3hp53mq"},{"post_id":"ck3st0exz000z1fih2h2y4cj9","tag_id":"ck3st0eyx003c1fihmtq29i6k","_id":"ck3st0eyz003o1fihp1nqsobe"},{"post_id":"ck3st0ey000141fihcx5hke4y","tag_id":"ck3st0eyy003g1fihuo9v1lrg","_id":"ck3st0ez0003p1fihnr5201nw"},{"post_id":"ck3st0ey000141fihcx5hke4y","tag_id":"ck3st0eyz003k1fihe360txek","_id":"ck3st0ez0003r1fihblg2tl9f"},{"post_id":"ck3st0ey100171fiheftspurf","tag_id":"ck3st0eyy003g1fihuo9v1lrg","_id":"ck3st0ez1003s1fihrd5c6xzm"},{"post_id":"ck3st0ey7001d1fihdrv5z3kj","tag_id":"ck3st0eyf001t1fihirf4kltd","_id":"ck3st0ez2003v1fihjg3h2xgg"},{"post_id":"ck3st0ey7001d1fihdrv5z3kj","tag_id":"ck3st0ez1003t1fihlbun2ekr","_id":"ck3st0ez2003w1fihr2tmnc5u"},{"post_id":"ck3st0ey9001i1fihzta9d96s","tag_id":"ck3st0ez2003u1fih6v6txaia","_id":"ck3st0ez3003z1fihq953s38p"},{"post_id":"ck3st0ey9001i1fihzta9d96s","tag_id":"ck3st0ez3003x1fihncpq4xrw","_id":"ck3st0ez300401fihh16cvqfz"},{"post_id":"ck3st0eya001l1fihp4yzim7u","tag_id":"ck3st0ez3003y1fihl6jxbpxc","_id":"ck3st0ez400421fihni4hat8b"},{"post_id":"ck3st0eyd001p1fih8crnt7as","tag_id":"ck3st0ez300411fihh3koz1m3","_id":"ck3st0ez400441fihecnaow58"},{"post_id":"ck3st0eye001q1fihzcx17w8j","tag_id":"ck3st0ez400431fih98jhstyl","_id":"ck3st0ez500461fihf495ywbl"},{"post_id":"ck3st0eyf001u1fih2myj85os","tag_id":"ck3st0eyu002z1fihx1bg6bgl","_id":"ck3st0ez600481fih52zb7o4n"},{"post_id":"ck3st0eyi001w1fihnxioj152","tag_id":"ck3st0ez500471fihupzwiinu","_id":"ck3st0ez6004a1fih8ovzc6it"},{"post_id":"ck3st0eyk00201fihwbje81f5","tag_id":"ck3st0ez600491fihbxqw90ut","_id":"ck3st0ez7004b1fih82euvzc1"}],"Tag":[{"name":"hyperledger 多机器部署","_id":"ck3st0exg00061fihx5uokqls"},{"name":"linux","_id":"ck3st0exp000b1fihmdx208v8"},{"name":"centos6.5","_id":"ck3st0exr000h1fihgsglldj3"},{"name":"crontab","_id":"ck3st0exu000o1fihfa56gd8t"},{"name":"hyperledger CA部署","_id":"ck3st0exv000t1fih2gbmos68"},{"name":"python","_id":"ck3st0exz00111fih7l2f3np2"},{"name":"gitlab","_id":"ck3st0ey9001g1fihgn12ikao"},{"name":"git","_id":"ck3st0eyd001o1fihnyjpf1wb"},{"name":"spark","_id":"ck3st0eyf001t1fihirf4kltd"},{"name":"hive","_id":"ck3st0eyk00211fihddi69fcr"},{"name":"hive on spark","_id":"ck3st0eym00261fih625crox0"},{"name":"安装","_id":"ck3st0eyp002h1fih239b6lu3"},{"name":"数组","_id":"ck3st0eys002m1fih5o4jedg9"},{"name":"查找index","_id":"ck3st0eyt002q1fihl9ao4mw2"},{"name":"hyperledger 测试","_id":"ck3st0eyu002t1fihtfxnwast"},{"name":"java","_id":"ck3st0eyu002z1fihx1bg6bgl"},{"name":"垃圾回收","_id":"ck3st0eyv00331fihwq4zvk7s"},{"name":"读书笔记","_id":"ck3st0eyv00361fih63zsakvr"},{"name":"jvm","_id":"ck3st0eyw00391fih1e5pfnco"},{"name":"openvpn","_id":"ck3st0eyx003c1fihmtq29i6k"},{"name":"安装mysql","_id":"ck3st0eyy003g1fihuo9v1lrg"},{"name":"主从同步","_id":"ck3st0eyz003k1fihe360txek"},{"name":"pyspark","_id":"ck3st0ez1003t1fihlbun2ekr"},{"name":"nginx","_id":"ck3st0ez2003u1fih6v6txaia"},{"name":"openssl","_id":"ck3st0ez3003x1fihncpq4xrw"},{"name":"php","_id":"ck3st0ez3003y1fihl6jxbpxc"},{"name":"导出数据","_id":"ck3st0ez300411fihh3koz1m3"},{"name":"hash","_id":"ck3st0ez400431fih98jhstyl"},{"name":"hyperledger 应用","_id":"ck3st0ez500471fihupzwiinu"},{"name":"小华二三事","_id":"ck3st0ez600491fihbxqw90ut"}]}}